package com.jzy.hio.oa.bbs.service.impl;

import java.util.ArrayList;
import java.util.List;
import org.springframework.beans.BeanUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import com.jzy.hio.base.service.impl.BaseServiceImpl;
import com.jzy.hio.base.utils.IDGenerator;
import com.jzy.hio.oa.bbs.entity.BbsForumPermission;
import com.jzy.hio.oa.bbs.mapper.BbsForumPermissionDao;
import com.jzy.hio.oa.bbs.service.BbsForumPermissionService;

/**
 * @author admin
 * 
 * 
 */

@Service
public class BbsForumPermissionServiceImpl extends  BaseServiceImpl<String,BbsForumPermission> implements BbsForumPermissionService{
	

	@Autowired
	private BbsForumPermissionDao bbsForumPermissionDao;

	@Override
	public void savePermissionService(BbsForumPermission bbsForumPermission) {
		List<BbsForumPermission> bbsForumPermissionList=new ArrayList<BbsForumPermission>();
		if(bbsForumPermission!=null && bbsForumPermission.getRoleId()!=null){
			String[] roleIds=bbsForumPermission.getRoleId().split(",");
			String[] roleNames=bbsForumPermission.getRoleName().split(",");
			for(int i=0;i<roleIds.length;i++){
				BbsForumPermission bbsForumPermissionNew=new BbsForumPermission();
				BeanUtils.copyProperties(bbsForumPermission, bbsForumPermissionNew);
				bbsForumPermissionNew.setRoleId(roleIds[i]);
				bbsForumPermissionNew.setRoleName(roleNames[i]);
				bbsForumPermissionNew.setDelflag(false);
				bbsForumPermissionNew.setId(IDGenerator.getUUID());
				bbsForumPermissionList.add(bbsForumPermissionNew);
			}
			this.saveBatch(bbsForumPermissionList);
		}
	}

	@Override
	public void deleteByForumId(BbsForumPermission bbsForumPermission) {
		bbsForumPermissionDao.deleteByForumId(bbsForumPermission);
	}

	@Override
	public BbsForumPermission getPermissionFormRole(String id) {
			BbsForumPermission bfp = new BbsForumPermission();
			bfp.setForumId(id);
			bfp.setDelflag(false);
			List<BbsForumPermission> bbsForumPermissionList= this.queryList(bfp);
			String roleIds="";
			String roleNames="";
			if(bbsForumPermissionList!=null && bbsForumPermissionList.size()>0){
				for(int i=0;i<bbsForumPermissionList.size();i++){
					BbsForumPermission bbsForumPermission=bbsForumPermissionList.get(i);
					if(!"".equals(roleIds)){
						roleIds+=",";
					}
					if(!"".equals(roleNames)){
						roleNames+=",";
					}
					roleIds+=bbsForumPermission.getRoleId();
					roleNames+=bbsForumPermission.getRoleName();
				}
			}
			BbsForumPermission bbsForumPermission = new BbsForumPermission();
			bbsForumPermission.setRoleId(roleIds);
			bbsForumPermission.setRoleName(roleNames);
			return bbsForumPermission;
	}
	
	

}
