<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>考勤历史月报</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <script src="../../common/common.css.js"></script>
    <link rel="styleSheet" href="css/kq.css">
    <link rel="stylesheet" href="../common/multiselect/multiple-select.css" />
	<link rel="styleSheet" href="../../common/custom/css/indexHr.css" >
</head>
<style>
    .tit-box .more > .btn {
        background: #fff;
    }
    .ui-jqgrid tr.jqgrow td {
        text-overflow: ellipsis;
    }
    .tit-big{
        font-weight: bold;
        font-size: 140%;
    }
    .tableDay{
        height:auto!important;
    }
    .tableMonth{
        height:auto!important;
    }
    html { overflow-x: hidden; }
	.title_month_bg {
        width: 78% !important;
    }
	#monthDivHeader .user-list,#monthDiv .user-list{
		line-height: inherit !important;
		background: #E4F2FF;
		height: 80px;
		position: relative;
		border: none !important;
		border-top-left-radius: 8px;
		border-top-right-radius: 8px;
		margin-bottom:10px;
		overflow:hidden;
		padding:0;
		width:100%;
	}
</style>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <div class="">
                <div class="xj-form-tab mt20 mb10 container-fluid">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="title_month_bg" style="border:1px solid #ddd;margin-top: 4px;">
                                <i class="fa fa-list addBlue" aria-hidden="true"></i>
                                <input type="hidden" name="nowKqMonth" id="nowKqMonth"/>
                                <input type="hidden" id="nowKqStartDate"/>
                                <input type="hidden" id="nowKqEndDate"/>
                                <input type="hidden" id="month1"/>
                                <input type="hidden" id="month2"/>
                                <input type="hidden" id="kqStartDate"/>
                                <input type="hidden" id="kqEndDate"/>
                                <div class="show1">
                                    <select class="form-control" id="yearSelect" name="yearSelect" onchange="annualQuery()"
                                            style="width:100%; margin:0;padding:0;border:none!important">
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-9 btns-group clearfix">
                            <button class="btn btn-sm btn-adv" id="closeWindow">返回</button>
                        </div>
                    </div>
                </div>
                <form class="form-inline">
                    <div id="monthDivHeader">
                    </div>
                    <div id="temp"></div>
                    <!--加载模板-->
                    <div   id="temp_11" style="display:none;margin-left: -1.1%;width:102.13%">
                        <div class="col-md-12 right-content ">
                            <div class="con-tit" id="rightContentOne">
                                <button class="btn btn-default btn-sm byuser active kqSummaryDay" style="margin-top: -4px">原始打卡数据</button>
                                <button class="btn btn-default btn-sm kqSummaryMonth" style="margin-top: -4px">考勤月结果</button>

                                <div class="tableSearchBox cearfix" id="colorDiv" style="margin-top: 2px">
                                    <div class="color-dec-bd color-dec-bd-c1">
                                        <span>异常</span>
                                    </div>
                                    <div class="color-dec-bd color-dec-bd-c2">
                                        <span>请假</span>
                                    </div>
                                    <div  class="color-dec-bd color-dec-bd-c3">
                                        <span>出差</span>
                                    </div>
                                    <div class="color-dec-bd color-dec-bd-c4">
                                        <span>市内公出</span>
                                    </div>
                                    <div class="color-dec-bd color-dec-bd-c5">
                                        <span>补打卡说明</span>
                                    </div>
                                    <div class="color-dec-bd color-dec-bd-c6">
                                        <span>流程未结束</span>
                                    </div>
                                    <a class="help-web helpMement" target="_blank" href="javascript:void(0);"
                                       alt="考勤统计说明" title="异常：当天只要存在迟到、早退、旷工任何一种情况则标记为异常
请假：当天只要有通过审批的请假申请且不存在异常情况则显示为请假
出差：当天只要有通过审批的出差申请且不存在异常情况则显示为出差
市内公出：当天只要有通过审批的公出申请且不存在异常情况则显示为市内公出
补打卡申请：当天只要有通过审批的补打卡申请且不存在异常情况则显示为补打卡申请
流程未结束：当天只要有审批中的请假/出差/公出/补打卡申请且不存在异常情况则显示为流程未结束
当一天内存在多个考勤结果时，则按照异常>请假>出差>市内公出>补打卡申请>流程未结束的优先级进行标记，且只标记为一个颜色"
                                       style="margin-left: 5px">
                                    </a>
                                </div>
                            </div>
                            <!--考勤日明细-->
                            <input type="hidden" name="orgId" id="orgId"/>

                            <div class="con-table" id="dayDiv" style="display:block;background-color: #F4F4F4;">
                                <div class="user-list" id="stationList" style="padding-top:10px;background-color: #F4F4F4;overflow: inherit;width: 100%;height: auto;">
                                    <div class="tableSearchBox clearfix" style="">

                                        <!--输入框查询-->
                                        <input type="text" class="form-control" placeholder="姓名/拼音/手机号" id="name"
                                               onchange="queryConditionList()">
                                        <!--考勤方案-->
                                        <select name="kqPlan" id="kqPlan" multiple="multiple" data-placeholder="考勤方案" size="1">
                                        </select>

                                        <!--所属机构-->
                                        <div class="input-group">
                                            <input type="hidden" id="orgIds" class="form-control"
                                                   name="orgIds">
                                            <input type="text" class="form-control"
                                                   id="orgNames" name="orgNames"
                                                   readonly="readonly" placeholder="所属机构">
                                            <div class="input-group-addon">
                                                <a class="glyphicon glyphicon-remove" onclick="empty()"></a>
                                            </div>
                                            <span class="input-group-addon w28">
                                            <a class="fa fa-ellipsis-h hr-multiple-selector"
                                               data-selectorType="org" data-treeParam='{"noChildren":"1"}'
                                               data-placeholder="所属机构" data-targetId="orgIds" data-targetname="orgNames"
                                               data-saveCallback="orgCallback"></a>
                                        </span>
                                        </div>

                                        <!--查询按钮-->
                                        <button class="btn btn-sm btn-dim" onclick="queryConditionList();" 
                                        	style="margin-top: 1px;margin-left: 3px; width: 39px;height: 39px;vertical-align: middle;">
		                                    <i style="width:38px; height:38px; display:inline-block;">
		                                        <img style="width:38px; height:38px;" src="../images/fdj.png" />
		                                    </i>
		                                </button>
                                    </div>
                                    <!--查询结束-->
                                    <div class="my-btn-group" style="margin-top:0px;margin-right:20px;float:right;">
                                        <button class="btn btn-default" style="margin-left: 35%;display: none"
                                                id="exportBtnDay">导出
                                        </button>
                                    </div>

                                </div>
                                <div class="mytable tableStyle tableDay" id="day">
                                    <table id="listResultByDay"></table>
                                    <!--<div id="pager2"></div>-->
                                </div>
                            </div>
                            <!--考勤月结果-->
                            <div class="con-table" id="monthDiv" style="display:none;background-color: #F4F4F4;">
                    			<div class="user-list" id="userList" style="padding-top:10px;background-color: #F4F4F4;overflow: inherit;width: 100%;height: auto;">
                                    <!--<span><span class="org-icons list-icon"></span><span class="tit">考勤月结果</span></span>-->
                                    <div class="tableSearchBox clearfix" style="background-color: #F5F5F5">
                                        <!--输入框查询-->
                                        <input type="text" class="form-control" placeholder="姓名/拼音/手机号" id="name2"
                                               onchange="queryConditionList2()">
                                        <!--考勤方案-->
                                        <select name="kqPlan2" id="kqPlan2" multiple="multiple" data-placeholder="考勤方案" size="1">
                                        </select>
                                        <!--所属机构-->
                                        <div class="input-group">
                                            <input type="hidden" id="orgIds2" class="form-control"
                                                   name="orgIds2">
                                            <input type="text" class="form-control"
                                                   id="orgNames2" name="orgNames2"
                                                   readonly="readonly" placeholder="所属机构">
                                            <div class="input-group-addon">
                                                <a class="glyphicon glyphicon-remove" onclick="empty2()"></a>
                                            </div>
                                            <span class="input-group-addon w28">
                                            <a class="fa fa-ellipsis-h hr-multiple-selector"
                                               data-selectorType="org" data-treeParam='{"noChildren":"1"}'
                                               data-placeholder="所属机构" data-targetId="orgIds" data-targetname="orgNames"
                                               data-saveCallback="orgCallback2"></a>
                                        </span>
                                        </div>

                                        <!--查询按钮-->
                                        <button class="btn btn-sm btn-dim" onclick="queryConditionList2();" 
                                        	style="margin-top: 1px;margin-left: 3px; width: 39px;height: 39px;vertical-align: middle;">
		                                    <i style="width:38px; height:38px; display:inline-block;">
		                                        <img style="width:38px; height:38px;" src="../images/fdj.png" />
		                                    </i>
		                                </button>
                                    </div>
                                    <!--查询结束-->
                                    <div class="my-btn-group" style="margin-top:0px;margin-right:20px;float: right;">
                                        <!--<button class="btn btn-default" onclick="calculate()">计算</button>-->
                                        <button class="btn btn-default" style="margin-left: 30%;display: none"
                                                id="exportBtnMonth">导出
                                        </button>
                                    </div>
                                </div>

                                <div class="mytable tableStyle tableMonth" id="month">
                                    <table id="listResultByMonth"></table>
                                </div>

                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<form id="exportParaForm" style="display: none;"  method="post">
    <input type="hidden" id="orgIdList" name="orgIdList"/>
    <!--<input type="hidden" id="name" name="name"/>-->
    <input type="hidden" id="planIdList" name="planIdList"/>
    <input type="hidden" id="date" name="date"/>
    <input type="hidden" id="type" name="type"/>
    <input type="hidden" id="startDate" name="startDate"/>
    <input type="hidden" id="endDate" name="endDate"/>
</form>


<input type="hidden" id="jqGridId" name="jqGridId"/>
<input type="hidden" id="modalId" name="modalId"/>
<!--treeModal出差-->
<div class="modal fade" id="bussModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">出差信息</span>

                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                    关闭
                </button>
            </div>

            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="bussList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal出差结束-->

<!--treeModal市内公出-->
<div class="modal fade" id="cityCussModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">市内公出信息</span>
                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                    	关闭
                </button>
            </div>
            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="cityBussList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal市内公出结束-->

<!--treeModal迟到-->
<div class="modal fade" id="kqLateModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">迟到信息</span>
                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                    	关闭
                </button>
            </div>
            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqLateList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal迟到结束-->

<!--treeModal早退-->
<div class="modal fade" id="kqLeaveEarlyModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">早退信息</span>
                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                    	关闭
                </button>
            </div>
            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqLeaveEarlyList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal早退结束-->

<!--treeModal旷工-->
<div class="modal fade" id="kqAbsenceModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">旷工信息</span>
                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                    	关闭
                </button>
            </div>
            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqAbsenceList"></table>
                    </div>
                    <!--<div class="mytable tableStyle">-->
                    <!--<table id="kqRestInApprovalList"></table>-->
                    <!--</div>-->
                    <!--<div class="mytable tableStyle">-->
                    <!--<table id="kqBussInApprovalList"></table>-->
                    <!--</div>-->
                    <!--<div class="mytable tableStyle">-->
                    <!--<table id="kqNoSignInApprovalList"></table>-->
                    <!--</div>-->
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal旷工结束-->

<!--treeModal漏打卡-->
<div class="modal fade bs-example-modal-sm" id="kqNoSignModal" tabindex="-1" role="dialog"
     aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">漏打卡信息</span>
                <button type="button" class="btn btn-sm blue pull-right mr20 modal-cancel">关闭</button>
            </div>

            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqNoSignList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal漏打卡结束-->

<!--treeModal年假-->
<div class="modal fade" id="kqAnnualLeaveModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">年假信息</span>
                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                   	关闭
                </button>
            </div>
            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqAnnualLeaveList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal年假结束-->

<!--treeModal事假-->
<div class="modal fade" id="kqAbsenceLeaveModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">事假信息</span>
                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                    	关闭
                </button>
            </div>
            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqAbsenceLeaveList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal事假结束-->

<!--treeModal病假-->
<div class="modal fade" id="kqSickLeaveModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">病假信息</span>
                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                    	关闭
                </button>
            </div>
            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqSickLeaveList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal病假结束-->

<!--treeModal婚假-->
<div class="modal fade" id="kqMaritalLeaveModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">婚假信息</span>
                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                    	关闭
                </button>
            </div>
            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqMaritalLeaveList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal婚假结束-->

<!--treeModal产假-->
<div class="modal fade" id="kqMaternityLeaveModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">产假信息</span>
                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                    	关闭
                </button>
            </div>
            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqMaternityLeaveList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal产假结束-->

<!--treeModal带薪假-->
<div class="modal fade" id="kqPaidLeaveModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">带薪假信息</span>
                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                    	关闭
                </button>
            </div>
            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqPaidLeaveList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal带薪假结束-->

<!--treeModal其他假期-->
<div class="modal fade" id="kqOtherLeaveModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">其他假期信息</span>
                <button class="btn btn-sm blue pull-right mr20" data-dismiss="modal" aria-label="Close">关闭</button>
            </div>
            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqOtherLeaveList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal其他假期结束-->

<!--treeModal请假审批中-->
<div class="modal fade" id="kqRestInApprovalModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">审批中请假信息</span>
                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                    	关闭
                </button>

            </div>

            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqRestInApprovalList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal请假审批中结束-->

<!--treeModal出差审批中-->
<div class="modal fade" id="kqBussInApprovalModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">审批中出差信息</span>
                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                    	关闭
                </button>
            </div>

            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqBussInApprovalList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal出差审批中结束-->

<!--treeModal补打卡审批中-->
<div class="modal fade" id="kqNoSignInApprovalModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">审批中补打卡信息</span>
                <button class="btn btn-sm blue pull-right mr20 modal-cancel" data-dismiss="modal" aria-label="Close">
                    	关闭
                </button>
            </div>
            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqNoSignInApprovalList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal补打卡审批中结束-->

<!--treeModal市内公出审批中-->
<div class="modal fade" id="kqBussPublicInApprovalModal" tabindex="-1" role="dialog" aria-labelledby="treeModalLabel">
    <div class="modal-dialog modal-grid" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span class="form-title" style="position: absolute;left: 50%">审批中市内公出信息</span>
                <button class="btn btn-sm blue pull-right mr20  modal-cancel" data-dismiss="modal" aria-label="Close">
                    	关闭
                </button>
            </div>
            <div class="modal-body">
                <div class="xj-form-content">
                    <div class="mytable tableStyle">
                        <table id="kqBussPublicInApprovalList"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--treeModal市内公出审批中结束-->
<iframe name="exportTarget" id="exportTarget" style="display:none;"></iframe>
<script src="../../common/common_hr.js"></script>
<script src="kqUtils.js"></script>
<script src="kq_summary_historical_monthly_report.js"></script>
<script src="../common/multiselect/multiple-select.js"></script>
</body>
</html>
