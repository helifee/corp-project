package com.jzy.fileserver.service;

import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertTrue;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import com.jzy.fileserver.controller.params.FileSendParam;
import com.jzy.fileserver.domain.Result;
import com.jzy.fileserver.utils.UUIDGenerator;

@RunWith(SpringRunner.class)
@SpringBootTest
public class FileServiceTests {
	
	@Autowired
	private FileService fileService;

	@Test
	public void contextLoads() {
	}

	@Test
	public void secondSend() {
		FileSendParam fileSendParam = new FileSendParam();
		fileSendParam.setApplicationCode("xxx");
		fileSendParam.setFileMd5("ab");
		fileSendParam.setFileName("a(1).txt");
		Result result = fileService.secondSend(fileSendParam);
		assertTrue(result.isSuccess());
	}
	
	@Test
	public void secondSend2() {
		FileSendParam fileSendParam = new FileSendParam();
		fileSendParam.setApplicationCode("xxx");
		fileSendParam.setFileMd5("abc");
		fileSendParam.setFileName("a(1).txt");
		Result result = fileService.secondSend(fileSendParam);
		assertFalse(result.isSuccess());
	}
	
	@Test
	public void saveUserFile() {
		String applicationCode = "hr";
		String fileMd5 = UUIDGenerator.getUUID();
//		String fileMd5 = "05fd21f56cb24fe5b90820a53eb3ce75";
		String fileName = "save.txt";
		String fileLocation = "b/c/e";
		long fileId = fileService.saveUserFile(applicationCode, fileMd5, fileName, fileLocation);
		assertNotNull(fileId);
//		assertEquals("46678edb5c8e47d98f0d85b947b2bf33", fileId);
	}
	
}
