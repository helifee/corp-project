<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jzy.hio.oa.task.mapper.TaskSharedMapper">

	<update id="delete">
		UPDATE `pt_task_shared` a SET a.`delflag` =
		#{delflag} WHERE 1=1 
		
		<if test="taskId != null">
			AND a.`task_id` = #{taskId}
		</if>
		
		<if test="calendarId != null">
			AND a.`calendar_id` = #{calendarId}
		</if>
		
	</update>

	<select id="queryTaskSharedList" resultType="com.jzy.hio.entity.TaskShared">

		SELECT
		`id`,
		`task_id` AS taskId,
		`create_person_id` AS createPersonId,
		`create_person_name` AS createPersonName,
		`create_date` AS createDate,
		`update_person_id` AS updatePersonId,
		`update_person_name` AS updatePersonName,
		`update_date` AS updateDate,
		`type`,
		`sharedshow_id` AS sharedshowId,
		`concurrency_version` AS concurrencyVersion,
		`delflag`,sharedshow_imid AS sharedshowImid,outType 
		FROM
		`pt_task_shared`
		WHERE delflag = '0'
		
		<if test="taskId != null">
			AND task_id = #{taskId}
		</if>
		
		<if test="type != null">
			AND type = #{type}
		</if>
		
		<if test="sharedshowId != null">
			AND sharedshow_id = #{sharedshowId}
		</if>
		
	</select>
	
	<update id="updateIsFollow">
		UPDATE `pt_task_shared` a SET a.`isfollow`
		= #{isfollow}
		WHERE a.`task_id` = #{taskId}
	</update>
</mapper>