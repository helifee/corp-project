package com.jzy.hio.oa.project.controller;

import com.jzy.hio.exception.HioMybatisQueryException;
import com.jzy.hio.oa.project.dto.ProjectTeamPersonPageParam;
import com.jzy.hio.oa.project.service.ProjectTeamPersonService;
import com.jzy.hio.utils.LoginUser;
import com.jzy.hio.utils.Page;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import com.jzy.hio.base.controller.BaseController;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

/**
 * 关注
 *
 * @author yangn
 *
 */
@RestController
@RequestMapping("project/projectTeamPerson")
public class ProjectTeamPersonController extends BaseController {

	private static Logger logger = LoggerFactory.getLogger(ProjectTeamPersonController.class);
	@Autowired
	private ProjectTeamPersonService projectTeamPersonService;

	/**
	 *
	 * 项目团队列表 page
	 * 
	 * @param
	 * @return
	 */
	@RequestMapping(value = "/page", method = RequestMethod.POST, consumes = "application/json")
	public Page page(@RequestBody ProjectTeamPersonPageParam param) throws HioMybatisQueryException {

		try {
			LoginUser loginUser = getLoginUser();
			return projectTeamPersonService.queryTeamPersonPage(param, loginUser);
		} catch (Exception e) {
			logger.error("获取项目信息分页失败!" + e.getMessage());
			throw new HioMybatisQueryException(e);
		}
	}

	/**
	 *
	 * 项目团队列表 List
	 *
	 * @param
	 * @return
	 */
	@RequestMapping(value = "/queryProjectTeamPersonByProjectId/{id}", method = RequestMethod.GET)
	public Object queryProjectTeamPersonByProjectId(@PathVariable("id") String id) throws HioMybatisQueryException {

		try {
			LoginUser loginUser = getLoginUser();
			/**
			 * 1.0版本
			 */
			return projectTeamPersonService.queryProjectTeamPersonTreeBak20180628(id, loginUser);
			/**
			 * 2.0版本
			 */
			//return projectTeamPersonService.queryProjectTeamPersonTree(id, loginUser);
		} catch (Exception e) {
			logger.error("获取项目团队树失败!" + e.getMessage());
			throw new HioMybatisQueryException(e);
		}
	}

	/**
	 *
	 * 项目团队列表 List
	 *
	 * @param
	 * @return
	 */
	@RequestMapping(value = "/queryProjectTeamPersonByProjectIdBak20180628/{id}", method = RequestMethod.GET)
	public Object queryProjectTeamPersonByProjectIdBak20180628(@PathVariable("id") String id) throws HioMybatisQueryException {

		try {
			LoginUser loginUser = getLoginUser();

			/**
			 * 1.0版本
			 */
			//return projectTeamPersonService.queryProjectTeamPersonTreeBak20180628(id, loginUser);
			/**
			 * 2.0版本
			 */
			return projectTeamPersonService.queryProjectTeamPersonTree(id, loginUser);
		} catch (Exception e) {
			logger.error("获取项目团队树失败!" + e.getMessage());
			throw new HioMybatisQueryException(e);
		}
	}
}
