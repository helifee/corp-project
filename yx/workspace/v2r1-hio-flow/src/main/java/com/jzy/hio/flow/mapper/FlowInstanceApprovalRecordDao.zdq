package com.jzy.hio.flow.mapper;

import java.util.Date;
import java.util.List;

import org.apache.ibatis.annotations.Param;

import com.jzy.hio.base.mapper.BaseMapper;
import com.jzy.hio.flow.entity.FlowInstanceApprovalRecord;
import com.jzy.hio.flow.entity.dto.ApprovalDto;
import com.jzy.hio.flow.entity.param.ApprovalParam;

public interface FlowInstanceApprovalRecordDao extends BaseMapper<FlowInstanceApprovalRecord> {

	/**
	 * 查询我的审批列表
	 * 
	 * @param approvalDTO
	 * @return
	 */
	List<ApprovalDto> getMyApprvoalList(ApprovalParam approvalParam);

	/**
	 * 查询我的审批列表总数
	 * 
	 * @return
	 */
	List<String> getCountMyApprvoalList(ApprovalParam approvalParam);

	/**
	 * 修改审批状态
	 * 
	 * @param instanceId
	 * @param instanceAcId
	 * @param approvalUser
	 * @return
	 */
	List<FlowInstanceApprovalRecord> queryApprovalRecord(@Param("instanceId") String instanceId,
			@Param("approvalUser") String approvalUser);

	/**
	 * 查询当前环节未审批是否为空
	 * 
	 * @param instanceId
	 * @param instanceAcId
	 * @return
	 */
	Integer queryUnapprovedRecordCount(@Param("instanceId") String instanceId,
			@Param("instanceAcId") String instanceAcId);

	/**
	 * 修改 加签 环节的审批人状态
	 * 
	 * @param flowInstanceApprovalRecord
	 */
	int updateApprovalState(FlowInstanceApprovalRecord flowInstanceApprovalRecord);

	/**
	 * 查询当前环节审批记录
	 * 
	 * @param approvalRecord
	 * @return
	 */
	List<FlowInstanceApprovalRecord> queryCurrentApprovedByInstanceAcId(FlowInstanceApprovalRecord approvalRecord);

	/**
	 * 查询加签上一共有多少人
	 * 
	 * @param instanceAcId_label
	 * @param instanceId
	 * @return
	 */
	List<FlowInstanceApprovalRecord> queryApporverList(@Param("instanceAcId") String instanceAcId, @Param("instanceId") String instanceId);

	/**
	 * 查询审批过的一共多少人
	 * 
	 * @param instanceId
	 * @return
	 */
	List<String> queryHaveApproval(@Param("instanceId") String instanceId);

	/**
	 * 修改驳回状态
	 * 
	 * @param isAdmin
	 * @param instanceAcId 
	 * 
	 * @param flowInstanceData
	 */
	int updateRejectState(@Param("instanceId") String instanceId, @Param("state") Integer state,
			@Param("desc") String desc, @Param("currentUserId") String currentUserId, @Param("isAdminOperation") boolean isAdminOperation,
			@Param("instanceAcId") String instanceAcId, @Param("updateDate") Date updateDate);

	/**
	 * 查询本环节的 审批人
	 * 
	 * @param currentAcIds
	 * @param instanceId
	 * @return
	 */
	List<String> queryInstanceAcapproverList(@Param("currentAcIds") String currentAcIds,
			@Param("instanceId") String instanceId);

	/**
	 * 查询环节所有审批记录
	 * 
	 * @param instranceIds
	 * @return
	 */
	List<FlowInstanceApprovalRecord> queryApprovalList(@Param("instanceIds") String instanceIds);

	Integer isChangeApprovalState(@Param("instanceId") String instanceId);

	/**
	 * 查询我的审批中是否有此实例的审批
	 * 
	 * @param instanceId
	 * @param userId
	 * @return
	 */
	List<FlowInstanceApprovalRecord> isMyApproval(@Param("instanceId") String instanceId, @Param("userId") String userId);

	/**
	 * 查询记录是否存在
	 * 
	 * @param instanceId
	 * @param id
	 * @return
	 */
	FlowInstanceApprovalRecord queryApprovaerInfoById(@Param("instanceId") String instanceId, @Param("id") String id);

	/**
	 * 修改加签环节的审批状态
	 * 
	 * @param updateInstanceAcList
	 * @return
	 */
	int updateApproverState(List<FlowInstanceApprovalRecord> updateInstanceAcList);

	Integer queryMyUnApprovalCount(@Param("userId") String userId);

	/**
	 * 刪除正在执行的 审批
	 * 
	 * @param executeInstanceIds
	 * @param instanceId
	 * @return
	 */
	int deleteExecuteApprovalByInstanceAcIds(@Param("executeInstanceIds") String executeInstanceIds,
			@Param("instanceId") String instanceId);

	List<FlowInstanceApprovalRecord> queryInstanceApprover(@Param("instanceAcIds")String instanceAcIds, @Param("instanceId")String instanceId);

	int deleteBatchPseudoAllAcApproverById(@Param("acIds")List<String> acIds,@Param("instanceId")String instanceId,@Param("updateDate") Date updateDate,@Param("isStartNode") boolean isStartNode);

	/**
	 * 提取未审的审批人
	 * @param executeNodeIds
	 * @param instanceId
	 * @param isStartNode
	 * @return
	 */
	List<String> noApprovalUserList(@Param("executeNodeIds")List<String> executeNodeIds,@Param("instanceId")  String instanceId,@Param("isStartNode") boolean isStartNode,@Param("isAdminOperation") boolean isAdminOperation);

	/**
	 * 查询列表的记录
	 * @param collect
	 * @return
	 */
	List<FlowInstanceApprovalRecord> queryListByInstanceIds(@Param("instanceIds")List<String> instanceIds);

}