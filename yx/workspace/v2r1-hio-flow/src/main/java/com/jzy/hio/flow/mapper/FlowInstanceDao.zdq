package com.jzy.hio.flow.mapper;

import java.util.Date;
import java.util.List;

import org.apache.ibatis.annotations.Param;

import com.jzy.hio.base.mapper.BaseMapper;
import com.jzy.hio.flow.entity.FlowCustomForm;
import com.jzy.hio.flow.entity.FlowInstance;
import com.jzy.hio.flow.entity.dto.ApprovalDto;
import com.jzy.hio.flow.entity.dto.FlowInstanceInfo;
import com.jzy.hio.flow.entity.dto.InstanceDetailsDto;
import com.jzy.hio.flow.entity.param.ApprovalParam;
import com.jzy.hio.flow.param.FlowByProjectParam;

public interface FlowInstanceDao extends BaseMapper<FlowInstance> {

	/**
	 * 我发起的列表
	 * 
	 * @param approvalDto
	 * @return
	 */
	List<ApprovalDto> getInstanceList(ApprovalParam approvalParam);

	/**
	 * 我发起的列表数量
	 * 
	 * @param approvalDto
	 * @return
	 */
	Integer getCountInstanceList(ApprovalParam approvalParam);

	FlowInstanceInfo getInstanceInfoById(@Param("instanceId") String instanceId);

	/**
	 * 查询流程详情基本信息
	 * 
	 * @param instanceId
	 * @return
	 */
	InstanceDetailsDto queryInstanceBasicInfoById(@Param("instanceId") String instanceId);

	/**
	 * 查询当前业务表单关联的所有实例
	 * 
	 * @param businessId
	 * @return
	 */
	String queryInstanceIdsByinstanceGroupId(@Param("instanceGroupId") String instanceGroupId,
			@Param("startDate") Date startDate);

	/**
	 * 查询 实例关联项目的count
	 * 
	 * @param flowByProjectParam
	 * @return
	 */
	Integer getInstanceListCountByProjectId(FlowByProjectParam flowByProjectParam);

	/**
	 * 查询 实例关联项目
	 * 
	 * @param flowByProjectParam
	 * @return
	 */
	List<ApprovalDto> getInstanceListByProjectId(FlowByProjectParam flowByProjectParam);

	/**
	 * 修改实例更新时间
	 * 
	 * @param updatDate
	 * @param instanceId
	 * @return
	 */
	int updateInstanceUpdateDate(@Param("updateDate") Date updateDate, @Param("instanceId") String instanceId);

	/**
	 * 查询自定义表单Id
	 * 
	 * @param instanceId
	 * @return
	 */
	FlowCustomForm queryCustomFormIdByInstanceId(@Param("instanceId") String instanceId);

	/**
	 * 恢复驳回已处理->驳回
	 * 
	 * @param instanceGroupId
	 */
	void recoveryState(@Param("instanceGroupId") String instanceGroupId);


	/**
	 * 修改实例templateId
	 * @param templateIdOld
	 * @param templateIdNew
	 * @return
	 */
	void updateInstanceDraft(@Param("templateIdOld") String templateIdOld,@Param("templateIdNew") String templateIdNew);

	/**
	 * 恢复退回已处理->退回
	 * 
	 * @param instanceGroupId
	 */
	void recoveryReturnState(@Param("instanceGroupId") String instanceGroupId);
}