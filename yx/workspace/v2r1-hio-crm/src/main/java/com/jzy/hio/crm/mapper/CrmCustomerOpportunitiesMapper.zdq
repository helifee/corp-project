package com.jzy.hio.crm.mapper;

import java.math.BigDecimal;
import java.util.List;

import org.apache.ibatis.annotations.Param;

import com.jzy.hio.base.mapper.BaseMapper;
import com.jzy.hio.crm.dto.CrmOpportunityPageDto;
import com.jzy.hio.crm.dto.CrmStatusCountDto;
import com.jzy.hio.crm.param.CrmOpportunitySearchParam;
import com.jzy.hio.crm.dto.CrmCustomerOpportunitiesDto;
import com.jzy.hio.crm.param.CrmCustomerOpportunitiesParam;
import com.jzy.hio.entity.CrmCustomerOpportunities;

/**
 * 商机
 * @author 
 *
 */
public interface CrmCustomerOpportunitiesMapper extends BaseMapper<CrmCustomerOpportunities> {

	/**
	 * 商机分页数据
	 * @param opportunitySearchParam
	 * @return
	 */
	List<CrmOpportunityPageDto> getPageOpportunities(CrmOpportunitySearchParam opportunitySearchParam);

	/**
	 * 商机分页总条数
	 * @param opportunitySearchParam
	 * @return
	 */
	int getPageOpportunitiesCount(CrmOpportunitySearchParam opportunitySearchParam);

	/**
	 * 查询商机各个阶段数量
	 * @param uid
	 * @return
	 */
	List<CrmStatusCountDto> selectCountGoupByStage(@Param("uid") String uid, @Param("customerId") String customerId);

    List<CrmCustomerOpportunitiesDto> queryOpportunities(@Param("userId") String userId);

    List<CrmCustomerOpportunitiesDto> queryAll(CrmCustomerOpportunitiesParam crmCustomerOpportunitiesParam);

    int getCount(CrmCustomerOpportunitiesParam crmCustomerOpportunitiesParam);

    /**
     * 查询客户下商机总额
     * @param customerId
     * @return
     */
	BigDecimal selectCustEstimateAmount(String customerId);

	/**
	 * 同一客户下商机名称不能重复
	 * @param id
	 * @param customerId
	 * @param name
	 * @return
	 */
	int selectOpportunityNameCount(@Param("id") String id, @Param("customerId") String customerId, @Param("name") String name);
	
}
