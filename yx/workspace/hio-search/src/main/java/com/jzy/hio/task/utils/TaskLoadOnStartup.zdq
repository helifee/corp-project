package com.jzy.hio.task.utils;

import java.util.List;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.jzy.hio.base.utils.LoginUtils;
import com.jzy.hio.task.entity.TaskInfo;
import com.jzy.hio.task.service.TaskInfoService;

/**
 * 
 * 初始化加载任务调度
 * 
 * @author haoqipeng
 *
 */
public class TaskLoadOnStartup {
	
	private static Logger log = LoggerFactory.getLogger(TaskLoadOnStartup.class);
	
	public void initExistJob() {
		TaskInfoService taskInfoService = QuartzSpringContext.getBean(TaskInfoService.class);
		String tendCode = LoginUtils.getSecurityUserBeanInfo().getTendCode();
		try {
			List<TaskInfo> taskInfoList = taskInfoService.queryList(null);
			
			for (TaskInfo taskInfo : taskInfoList) {
				QuartzManager.addTask(taskInfo, tendCode);
			}
				
		} catch (Exception e) {
			log.error(e.getMessage(), e);
		}
	}

}
