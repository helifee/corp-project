package com.jzy.platform.flow.mapper;

import java.util.ArrayList;
import java.util.List;

import org.apache.ibatis.session.RowBounds;
import org.junit.Assert;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import com.jzy.hio.base.datasource.DataSourceContextHolder;
import com.jzy.hio.flow.HioFlowApplication;
import com.jzy.hio.flow.dto.tobedeleted.ApprovalList;
import com.jzy.hio.flow.entity.Instance;
import com.jzy.hio.flow.mapper.InstanceDao;

@RunWith(SpringRunner.class)
@SpringBootTest(classes=HioFlowApplication.class)
public class InstanceDaoTest {

	@Autowired
	private InstanceDao instanceDao;

	@Test
	public void selectByPrimaryKey() throws Exception {
		DataSourceContextHolder.setDataSourceType("test_test013");
		Instance instance = instanceDao.selectByPrimaryKey("01b57861faa54f0883ac49ad5670b8ae");
		Assert.assertNotNull(instance);
	}
	
	@Test
	public void select() throws Exception {
		List<Instance> list = instanceDao.select(new Instance());
		System.out.println(">>>>>>>>>>>>" + list.size());
		Assert.assertEquals(737, list.size());
	}
	
	@Test
	public void selectAll() throws Exception {
		List<Instance> list = instanceDao.selectAll();
		System.out.println(">>>>>>>>>>>>" + list.size());
		Assert.assertEquals(737, list.size());
	}
	
	@Test
	public void deleteByPrimaryKey() throws Exception {
		int result = instanceDao.deleteByPrimaryKey("032f92d28505417f81dc82d52c7852aa");
		Assert.assertEquals(1, result);
	}
	
	@Test
	public void insert() throws Exception {
		Instance instance = new Instance();
		instance.setName("测试流程");
		int result = instanceDao.insert(instance);
		Assert.assertEquals(1, result);
	}
	
	@Test
	public void updateByPrimaryKey() throws Exception {
		Instance instance = new Instance();
		instance.setId("1e1242306fd94940936c70ec7a2a74a6");
		instance.setName("newname");
		int result = instanceDao.updateByPrimaryKey(instance);
		Assert.assertEquals(1, result);
	}
	
	@Test
	public void insertList() throws Exception {
		Instance instance = new Instance();
		instance.setName("name1");
		Instance instance2 = new Instance();
		instance2.setName("name2");
		List<Instance> recordList = new ArrayList<Instance>();
		recordList.add(instance);
		recordList.add(instance2);
		int result = instanceDao.insertList(recordList);
		Assert.assertEquals(2, result);
	}
	
	@Test
	public void testPage() {
		List<Instance> list = instanceDao.selectByRowBounds(new Instance(), new RowBounds(0, 10));
	}
	
	
	@Test
	public void queryApprovalList() throws Exception {
		List<ApprovalList> approvalList = instanceDao.queryApprovalList("0edaf1d9852b40c6ae7a82d76df2bec4", "1");
		Assert.assertEquals(2, approvalList.size());
	}
}