package com.jzy.fileserver.dao;

import static org.junit.Assert.assertNotNull;

import java.util.Date;
import java.util.List;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import com.jzy.fileserver.domain.PrintTaskVo;
import com.jzy.fileserver.enums.TaskPrior;
import com.jzy.fileserver.enums.TaskStatus;

@RunWith(SpringRunner.class)
@SpringBootTest
public class PrintTaskDaoTests {
	
	@Autowired
	private PrintTaskDao printTaskDao;

	@Test
	public void contextLoads() {
	}

	@Test
	public void save() {
		PrintTaskVo task = new PrintTaskVo();
		task.setFileId(1);
		task.setSendPageNotify(true);
		task.setGenThumb(true);
		task.setTaskPrior(TaskPrior.NORMAL.getCode());
		task.setTaskStatus(TaskStatus.task_accept.name());
		task.setInputType(0);	//暂未使用
		task.setOutputType(0);
		task.setFileSrcPath("20180810/a.txt");
		task.setFileDestPath("20180810/out/");
		task.setCreateTime(new Date());
		
		printTaskDao.save(task);
		System.out.println(task.getId());
	}
	
	@Test
	public void updateTaskStatus() {
		int taskId = 14;
		String taskStatus = TaskStatus.task_accept.name();
		String printerHost = "xxx.xx.xx.xxx";
		printTaskDao.updateTaskStatusAndHost(taskId, taskStatus, printerHost);
	}
	
	@Test
	public void findFailTasks() {
		List<PrintTaskVo> findFailTasks = printTaskDao.findFailTasks();
		System.out.println(findFailTasks);
	}
	
	@Test
	public void findById() {
		int taskId = 14;
		PrintTaskVo taskVo = printTaskDao.findById(taskId);
		assertNotNull(taskVo);
	}
}
