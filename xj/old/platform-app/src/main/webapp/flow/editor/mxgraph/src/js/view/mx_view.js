var mxPerimeter={RectanglePerimeter:function(C,K,N,I){var H=C.getCenterX();var F=C.getCenterY();var L=N.x-H;var J=N.y-F;var G=Math.atan2(J,L);var B=new mxPoint(0,0);var M=Math.PI;var A=Math.PI/2;var E=A-G;var D=Math.atan2(C.height,C.width);if(G<-M+D||G>M-D){B.x=C.x;B.y=F-C.width*Math.tan(G)/2}else{if(G<-D){B.y=C.y;B.x=H-C.height*Math.tan(E)/2}else{if(G<D){B.x=C.x+C.width;B.y=F+C.width*Math.tan(G)/2}else{B.y=C.y+C.height;B.x=H+C.height*Math.tan(E)/2}}}if(I){if(N.x>=C.x&&N.x<=C.x+C.width){B.x=N.x}else{if(N.y>=C.y&&N.y<=C.y+C.height){B.y=N.y}}if(N.x<C.x){B.x=C.x}else{if(N.x>C.x+C.width){B.x=C.x+C.width}}if(N.y<C.y){B.y=C.y}else{if(N.y>C.y+C.height){B.y=C.y+C.height}}}return B},EllipsePerimeter:function(U,N,Q,W){var Z=U.x;var c=U.y;var A=U.width/2;var I=U.height/2;var D=Z+A;var R=c+I;var Y=Q.x;var H=Q.y;var G=parseInt(Y-D);var V=parseInt(H-R);if(G==0&&V!=0){return new mxPoint(D,R+I*V/Math.abs(V))}else{if(G==0&&V==0){return new mxPoint(Y,H)}}if(W){if(H>=c&&H<=c+U.height){var J=H-R;var i=Math.sqrt(A*A*(1-(J*J)/(I*I)))||0;if(Y<=Z){i=-i}return new mxPoint(D+i,H)}if(Y>=Z&&Y<=Z+U.width){var i=Y-D;var J=Math.sqrt(I*I*(1-(i*i)/(A*A)))||0;if(H<=c){J=-J}return new mxPoint(Y,R+J)}}var M=V/G;var E=R-M*D;var C=A*A*M*M+I*I;var K=-2*D*C;var L=A*A*M*M*D*D+I*I*D*D-A*A*I*I;var j=Math.sqrt(K*K-4*C*L);var S=(-K+j)/(2*C);var k=(-K-j)/(2*C);var O=M*S+E;var B=M*k+E;var T=Math.sqrt(Math.pow((S-Y),2)+Math.pow((O-H),2));var P=Math.sqrt(Math.pow((k-Y),2)+Math.pow((B-H),2));var F=0;var X=0;if(T<P){F=S;X=O}else{F=k;X=B}return new mxPoint(F,X)},RhombusPerimeter:function(B,H,N,G){var J=B.x;var K=B.y;var C=B.width;var E=B.height;var F=J+C/2;var D=K+E/2;var L=N.x;var I=N.y;if(F==L){if(D>I){return new mxPoint(F,K)}else{return new mxPoint(F,K+E)}}else{if(D==I){if(F>L){return new mxPoint(J,D)}else{return new mxPoint(J+C,D)}}}var A=F;var M=D;if(G){if(L>=J&&L<=J+C){A=L}else{if(I>=K&&I<=K+E){M=I}}}if(L<F){if(I<D){return mxUtils.intersection(L,I,A,M,F,K,J,D)}else{return mxUtils.intersection(L,I,A,M,F,K+E,J,D)}}else{if(I<D){return mxUtils.intersection(L,I,A,M,F,K,J+C,D)}else{return mxUtils.intersection(L,I,A,M,F,K+E,J+C,D)}}},TrianglePerimeter:function(P,L,N,I){var G=(L!=null)?L.style[mxConstants.STYLE_DIRECTION]:null;var K=G==mxConstants.DIRECTION_NORTH||G==mxConstants.DIRECTION_SOUTH;var S=P.x;var T=P.y;var C=P.width;var F=P.height;var E=S+C/2;var O=T+F/2;var U=new mxPoint(S,T);var V=new mxPoint(S+C,O);var J=new mxPoint(S,T+F);if(G==mxConstants.DIRECTION_NORTH){U=J;V=new mxPoint(E,T);J=new mxPoint(S+C,T+F)}else{if(G==mxConstants.DIRECTION_SOUTH){V=new mxPoint(E,T+F);J=new mxPoint(S+C,T)}else{if(G==mxConstants.DIRECTION_WEST){U=new mxPoint(S+C,T);V=new mxPoint(S,O);J=new mxPoint(S+C,T+F)}}}var H=N.x-E;var Q=N.y-O;var M=(K)?Math.atan2(H,Q):Math.atan2(Q,H);var D=(K)?Math.atan2(C,F):Math.atan2(F,C);var B=false;if(G==mxConstants.DIRECTION_NORTH||G==mxConstants.DIRECTION_WEST){B=M>-D&&M<D}else{B=M<-Math.PI+D||M>Math.PI-D}var A=null;if(B){if(I&&((K&&N.x>=U.x&&N.x<=J.x)||(!K&&N.y>=U.y&&N.y<=J.y))){if(K){A=new mxPoint(N.x,U.y)}else{A=new mxPoint(U.x,N.y)}}else{if(G==mxConstants.DIRECTION_NORTH){A=new mxPoint(S+C/2+F*Math.tan(M)/2,T+F)}else{if(G==mxConstants.DIRECTION_SOUTH){A=new mxPoint(S+C/2-F*Math.tan(M)/2,T)}else{if(G==mxConstants.DIRECTION_WEST){A=new mxPoint(S+C,T+F/2+C*Math.tan(M)/2)}else{A=new mxPoint(S,T+F/2-C*Math.tan(M)/2)}}}}}else{if(I){var R=new mxPoint(E,O);if(N.y>=T&&N.y<=T+F){R.x=(K)?E:((G==mxConstants.DIRECTION_WEST)?S+C:S);R.y=N.y}else{if(N.x>=S&&N.x<=S+C){R.x=N.x;R.y=(!K)?O:((G==mxConstants.DIRECTION_NORTH)?T+F:T)}}H=N.x-R.x;Q=N.y-R.y;E=R.x;O=R.y}if((K&&N.x<=S+C/2)||(!K&&N.y<=T+F/2)){A=mxUtils.intersection(N.x,N.y,E,O,U.x,U.y,V.x,V.y)}else{A=mxUtils.intersection(N.x,N.y,E,O,V.x,V.y,J.x,J.y)}}if(A==null){A=new mxPoint(E,O)}return A},HexagonPerimeter:function(S,N,Q,J){var V=S.x;var W=S.y;var D=S.width;var F=S.height;var E=S.getCenterX();var R=S.getCenterY();var U=Q.x;var I=Q.y;var H=U-E;var T=I-R;var P=-Math.atan2(T,H);var B=Math.PI;var O=Math.PI/2;var C=new mxPoint(E,R);var G=(N!=null)?mxUtils.getValue(N.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST):mxConstants.DIRECTION_EAST;var M=G==mxConstants.DIRECTION_NORTH||G==mxConstants.DIRECTION_SOUTH;var K=new mxPoint();var Y=new mxPoint();if((U<V)&&(I<W)||(U<V)&&(I>W+F)||(U>V+D)&&(I<W)||(U>V+D)&&(I>W+F)){J=false}if(J){if(M){if(U==E){if(I<=W){return new mxPoint(E,W)}else{if(I>=W+F){return new mxPoint(E,W+F)}}}else{if(U<V){if(I==W+F/4){return new mxPoint(V,W+F/4)}else{if(I==W+3*F/4){return new mxPoint(V,W+3*F/4)}}}else{if(U>V+D){if(I==W+F/4){return new mxPoint(V+D,W+F/4)}else{if(I==W+3*F/4){return new mxPoint(V+D,W+3*F/4)}}}else{if(U==V){if(I<R){return new mxPoint(V,W+F/4)}else{if(I>R){return new mxPoint(V,W+3*F/4)}}}else{if(U==V+D){if(I<R){return new mxPoint(V+D,W+F/4)}else{if(I>R){return new mxPoint(V+D,W+3*F/4)}}}}}}}if(I==W){return new mxPoint(E,W)}else{if(I==W+F){return new mxPoint(E,W+F)}}if(U<E){if((I>W+F/4)&&(I<W+3*F/4)){K=new mxPoint(V,W);Y=new mxPoint(V,W+F)}else{if(I<W+F/4){K=new mxPoint(V-Math.floor(0.5*D),W+Math.floor(0.5*F));Y=new mxPoint(V+D,W-Math.floor(0.25*F))}else{if(I>W+3*F/4){K=new mxPoint(V-Math.floor(0.5*D),W+Math.floor(0.5*F));Y=new mxPoint(V+D,W+Math.floor(1.25*F))}}}}else{if(U>E){if((I>W+F/4)&&(I<W+3*F/4)){K=new mxPoint(V+D,W);Y=new mxPoint(V+D,W+F)}else{if(I<W+F/4){K=new mxPoint(V,W-Math.floor(0.25*F));Y=new mxPoint(V+Math.floor(1.5*D),W+Math.floor(0.5*F))}else{if(I>W+3*F/4){K=new mxPoint(V+Math.floor(1.5*D),W+Math.floor(0.5*F));Y=new mxPoint(V,W+Math.floor(1.25*F))}}}}}}else{if(I==R){if(U<=V){return new mxPoint(V,W+F/2)}else{if(U>=V+D){return new mxPoint(V+D,W+F/2)}}}else{if(I<W){if(U==V+D/4){return new mxPoint(V+D/4,W)}else{if(U==V+3*D/4){return new mxPoint(V+3*D/4,W)}}}else{if(I>W+F){if(U==V+D/4){return new mxPoint(V+D/4,W+F)}else{if(U==V+3*D/4){return new mxPoint(V+3*D/4,W+F)}}}else{if(I==W){if(U<E){return new mxPoint(V+D/4,W)}else{if(U>E){return new mxPoint(V+3*D/4,W)}}}else{if(I==W+F){if(U<E){return new mxPoint(V+D/4,W+F)}else{if(I>R){return new mxPoint(V+3*D/4,W+F)}}}}}}}if(U==V){return new mxPoint(V,R)}else{if(U==V+D){return new mxPoint(V+D,R)}}if(I<R){if((U>V+D/4)&&(U<V+3*D/4)){K=new mxPoint(V,W);Y=new mxPoint(V+D,W)}else{if(U<V+D/4){K=new mxPoint(V-Math.floor(0.25*D),W+F);Y=new mxPoint(V+Math.floor(0.5*D),W-Math.floor(0.5*F))}else{if(U>V+3*D/4){K=new mxPoint(V+Math.floor(0.5*D),W-Math.floor(0.5*F));Y=new mxPoint(V+Math.floor(1.25*D),W+F)}}}}else{if(I>R){if((U>V+D/4)&&(U<V+3*D/4)){K=new mxPoint(V,W+F);Y=new mxPoint(V+D,W+F)}else{if(U<V+D/4){K=new mxPoint(V-Math.floor(0.25*D),W);Y=new mxPoint(V+Math.floor(0.5*D),W+Math.floor(1.5*F))}else{if(U>V+3*D/4){K=new mxPoint(V+Math.floor(0.5*D),W+Math.floor(1.5*F));Y=new mxPoint(V+Math.floor(1.25*D),W)}}}}}}var X=E;var A=R;if(U>=V&&U<=V+D){X=U;if(I<R){A=W+F}else{A=W}}else{if(I>=W&&I<=W+F){A=I;if(U<E){X=V+D}else{X=V}}}C=mxUtils.intersection(X,A,Q.x,Q.y,K.x,K.y,Y.x,Y.y)}else{if(M){var L=Math.atan2(F/4,D/2);if(P==L){return new mxPoint(V+D,W+Math.floor(0.25*F))}else{if(P==O){return new mxPoint(V+Math.floor(0.5*D),W)}else{if(P==(B-L)){return new mxPoint(V,W+Math.floor(0.25*F))}else{if(P==-L){return new mxPoint(V+D,W+Math.floor(0.75*F))}else{if(P==(-O)){return new mxPoint(V+Math.floor(0.5*D),W+F)}else{if(P==(-B+L)){return new mxPoint(V,W+Math.floor(0.75*F))}}}}}}if((P<L)&&(P>-L)){K=new mxPoint(V+D,W);Y=new mxPoint(V+D,W+F)}else{if((P>L)&&(P<O)){K=new mxPoint(V,W-Math.floor(0.25*F));Y=new mxPoint(V+Math.floor(1.5*D),W+Math.floor(0.5*F))}else{if((P>O)&&(P<(B-L))){K=new mxPoint(V-Math.floor(0.5*D),W+Math.floor(0.5*F));Y=new mxPoint(V+D,W-Math.floor(0.25*F))}else{if(((P>(B-L))&&(P<=B))||((P<(-B+L))&&(P>=-B))){K=new mxPoint(V,W);Y=new mxPoint(V,W+F)}else{if((P<-L)&&(P>-O)){K=new mxPoint(V+Math.floor(1.5*D),W+Math.floor(0.5*F));Y=new mxPoint(V,W+Math.floor(1.25*F))}else{if((P<-O)&&(P>(-B+L))){K=new mxPoint(V-Math.floor(0.5*D),W+Math.floor(0.5*F));Y=new mxPoint(V+D,W+Math.floor(1.25*F))}}}}}}}else{var L=Math.atan2(F/2,D/4);if(P==L){return new mxPoint(V+Math.floor(0.75*D),W)}else{if(P==(B-L)){return new mxPoint(V+Math.floor(0.25*D),W)}else{if((P==B)||(P==-B)){return new mxPoint(V,W+Math.floor(0.5*F))}else{if(P==0){return new mxPoint(V+D,W+Math.floor(0.5*F))}else{if(P==-L){return new mxPoint(V+Math.floor(0.75*D),W+F)}else{if(P==(-B+L)){return new mxPoint(V+Math.floor(0.25*D),W+F)}}}}}}if((P>0)&&(P<L)){K=new mxPoint(V+Math.floor(0.5*D),W-Math.floor(0.5*F));Y=new mxPoint(V+Math.floor(1.25*D),W+F)}else{if((P>L)&&(P<(B-L))){K=new mxPoint(V,W);Y=new mxPoint(V+D,W)}else{if((P>(B-L))&&(P<B)){K=new mxPoint(V-Math.floor(0.25*D),W+F);Y=new mxPoint(V+Math.floor(0.5*D),W-Math.floor(0.5*F))}else{if((P<0)&&(P>-L)){K=new mxPoint(V+Math.floor(0.5*D),W+Math.floor(1.5*F));Y=new mxPoint(V+Math.floor(1.25*D),W)}else{if((P<-L)&&(P>(-B+L))){K=new mxPoint(V,W+F);Y=new mxPoint(V+D,W+F)}else{if((P<(-B+L))&&(P>-B)){K=new mxPoint(V-Math.floor(0.25*D),W);Y=new mxPoint(V+Math.floor(0.5*D),W+Math.floor(1.5*F))}}}}}}}C=mxUtils.intersection(E,R,Q.x,Q.y,K.x,K.y,Y.x,Y.y)}if(C==null){return new mxPoint(E,R)}return C}};function mxPrintPreview(B,C,D,A,E,F,I,H,G){this.graph=B;this.scale=(C!=null)?C:1/B.pageScale;this.border=(A!=null)?A:0;this.pageFormat=mxRectangle.fromRectangle((D!=null)?D:B.pageFormat);this.title=(H!=null)?H:"Printer-friendly version";this.x0=(E!=null)?E:0;this.y0=(F!=null)?F:0;this.borderColor=I;this.pageSelector=(G!=null)?G:true}mxPrintPreview.prototype.graph=null;mxPrintPreview.prototype.pageFormat=null;mxPrintPreview.prototype.scale=null;mxPrintPreview.prototype.border=0;mxPrintPreview.prototype.marginTop=0;mxPrintPreview.prototype.marginBottom=0;mxPrintPreview.prototype.x0=0;mxPrintPreview.prototype.y0=0;mxPrintPreview.prototype.autoOrigin=true;mxPrintPreview.prototype.printOverlays=false;mxPrintPreview.prototype.printControls=false;mxPrintPreview.prototype.printBackgroundImage=false;mxPrintPreview.prototype.backgroundColor="#ffffff";mxPrintPreview.prototype.borderColor=null;mxPrintPreview.prototype.title=null;mxPrintPreview.prototype.pageSelector=null;mxPrintPreview.prototype.wnd=null;mxPrintPreview.prototype.targetWindow=null;mxPrintPreview.prototype.pageCount=0;mxPrintPreview.prototype.clipping=true;mxPrintPreview.prototype.getWindow=function(){return this.wnd};mxPrintPreview.prototype.getDoctype=function(){var A="";if(document.documentMode==5){A='<meta http-equiv="X-UA-Compatible" content="IE=5">'}else{if(document.documentMode==8){A='<meta http-equiv="X-UA-Compatible" content="IE=8">'}else{if(document.documentMode>8){A='<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->'}}}return A};mxPrintPreview.prototype.appendGraph=function(C,F,D,E,A,B){this.graph=C;this.scale=(F!=null)?F:1/C.pageScale;this.x0=D;this.y0=E;this.open(null,null,A,B)};mxPrintPreview.prototype.open=function(B,U,N,O){var X=this.graph.cellRenderer.initializeOverlay;var E=null;try{if(this.printOverlays){this.graph.cellRenderer.initializeOverlay=function(d,c){c.init(d.view.getDrawPane())}}if(this.printControls){this.graph.cellRenderer.initControl=function(f,e,c,d){e.dialect=f.view.graph.dialect;e.init(f.view.getDrawPane())}}this.wnd=(U!=null)?U:this.wnd;var V=false;if(this.wnd==null){V=true;this.wnd=window.open()}var P=this.wnd.document;if(V){var F=this.getDoctype();if(F!=null&&F.length>0){P.writeln(F)}if(mxClient.IS_VML){P.writeln('<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">')}else{if(document.compatMode==="CSS1Compat"){P.writeln("<!DOCTYPE html>")}P.writeln("<html>")}P.writeln("<head>");this.writeHead(P,B);P.writeln("</head>");P.writeln('<body class="mxPage">')}var T=this.graph.getGraphBounds().clone();var K=this.graph.getView().getScale();var G=K/this.scale;var R=this.graph.getView().getTranslate();if(!this.autoOrigin){this.x0-=R.x*this.scale;this.y0-=R.y*this.scale;T.width+=T.x;T.height+=T.y;T.x=0;T.y=0;this.border=0}var b=this.pageFormat.width-(this.border*2);var a=this.pageFormat.height-(this.border*2);this.pageFormat.height+=this.marginTop+this.marginBottom;T.width/=G;T.height/=G;var J=Math.max(1,Math.ceil((T.width+this.x0)/b));var H=Math.max(1,Math.ceil((T.height+this.y0)/a));this.pageCount=J*H;var A=mxUtils.bind(this,function(){if(this.pageSelector&&(H>1||J>1)){var d=this.createPageSelector(H,J);P.body.appendChild(d);if(mxClient.IS_IE&&P.documentMode==null||P.documentMode==5||P.documentMode==8||P.documentMode==7){d.style.position="absolute";var c=function(){d.style.top=((P.body.scrollTop||P.documentElement.scrollTop)+10)+"px"};mxEvent.addListener(this.wnd,"scroll",function(e){c()});mxEvent.addListener(this.wnd,"resize",function(e){c()})}}});var S=mxUtils.bind(this,function(d,c){if(this.borderColor!=null){d.style.borderColor=this.borderColor;d.style.borderStyle="solid";d.style.borderWidth="1px"}d.style.background=this.backgroundColor;if(N||c){d.style.pageBreakAfter="always"}if(mxClient.IS_IE||document.documentMode>=11||mxClient.IS_EDGE){P.writeln(d.outerHTML);d.parentNode.removeChild(d)}else{d.parentNode.removeChild(d);P.body.appendChild(d)}if(N||c){this.addPageBreak(P)}});var L=this.getCoverPages(this.pageFormat.width,this.pageFormat.height);if(L!=null){for(var Z=0;Z<L.length;Z++){S(L[Z],true)}}var C=this.getAppendices(this.pageFormat.width,this.pageFormat.height);for(var Z=0;Z<H;Z++){var I=Z*a/this.scale-this.y0/this.scale+(T.y-R.y*K)/K;for(var D=0;D<J;D++){if(this.wnd==null){return null}var Q=D*b/this.scale-this.x0/this.scale+(T.x-R.x*K)/K;var M=Z*J+D+1;var Y=new mxRectangle(Q,I,b,a);E=this.renderPage(this.pageFormat.width,this.pageFormat.height,0,0,mxUtils.bind(this,function(c){this.addGraphFragment(-Q,-I,this.scale,M,c,Y);if(this.printBackgroundImage){this.insertBackgroundImage(c,-Q,-I)}}),M);E.setAttribute("id","mxPage-"+M);S(E,C!=null||Z<H-1||D<J-1)}}if(C!=null){for(var Z=0;Z<C.length;Z++){S(C[Z],Z<C.length-1)}}if(V&&!O){this.closeDocument();A()}this.wnd.focus()}catch(W){if(E!=null&&E.parentNode!=null){E.parentNode.removeChild(E)}}finally{this.graph.cellRenderer.initializeOverlay=X}return this.wnd};mxPrintPreview.prototype.addPageBreak=function(B){var A=B.createElement("hr");A.className="mxPageBreak";B.body.appendChild(A)};mxPrintPreview.prototype.closeDocument=function(){if(this.wnd!=null&&this.wnd.document!=null){var A=this.wnd.document;this.writePostfix(A);A.writeln("</body>");A.writeln("</html>");A.close();mxEvent.release(A.body)}};mxPrintPreview.prototype.writeHead=function(B,A){if(this.title!=null){B.writeln("<title>"+this.title+"</title>")}if(mxClient.IS_VML){B.writeln('<style type="text/css">v\\:*{behavior:url(#default#VML)}o\\:*{behavior:url(#default#VML)}</style>')}mxClient.link("stylesheet",mxClient.basePath+"/css/common.css",B);B.writeln('<style type="text/css">');B.writeln("@media print {");B.writeln("  table.mxPageSelector { display: none; }");B.writeln("  hr.mxPageBreak { display: none; }");B.writeln("}");B.writeln("@media screen {");B.writeln("  table.mxPageSelector { position: fixed; right: 10px; top: 10px;font-family: Arial; font-size:10pt; border: solid 1px darkgray;background: white; border-collapse:collapse; }");B.writeln("  table.mxPageSelector td { border: solid 1px gray; padding:4px; }");B.writeln("  body.mxPage { background: gray; }");B.writeln("}");if(A!=null){B.writeln(A)}B.writeln("</style>")};mxPrintPreview.prototype.writePostfix=function(A){};mxPrintPreview.prototype.createPageSelector=function(B,D){var G=this.wnd.document;var L=G.createElement("table");L.className="mxPageSelector";L.setAttribute("border","0");var I=G.createElement("tbody");for(var E=0;E<B;E++){var F=G.createElement("tr");for(var C=0;C<D;C++){var K=E*D+C+1;var H=G.createElement("td");var J=G.createElement("a");J.setAttribute("href","#mxPage-"+K);if(mxClient.IS_NS&&!mxClient.IS_SF&&!mxClient.IS_GC){var A="var page = document.getElementById('mxPage-"+K+"');page.scrollIntoView(true);event.preventDefault();";J.setAttribute("onclick",A)}mxUtils.write(J,K,G);H.appendChild(J);F.appendChild(H)}I.appendChild(F)}L.appendChild(I);return L};mxPrintPreview.prototype.renderPage=function(B,D,I,F,K,J){var G=this.wnd.document;var L=document.createElement("div");var E=null;try{if(I!=0||F!=0){L.style.position="relative";L.style.width=B+"px";L.style.height=D+"px";L.style.pageBreakInside="avoid";var C=document.createElement("div");C.style.position="relative";C.style.top=this.border+"px";C.style.left=this.border+"px";C.style.width=(B-2*this.border)+"px";C.style.height=(D-2*this.border)+"px";C.style.overflow="hidden";var H=document.createElement("div");H.style.position="relative";H.style.marginLeft=I+"px";H.style.marginTop=F+"px";if(G.documentMode==8){C.style.position="absolute";H.style.position="absolute"}if(G.documentMode==10){H.style.width="100%";H.style.height="100%"}C.appendChild(H);L.appendChild(C);document.body.appendChild(L);E=H}else{L.style.width=B+"px";L.style.height=D+"px";L.style.overflow="hidden";L.style.pageBreakInside="avoid";if(G.documentMode==8){L.style.position="relative"}var C=document.createElement("div");C.style.width=(B-2*this.border)+"px";C.style.height=(D-2*this.border)+"px";C.style.overflow="hidden";if(mxClient.IS_IE&&(G.documentMode==null||G.documentMode==5||G.documentMode==8||G.documentMode==7)){C.style.marginTop=this.border+"px";C.style.marginLeft=this.border+"px"}else{C.style.top=this.border+"px";C.style.left=this.border+"px"}if(this.graph.dialect==mxConstants.DIALECT_VML){C.style.position="absolute"}L.appendChild(C);document.body.appendChild(L);E=C}}catch(A){L.parentNode.removeChild(L);L=null;throw A}K(E);return L};mxPrintPreview.prototype.getRoot=function(){var A=this.graph.view.currentRoot;if(A==null){A=this.graph.getModel().getRoot()}return A};mxPrintPreview.prototype.addGraphFragment=function(I,T,N,F,G,V){var S=this.graph.getView();var J=this.graph.container;this.graph.container=G;var B=S.getCanvas();var P=S.getBackgroundPane();var D=S.getDrawPane();var K=S.getOverlayPane();if(this.graph.dialect==mxConstants.DIALECT_SVG){S.createSvg()}else{if(this.graph.dialect==mxConstants.DIALECT_VML){S.createVml()}else{S.createHtml()}}var W=S.isEventsEnabled();S.setEventsEnabled(false);var H=this.graph.isEnabled();this.graph.setEnabled(false);var O=S.getTranslate();S.translate=new mxPoint(I,T);var E=this.graph.cellRenderer.redraw;var M=S.states;var Q=S.scale;if(this.clipping){var A=new mxRectangle((V.x+O.x)*Q,(V.y+O.y)*Q,V.width*Q/N,V.height*Q/N);this.graph.cellRenderer.redraw=function(d,b,a){if(d!=null){var Z=M.get(d.cell);if(Z!=null){var c=S.getBoundingBox(Z,false);if(c!=null&&!mxUtils.intersects(A,c)){return}}}E.apply(this,arguments)}}var L=null;try{var R=[this.getRoot()];L=new mxTemporaryCellStates(S,N,R)}finally{if(mxClient.IS_IE){S.overlayPane.innerHTML="";S.canvas.style.overflow="hidden";S.canvas.style.position="relative";S.canvas.style.top=this.marginTop+"px";S.canvas.style.width=V.width+"px";S.canvas.style.height=V.height+"px"}else{var C=G.firstChild;while(C!=null){var U=C.nextSibling;var X=C.nodeName.toLowerCase();if(X=="svg"){C.style.overflow="hidden";C.style.position="relative";C.style.top=this.marginTop+"px";C.setAttribute("width",V.width);C.setAttribute("height",V.height);C.style.width="";C.style.height=""}else{if(C.style.cursor!="default"&&X!="div"){C.parentNode.removeChild(C)}}C=U}}if(this.printBackgroundImage){var Y=G.getElementsByTagName("svg");if(Y.length>0){Y[0].style.position="absolute"}}S.overlayPane.parentNode.removeChild(S.overlayPane);this.graph.setEnabled(H);this.graph.container=J;this.graph.cellRenderer.redraw=E;S.canvas=B;S.backgroundPane=P;S.drawPane=D;S.overlayPane=K;S.translate=O;L.destroy();S.setEventsEnabled(W)}};mxPrintPreview.prototype.insertBackgroundImage=function(D,B,C){var A=this.graph.backgroundImage;if(A!=null){var E=document.createElement("img");E.style.position="absolute";E.style.marginLeft=Math.round(B*this.scale)+"px";E.style.marginTop=Math.round(C*this.scale)+"px";E.setAttribute("width",Math.round(this.scale*A.width));E.setAttribute("height",Math.round(this.scale*A.height));E.src=A.src;D.insertBefore(E,D.firstChild)}};mxPrintPreview.prototype.getCoverPages=function(){return null};mxPrintPreview.prototype.getAppendices=function(){return null};mxPrintPreview.prototype.print=function(B){var A=this.open(B);if(A!=null){A.print()}};mxPrintPreview.prototype.close=function(){if(this.wnd!=null){this.wnd.close();this.wnd=null}};function mxStylesheet(){this.styles=new Object();this.putDefaultVertexStyle(this.createDefaultVertexStyle());this.putDefaultEdgeStyle(this.createDefaultEdgeStyle())}mxStylesheet.prototype.styles;mxStylesheet.prototype.createDefaultVertexStyle=function(){var A=new Object();A[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_RECTANGLE;A[mxConstants.STYLE_PERIMETER]=mxPerimeter.RectanglePerimeter;A[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;A[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER;A[mxConstants.STYLE_FILLCOLOR]="#C3D9FF";A[mxConstants.STYLE_STROKECOLOR]="#6482B9";A[mxConstants.STYLE_FONTCOLOR]="#774400";return A};mxStylesheet.prototype.createDefaultEdgeStyle=function(){var A=new Object();A[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_CONNECTOR;A[mxConstants.STYLE_ENDARROW]=mxConstants.ARROW_CLASSIC;A[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;A[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER;A[mxConstants.STYLE_STROKECOLOR]="#6482B9";A[mxConstants.STYLE_FONTCOLOR]="#446299";return A};mxStylesheet.prototype.putDefaultVertexStyle=function(A){this.putCellStyle("defaultVertex",A)};mxStylesheet.prototype.putDefaultEdgeStyle=function(A){this.putCellStyle("defaultEdge",A)};mxStylesheet.prototype.getDefaultVertexStyle=function(){return this.styles["defaultVertex"]};mxStylesheet.prototype.getDefaultEdgeStyle=function(){return this.styles["defaultEdge"]};mxStylesheet.prototype.putCellStyle=function(A,B){this.styles[A]=B};mxStylesheet.prototype.getCellStyle=function(A,B){var F=B;if(A!=null&&A.length>0){var J=A.split(";");if(F!=null&&A.charAt(0)!=";"){F=mxUtils.clone(F)}else{F=new Object()}for(var E=0;E<J.length;E++){var C=J[E];var G=C.indexOf("=");if(G>=0){var H=C.substring(0,G);var D=C.substring(G+1);if(D==mxConstants.NONE){delete F[H]}else{if(mxUtils.isNumeric(D)){F[H]=parseFloat(D)}else{F[H]=D}}}else{var I=this.styles[C];if(I!=null){for(var H in I){F[H]=I[H]}}}}}return F};function mxCellState(B,C,A){this.view=B;this.cell=C;this.style=A;this.origin=new mxPoint();this.absoluteOffset=new mxPoint()}mxCellState.prototype=new mxRectangle();mxCellState.prototype.constructor=mxCellState;mxCellState.prototype.view=null;mxCellState.prototype.cell=null;mxCellState.prototype.style=null;mxCellState.prototype.invalid=true;mxCellState.prototype.origin=null;mxCellState.prototype.absolutePoints=null;mxCellState.prototype.absoluteOffset=null;mxCellState.prototype.visibleSourceState=null;mxCellState.prototype.visibleTargetState=null;mxCellState.prototype.terminalDistance=0;mxCellState.prototype.length=0;mxCellState.prototype.segments=null;mxCellState.prototype.shape=null;mxCellState.prototype.text=null;mxCellState.prototype.unscaledWidth=null;mxCellState.prototype.getPerimeterBounds=function(A,B){A=A||0;B=(B!=null)?B:new mxRectangle(this.x,this.y,this.width,this.height);if(this.shape!=null&&this.shape.stencil!=null&&this.shape.stencil.aspect=="fixed"){var C=this.shape.stencil.computeAspect(this.style,B.x,B.y,B.width,B.height);B.x=C.x;B.y=C.y;B.width=this.shape.stencil.w0*C.width;B.height=this.shape.stencil.h0*C.height}if(A!=0){B.grow(A)}return B};mxCellState.prototype.setAbsoluteTerminalPoint=function(B,A){if(A){if(this.absolutePoints==null){this.absolutePoints=[]}if(this.absolutePoints.length==0){this.absolutePoints.push(B)}else{this.absolutePoints[0]=B}}else{if(this.absolutePoints==null){this.absolutePoints=[];this.absolutePoints.push(null);this.absolutePoints.push(B)}else{if(this.absolutePoints.length==1){this.absolutePoints.push(B)}else{this.absolutePoints[this.absolutePoints.length-1]=B}}}};mxCellState.prototype.setCursor=function(A){if(this.shape!=null){this.shape.setCursor(A)}if(this.text!=null){this.text.setCursor(A)}};mxCellState.prototype.getVisibleTerminal=function(B){var A=this.getVisibleTerminalState(B);return(A!=null)?A.cell:null};mxCellState.prototype.getVisibleTerminalState=function(A){return(A)?this.visibleSourceState:this.visibleTargetState};mxCellState.prototype.setVisibleTerminalState=function(A,B){if(B){this.visibleSourceState=A}else{this.visibleTargetState=A}};mxCellState.prototype.getCellBounds=function(){return this.cellBounds};mxCellState.prototype.getPaintBounds=function(){return this.paintBounds};mxCellState.prototype.updateCachedBounds=function(){var B=this.view.translate;var A=this.view.scale;this.cellBounds=new mxRectangle(this.x/A-B.x,this.y/A-B.y,this.width/A,this.height/A);this.paintBounds=mxRectangle.fromRectangle(this.cellBounds);if(this.shape!=null&&this.shape.isPaintBoundsInverted()){this.paintBounds.rotate90()}};mxCellState.prototype.setState=function(A){this.view=A.view;this.cell=A.cell;this.style=A.style;this.absolutePoints=A.absolutePoints;this.origin=A.origin;this.absoluteOffset=A.absoluteOffset;this.boundingBox=A.boundingBox;this.terminalDistance=A.terminalDistance;this.segments=A.segments;this.length=A.length;this.x=A.x;this.y=A.y;this.width=A.width;this.height=A.height;this.unscaledWidth=A.unscaledWidth};mxCellState.prototype.clone=function(){var B=new mxCellState(this.view,this.cell,this.style);if(this.absolutePoints!=null){B.absolutePoints=[];for(var A=0;A<this.absolutePoints.length;A++){B.absolutePoints[A]=this.absolutePoints[A].clone()}}if(this.origin!=null){B.origin=this.origin.clone()}if(this.absoluteOffset!=null){B.absoluteOffset=this.absoluteOffset.clone()}if(this.boundingBox!=null){B.boundingBox=this.boundingBox.clone()}B.terminalDistance=this.terminalDistance;B.segments=this.segments;B.length=this.length;B.x=this.x;B.y=this.y;B.width=this.width;B.height=this.height;B.unscaledWidth=this.unscaledWidth;return B};mxCellState.prototype.destroy=function(){this.view.graph.cellRenderer.destroy(this)};function mxGraphSelectionModel(A){this.graph=A;this.cells=[]}mxGraphSelectionModel.prototype=new mxEventSource();mxGraphSelectionModel.prototype.constructor=mxGraphSelectionModel;mxGraphSelectionModel.prototype.doneResource=(mxClient.language!="none")?"done":"";mxGraphSelectionModel.prototype.updatingSelectionResource=(mxClient.language!="none")?"updatingSelection":"";mxGraphSelectionModel.prototype.graph=null;mxGraphSelectionModel.prototype.singleSelection=false;mxGraphSelectionModel.prototype.isSingleSelection=function(){return this.singleSelection};mxGraphSelectionModel.prototype.setSingleSelection=function(A){this.singleSelection=A};mxGraphSelectionModel.prototype.isSelected=function(A){if(A!=null){return mxUtils.indexOf(this.cells,A)>=0}return false};mxGraphSelectionModel.prototype.isEmpty=function(){return this.cells.length==0};mxGraphSelectionModel.prototype.clear=function(){this.changeSelection(null,this.cells)};mxGraphSelectionModel.prototype.setCell=function(A){if(A!=null){this.setCells([A])}};mxGraphSelectionModel.prototype.setCells=function(C){if(C!=null){if(this.singleSelection){C=[this.getFirstSelectableCell(C)]}var A=[];for(var B=0;B<C.length;B++){if(this.graph.isCellSelectable(C[B])){A.push(C[B])}}this.changeSelection(A,this.cells)}};mxGraphSelectionModel.prototype.getFirstSelectableCell=function(B){if(B!=null){for(var A=0;A<B.length;A++){if(this.graph.isCellSelectable(B[A])){return B[A]}}}return null};mxGraphSelectionModel.prototype.addCell=function(A){if(A!=null){this.addCells([A])}};mxGraphSelectionModel.prototype.addCells=function(D){if(D!=null){var A=null;if(this.singleSelection){A=this.cells;D=[this.getFirstSelectableCell(D)]}var C=[];for(var B=0;B<D.length;B++){if(!this.isSelected(D[B])&&this.graph.isCellSelectable(D[B])){C.push(D[B])}}this.changeSelection(C,A)}};mxGraphSelectionModel.prototype.removeCell=function(A){if(A!=null){this.removeCells([A])}};mxGraphSelectionModel.prototype.removeCells=function(C){if(C!=null){var A=[];for(var B=0;B<C.length;B++){if(this.isSelected(C[B])){A.push(C[B])}}this.changeSelection(null,A)}};mxGraphSelectionModel.prototype.changeSelection=function(D,A){if((D!=null&&D.length>0&&D[0]!=null)||(A!=null&&A.length>0&&A[0]!=null)){var B=new mxSelectionChange(this,D,A);B.execute();var C=new mxUndoableEdit(this,false);C.add(B);this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",C))}};mxGraphSelectionModel.prototype.cellAdded=function(A){if(A!=null&&!this.isSelected(A)){this.cells.push(A)}};mxGraphSelectionModel.prototype.cellRemoved=function(B){if(B!=null){var A=mxUtils.indexOf(this.cells,B);if(A>=0){this.cells.splice(A,1)}}};function mxSelectionChange(B,C,A){this.selectionModel=B;this.added=(C!=null)?C.slice():null;this.removed=(A!=null)?A.slice():null}mxSelectionChange.prototype.execute=function(){var C=mxLog.enter("mxSelectionChange.execute");window.status=mxResources.get(this.selectionModel.updatingSelectionResource)||this.selectionModel.updatingSelectionResource;if(this.removed!=null){for(var B=0;B<this.removed.length;B++){this.selectionModel.cellRemoved(this.removed[B])}}if(this.added!=null){for(var B=0;B<this.added.length;B++){this.selectionModel.cellAdded(this.added[B])}}var A=this.added;this.added=this.removed;this.removed=A;window.status=mxResources.get(this.selectionModel.doneResource)||this.selectionModel.doneResource;mxLog.leave("mxSelectionChange.execute",C);this.selectionModel.fireEvent(new mxEventObject(mxEvent.CHANGE,"added",this.added,"removed",this.removed))};function mxCellEditor(A){this.graph=A;this.zoomHandler=mxUtils.bind(this,function(){if(this.graph.isEditing()){this.resize()}});this.graph.view.addListener(mxEvent.SCALE,this.zoomHandler);this.graph.view.addListener(mxEvent.SCALE_AND_TRANSLATE,this.zoomHandler);this.changeHandler=mxUtils.bind(this,function(B){if(this.editingCell!=null&&this.graph.getView().getState(this.editingCell)==null){this.stopEditing(true)}});this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler)}mxCellEditor.prototype.graph=null;mxCellEditor.prototype.textarea=null;mxCellEditor.prototype.editingCell=null;mxCellEditor.prototype.trigger=null;mxCellEditor.prototype.modified=false;mxCellEditor.prototype.autoSize=true;mxCellEditor.prototype.selectText=true;mxCellEditor.prototype.emptyLabelText=(mxClient.IS_FF)?"<br>":"";mxCellEditor.prototype.escapeCancelsEditing=true;mxCellEditor.prototype.textNode="";mxCellEditor.prototype.zIndex=5;mxCellEditor.prototype.minResize=new mxRectangle(0,20);mxCellEditor.prototype.wordWrapPadding=(mxClient.IS_QUIRKS)?2:(!mxClient.IS_IE11)?1:0;mxCellEditor.prototype.blurEnabled=false;mxCellEditor.prototype.initialValue=null;mxCellEditor.prototype.init=function(){this.textarea=document.createElement("div");this.textarea.className="mxCellEditor mxPlainTextEditor";this.textarea.contentEditable=true;if(mxClient.IS_GC){this.textarea.style.minHeight="1em"}this.installListeners(this.textarea)};mxCellEditor.prototype.applyValue=function(B,A){this.graph.labelChanged(B.cell,A,this.trigger)};mxCellEditor.prototype.getInitialValue=function(C,B){var A=mxUtils.htmlEntities(this.graph.getEditingValue(C.cell,B),false);if(!mxClient.IS_QUIRKS&&document.documentMode!=8&&document.documentMode!=9&&document.documentMode!=10){A=mxUtils.replaceTrailingNewlines(A,"<div><br></div>")}return A.replace(/\n/g,"<br>")};mxCellEditor.prototype.getCurrentValue=function(B){var A=mxUtils.extractTextWithWhitespace(this.textarea.childNodes);if(A.length>0&&A.charAt(A.length-1)=="\n"){A=A.substring(0,A.length-1)}return A};mxCellEditor.prototype.installListeners=function(C){mxEvent.addListener(C,"blur",mxUtils.bind(this,function(F){if(this.blurEnabled){this.focusLost(F)}}));mxEvent.addListener(C,"keydown",mxUtils.bind(this,function(F){if(!mxEvent.isConsumed(F)){if(this.isStopEditingEvent(F)){this.graph.stopEditing(false);mxEvent.consume(F)}else{if(F.keyCode==27){this.graph.stopEditing(this.escapeCancelsEditing||mxEvent.isShiftDown(F));mxEvent.consume(F)}}}}));var E=mxUtils.bind(this,function(F){if(this.editingCell!=null){if(this.clearOnChange&&C.innerHTML==this.getEmptyLabelText()&&(!mxClient.IS_FF||(F.keyCode!=8&&F.keyCode!=46))){this.clearOnChange=false;C.innerHTML=""}}});mxEvent.addListener(C,"keypress",E);mxEvent.addListener(C,"paste",E);var A=mxUtils.bind(this,function(F){if(this.editingCell!=null){if(this.textarea.innerHTML.length==0||this.textarea.innerHTML=="<br>"){this.textarea.innerHTML=this.getEmptyLabelText();this.clearOnChange=this.textarea.innerHTML.length>0}else{this.clearOnChange=false}}});mxEvent.addListener(C,(!mxClient.IS_IE11&&!mxClient.IS_IE)?"input":"keyup",A);mxEvent.addListener(C,"cut",A);mxEvent.addListener(C,"paste",A);var D=(!mxClient.IS_IE11&&!mxClient.IS_IE)?"input":"keydown";var B=mxUtils.bind(this,function(F){if(this.editingCell!=null&&this.autoSize&&!mxEvent.isConsumed(F)){if(this.resizeThread!=null){window.clearTimeout(this.resizeThread)}this.resizeThread=window.setTimeout(mxUtils.bind(this,function(){this.resizeThread=null;this.resize()}),0)}});mxEvent.addListener(C,D,B);if(document.documentMode>=9){mxEvent.addListener(C,"DOMNodeRemoved",B);mxEvent.addListener(C,"DOMNodeInserted",B)}else{mxEvent.addListener(C,"cut",B);mxEvent.addListener(C,"paste",B)}};mxCellEditor.prototype.isStopEditingEvent=function(A){return A.keyCode==113||(this.graph.isEnterStopsCellEditing()&&A.keyCode==13&&!mxEvent.isControlDown(A)&&!mxEvent.isShiftDown(A))};mxCellEditor.prototype.isEventSource=function(A){return mxEvent.getSource(A)==this.textarea};mxCellEditor.prototype.resize=function(){var I=this.graph.getView().getState(this.editingCell);if(I==null){this.stopEditing(true)}else{if(this.textarea!=null){var P=this.graph.getModel().isEdge(I.cell);var E=this.graph.getView().scale;var K=null;if(!this.autoSize||(I.style[mxConstants.STYLE_OVERFLOW]=="fill")){this.bounds=this.getEditorBounds(I);this.textarea.style.width=Math.round(this.bounds.width/E)+"px";this.textarea.style.height=Math.round(this.bounds.height/E)+"px";if(document.documentMode==8||mxClient.IS_QUIRKS){this.textarea.style.left=Math.round(this.bounds.x)+"px";this.textarea.style.top=Math.round(this.bounds.y)+"px"}else{this.textarea.style.left=Math.max(0,Math.round(this.bounds.x+1))+"px";this.textarea.style.top=Math.max(0,Math.round(this.bounds.y+1))+"px"}if(this.graph.isWrapping(I.cell)&&(this.bounds.width>=2||this.bounds.height>=2)&&this.textarea.innerHTML!=this.getEmptyLabelText()){this.textarea.style.wordWrap=mxConstants.WORD_WRAP;this.textarea.style.whiteSpace="normal";if(I.style[mxConstants.STYLE_OVERFLOW]!="fill"){this.textarea.style.width=Math.round(this.bounds.width/E)+this.wordWrapPadding+"px"}}else{this.textarea.style.whiteSpace="nowrap";if(I.style[mxConstants.STYLE_OVERFLOW]!="fill"){this.textarea.style.width=""}}}else{var L=mxUtils.getValue(I.style,mxConstants.STYLE_LABEL_WIDTH,null);K=(I.text!=null)?I.text.margin:null;if(K==null){K=mxUtils.getAlignmentAsPoint(mxUtils.getValue(I.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER),mxUtils.getValue(I.style,mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE))}if(P){this.bounds=new mxRectangle(I.absoluteOffset.x,I.absoluteOffset.y,0,0);if(L!=null){var H=(parseFloat(L)+2)*E;this.bounds.width=H;this.bounds.x+=K.x*H}}else{var J=mxRectangle.fromRectangle(I);var C=mxUtils.getValue(I.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);var O=mxUtils.getValue(I.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);J=(I.shape!=null&&C==mxConstants.ALIGN_CENTER&&O==mxConstants.ALIGN_MIDDLE)?I.shape.getLabelBounds(J):J;if(L!=null){J.width=parseFloat(L)*E}if(!I.view.graph.cellRenderer.legacySpacing||I.style[mxConstants.STYLE_OVERFLOW]!="width"){var G=parseInt(I.style[mxConstants.STYLE_SPACING]||2)*E;var F=(parseInt(I.style[mxConstants.STYLE_SPACING_TOP]||0)+mxText.prototype.baseSpacingTop)*E+G;var D=(parseInt(I.style[mxConstants.STYLE_SPACING_RIGHT]||0)+mxText.prototype.baseSpacingRight)*E+G;var A=(parseInt(I.style[mxConstants.STYLE_SPACING_BOTTOM]||0)+mxText.prototype.baseSpacingBottom)*E+G;var M=(parseInt(I.style[mxConstants.STYLE_SPACING_LEFT]||0)+mxText.prototype.baseSpacingLeft)*E+G;var C=mxUtils.getValue(I.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);var O=mxUtils.getValue(I.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);J=new mxRectangle(J.x+M,J.y+F,J.width-((C==mxConstants.ALIGN_CENTER&&L==null)?(M+D):0),J.height-((O==mxConstants.ALIGN_MIDDLE)?(F+A):0))}this.bounds=new mxRectangle(J.x+I.absoluteOffset.x,J.y+I.absoluteOffset.y,J.width,J.height)}if(this.graph.isWrapping(I.cell)&&(this.bounds.width>=2||this.bounds.height>=2)&&this.textarea.innerHTML!=this.getEmptyLabelText()){this.textarea.style.wordWrap=mxConstants.WORD_WRAP;this.textarea.style.whiteSpace="normal";var H=Math.round(this.bounds.width/((document.documentMode==8)?E:E))+this.wordWrapPadding;this.textarea.style.width=H+"px";if(this.textarea.scrollWidth>H){this.textarea.style.width=this.textarea.scrollWidth+"px"}}else{this.textarea.style.whiteSpace="nowrap";this.textarea.style.width=""}if(document.documentMode==8){this.textarea.style.zoom="1";this.textarea.style.height="auto"}var N=this.textarea.scrollWidth;var B=this.textarea.scrollHeight;if(document.documentMode==8){this.textarea.style.left=Math.max(0,Math.ceil((this.bounds.x-K.x*(this.bounds.width-(N+1)*E)+N*(E-1)*0+(K.x+0.5)*2)/E))+"px";this.textarea.style.top=Math.max(0,Math.ceil((this.bounds.y-K.y*(this.bounds.height-(B+0.5)*E)+B*(E-1)*0+Math.abs(K.y+0.5)*1)/E))+"px";this.textarea.style.width=Math.round(N*E)+"px";this.textarea.style.height=Math.round(B*E)+"px"}else{if(mxClient.IS_QUIRKS){this.textarea.style.left=Math.max(0,Math.ceil(this.bounds.x-K.x*(this.bounds.width-(N+1)*E)+N*(E-1)*0+(K.x+0.5)*2))+"px";this.textarea.style.top=Math.max(0,Math.ceil(this.bounds.y-K.y*(this.bounds.height-(B+0.5)*E)+B*(E-1)*0+Math.abs(K.y+0.5)*1))+"px"}else{this.textarea.style.left=Math.max(0,Math.round(this.bounds.x-K.x*(this.bounds.width-2))+1)+"px";this.textarea.style.top=Math.max(0,Math.round(this.bounds.y-K.y*(this.bounds.height-4)+((K.y==-1)?3:0))+1)+"px"}}}if(mxClient.IS_VML){this.textarea.style.zoom=E}else{mxUtils.setPrefixedStyle(this.textarea.style,"transformOrigin","0px 0px");mxUtils.setPrefixedStyle(this.textarea.style,"transform","scale("+E+","+E+")"+((K==null)?"":" translate("+(K.x*100)+"%,"+(K.y*100)+"%)"))}}}};mxCellEditor.prototype.focusLost=function(){this.stopEditing(!this.graph.isInvokesStopCellEditing())};mxCellEditor.prototype.getBackgroundColor=function(A){return null};mxCellEditor.prototype.startEditing=function(M,A){this.stopEditing(true);if(this.textarea==null){this.init()}if(this.graph.tooltipHandler!=null){this.graph.tooltipHandler.hideTooltip()}var J=this.graph.getView().getState(M);if(J!=null){var D=this.graph.getView().scale;var I=mxUtils.getValue(J.style,mxConstants.STYLE_FONTSIZE,mxConstants.DEFAULT_FONTSIZE);var K=mxUtils.getValue(J.style,mxConstants.STYLE_FONTFAMILY,mxConstants.DEFAULT_FONTFAMILY);var F=mxUtils.getValue(J.style,mxConstants.STYLE_FONTCOLOR,"black");var H=mxUtils.getValue(J.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT);var C=(mxUtils.getValue(J.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD;var L=(mxUtils.getValue(J.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC;var E=(mxUtils.getValue(J.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE;this.textarea.style.lineHeight=(mxConstants.ABSOLUTE_LINE_HEIGHT)?Math.round(I*mxConstants.LINE_HEIGHT)+"px":mxConstants.LINE_HEIGHT;this.textarea.style.backgroundColor=this.getBackgroundColor(J);this.textarea.style.textDecoration=(E)?"underline":"";this.textarea.style.fontWeight=(C)?"bold":"normal";this.textarea.style.fontStyle=(L)?"italic":"";this.textarea.style.fontSize=Math.round(I)+"px";this.textarea.style.zIndex=this.zIndex;this.textarea.style.fontFamily=K;this.textarea.style.textAlign=H;this.textarea.style.outline="none";this.textarea.style.color=F;var B=this.textDirection=mxUtils.getValue(J.style,mxConstants.STYLE_TEXT_DIRECTION,mxConstants.DEFAULT_TEXT_DIRECTION);if(B==mxConstants.TEXT_DIRECTION_AUTO){if(J!=null&&J.text!=null&&J.text.dialect!=mxConstants.DIALECT_STRICTHTML&&!mxUtils.isNode(J.text.value)){B=J.text.getAutoDirection()}}if(B==mxConstants.TEXT_DIRECTION_LTR||B==mxConstants.TEXT_DIRECTION_RTL){this.textarea.setAttribute("dir",B)}else{this.textarea.removeAttribute("dir")}this.textarea.innerHTML=this.getInitialValue(J,A)||"";this.initialValue=this.textarea.innerHTML;if(this.textarea.innerHTML.length==0||this.textarea.innerHTML=="<br>"){this.textarea.innerHTML=this.getEmptyLabelText();this.clearOnChange=true}else{this.clearOnChange=this.textarea.innerHTML==this.getEmptyLabelText()}this.graph.container.appendChild(this.textarea);this.editingCell=M;this.trigger=A;this.textNode=null;if(J.text!=null&&this.isHideLabel(J)){this.textNode=J.text.node;this.textNode.style.visibility="hidden"}if(this.autoSize&&(this.graph.model.isEdge(J.cell)||J.style[mxConstants.STYLE_OVERFLOW]!="fill")){window.setTimeout(mxUtils.bind(this,function(){this.resize()}),0)}this.resize();try{this.textarea.focus();if(this.isSelectText()&&this.textarea.innerHTML.length>0&&(this.textarea.innerHTML!=this.getEmptyLabelText()||!this.clearOnChange)){document.execCommand("selectAll",false,null)}}catch(G){}}};mxCellEditor.prototype.isSelectText=function(){return this.selectText};mxCellEditor.prototype.stopEditing=function(C){C=C||false;if(this.editingCell!=null){if(this.textNode!=null){this.textNode.style.visibility="visible";this.textNode=null}var D=(!C)?this.graph.view.getState(this.editingCell):null;var A=this.initialValue;this.initialValue=null;this.editingCell=null;this.trigger=null;this.bounds=null;this.textarea.blur();if(this.textarea.parentNode!=null){this.textarea.parentNode.removeChild(this.textarea)}if(this.clearOnChange&&this.textarea.innerHTML==this.getEmptyLabelText()){this.textarea.innerHTML="";this.clearOnChange=false}if(D!=null&&this.textarea.innerHTML!=A){var B=this.getCurrentValue(D);if(B!=null){this.applyValue(D,B)}}mxEvent.release(this.textarea);this.textarea=null}};mxCellEditor.prototype.isHideLabel=function(A){return true};mxCellEditor.prototype.getMinimumSize=function(B){var A=this.graph.getView().scale;return new mxRectangle(0,0,(B.text==null)?30:B.text.size*A+20,(this.textarea.style.textAlign=="left")?120:40)};mxCellEditor.prototype.getEditorBounds=function(I){var J=this.graph.getModel().isEdge(I.cell);var D=this.graph.getView().scale;var L=this.getMinimumSize(I);var F=L.width;var N=L.height;var B=null;if(!J&&I.view.graph.cellRenderer.legacySpacing&&I.style[mxConstants.STYLE_OVERFLOW]=="fill"){B=I.shape.getLabelBounds(mxRectangle.fromRectangle(I))}else{var H=parseInt(I.style[mxConstants.STYLE_SPACING]||0)*D;var E=(parseInt(I.style[mxConstants.STYLE_SPACING_TOP]||0)+mxText.prototype.baseSpacingTop)*D+H;var C=(parseInt(I.style[mxConstants.STYLE_SPACING_RIGHT]||0)+mxText.prototype.baseSpacingRight)*D+H;var G=(parseInt(I.style[mxConstants.STYLE_SPACING_BOTTOM]||0)+mxText.prototype.baseSpacingBottom)*D+H;var M=(parseInt(I.style[mxConstants.STYLE_SPACING_LEFT]||0)+mxText.prototype.baseSpacingLeft)*D+H;B=new mxRectangle(I.x,I.y,Math.max(F,I.width-M-C),Math.max(N,I.height-E-G));var P=mxUtils.getValue(I.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);var O=mxUtils.getValue(I.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);B=(I.shape!=null&&P==mxConstants.ALIGN_CENTER&&O==mxConstants.ALIGN_MIDDLE)?I.shape.getLabelBounds(B):B;if(J){B.x=I.absoluteOffset.x;B.y=I.absoluteOffset.y;if(I.text!=null&&I.text.boundingBox!=null){if(I.text.boundingBox.x>0){B.x=I.text.boundingBox.x}if(I.text.boundingBox.y>0){B.y=I.text.boundingBox.y}}}else{if(I.text!=null&&I.text.boundingBox!=null){B.x=Math.min(B.x,I.text.boundingBox.x);B.y=Math.min(B.y,I.text.boundingBox.y)}}B.x+=M;B.y+=E;if(I.text!=null&&I.text.boundingBox!=null){if(!J){B.width=Math.max(B.width,I.text.boundingBox.width);B.height=Math.max(B.height,I.text.boundingBox.height)}else{B.width=Math.max(F,I.text.boundingBox.width);B.height=Math.max(N,I.text.boundingBox.height)}}if(this.graph.getModel().isVertex(I.cell)){var K=mxUtils.getValue(I.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);if(K==mxConstants.ALIGN_LEFT){B.x-=I.width}else{if(K==mxConstants.ALIGN_RIGHT){B.x+=I.width}}var A=mxUtils.getValue(I.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);if(A==mxConstants.ALIGN_TOP){B.y-=I.height}else{if(A==mxConstants.ALIGN_BOTTOM){B.y+=I.height}}}}return new mxRectangle(Math.round(B.x),Math.round(B.y),Math.round(B.width),Math.round(B.height))};mxCellEditor.prototype.getEmptyLabelText=function(A){return this.emptyLabelText};mxCellEditor.prototype.getEditingCell=function(){return this.editingCell};mxCellEditor.prototype.destroy=function(){if(this.textarea!=null){mxEvent.release(this.textarea);if(this.textarea.parentNode!=null){this.textarea.parentNode.removeChild(this.textarea)}this.textarea=null}if(this.changeHandler!=null){this.graph.getModel().removeListener(this.changeHandler);this.changeHandler=null}if(this.zoomHandler){this.graph.view.removeListener(this.zoomHandler);this.zoomHandler=null}};function mxCellRenderer(){}mxCellRenderer.prototype.defaultEdgeShape=mxConnector;mxCellRenderer.prototype.defaultVertexShape=mxRectangleShape;mxCellRenderer.prototype.defaultTextShape=mxText;mxCellRenderer.prototype.legacyControlPosition=true;mxCellRenderer.prototype.legacySpacing=true;mxCellRenderer.prototype.defaultShapes=new Object();mxCellRenderer.prototype.antiAlias=true;mxCellRenderer.prototype.forceControlClickHandler=false;mxCellRenderer.registerShape=function(A,B){mxCellRenderer.prototype.defaultShapes[A]=B};mxCellRenderer.registerShape(mxConstants.SHAPE_RECTANGLE,mxRectangleShape);mxCellRenderer.registerShape(mxConstants.SHAPE_ELLIPSE,mxEllipse);mxCellRenderer.registerShape(mxConstants.SHAPE_RHOMBUS,mxRhombus);mxCellRenderer.registerShape(mxConstants.SHAPE_CYLINDER,mxCylinder);mxCellRenderer.registerShape(mxConstants.SHAPE_CONNECTOR,mxConnector);mxCellRenderer.registerShape(mxConstants.SHAPE_ACTOR,mxActor);mxCellRenderer.registerShape(mxConstants.SHAPE_TRIANGLE,mxTriangle);mxCellRenderer.registerShape(mxConstants.SHAPE_HEXAGON,mxHexagon);mxCellRenderer.registerShape(mxConstants.SHAPE_CLOUD,mxCloud);mxCellRenderer.registerShape(mxConstants.SHAPE_LINE,mxLine);mxCellRenderer.registerShape(mxConstants.SHAPE_ARROW,mxArrow);mxCellRenderer.registerShape(mxConstants.SHAPE_ARROW_CONNECTOR,mxArrowConnector);mxCellRenderer.registerShape(mxConstants.SHAPE_DOUBLE_ELLIPSE,mxDoubleEllipse);mxCellRenderer.registerShape(mxConstants.SHAPE_SWIMLANE,mxSwimlane);mxCellRenderer.registerShape(mxConstants.SHAPE_IMAGE,mxImageShape);mxCellRenderer.registerShape(mxConstants.SHAPE_LABEL,mxLabel);mxCellRenderer.prototype.initializeShape=function(A){A.shape.dialect=A.view.graph.dialect;this.configureShape(A);A.shape.init(A.view.getDrawPane())};mxCellRenderer.prototype.createShape=function(D){var A=null;if(D.style!=null){var B=mxStencilRegistry.getStencil(D.style[mxConstants.STYLE_SHAPE]);if(B!=null){A=new mxShape(B)}else{var C=this.getShapeConstructor(D);A=new C()}}return A};mxCellRenderer.prototype.createIndicatorShape=function(A){A.shape.indicatorShape=this.getShape(A.view.graph.getIndicatorShape(A))};mxCellRenderer.prototype.getShape=function(A){return(A!=null)?mxCellRenderer.prototype.defaultShapes[A]:null};mxCellRenderer.prototype.getShapeConstructor=function(B){var A=this.getShape(B.style[mxConstants.STYLE_SHAPE]);if(A==null){A=(B.view.graph.getModel().isEdge(B.cell))?this.defaultEdgeShape:this.defaultVertexShape}return A};mxCellRenderer.prototype.configureShape=function(A){A.shape.apply(A);A.shape.image=A.view.graph.getImage(A);A.shape.indicatorColor=A.view.graph.getIndicatorColor(A);A.shape.indicatorStrokeColor=A.style[mxConstants.STYLE_INDICATOR_STROKECOLOR];A.shape.indicatorGradientColor=A.view.graph.getIndicatorGradientColor(A);A.shape.indicatorDirection=A.style[mxConstants.STYLE_INDICATOR_DIRECTION];A.shape.indicatorImage=A.view.graph.getIndicatorImage(A);this.postConfigureShape(A)};mxCellRenderer.prototype.postConfigureShape=function(A){if(A.shape!=null){this.resolveColor(A,"indicatorColor",mxConstants.STYLE_FILLCOLOR);this.resolveColor(A,"indicatorGradientColor",mxConstants.STYLE_GRADIENTCOLOR);this.resolveColor(A,"fill",mxConstants.STYLE_FILLCOLOR);this.resolveColor(A,"stroke",mxConstants.STYLE_STROKECOLOR);this.resolveColor(A,"gradient",mxConstants.STYLE_GRADIENTCOLOR)}};mxCellRenderer.prototype.resolveColor=function(G,E,B){var A=G.shape[E];var C=G.view.graph;var D=null;if(A=="inherit"){D=C.model.getParent(G.cell)}else{if(A=="swimlane"){if(C.model.getTerminal(G.cell,false)!=null){D=C.model.getTerminal(G.cell,false)}else{D=G.cell}D=C.getSwimlane(D);B=C.swimlaneIndicatorColorAttribute}else{if(A=="indicated"){G.shape[E]=G.shape.indicatorColor}}}if(D!=null){var F=C.getView().getState(D);G.shape[E]=null;if(F!=null){if(F.shape!=null&&E!="indicatorColor"){G.shape[E]=F.shape[E]}else{G.shape[E]=F.style[B]}}}};mxCellRenderer.prototype.getLabelValue=function(A){return A.view.graph.getLabel(A.cell)};mxCellRenderer.prototype.createLabel=function(G,E){var D=G.view.graph;var C=D.getModel().isEdge(G.cell);if(G.style[mxConstants.STYLE_FONTSIZE]>0||G.style[mxConstants.STYLE_FONTSIZE]==null){var A=(D.isHtmlLabel(G.cell)||(E!=null&&mxUtils.isNode(E)));G.text=new this.defaultTextShape(E,new mxRectangle(),(G.style[mxConstants.STYLE_ALIGN]||mxConstants.ALIGN_CENTER),D.getVerticalAlign(G),G.style[mxConstants.STYLE_FONTCOLOR],G.style[mxConstants.STYLE_FONTFAMILY],G.style[mxConstants.STYLE_FONTSIZE],G.style[mxConstants.STYLE_FONTSTYLE],G.style[mxConstants.STYLE_SPACING],G.style[mxConstants.STYLE_SPACING_TOP],G.style[mxConstants.STYLE_SPACING_RIGHT],G.style[mxConstants.STYLE_SPACING_BOTTOM],G.style[mxConstants.STYLE_SPACING_LEFT],G.style[mxConstants.STYLE_HORIZONTAL],G.style[mxConstants.STYLE_LABEL_BACKGROUNDCOLOR],G.style[mxConstants.STYLE_LABEL_BORDERCOLOR],D.isWrapping(G.cell)&&D.isHtmlLabel(G.cell),D.isLabelClipped(G.cell),G.style[mxConstants.STYLE_OVERFLOW],G.style[mxConstants.STYLE_LABEL_PADDING],mxUtils.getValue(G.style,mxConstants.STYLE_TEXT_DIRECTION,mxConstants.DEFAULT_TEXT_DIRECTION));G.text.opacity=mxUtils.getValue(G.style,mxConstants.STYLE_TEXT_OPACITY,100);G.text.dialect=(A)?mxConstants.DIALECT_STRICTHTML:G.view.graph.dialect;G.text.style=G.style;G.text.state=G;this.initializeLabel(G,G.text);var B=false;var F=function(I){var H=G;if(mxClient.IS_TOUCH||B){var K=mxEvent.getClientX(I);var L=mxEvent.getClientY(I);var J=mxUtils.convertPoint(D.container,K,L);H=D.view.getState(D.getCellAt(J.x,J.y))}return H};mxEvent.addGestureListeners(G.text.node,mxUtils.bind(this,function(H){if(this.isLabelEvent(G,H)){D.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(H,G));B=D.dialect!=mxConstants.DIALECT_SVG&&mxEvent.getSource(H).nodeName=="IMG"}}),mxUtils.bind(this,function(H){if(this.isLabelEvent(G,H)){D.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(H,F(H)))}}),mxUtils.bind(this,function(H){if(this.isLabelEvent(G,H)){D.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(H,F(H)));B=false}}));if(D.nativeDblClickEnabled){mxEvent.addListener(G.text.node,"dblclick",mxUtils.bind(this,function(H){if(this.isLabelEvent(G,H)){D.dblClick(H,G.cell);mxEvent.consume(H)}}))}}};mxCellRenderer.prototype.initializeLabel=function(B,A){if(mxClient.IS_SVG&&mxClient.NO_FO&&A.dialect!=mxConstants.DIALECT_SVG){A.init(B.view.graph.container)}else{A.init(B.view.getDrawPane())}};mxCellRenderer.prototype.createCellOverlays=function(G){var E=G.view.graph;var D=E.getCellOverlays(G.cell);var A=null;if(D!=null){A=new mxDictionary();for(var B=0;B<D.length;B++){var F=(G.overlays!=null)?G.overlays.remove(D[B]):null;if(F==null){var C=new mxImageShape(new mxRectangle(),D[B].image.src);C.dialect=G.view.graph.dialect;C.preserveImageAspect=false;C.overlay=D[B];this.initializeOverlay(G,C);this.installCellOverlayListeners(G,D[B],C);if(D[B].cursor!=null){C.node.style.cursor=D[B].cursor}A.put(D[B],C)}else{A.put(D[B],F)}}}if(G.overlays!=null){G.overlays.visit(function(I,H){H.destroy()})}G.overlays=A};mxCellRenderer.prototype.initializeOverlay=function(B,A){A.init(B.view.getOverlayPane())};mxCellRenderer.prototype.installCellOverlayListeners=function(D,C,A){var B=D.view.graph;mxEvent.addListener(A.node,"click",function(E){if(B.isEditing()){B.stopEditing(!B.isInvokesStopCellEditing())}C.fireEvent(new mxEventObject(mxEvent.CLICK,"event",E,"cell",D.cell))});mxEvent.addGestureListeners(A.node,function(E){mxEvent.consume(E)},function(E){B.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(E,D))});if(mxClient.IS_TOUCH){mxEvent.addListener(A.node,"touchend",function(E){C.fireEvent(new mxEventObject(mxEvent.CLICK,"event",E,"cell",D.cell))})}};mxCellRenderer.prototype.createControl=function(D){var A=D.view.graph;var B=A.getFoldingImage(D);if(A.foldingEnabled&&B!=null){if(D.control==null){var C=new mxRectangle(0,0,B.width,B.height);D.control=new mxImageShape(C,B.src);D.control.preserveImageAspect=false;D.control.dialect=A.dialect;this.initControl(D,D.control,true,this.createControlClickHandler(D))}}else{if(D.control!=null){D.control.destroy();D.control=null}}};mxCellRenderer.prototype.createControlClickHandler=function(B){var A=B.view.graph;return mxUtils.bind(this,function(D){if(this.forceControlClickHandler||A.isEnabled()){var C=!A.isCellCollapsed(B.cell);A.foldCells(C,false,[B.cell],null,D);mxEvent.consume(D)}})};mxCellRenderer.prototype.initControl=function(C,H,E,A){var B=C.view.graph;var D=B.isHtmlLabel(C.cell)&&mxClient.NO_FO&&B.dialect==mxConstants.DIALECT_SVG;if(D){H.dialect=mxConstants.DIALECT_PREFERHTML;H.init(B.container);H.node.style.zIndex=1}else{H.init(C.view.getOverlayPane())}var F=H.innerNode||H.node;if(A!=null&&!mxClient.IS_IOS){if(B.isEnabled()){F.style.cursor="pointer"}mxEvent.addListener(F,"click",A)}if(E){var G=null;mxEvent.addGestureListeners(F,function(I){G=new mxPoint(mxEvent.getClientX(I),mxEvent.getClientY(I));B.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(I,C));mxEvent.consume(I)},function(I){B.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(I,C))},function(I){B.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(I,C));mxEvent.consume(I)});if(A!=null&&mxClient.IS_IOS){F.addEventListener("touchend",function(I){if(G!=null){var J=B.tolerance;if(Math.abs(G.x-mxEvent.getClientX(I))<J&&Math.abs(G.y-mxEvent.getClientY(I))<J){A.call(A,I);mxEvent.consume(I)}}},true)}}return F};mxCellRenderer.prototype.isShapeEvent=function(B,A){return true};mxCellRenderer.prototype.isLabelEvent=function(B,A){return true};mxCellRenderer.prototype.installListeners=function(C){var A=C.view.graph;var B=function(E){var D=C;if((A.dialect!=mxConstants.DIALECT_SVG&&mxEvent.getSource(E).nodeName=="IMG")||mxClient.IS_TOUCH){var G=mxEvent.getClientX(E);var H=mxEvent.getClientY(E);var F=mxUtils.convertPoint(A.container,G,H);D=A.view.getState(A.getCellAt(F.x,F.y))}return D};mxEvent.addGestureListeners(C.shape.node,mxUtils.bind(this,function(D){if(this.isShapeEvent(C,D)){A.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(D,C))}}),mxUtils.bind(this,function(D){if(this.isShapeEvent(C,D)){A.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(D,B(D)))}}),mxUtils.bind(this,function(D){if(this.isShapeEvent(C,D)){A.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(D,B(D)))}}));if(A.nativeDblClickEnabled){mxEvent.addListener(C.shape.node,"dblclick",mxUtils.bind(this,function(D){if(this.isShapeEvent(C,D)){A.dblClick(D,C.cell);mxEvent.consume(D)}}))}};mxCellRenderer.prototype.redrawLabel=function(H,K){var G=this.getLabelValue(H);if(H.text==null&&G!=null&&(mxUtils.isNode(G)||G.length>0)){this.createLabel(H,G)}else{if(H.text!=null&&(G==null||G.length==0)){H.text.destroy();H.text=null}}if(H.text!=null){var C=H.view.graph;if(K){if(H.text.lastValue!=null&&this.isTextShapeInvalid(H,H.text)){H.text.lastValue=null}H.text.resetStyles();H.text.apply(H);H.text.valign=C.getVerticalAlign(H)}var A=this.getLabelBounds(H);var B=C.isWrapping(H.cell);var D=C.isLabelClipped(H.cell);var I=(H.view.graph.isHtmlLabel(H.cell)||(G!=null&&mxUtils.isNode(G)));var E=(I)?mxConstants.DIALECT_STRICTHTML:H.view.graph.dialect;var J=H.style[mxConstants.STYLE_OVERFLOW]||"visible";if(K||H.text.value!=G||H.text.isWrapping!=B||H.text.overflow!=J||H.text.isClipping!=D||H.text.scale!=this.getTextScale(H)||H.text.dialect!=E||!H.text.bounds.equals(A)){H.text.dialect=E;H.text.value=G;H.text.bounds=A;H.text.scale=this.getTextScale(H);H.text.wrap=B;H.text.clipped=D;H.text.overflow=J;var F=H.text.node.style.visibility;this.redrawLabelShape(H.text);H.text.node.style.visibility=F}}};mxCellRenderer.prototype.isTextShapeInvalid=function(C,A){function B(E,D,F){return A[E]!=(C.style[D]||F)}return B("fontStyle",mxConstants.STYLE_FONTSTYLE,mxConstants.DEFAULT_FONTSTYLE)||B("family",mxConstants.STYLE_FONTFAMILY,mxConstants.DEFAULT_FONTFAMILY)||B("size",mxConstants.STYLE_FONTSIZE,mxConstants.DEFAULT_FONTSIZE)||B("color",mxConstants.STYLE_FONTCOLOR,"black")||B("align",mxConstants.STYLE_ALIGN,"")||B("valign",mxConstants.STYLE_VERTICAL_ALIGN,"")||B("spacing",mxConstants.STYLE_SPACING,2)||B("spacingTop",mxConstants.STYLE_SPACING_TOP,2)||B("spacingRight",mxConstants.STYLE_SPACING_RIGHT,2)||B("spacingBottom",mxConstants.STYLE_SPACING_BOTTOM,2)||B("spacingLeft",mxConstants.STYLE_SPACING_LEFT,2)||B("horizontal",mxConstants.STYLE_HORIZONTAL,true)||B("background",mxConstants.STYLE_LABEL_BACKGROUNDCOLOR)||B("border",mxConstants.STYLE_LABEL_BORDERCOLOR)||B("opacity",mxConstants.STYLE_TEXT_OPACITY,100)||B("textDirection",mxConstants.STYLE_TEXT_DIRECTION,mxConstants.DEFAULT_TEXT_DIRECTION)};mxCellRenderer.prototype.redrawLabelShape=function(A){A.redraw()};mxCellRenderer.prototype.getTextScale=function(A){return A.view.scale};mxCellRenderer.prototype.getLabelBounds=function(G){var D=G.view.graph;var C=G.view.scale;var H=D.getModel().isEdge(G.cell);var B=new mxRectangle(G.absoluteOffset.x,G.absoluteOffset.y);if(H){var E=G.text.getSpacing();B.x+=E.x*C;B.y+=E.y*C;var N=D.getCellGeometry(G.cell);if(N!=null){B.width=Math.max(0,N.width*C);B.height=Math.max(0,N.height*C)}}else{if(G.text.isPaintBoundsInverted()){var F=B.x;B.x=B.y;B.y=F}B.x+=G.x;B.y+=G.y;B.width=Math.max(1,G.width);B.height=Math.max(1,G.height);var P=mxUtils.getValue(G.style,mxConstants.STYLE_STROKECOLOR,mxConstants.NONE);if(P!=mxConstants.NONE&&P!=""){var A=parseFloat(mxUtils.getValue(G.style,mxConstants.STYLE_STROKEWIDTH,1))*C;var K=1+Math.floor((A-1)/2);var J=Math.floor(A+1);B.x+=K;B.y+=K;B.width-=J;B.height-=J}}if(G.text.isPaintBoundsInverted()){var M=(G.width-G.height)/2;B.x+=M;B.y-=M;var F=B.width;B.width=B.height;B.height=F}if(G.shape!=null){var O=mxUtils.getValue(G.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);var I=mxUtils.getValue(G.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);if(O==mxConstants.ALIGN_CENTER&&I==mxConstants.ALIGN_MIDDLE){B=G.shape.getLabelBounds(B)}}var L=mxUtils.getValue(G.style,mxConstants.STYLE_LABEL_WIDTH,null);if(L!=null){B.width=parseFloat(L)*C}if(!H){this.rotateLabelBounds(G,B)}return B};mxCellRenderer.prototype.rotateLabelBounds=function(G,B){B.y-=G.text.margin.y*B.height;B.x-=G.text.margin.x*B.width;if(!this.legacySpacing||(G.style[mxConstants.STYLE_OVERFLOW]!="fill"&&G.style[mxConstants.STYLE_OVERFLOW]!="width")){var A=G.view.scale;var D=G.text.getSpacing();B.x+=D.x*A;B.y+=D.y*A;var K=mxUtils.getValue(G.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);var J=mxUtils.getValue(G.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);var H=mxUtils.getValue(G.style,mxConstants.STYLE_LABEL_WIDTH,null);B.width=Math.max(0,B.width-((K==mxConstants.ALIGN_CENTER&&H==null)?(G.text.spacingLeft*A+G.text.spacingRight*A):0));B.height=Math.max(0,B.height-((J==mxConstants.ALIGN_MIDDLE)?(G.text.spacingTop*A+G.text.spacingBottom*A):0))}var I=G.text.getTextRotation();if(I!=0&&G!=null&&G.view.graph.model.isVertex(G.cell)){var C=G.getCenterX();var E=G.getCenterY();if(B.x!=C||B.y!=E){var F=I*(Math.PI/180);pt=mxUtils.getRotatedPoint(new mxPoint(B.x,B.y),Math.cos(F),Math.sin(F),new mxPoint(C,E));B.x=pt.x;B.y=pt.y}}};mxCellRenderer.prototype.redrawCellOverlays=function(F,E){this.createCellOverlays(F);if(F.overlays!=null){var B=mxUtils.mod(mxUtils.getValue(F.style,mxConstants.STYLE_ROTATION,0),90);var D=mxUtils.toRadians(B);var C=Math.cos(D);var A=Math.sin(D);F.overlays.visit(function(L,G){var H=G.overlay.getBounds(F);if(!F.view.graph.getModel().isEdge(F.cell)){if(F.shape!=null&&B!=0){var K=H.getCenterX();var J=H.getCenterY();var I=mxUtils.getRotatedPoint(new mxPoint(K,J),C,A,new mxPoint(F.getCenterX(),F.getCenterY()));K=I.x;J=I.y;H.x=Math.round(K-H.width/2);H.y=Math.round(J-H.height/2)}}if(E||G.bounds==null||G.scale!=F.view.scale||!G.bounds.equals(H)){G.bounds=H;G.scale=F.view.scale;G.redraw()}})}};mxCellRenderer.prototype.redrawControl=function(F,E){var D=F.view.graph.getFoldingImage(F);if(F.control!=null&&D!=null){var C=this.getControlBounds(F,D.width,D.height);var A=(this.legacyControlPosition)?mxUtils.getValue(F.style,mxConstants.STYLE_ROTATION,0):F.shape.getTextRotation();var B=F.view.scale;if(E||F.control.scale!=B||!F.control.bounds.equals(C)||F.control.rotation!=A){F.control.rotation=A;F.control.bounds=C;F.control.scale=B;F.control.redraw()}}};mxCellRenderer.prototype.getControlBounds=function(J,D,K){if(J.control!=null){var A=J.view.scale;var G=J.getCenterX();var I=J.getCenterY();if(!J.view.graph.getModel().isEdge(J.cell)){G=J.x+D*A;I=J.y+K*A;if(J.shape!=null){var H=J.shape.getShapeRotation();if(this.legacyControlPosition){H=mxUtils.getValue(J.style,mxConstants.STYLE_ROTATION,0)}else{if(J.shape.isPaintBoundsInverted()){var E=(J.width-J.height)/2;G+=E;I-=E}}if(H!=0){var F=mxUtils.toRadians(H);var C=Math.cos(F);var B=Math.sin(F);var L=mxUtils.getRotatedPoint(new mxPoint(G,I),C,B,new mxPoint(J.getCenterX(),J.getCenterY()));G=L.x;I=L.y}}}return(J.view.graph.getModel().isEdge(J.cell))?new mxRectangle(Math.round(G-D/2*A),Math.round(I-K/2*A),Math.round(D*A),Math.round(K*A)):new mxRectangle(Math.round(G-D/2*A),Math.round(I-K/2*A),Math.round(D*A),Math.round(K*A))}return null};mxCellRenderer.prototype.insertStateAfter=function(B,D,F){var H=this.getShapesForState(B);for(var E=0;E<H.length;E++){if(H[E]!=null&&H[E].node!=null){var G=H[E].node.parentNode!=B.view.getDrawPane()&&H[E].node.parentNode!=B.view.getOverlayPane();var C=(G)?F:D;if(C!=null&&C.nextSibling!=H[E].node){if(C.nextSibling==null){C.parentNode.appendChild(H[E].node)}else{C.parentNode.insertBefore(H[E].node,C.nextSibling)}}else{if(C==null){if(H[E].node.parentNode==B.view.graph.container){var A=B.view.canvas;while(A!=null&&A.parentNode!=B.view.graph.container){A=A.parentNode}if(A!=null&&A.nextSibling!=null){if(A.nextSibling!=H[E].node){H[E].node.parentNode.insertBefore(H[E].node,A.nextSibling)}}else{H[E].node.parentNode.appendChild(H[E].node)}}else{if(H[E].node.parentNode.firstChild!=null&&H[E].node.parentNode.firstChild!=H[E].node){H[E].node.parentNode.insertBefore(H[E].node,H[E].node.parentNode.firstChild)}}}}if(G){F=H[E].node}else{D=H[E].node}}}return[D,F]};mxCellRenderer.prototype.getShapesForState=function(A){return[A.shape,A.text,A.control]};mxCellRenderer.prototype.redraw=function(D,C,A){var B=this.redrawShape(D,C,A);if(D.shape!=null&&(A==null||A)){this.redrawLabel(D,B);this.redrawCellOverlays(D,B);this.redrawControl(D,B)}};mxCellRenderer.prototype.redrawShape=function(E,C,A){var D=E.view.graph.model;var B=false;if(E.shape!=null&&E.shape.style!=null&&E.style!=null&&E.shape.style[mxConstants.STYLE_SHAPE]!=E.style[mxConstants.STYLE_SHAPE]){E.shape.destroy();E.shape=null}if(E.shape==null&&E.view.graph.container!=null&&E.cell!=E.view.currentRoot&&(D.isVertex(E.cell)||D.isEdge(E.cell))){E.shape=this.createShape(E);if(E.shape!=null){E.shape.antiAlias=this.antiAlias;this.createIndicatorShape(E);this.initializeShape(E);this.createCellOverlays(E);this.installListeners(E);E.view.graph.selectionCellsHandler.updateHandler(E)}}else{if(E.shape!=null&&!mxUtils.equalEntries(E.shape.style,E.style)){E.shape.resetStyles();this.configureShape(E);E.view.graph.selectionCellsHandler.updateHandler(E);C=true}}if(E.shape!=null){this.createControl(E);if(C||E.shape.bounds==null||E.shape.scale!=E.view.scale||(E.absolutePoints==null&&!E.shape.bounds.equals(E))||(E.absolutePoints!=null&&!mxUtils.equalPoints(E.shape.points,E.absolutePoints))){if(E.absolutePoints!=null){E.shape.points=E.absolutePoints.slice();E.shape.bounds=null}else{E.shape.points=null;E.shape.bounds=new mxRectangle(E.x,E.y,E.width,E.height)}E.shape.scale=E.view.scale;if(A==null||A){E.shape.redraw()}else{E.shape.updateBoundingBox()}B=true}}return B};mxCellRenderer.prototype.destroy=function(A){if(A.shape!=null){if(A.text!=null){A.text.destroy();A.text=null}if(A.overlays!=null){A.overlays.visit(function(C,B){B.destroy()});A.overlays=null}if(A.control!=null){A.control.destroy();A.control=null}A.shape.destroy();A.shape=null}};var mxEdgeStyle={EntityRelation:function(E,P,V,O,D){var K=E.view;var S=K.graph;var J=mxUtils.getValue(E.style,mxConstants.STYLE_SEGMENT,mxConstants.ENTITY_SEGMENT)*K.scale;var T=E.absolutePoints;var N=T[0];var A=T[T.length-1];var Y=false;if(N!=null){P=new mxCellState();P.x=N.x;P.y=N.y}else{if(P!=null){var M=mxUtils.getPortConstraints(P,E,true,mxConstants.DIRECTION_MASK_NONE);if(M!=mxConstants.DIRECTION_MASK_NONE&&M!=mxConstants.DIRECTION_MASK_WEST+mxConstants.DIRECTION_MASK_EAST){Y=M==mxConstants.DIRECTION_MASK_WEST}else{var Q=S.getCellGeometry(P.cell);if(Q.relative){Y=Q.x<=0.5}else{if(V!=null){Y=V.x+V.width<P.x}}}}else{return}}var U=true;if(A!=null){V=new mxCellState();V.x=A.x;V.y=A.y}else{if(V!=null){var M=mxUtils.getPortConstraints(V,E,false,mxConstants.DIRECTION_MASK_NONE);if(M!=mxConstants.DIRECTION_MASK_NONE&&M!=mxConstants.DIRECTION_MASK_WEST+mxConstants.DIRECTION_MASK_EAST){U=M==mxConstants.DIRECTION_MASK_WEST}else{var C=S.getCellGeometry(V.cell);if(C.relative){U=C.x<=0.5}else{if(P!=null){U=P.x+P.width<V.x}}}}}if(P!=null&&V!=null){var H=(Y)?P.x:P.x+P.width;var I=K.getRoutingCenterY(P);var B=(U)?V.x:V.x+V.width;var W=K.getRoutingCenterY(V);var Z=J;var F=(Y)?-Z:Z;var G=new mxPoint(H+F,I);F=(U)?-Z:Z;var R=new mxPoint(B+F,W);if(Y==U){var X=(Y)?Math.min(H,B)-J:Math.max(H,B)+J;D.push(new mxPoint(X,I));D.push(new mxPoint(X,W))}else{if((G.x<R.x)==Y){var L=I+(W-I)/2;D.push(G);D.push(new mxPoint(G.x,L));D.push(new mxPoint(R.x,L));D.push(R)}else{D.push(G);D.push(R)}}}},Loop:function(E,J,O,I,C){var B=E.absolutePoints;var H=B[0];var A=B[B.length-1];if(H!=null&&A!=null){if(I!=null&&I.length>0){for(var D=0;D<I.length;D++){var N=I[D];N=E.view.transformControlPoint(E,N);C.push(new mxPoint(N.x,N.y))}}return}if(J!=null){var K=E.view;var M=K.graph;var N=(I!=null&&I.length>0)?I[0]:null;if(N!=null){N=K.transformControlPoint(E,N);if(mxUtils.contains(J,N.x,N.y)){N=null}}var P=0;var F=0;var Q=0;var L=0;var R=mxUtils.getValue(E.style,mxConstants.STYLE_SEGMENT,M.gridSize)*K.scale;var G=mxUtils.getValue(E.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_WEST);if(G==mxConstants.DIRECTION_NORTH||G==mxConstants.DIRECTION_SOUTH){P=K.getRoutingCenterX(J);F=R}else{Q=K.getRoutingCenterY(J);L=R}if(N==null||N.x<J.x||N.x>J.x+J.width){if(N!=null){P=N.x;L=Math.max(Math.abs(Q-N.y),L)}else{if(G==mxConstants.DIRECTION_NORTH){Q=J.y-2*F}else{if(G==mxConstants.DIRECTION_SOUTH){Q=J.y+J.height+2*F}else{if(G==mxConstants.DIRECTION_EAST){P=J.x-2*L}else{P=J.x+J.width+2*L}}}}}else{if(N!=null){P=K.getRoutingCenterX(J);F=Math.max(Math.abs(P-N.x),L);Q=N.y;L=0}}C.push(new mxPoint(P-F,Q-L));C.push(new mxPoint(P+F,Q+L))}},ElbowConnector:function(G,I,J,K,B){var A=(K!=null&&K.length>0)?K[0]:null;var D=false;var H=false;if(I!=null&&J!=null){if(A!=null){var F=Math.min(I.x,J.x);var C=Math.max(I.x+I.width,J.x+J.width);var E=Math.min(I.y,J.y);var L=Math.max(I.y+I.height,J.y+J.height);A=G.view.transformControlPoint(G,A);D=A.y<E||A.y>L;H=A.x<F||A.x>C}else{var F=Math.max(I.x,J.x);var C=Math.min(I.x+I.width,J.x+J.width);D=F==C;if(!D){var E=Math.max(I.y,J.y);var L=Math.min(I.y+I.height,J.y+J.height);H=E==L}}}if(!H&&(D||G.style[mxConstants.STYLE_ELBOW]==mxConstants.ELBOW_VERTICAL)){mxEdgeStyle.TopToBottom(G,I,J,K,B)}else{mxEdgeStyle.SideToSide(G,I,J,K,B)}},SideToSide:function(D,K,O,J,C){var G=D.view;var H=(J!=null&&J.length>0)?J[0]:null;var L=D.absolutePoints;var I=L[0];var M=L[L.length-1];if(H!=null){H=G.transformControlPoint(D,H)}if(I!=null){K=new mxCellState();K.x=I.x;K.y=I.y}if(M!=null){O=new mxCellState();O.x=M.x;O.y=M.y}if(K!=null&&O!=null){var E=Math.max(K.x,O.x);var A=Math.min(K.x+K.width,O.x+O.width);var P=(H!=null)?H.x:Math.round(A+(E-A)/2);var N=G.getRoutingCenterY(K);var Q=G.getRoutingCenterY(O);if(H!=null){if(H.y>=K.y&&H.y<=K.y+K.height){N=H.y}if(H.y>=O.y&&H.y<=O.y+O.height){Q=H.y}}if(!mxUtils.contains(O,P,N)&&!mxUtils.contains(K,P,N)){C.push(new mxPoint(P,N))}if(!mxUtils.contains(O,P,Q)&&!mxUtils.contains(K,P,Q)){C.push(new mxPoint(P,Q))}if(C.length==1){if(H!=null){if(!mxUtils.contains(O,P,H.y)&&!mxUtils.contains(K,P,H.y)){C.push(new mxPoint(P,H.y))}}else{var B=Math.max(K.y,O.y);var F=Math.min(K.y+K.height,O.y+O.height);C.push(new mxPoint(P,B+(F-B)/2))}}}},TopToBottom:function(H,J,K,L,C){var A=H.view;var B=(L!=null&&L.length>0)?L[0]:null;var M=H.absolutePoints;var G=M[0];var D=M[M.length-1];if(B!=null){B=A.transformControlPoint(H,B)}if(G!=null){J=new mxCellState();J.x=G.x;J.y=G.y}if(D!=null){K=new mxCellState();K.x=D.x;K.y=D.y}if(J!=null&&K!=null){var E=Math.max(J.y,K.y);var N=Math.min(J.y+J.height,K.y+K.height);var O=A.getRoutingCenterX(J);if(B!=null&&B.x>=J.x&&B.x<=J.x+J.width){O=B.x}var P=(B!=null)?B.y:Math.round(N+(E-N)/2);if(!mxUtils.contains(K,O,P)&&!mxUtils.contains(J,O,P)){C.push(new mxPoint(O,P))}if(B!=null&&B.x>=K.x&&B.x<=K.x+K.width){O=B.x}else{O=A.getRoutingCenterX(K)}if(!mxUtils.contains(K,O,P)&&!mxUtils.contains(J,O,P)){C.push(new mxPoint(O,P))}if(C.length==1){if(B!=null&&C.length==1){if(!mxUtils.contains(K,B.x,P)&&!mxUtils.contains(J,B.x,P)){C.push(new mxPoint(B.x,P))}}else{var I=Math.max(J.x,K.x);var F=Math.min(J.x+J.width,K.x+K.width);C.push(new mxPoint(I+(F-I)/2,P))}}}},SegmentConnector:function(H,Q,X,S,E){var D=H.absolutePoints;var C=Math.max(1,H.view.scale);var I=(E.length>0)?E[0]:null;var Z=true;var V=null;function K(a){if(I==null||Math.abs(I.x-a.x)>=C||Math.abs(I.y-a.y)>=C){E.push(a);I=a}return I}var W=D[0];if(W==null&&Q!=null){W=new mxPoint(H.view.getRoutingCenterX(Q),H.view.getRoutingCenterY(Q))}else{if(W!=null){W=W.clone()}}W.x=Math.round(W.x);W.y=Math.round(W.y);var A=D.length-1;if(S!=null&&S.length>0){var F=[];for(var G=0;G<S.length;G++){var B=H.view.transformControlPoint(H,S[G]);if(B!=null){B.x=Math.round(B.x);B.y=Math.round(B.y);F.push(B)}}if(F.length==0){return}S=F;if(W!=null&&S[0]!=null){if(Math.abs(S[0].x-W.x)<C){S[0].x=W.x}if(Math.abs(S[0].y-W.y)<C){S[0].y=W.y}}var T=D[A];if(T!=null&&S[S.length-1]!=null){if(Math.abs(S[S.length-1].x-T.x)<C){S[S.length-1].x=T.x}if(Math.abs(S[S.length-1].y-T.y)<C){S[S.length-1].y=T.y}}V=S[0];var P=Q;var R=D[0];var Y=false;var M=false;var N=V;if(R!=null){R.x=Math.round(R.x);R.y=Math.round(R.y);P=null}for(var G=0;G<2;G++){var O=R!=null&&R.x==N.x;var U=R!=null&&R.y==N.y;var L=P!=null&&(N.y>=P.y&&N.y<=P.y+P.height);var J=P!=null&&(N.x>=P.x&&N.x<=P.x+P.width);Y=U||(R==null&&L);M=O||(R==null&&J);if(G==0&&((Y&&M)||(O&&U))){}else{if(R!=null&&(!U&&!O)&&(L||J)){Z=L?false:true;break}if(M||Y){Z=Y;if(G==1){Z=S.length%2==0?Y:M}break}}P=X;R=D[A];if(R!=null){R.x=Math.round(R.x);R.y=Math.round(R.y);P=null}N=S[S.length-1];if(O&&U){S=S.slice(1)}}if(Z&&((D[0]!=null&&D[0].y!=V.y)||(D[0]==null&&Q!=null&&(V.y<Q.y||V.y>Q.y+Q.height)))){K(new mxPoint(W.x,V.y))}else{if(!Z&&((D[0]!=null&&D[0].x!=V.x)||(D[0]==null&&Q!=null&&(V.x<Q.x||V.x>Q.x+Q.width)))){K(new mxPoint(V.x,W.y))}}if(Z){W.y=V.y}else{W.x=V.x}for(var G=0;G<S.length;G++){Z=!Z;V=S[G];if(Z){W.y=V.y}else{W.x=V.x}K(W.clone())}}else{V=W;Z=true}W=D[A];if(W==null&&X!=null){W=new mxPoint(H.view.getRoutingCenterX(X),H.view.getRoutingCenterY(X))}if(W!=null){W.x=Math.round(W.x);W.y=Math.round(W.y);if(V!=null){if(Z&&((D[A]!=null&&D[A].y!=V.y)||(D[A]==null&&X!=null&&(V.y<X.y||V.y>X.y+X.height)))){K(new mxPoint(W.x,V.y))}else{if(!Z&&((D[A]!=null&&D[A].x!=V.x)||(D[A]==null&&X!=null&&(V.x<X.x||V.x>X.x+X.width)))){K(new mxPoint(V.x,W.y))}}}}if(D[0]==null&&Q!=null){while(E.length>1&&E[1]!=null&&mxUtils.contains(Q,E[1].x,E[1].y)){E.splice(1,1)}}if(D[A]==null&&X!=null){while(E.length>1&&E[E.length-1]!=null&&mxUtils.contains(X,E[E.length-1].x,E[E.length-1].y)){E.splice(E.length-1,1)}}if(T!=null&&E[E.length-1]!=null&&Math.abs(T.x-E[E.length-1].x)<C&&Math.abs(T.y-E[E.length-1].y)<C){E.splice(E.length-1,1);if(E[E.length-1]!=null){if(Math.abs(E[E.length-1].x-T.x)<C){E[E.length-1].x=T.x}if(Math.abs(E[E.length-1].y-T.y)<C){E[E.length-1].y=T.y}}}},orthBuffer:10,orthPointsFallback:true,dirVectors:[[-1,0],[0,-1],[1,0],[0,1],[-1,0],[0,-1],[1,0]],wayPoints1:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],routePatterns:[[[513,2308,2081,2562],[513,1090,514,2184,2114,2561],[513,1090,514,2564,2184,2562],[513,2308,2561,1090,514,2568,2308]],[[514,1057,513,2308,2081,2562],[514,2184,2114,2561],[514,2184,2562,1057,513,2564,2184],[514,1057,513,2568,2308,2561]],[[1090,514,1057,513,2308,2081,2562],[2114,2561],[1090,2562,1057,513,2564,2184],[1090,514,1057,513,2308,2561,2568]],[[2081,2562],[1057,513,1090,514,2184,2114,2561],[1057,513,1090,514,2184,2562,2564],[1057,2561,1090,514,2568,2308]]],inlineRoutePatterns:[[null,[2114,2568],null,null],[null,[514,2081,2114,2568],null,null],[null,[2114,2561],null,null],[[2081,2562],[1057,2114,2568],[2184,2562],null]],vertexSeperations:[],limits:[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]],LEFT_MASK:32,TOP_MASK:64,RIGHT_MASK:128,BOTTOM_MASK:256,LEFT:1,TOP:2,RIGHT:4,BOTTOM:8,SIDE_MASK:480,CENTER_MASK:512,SOURCE_MASK:1024,TARGET_MASK:2048,VERTEX_MASK:3072,getJettySize:function(D,E,F,G,H){var C=mxUtils.getValue(D.style,(H)?mxConstants.STYLE_SOURCE_JETTY_SIZE:mxConstants.STYLE_TARGET_JETTY_SIZE,mxUtils.getValue(D.style,mxConstants.STYLE_JETTY_SIZE,mxEdgeStyle.orthBuffer));if(C=="auto"){var B=mxUtils.getValue(D.style,(H)?mxConstants.STYLE_STARTARROW:mxConstants.STYLE_ENDARROW,mxConstants.NONE);if(B!=mxConstants.NONE){var A=mxUtils.getNumber(D.style,(H)?mxConstants.STYLE_STARTSIZE:mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE);C=Math.max(2,Math.ceil((A+mxEdgeStyle.orthBuffer)/mxEdgeStyle.orthBuffer))*mxEdgeStyle.orthBuffer}else{C=2*mxEdgeStyle.orthBuffer}}return C},OrthConnector:function(L,Ag,w,Aj,U){var Z=L.view.graph;var u=Ag==null?false:Z.getModel().isEdge(Ag.cell);var As=w==null?false:Z.getModel().isEdge(w.cell);var Af=L.absolutePoints;var l=Af[0];var Ar=Af[Af.length-1];var F=Ag!=null?Ag.x:l.x;var E=Ag!=null?Ag.y:l.y;var S=Ag!=null?Ag.width:0;var N=Ag!=null?Ag.height:0;var a=w!=null?w.x:Ar.x;var b=w!=null?w.y:Ar.y;var O=w!=null?w.width:0;var V=w!=null?w.height:0;var c=L.view.scale*mxEdgeStyle.getJettySize(L,Ag,w,Aj,true);var Ad=L.view.scale*mxEdgeStyle.getJettySize(L,Ag,w,Aj,false);if(Ag!=null&&w==Ag){Ad=Math.max(c,Ad);c=Ad}var T=Ad+c;var k=false;if(l!=null&&Ar!=null){var C=Ar.x-l.x;var t=Ar.y-l.y;k=C*C+t*t<T*T}if(k||(mxEdgeStyle.orthPointsFallback&&(Aj!=null&&Aj.length>0))||u||As){mxEdgeStyle.SegmentConnector(L,Ag,w,Aj,U);return}var y=[mxConstants.DIRECTION_MASK_ALL,mxConstants.DIRECTION_MASK_ALL];var o=0;if(Ag!=null){y[0]=mxUtils.getPortConstraints(Ag,L,true,mxConstants.DIRECTION_MASK_ALL);o=mxUtils.getValue(Ag.style,mxConstants.STYLE_ROTATION,0);if(o!=0){var I=mxUtils.getBoundingBox(new mxRectangle(F,E,S,N),o);F=I.x;E=I.y;S=I.width;N=I.height}}if(w!=null){y[1]=mxUtils.getPortConstraints(w,L,false,mxConstants.DIRECTION_MASK_ALL);o=mxUtils.getValue(w.style,mxConstants.STYLE_ROTATION,0);if(o!=0){var I=mxUtils.getBoundingBox(new mxRectangle(a,b,O,V),o);a=I.x;b=I.y;O=I.width;V=I.height}}F=Math.round(F*10)/10;E=Math.round(E*10)/10;S=Math.round(S*10)/10;N=Math.round(N*10)/10;a=Math.round(a*10)/10;b=Math.round(b*10)/10;O=Math.round(O*10)/10;V=Math.round(V*10)/10;var J=[0,0];var Au=[[F,E,S,N],[a,b,O,V]];var Am=[c,Ad];for(var An=0;An<2;An++){mxEdgeStyle.limits[An][1]=Au[An][0]-Am[An];mxEdgeStyle.limits[An][2]=Au[An][1]-Am[An];mxEdgeStyle.limits[An][4]=Au[An][0]+Au[An][2]+Am[An];mxEdgeStyle.limits[An][8]=Au[An][1]+Au[An][3]+Am[An]}var D=Au[0][0]+Au[0][2]/2;var j=Au[0][1]+Au[0][3]/2;var Q=Au[1][0]+Au[1][2]/2;var Y=Au[1][1]+Au[1][3]/2;var C=D-Q;var t=j-Y;var Ah=0;if(C<0){if(t<0){Ah=2}else{Ah=1}}else{if(t<=0){Ah=3;if(C==0){Ah=2}}}var d=null;if(Ag!=null){d=l}var P=[[0.5,0.5],[0.5,0.5]];for(var An=0;An<2;An++){if(d!=null){P[An][0]=(d.x-Au[An][0])/Au[An][2];if(Math.abs(d.x-Au[An][0])<=1){J[An]=mxConstants.DIRECTION_MASK_WEST}else{if(Math.abs(d.x-Au[An][0]-Au[An][2])<=1){J[An]=mxConstants.DIRECTION_MASK_EAST}}P[An][1]=(d.y-Au[An][1])/Au[An][3];if(Math.abs(d.y-Au[An][1])<=1){J[An]=mxConstants.DIRECTION_MASK_NORTH}else{if(Math.abs(d.y-Au[An][1]-Au[An][3])<=1){J[An]=mxConstants.DIRECTION_MASK_SOUTH}}}d=null;if(w!=null){d=Ar}}var g=Au[0][1]-(Au[1][1]+Au[1][3]);var e=Au[0][0]-(Au[1][0]+Au[1][2]);var x=Au[1][1]-(Au[0][1]+Au[0][3]);var q=Au[1][0]-(Au[0][0]+Au[0][2]);mxEdgeStyle.vertexSeperations[1]=Math.max(e-T,0);mxEdgeStyle.vertexSeperations[2]=Math.max(g-T,0);mxEdgeStyle.vertexSeperations[4]=Math.max(x-T,0);mxEdgeStyle.vertexSeperations[3]=Math.max(q-T,0);var p=[];var A=[];var f=[];A[0]=(e>=q)?mxConstants.DIRECTION_MASK_WEST:mxConstants.DIRECTION_MASK_EAST;f[0]=(g>=x)?mxConstants.DIRECTION_MASK_NORTH:mxConstants.DIRECTION_MASK_SOUTH;A[1]=mxUtils.reversePortConstraints(A[0]);f[1]=mxUtils.reversePortConstraints(f[0]);var s=e>=q?e:q;var W=g>=x?g:x;var Av=[[0,0],[0,0]];var X=false;for(var An=0;An<2;An++){if(J[An]!=0){continue}if((A[An]&y[An])==0){A[An]=mxUtils.reversePortConstraints(A[An])}if((f[An]&y[An])==0){f[An]=mxUtils.reversePortConstraints(f[An])}Av[An][0]=f[An];Av[An][1]=A[An]}if(W>0&&s>0){if(((A[0]&y[0])>0)&&((f[1]&y[1])>0)){Av[0][0]=A[0];Av[0][1]=f[0];Av[1][0]=f[1];Av[1][1]=A[1];X=true}else{if(((f[0]&y[0])>0)&&((A[1]&y[1])>0)){Av[0][0]=f[0];Av[0][1]=A[0];Av[1][0]=A[1];Av[1][1]=f[1];X=true}}}if(W>0&&!X){Av[0][0]=f[0];Av[0][1]=A[0];Av[1][0]=f[1];Av[1][1]=A[1];X=true}if(s>0&&!X){Av[0][0]=A[0];Av[0][1]=f[0];Av[1][0]=A[1];Av[1][1]=f[1];X=true}for(var An=0;An<2;An++){if(J[An]!=0){continue}if((Av[An][0]&y[An])==0){Av[An][0]=Av[An][1]}p[An]=Av[An][0]&y[An];p[An]|=(Av[An][1]&y[An])<<8;p[An]|=(Av[1-An][An]&y[An])<<16;p[An]|=(Av[1-An][1-An]&y[An])<<24;if((p[An]&15)==0){p[An]=p[An]<<8}if((p[An]&3840)==0){p[An]=(p[An]&15)|p[An]>>8}if((p[An]&983040)==0){p[An]=(p[An]&65535)|((p[An]&251658240)>>8)}J[An]=p[An]&15;if(y[An]==mxConstants.DIRECTION_MASK_WEST||y[An]==mxConstants.DIRECTION_MASK_NORTH||y[An]==mxConstants.DIRECTION_MASK_EAST||y[An]==mxConstants.DIRECTION_MASK_SOUTH){J[An]=y[An]}}var Aa=J[0]==mxConstants.DIRECTION_MASK_EAST?3:J[0];var G=J[1]==mxConstants.DIRECTION_MASK_EAST?3:J[1];Aa-=Ah;G-=Ah;if(Aa<1){Aa+=4}if(G<1){G+=4}var z=mxEdgeStyle.routePatterns[Aa-1][G-1];mxEdgeStyle.wayPoints1[0][0]=Au[0][0];mxEdgeStyle.wayPoints1[0][1]=Au[0][1];switch(J[0]){case mxConstants.DIRECTION_MASK_WEST:mxEdgeStyle.wayPoints1[0][0]-=c;mxEdgeStyle.wayPoints1[0][1]+=P[0][1]*Au[0][3];break;case mxConstants.DIRECTION_MASK_SOUTH:mxEdgeStyle.wayPoints1[0][0]+=P[0][0]*Au[0][2];mxEdgeStyle.wayPoints1[0][1]+=Au[0][3]+c;break;case mxConstants.DIRECTION_MASK_EAST:mxEdgeStyle.wayPoints1[0][0]+=Au[0][2]+c;mxEdgeStyle.wayPoints1[0][1]+=P[0][1]*Au[0][3];break;case mxConstants.DIRECTION_MASK_NORTH:mxEdgeStyle.wayPoints1[0][0]+=P[0][0]*Au[0][2];mxEdgeStyle.wayPoints1[0][1]-=c;break}var m=0;var H=(J[0]&(mxConstants.DIRECTION_MASK_EAST|mxConstants.DIRECTION_MASK_WEST))>0?0:1;var R=H;var M=0;for(var An=0;An<z.length;An++){var h=z[An]&15;var K=h==mxConstants.DIRECTION_MASK_EAST?3:h;K+=Ah;if(K>4){K-=4}var Ak=mxEdgeStyle.dirVectors[K-1];M=(K%2>0)?0:1;if(M!=H){m++;mxEdgeStyle.wayPoints1[m][0]=mxEdgeStyle.wayPoints1[m-1][0];mxEdgeStyle.wayPoints1[m][1]=mxEdgeStyle.wayPoints1[m-1][1]}var At=(z[An]&mxEdgeStyle.TARGET_MASK)>0;var v=(z[An]&mxEdgeStyle.SOURCE_MASK)>0;var Aq=(z[An]&mxEdgeStyle.SIDE_MASK)>>5;Aq=Aq<<Ah;if(Aq>15){Aq=Aq>>4}var Ae=(z[An]&mxEdgeStyle.CENTER_MASK)>0;if((v||At)&&Aq<9){var B=0;var Ao=v?0:1;if(Ae&&M==0){B=Au[Ao][0]+P[Ao][0]*Au[Ao][2]}else{if(Ae){B=Au[Ao][1]+P[Ao][1]*Au[Ao][3]}else{B=mxEdgeStyle.limits[Ao][Aq]}}if(M==0){var Al=mxEdgeStyle.wayPoints1[m][0];var r=(B-Al)*Ak[0];if(r>0){mxEdgeStyle.wayPoints1[m][0]+=Ak[0]*r}}else{var n=mxEdgeStyle.wayPoints1[m][1];var Ac=(B-n)*Ak[1];if(Ac>0){mxEdgeStyle.wayPoints1[m][1]+=Ak[1]*Ac}}}else{if(Ae){mxEdgeStyle.wayPoints1[m][0]+=Ak[0]*Math.abs(mxEdgeStyle.vertexSeperations[K]/2);mxEdgeStyle.wayPoints1[m][1]+=Ak[1]*Math.abs(mxEdgeStyle.vertexSeperations[K]/2)}}if(m>0&&mxEdgeStyle.wayPoints1[m][M]==mxEdgeStyle.wayPoints1[m-1][M]){m--}else{H=M}}for(var An=0;An<=m;An++){if(An==m){var Ai=(J[1]&(mxConstants.DIRECTION_MASK_EAST|mxConstants.DIRECTION_MASK_WEST))>0?0:1;var Ab=Ai==R?0:1;if(Ab!=(m+1)%2){break}}U.push(new mxPoint(Math.round(mxEdgeStyle.wayPoints1[An][0]),Math.round(mxEdgeStyle.wayPoints1[An][1])))}var Ap=1;while(Ap<U.length){if(U[Ap-1]==null||U[Ap]==null||U[Ap-1].x!=U[Ap].x||U[Ap-1].y!=U[Ap].y){Ap++}else{U.splice(Ap,1)}}},getRoutePattern:function(A,D,C,E){var B=A[0]==mxConstants.DIRECTION_MASK_EAST?3:A[0];var G=A[1]==mxConstants.DIRECTION_MASK_EAST?3:A[1];B-=D;G-=D;if(B<1){B+=4}if(G<1){G+=4}var F=routePatterns[B-1][G-1];if(C==0||E==0){if(inlineRoutePatterns[B-1][G-1]!=null){F=inlineRoutePatterns[B-1][G-1]}}return F}};var mxStyleRegistry={values:[],putValue:function(B,A){mxStyleRegistry.values[B]=A},getValue:function(A){return mxStyleRegistry.values[A]},getName:function(B){for(var A in mxStyleRegistry.values){if(mxStyleRegistry.values[A]==B){return A}}return null}};mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ELBOW,mxEdgeStyle.ElbowConnector);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ENTITY_RELATION,mxEdgeStyle.EntityRelation);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_LOOP,mxEdgeStyle.Loop);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_SIDETOSIDE,mxEdgeStyle.SideToSide);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_TOPTOBOTTOM,mxEdgeStyle.TopToBottom);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ORTHOGONAL,mxEdgeStyle.OrthConnector);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_SEGMENT,mxEdgeStyle.SegmentConnector);mxStyleRegistry.putValue(mxConstants.PERIMETER_ELLIPSE,mxPerimeter.EllipsePerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_RECTANGLE,mxPerimeter.RectanglePerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_RHOMBUS,mxPerimeter.RhombusPerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_TRIANGLE,mxPerimeter.TrianglePerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_HEXAGON,mxPerimeter.HexagonPerimeter);function mxGraphView(A){this.graph=A;this.translate=new mxPoint();this.graphBounds=new mxRectangle();this.states=new mxDictionary()}mxGraphView.prototype=new mxEventSource();mxGraphView.prototype.constructor=mxGraphView;mxGraphView.prototype.EMPTY_POINT=new mxPoint();mxGraphView.prototype.doneResource=(mxClient.language!="none")?"done":"";mxGraphView.prototype.updatingDocumentResource=(mxClient.language!="none")?"updatingDocument":"";mxGraphView.prototype.allowEval=false;mxGraphView.prototype.captureDocumentGesture=true;mxGraphView.prototype.optimizeVmlReflows=true;mxGraphView.prototype.rendering=true;mxGraphView.prototype.graph=null;mxGraphView.prototype.currentRoot=null;mxGraphView.prototype.graphBounds=null;mxGraphView.prototype.scale=1;mxGraphView.prototype.translate=null;mxGraphView.prototype.states=null;mxGraphView.prototype.updateStyle=false;mxGraphView.prototype.lastNode=null;mxGraphView.prototype.lastHtmlNode=null;mxGraphView.prototype.lastForegroundNode=null;mxGraphView.prototype.lastForegroundHtmlNode=null;mxGraphView.prototype.getGraphBounds=function(){return this.graphBounds};mxGraphView.prototype.setGraphBounds=function(A){this.graphBounds=A};mxGraphView.prototype.getBounds=function(C){var B=null;if(C!=null&&C.length>0){var D=this.graph.getModel();for(var A=0;A<C.length;A++){if(D.isVertex(C[A])||D.isEdge(C[A])){var E=this.getState(C[A]);if(E!=null){if(B==null){B=mxRectangle.fromRectangle(E)}else{B.add(E)}}}}}return B};mxGraphView.prototype.setCurrentRoot=function(B){if(this.currentRoot!=B){var A=new mxCurrentRootChange(this,B);A.execute();var C=new mxUndoableEdit(this,false);C.add(A);this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",C));this.graph.sizeDidChange()}return B};mxGraphView.prototype.scaleAndTranslate=function(D,B,C){var E=this.scale;var A=new mxPoint(this.translate.x,this.translate.y);if(this.scale!=D||this.translate.x!=B||this.translate.y!=C){this.scale=D;this.translate.x=B;this.translate.y=C;if(this.isEventsEnabled()){this.revalidate();this.graph.sizeDidChange()}}this.fireEvent(new mxEventObject(mxEvent.SCALE_AND_TRANSLATE,"scale",D,"previousScale",E,"translate",this.translate,"previousTranslate",A))};mxGraphView.prototype.getScale=function(){return this.scale};mxGraphView.prototype.setScale=function(A){var B=this.scale;if(this.scale!=A){this.scale=A;if(this.isEventsEnabled()){this.revalidate();this.graph.sizeDidChange()}}this.fireEvent(new mxEventObject(mxEvent.SCALE,"scale",A,"previousScale",B))};mxGraphView.prototype.getTranslate=function(){return this.translate};mxGraphView.prototype.setTranslate=function(B,C){var A=new mxPoint(this.translate.x,this.translate.y);if(this.translate.x!=B||this.translate.y!=C){this.translate.x=B;this.translate.y=C;if(this.isEventsEnabled()){this.revalidate();this.graph.sizeDidChange()}}this.fireEvent(new mxEventObject(mxEvent.TRANSLATE,"translate",this.translate,"previousTranslate",A))};mxGraphView.prototype.refresh=function(){if(this.currentRoot!=null){this.clear()}this.revalidate()};mxGraphView.prototype.revalidate=function(){this.invalidate();this.validate()};mxGraphView.prototype.clear=function(E,D,B){var F=this.graph.getModel();E=E||F.getRoot();D=(D!=null)?D:false;B=(B!=null)?B:true;this.removeState(E);if(B&&(D||E!=this.currentRoot)){var A=F.getChildCount(E);for(var C=0;C<A;C++){this.clear(F.getChildAt(E,C),D)}}else{this.invalidate(E)}};mxGraphView.prototype.invalidate=function(I,F,E){var H=this.graph.getModel();I=I||H.getRoot();F=(F!=null)?F:true;E=(E!=null)?E:true;var C=this.getState(I);if(C!=null){C.invalid=true}if(!I.invalidating){I.invalidating=true;if(F){var A=H.getChildCount(I);for(var D=0;D<A;D++){var B=H.getChildAt(I,D);this.invalidate(B,F,E)}}if(E){var G=H.getEdgeCount(I);for(var D=0;D<G;D++){this.invalidate(H.getEdgeAt(I,D),F,E)}}delete I.invalidating}};mxGraphView.prototype.validate=function(C){var B=mxLog.enter("mxGraphView.validate");window.status=mxResources.get(this.updatingDocumentResource)||this.updatingDocumentResource;this.resetValidationState();var D=null;if(this.optimizeVmlReflows&&this.canvas!=null&&this.textDiv==null&&((document.documentMode==8&&!mxClient.IS_EM)||mxClient.IS_QUIRKS)){this.placeholder=document.createElement("div");this.placeholder.style.position="absolute";this.placeholder.style.width=this.canvas.clientWidth+"px";this.placeholder.style.height=this.canvas.clientHeight+"px";this.canvas.parentNode.appendChild(this.placeholder);D=this.drawPane.style.display;this.canvas.style.display="none";this.textDiv=document.createElement("div");this.textDiv.style.position="absolute";this.textDiv.style.whiteSpace="nowrap";this.textDiv.style.visibility="hidden";this.textDiv.style.display=(mxClient.IS_QUIRKS)?"inline":"inline-block";this.textDiv.style.zoom="1";document.body.appendChild(this.textDiv)}var A=this.getBoundingBox(this.validateCellState(this.validateCell(C||((this.currentRoot!=null)?this.currentRoot:this.graph.getModel().getRoot()))));this.setGraphBounds((A!=null)?A:this.getEmptyBounds());this.validateBackground();if(D!=null){this.canvas.style.display=D;this.textDiv.parentNode.removeChild(this.textDiv);if(this.placeholder!=null){this.placeholder.parentNode.removeChild(this.placeholder)}this.textDiv=null}this.resetValidationState();window.status=mxResources.get(this.doneResource)||this.doneResource;mxLog.leave("mxGraphView.validate",B)};mxGraphView.prototype.getEmptyBounds=function(){return new mxRectangle(this.translate.x*this.scale,this.translate.y*this.scale)};mxGraphView.prototype.getBoundingBox=function(G,B){B=(B!=null)?B:true;var E=null;if(G!=null){if(G.shape!=null&&G.shape.boundingBox!=null){E=G.shape.boundingBox.clone()}if(G.text!=null&&G.text.boundingBox!=null){if(E!=null){E.add(G.text.boundingBox)}else{E=G.text.boundingBox.clone()}}if(B){var F=this.graph.getModel();var A=F.getChildCount(G.cell);for(var C=0;C<A;C++){var D=this.getBoundingBox(this.getState(F.getChildAt(G.cell,C)));if(D!=null){if(E==null){E=D}else{E.add(D)}}}}}return E};mxGraphView.prototype.createBackgroundPageShape=function(A){return new mxRectangleShape(A,"white","black")};mxGraphView.prototype.validateBackground=function(){this.validateBackgroundImage();this.validateBackgroundPage()};mxGraphView.prototype.validateBackgroundImage=function(){var A=this.graph.getBackgroundImage();if(A!=null){if(this.backgroundImage==null||this.backgroundImage.image!=A.src){if(this.backgroundImage!=null){this.backgroundImage.destroy()}var B=new mxRectangle(0,0,1,1);this.backgroundImage=new mxImageShape(B,A.src);this.backgroundImage.dialect=this.graph.dialect;this.backgroundImage.init(this.backgroundPane);this.backgroundImage.redraw();if(document.documentMode==8&&!mxClient.IS_EM){mxEvent.addGestureListeners(this.backgroundImage.node,mxUtils.bind(this,function(C){this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(C))}),mxUtils.bind(this,function(C){this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(C))}),mxUtils.bind(this,function(C){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(C))}))}}this.redrawBackgroundImage(this.backgroundImage,A)}else{if(this.backgroundImage!=null){this.backgroundImage.destroy();this.backgroundImage=null}}};mxGraphView.prototype.validateBackgroundPage=function(){if(this.graph.pageVisible){var A=this.getBackgroundPageBounds();if(this.backgroundPageShape==null){this.backgroundPageShape=this.createBackgroundPageShape(A);this.backgroundPageShape.scale=this.scale;this.backgroundPageShape.isShadow=true;this.backgroundPageShape.dialect=this.graph.dialect;this.backgroundPageShape.init(this.backgroundPane);this.backgroundPageShape.redraw();if(this.graph.nativeDblClickEnabled){mxEvent.addListener(this.backgroundPageShape.node,"dblclick",mxUtils.bind(this,function(B){this.graph.dblClick(B)}))}mxEvent.addGestureListeners(this.backgroundPageShape.node,mxUtils.bind(this,function(B){this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(B))}),mxUtils.bind(this,function(B){if(this.graph.tooltipHandler!=null&&this.graph.tooltipHandler.isHideOnHover()){this.graph.tooltipHandler.hide()}if(this.graph.isMouseDown&&!mxEvent.isConsumed(B)){this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(B))}}),mxUtils.bind(this,function(B){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(B))}))}else{this.backgroundPageShape.scale=this.scale;this.backgroundPageShape.bounds=A;this.backgroundPageShape.redraw()}}else{if(this.backgroundPageShape!=null){this.backgroundPageShape.destroy();this.backgroundPageShape=null}}};mxGraphView.prototype.getBackgroundPageBounds=function(){var A=this.graph.pageFormat;var B=this.scale*this.graph.pageScale;var C=new mxRectangle(this.scale*this.translate.x,this.scale*this.translate.y,A.width*B,A.height*B);return C};mxGraphView.prototype.redrawBackgroundImage=function(A,B){A.scale=this.scale;A.bounds.x=this.scale*this.translate.x;A.bounds.y=this.scale*this.translate.y;A.bounds.width=this.scale*B.width;A.bounds.height=this.scale*B.height;A.redraw()};mxGraphView.prototype.validateCell=function(D,C){C=(C!=null)?C:true;if(D!=null){C=C&&this.graph.isCellVisible(D);var F=this.getState(D,C);if(F!=null&&!C){this.removeState(D)}else{var E=this.graph.getModel();var A=E.getChildCount(D);for(var B=0;B<A;B++){this.validateCell(E.getChildAt(D,B),C&&(!this.isCellCollapsed(D)||D==this.currentRoot))}}}return D};mxGraphView.prototype.validateCellState=function(D,B){B=(B!=null)?B:true;var F=null;if(D!=null){F=this.getState(D);if(F!=null){var E=this.graph.getModel();if(F.invalid){F.invalid=false;if(F.style==null){F.style=this.graph.getCellStyle(F.cell)}if(D!=this.currentRoot){this.validateCellState(E.getParent(D),false)}F.setVisibleTerminalState(this.validateCellState(this.getVisibleTerminal(D,true),false),true);F.setVisibleTerminalState(this.validateCellState(this.getVisibleTerminal(D,false),false),false);this.updateCellState(F);if(D!=this.currentRoot&&!F.invalid){this.graph.cellRenderer.redraw(F,false,this.isRendering())}}if(B&&!F.invalid){if(F.shape!=null){this.stateValidated(F)}var A=E.getChildCount(D);for(var C=0;C<A;C++){this.validateCellState(E.getChildAt(D,C))}}}}return F};mxGraphView.prototype.updateCellState=function(F){F.absoluteOffset.x=0;F.absoluteOffset.y=0;F.origin.x=0;F.origin.y=0;F.length=0;if(F.cell!=this.currentRoot){var E=this.graph.getModel();var C=this.getState(E.getParent(F.cell));if(C!=null&&C.cell!=this.currentRoot){F.origin.x+=C.origin.x;F.origin.y+=C.origin.y}var A=this.graph.getChildOffsetForCell(F.cell);if(A!=null){F.origin.x+=A.x;F.origin.y+=A.y}var B=this.graph.getCellGeometry(F.cell);if(B!=null){if(!E.isEdge(F.cell)){A=B.offset||this.EMPTY_POINT;if(B.relative&&C!=null){if(E.isEdge(C.cell)){var D=this.getPoint(C,B);if(D!=null){F.origin.x+=(D.x/this.scale)-C.origin.x-this.translate.x;F.origin.y+=(D.y/this.scale)-C.origin.y-this.translate.y}}else{F.origin.x+=B.x*C.width/this.scale+A.x;F.origin.y+=B.y*C.height/this.scale+A.y}}else{F.absoluteOffset.x=this.scale*A.x;F.absoluteOffset.y=this.scale*A.y;F.origin.x+=B.x;F.origin.y+=B.y}}F.x=this.scale*(this.translate.x+F.origin.x);F.y=this.scale*(this.translate.y+F.origin.y);F.width=this.scale*B.width;F.unscaledWidth=B.width;F.height=this.scale*B.height;if(E.isVertex(F.cell)){this.updateVertexState(F,B)}if(E.isEdge(F.cell)){this.updateEdgeState(F,B)}}}F.updateCachedBounds()};mxGraphView.prototype.isCellCollapsed=function(A){return this.graph.isCellCollapsed(A)};mxGraphView.prototype.updateVertexState=function(G,I){var J=this.graph.getModel();var B=this.getState(J.getParent(G.cell));if(I.relative&&B!=null&&!J.isEdge(B.cell)){var F=mxUtils.toRadians(B.style[mxConstants.STYLE_ROTATION]||"0");if(F!=0){var E=Math.cos(F);var D=Math.sin(F);var H=new mxPoint(G.getCenterX(),G.getCenterY());var C=new mxPoint(B.getCenterX(),B.getCenterY());var A=mxUtils.getRotatedPoint(H,E,D,C);G.x=A.x-G.width/2;G.y=A.y-G.height/2}}this.updateVertexLabelOffset(G)};mxGraphView.prototype.updateEdgeState=function(E,A){var B=E.getVisibleTerminalState(true);var D=E.getVisibleTerminalState(false);if((this.graph.model.getTerminal(E.cell,true)!=null&&B==null)||(B==null&&A.getTerminalPoint(true)==null)||(this.graph.model.getTerminal(E.cell,false)!=null&&D==null)||(D==null&&A.getTerminalPoint(false)==null)){this.clear(E.cell,true)}else{this.updateFixedTerminalPoints(E,B,D);this.updatePoints(E,A.points,B,D);this.updateFloatingTerminalPoints(E,B,D);var C=E.absolutePoints;if(E.cell!=this.currentRoot&&(C==null||C.length<2||C[0]==null||C[C.length-1]==null)){this.clear(E.cell,true)}else{this.updateEdgeBounds(E);this.updateEdgeLabelOffset(E)}}};mxGraphView.prototype.updateVertexLabelOffset=function(F){var A=mxUtils.getValue(F.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);if(A==mxConstants.ALIGN_LEFT){var B=mxUtils.getValue(F.style,mxConstants.STYLE_LABEL_WIDTH,null);if(B!=null){B*=this.scale}else{B=F.width}F.absoluteOffset.x-=B}else{if(A==mxConstants.ALIGN_RIGHT){F.absoluteOffset.x+=F.width}else{if(A==mxConstants.ALIGN_CENTER){var B=mxUtils.getValue(F.style,mxConstants.STYLE_LABEL_WIDTH,null);if(B!=null){var D=mxUtils.getValue(F.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER);var C=0;if(D==mxConstants.ALIGN_CENTER){C=0.5}else{if(D==mxConstants.ALIGN_RIGHT){C=1}}if(C!=0){F.absoluteOffset.x-=(B*this.scale-F.width)*C}}}}}var E=mxUtils.getValue(F.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);if(E==mxConstants.ALIGN_TOP){F.absoluteOffset.y-=F.height}else{if(E==mxConstants.ALIGN_BOTTOM){F.absoluteOffset.y+=F.height}}};mxGraphView.prototype.resetValidationState=function(){this.lastNode=null;this.lastHtmlNode=null;this.lastForegroundNode=null;this.lastForegroundHtmlNode=null};mxGraphView.prototype.stateValidated=function(E){var C=(this.graph.getModel().isEdge(E.cell)&&this.graph.keepEdgesInForeground)||(this.graph.getModel().isVertex(E.cell)&&this.graph.keepEdgesInBackground);var D=(C)?this.lastForegroundHtmlNode||this.lastHtmlNode:this.lastHtmlNode;var A=(C)?this.lastForegroundNode||this.lastNode:this.lastNode;var B=this.graph.cellRenderer.insertStateAfter(E,A,D);if(C){this.lastForegroundHtmlNode=B[1];this.lastForegroundNode=B[0]}else{this.lastHtmlNode=B[1];this.lastNode=B[0]}};mxGraphView.prototype.updateFixedTerminalPoints=function(B,A,C){this.updateFixedTerminalPoint(B,A,true,this.graph.getConnectionConstraint(B,A,true));this.updateFixedTerminalPoint(B,C,false,this.graph.getConnectionConstraint(B,C,false))};mxGraphView.prototype.updateFixedTerminalPoint=function(B,D,A,C){B.setAbsoluteTerminalPoint(this.getFixedTerminalPoint(B,D,A,C),A)};mxGraphView.prototype.getFixedTerminalPoint=function(E,D,B,G){var A=null;if(G!=null){A=this.graph.getConnectionPoint(D,G)}if(A==null&&D==null){var C=this.scale;var F=this.translate;var I=E.origin;var H=this.graph.getCellGeometry(E.cell);A=H.getTerminalPoint(B);if(A!=null){A=new mxPoint(C*(F.x+A.x+I.x),C*(F.y+A.y+I.y))}}return A};mxGraphView.prototype.updateBoundsFromStencil=function(C){var B=null;if(C!=null&&C.shape!=null&&C.shape.stencil!=null&&C.shape.stencil.aspect=="fixed"){B=mxRectangle.fromRectangle(C);var A=C.shape.stencil.computeAspect(C.style,C.x,C.y,C.width,C.height);C.setRect(A.x,A.y,C.shape.stencil.w0*A.width,C.shape.stencil.h0*A.height)}return B};mxGraphView.prototype.updatePoints=function(I,K,C,J){if(I!=null){var A=[];A.push(I.absolutePoints[0]);var M=this.getEdgeStyle(I,K,C,J);if(M!=null){var L=this.getTerminalPort(I,C,true);var E=this.getTerminalPort(I,J,false);var G=this.updateBoundsFromStencil(L);var H=this.updateBoundsFromStencil(E);M(I,L,E,K,A);if(G!=null){L.setRect(G.x,G.y,G.width,G.height)}if(H!=null){E.setRect(H.x,H.y,H.width,H.height)}}else{if(K!=null){for(var F=0;F<K.length;F++){if(K[F]!=null){var B=mxUtils.clone(K[F]);A.push(this.transformControlPoint(I,B))}}}}var D=I.absolutePoints;A.push(D[D.length-1]);I.absolutePoints=A}};mxGraphView.prototype.transformControlPoint=function(C,B){if(C!=null&&B!=null){var A=C.origin;return new mxPoint(this.scale*(B.x+this.translate.x+A.x),this.scale*(B.y+this.translate.y+A.y))}return null};mxGraphView.prototype.isLoopStyleEnabled=function(D,E,C,F){var A=this.graph.getConnectionConstraint(D,C,true);var B=this.graph.getConnectionConstraint(D,F,false);if(!mxUtils.getValue(D.style,mxConstants.STYLE_ORTHOGONAL_LOOP,false)||((A==null||A.point==null)&&(B==null||B.point==null))){return C!=null&&C==F}return false};mxGraphView.prototype.getEdgeStyle=function(edge,points,source,target){var edgeStyle=this.isLoopStyleEnabled(edge,points,source,target)?mxUtils.getValue(edge.style,mxConstants.STYLE_LOOP,this.graph.defaultLoopStyle):(!mxUtils.getValue(edge.style,mxConstants.STYLE_NOEDGESTYLE,false)?edge.style[mxConstants.STYLE_EDGE]:null);if(typeof(edgeStyle)=="string"){var tmp=mxStyleRegistry.getValue(edgeStyle);if(tmp==null&&this.isAllowEval()){tmp=mxUtils.eval(edgeStyle)}edgeStyle=tmp}if(typeof(edgeStyle)=="function"){return edgeStyle}return null};mxGraphView.prototype.updateFloatingTerminalPoints=function(F,C,E){var A=F.absolutePoints;var D=A[0];var B=A[A.length-1];if(B==null&&E!=null){this.updateFloatingTerminalPoint(F,E,C,false)}if(D==null&&C!=null){this.updateFloatingTerminalPoint(F,C,E,true)}};mxGraphView.prototype.updateFloatingTerminalPoint=function(B,D,C,A){B.setAbsoluteTerminalPoint(this.getFloatingTerminalPoint(B,D,C,A),A)};mxGraphView.prototype.getFloatingTerminalPoint=function(I,C,D,H){C=this.getTerminalPort(I,C,H);var L=this.getNextPoint(I,D,H);var J=this.graph.isOrthogonal(I);var F=mxUtils.toRadians(Number(C.style[mxConstants.STYLE_ROTATION]||"0"));var A=new mxPoint(C.getCenterX(),C.getCenterY());if(F!=0){var G=Math.cos(-F);var E=Math.sin(-F);L=mxUtils.getRotatedPoint(L,G,E,A)}var K=parseFloat(I.style[mxConstants.STYLE_PERIMETER_SPACING]||0);K+=parseFloat(I.style[(H)?mxConstants.STYLE_SOURCE_PERIMETER_SPACING:mxConstants.STYLE_TARGET_PERIMETER_SPACING]||0);var B=this.getPerimeterPoint(C,L,F==0&&J,K);if(F!=0){var G=Math.cos(F);var E=Math.sin(F);B=mxUtils.getRotatedPoint(B,G,E,A)}return B};mxGraphView.prototype.getTerminalPort=function(F,E,C){var B=(C)?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT;var D=mxUtils.getValue(F.style,B);if(D!=null){var A=this.getState(this.graph.getModel().getCell(D));if(A!=null){E=A}}return E};mxGraphView.prototype.getPerimeterPoint=function(G,D,F,A){var C=null;if(G!=null){var B=this.getPerimeterFunction(G);if(B!=null&&D!=null){var E=this.getPerimeterBounds(G,A);if(E.width>0||E.height>0){C=B(E,G,D,F)}}if(C==null){C=this.getPoint(G)}}return C};mxGraphView.prototype.getRoutingCenterX=function(B){var A=(B.style!=null)?parseFloat(B.style[mxConstants.STYLE_ROUTING_CENTER_X])||0:0;return B.getCenterX()+A*B.width};mxGraphView.prototype.getRoutingCenterY=function(B){var A=(B.style!=null)?parseFloat(B.style[mxConstants.STYLE_ROUTING_CENTER_Y])||0:0;return B.getCenterY()+A*B.height};mxGraphView.prototype.getPerimeterBounds=function(B,A){A=(A!=null)?A:0;if(B!=null){A+=parseFloat(B.style[mxConstants.STYLE_PERIMETER_SPACING]||0)}return B.getPerimeterBounds(A*this.scale)};mxGraphView.prototype.getPerimeterFunction=function(state){var perimeter=state.style[mxConstants.STYLE_PERIMETER];if(typeof(perimeter)=="string"){var tmp=mxStyleRegistry.getValue(perimeter);if(tmp==null&&this.isAllowEval()){tmp=mxUtils.eval(perimeter)}perimeter=tmp}if(typeof(perimeter)=="function"){return perimeter}return null};mxGraphView.prototype.getNextPoint=function(E,A,D){var F=E.absolutePoints;var B=null;if(F!=null&&F.length>=2){var C=F.length;B=F[(D)?Math.min(1,C-1):Math.max(0,C-2)]}if(B==null&&A!=null){B=new mxPoint(A.getCenterX(),A.getCenterY())}return B};mxGraphView.prototype.getVisibleTerminal=function(B,A){var D=this.graph.getModel();var C=D.getTerminal(B,A);var E=C;while(C!=null&&C!=this.currentRoot){if(!this.graph.isCellVisible(E)||this.isCellCollapsed(C)){E=C}C=D.getParent(C)}if(D.getParent(E)==D.getRoot()){E=null}return E};mxGraphView.prototype.updateEdgeBounds=function(E){var K=E.absolutePoints;var J=K[0];var M=K[K.length-1];if(J.x!=M.x||J.y!=M.y){var F=M.x-J.x;var N=M.y-J.y;E.terminalDistance=Math.sqrt(F*F+N*N)}else{E.terminalDistance=0}var A=0;var Q=[];var O=J;if(O!=null){var B=O.x;var L=O.y;var P=B;var I=L;for(var D=1;D<K.length;D++){var C=K[D];if(C!=null){var F=O.x-C.x;var N=O.y-C.y;var H=Math.sqrt(F*F+N*N);Q.push(H);A+=H;O=C;B=Math.min(O.x,B);L=Math.min(O.y,L);P=Math.max(O.x,P);I=Math.max(O.y,I)}}E.length=A;E.segments=Q;var G=1;E.x=B;E.y=L;E.width=Math.max(G,P-B);E.height=Math.max(G,I-L)}};mxGraphView.prototype.getPoint=function(O,R){var T=O.getCenterX();var U=O.getCenterY();if(O.segments!=null&&(R==null||R.relative)){var G=(R!=null)?R.x/2:0;var K=O.absolutePoints.length;var N=Math.round((G+0.5)*O.length);var J=O.segments[0];var A=0;var D=1;while(N>=Math.round(A+J)&&D<K-1){A+=J;J=O.segments[D++]}var S=(J==0)?0:(N-A)/J;var L=O.absolutePoints[D-1];var Q=O.absolutePoints[D];if(L!=null&&Q!=null){var P=0;var E=0;var F=0;if(R!=null){P=R.y;var B=R.offset;if(B!=null){E=B.x;F=B.y}}var H=Q.x-L.x;var I=Q.y-L.y;var C=(J==0)?0:I/J;var M=(J==0)?0:H/J;T=L.x+H*S+(C*P+E)*this.scale;U=L.y+I*S-(M*P-F)*this.scale}}else{if(R!=null){var B=R.offset;if(B!=null){T+=B.x;U+=B.y}}}return new mxPoint(T,U)};mxGraphView.prototype.getRelativePoint=function(W,Y,Z){var H=this.graph.getModel();var V=H.getGeometry(W.cell);if(V!=null){var J=W.absolutePoints.length;if(V.relative&&J>1){var B=W.length;var d=W.segments;var O=W.absolutePoints[0];var S=W.absolutePoints[1];var L=mxUtils.ptSegDistSq(O.x,O.y,S.x,S.y,Y,Z);var G=0;var E=0;var A=0;for(var I=2;I<J;I++){E+=d[I-2];S=W.absolutePoints[I];var R=mxUtils.ptSegDistSq(O.x,O.y,S.x,S.y,Y,Z);if(R<=L){L=R;G=I-1;A=E}O=S}var a=d[G];O=W.absolutePoints[G];S=W.absolutePoints[G+1];var b=O.x;var c=O.y;var U=S.x;var F=S.y;var X=Y;var K=Z;var T=b-U;var N=c-F;X-=U;K-=F;var Q=0;X=T-X;K=N-K;var P=X*T+K*N;if(P<=0){Q=0}else{Q=P*P/(T*T+N*N)}var M=Math.sqrt(Q);if(M>a){M=a}var D=Math.sqrt(mxUtils.ptSegDistSq(O.x,O.y,S.x,S.y,Y,Z));var C=mxUtils.relativeCcw(O.x,O.y,S.x,S.y,Y,Z);if(C==-1){D=-D}return new mxPoint(((B/2-A-M)/B)*-2,D/this.scale)}}return new mxPoint()};mxGraphView.prototype.updateEdgeLabelOffset=function(F){var J=F.absolutePoints;F.absoluteOffset.x=F.getCenterX();F.absoluteOffset.y=F.getCenterY();if(J!=null&&J.length>0&&F.segments!=null){var E=this.graph.getCellGeometry(F.cell);if(E.relative){var B=this.getPoint(F,E);if(B!=null){F.absoluteOffset=B}}else{var H=J[0];var A=J[J.length-1];if(H!=null&&A!=null){var I=A.x-H.x;var G=A.y-H.y;var C=0;var D=0;var M=E.offset;if(M!=null){C=M.x;D=M.y}var L=H.x+I/2+C*this.scale;var K=H.y+G/2+D*this.scale;F.absoluteOffset.x=L;F.absoluteOffset.y=K}}}};mxGraphView.prototype.getState=function(B,A){A=A||false;var C=null;if(B!=null){C=this.states.get(B);if(A&&(C==null||this.updateStyle)&&this.graph.isCellVisible(B)){if(C==null){C=this.createState(B);this.states.put(B,C)}else{C.style=this.graph.getCellStyle(B)}}}return C};mxGraphView.prototype.isRendering=function(){return this.rendering};mxGraphView.prototype.setRendering=function(A){this.rendering=A};mxGraphView.prototype.isAllowEval=function(){return this.allowEval};mxGraphView.prototype.setAllowEval=function(A){this.allowEval=A};mxGraphView.prototype.getStates=function(){return this.states};mxGraphView.prototype.setStates=function(A){this.states=A};mxGraphView.prototype.getCellStates=function(C){if(C==null){return this.states}else{var B=[];for(var A=0;A<C.length;A++){var D=this.getState(C[A]);if(D!=null){B.push(D)}}return B}};mxGraphView.prototype.removeState=function(A){var B=null;if(A!=null){B=this.states.remove(A);if(B!=null){this.graph.cellRenderer.destroy(B);B.invalid=true;B.destroy()}}return B};mxGraphView.prototype.createState=function(A){return new mxCellState(this,A,this.graph.getCellStyle(A))};mxGraphView.prototype.getCanvas=function(){return this.canvas};mxGraphView.prototype.getBackgroundPane=function(){return this.backgroundPane};mxGraphView.prototype.getDrawPane=function(){return this.drawPane};mxGraphView.prototype.getOverlayPane=function(){return this.overlayPane};mxGraphView.prototype.getDecoratorPane=function(){return this.decoratorPane};mxGraphView.prototype.isContainerEvent=function(B){var A=mxEvent.getSource(B);return(A==this.graph.container||A.parentNode==this.backgroundPane||(A.parentNode!=null&&A.parentNode.parentNode==this.backgroundPane)||A==this.canvas.parentNode||A==this.canvas||A==this.backgroundPane||A==this.drawPane||A==this.overlayPane||A==this.decoratorPane)};mxGraphView.prototype.isScrollEvent=function(C){var A=mxUtils.getOffset(this.graph.container);var B=new mxPoint(C.clientX-A.x,C.clientY-A.y);var G=this.graph.container.offsetWidth;var D=this.graph.container.clientWidth;if(G>D&&B.x>D+2&&B.x<=G){return true}var F=this.graph.container.offsetHeight;var E=this.graph.container.clientHeight;if(F>E&&B.y>E+2&&B.y<=F){return true}return false};mxGraphView.prototype.init=function(){this.installListeners();var A=this.graph;if(A.dialect==mxConstants.DIALECT_SVG){this.createSvg()}else{if(A.dialect==mxConstants.DIALECT_VML){this.createVml()}else{this.createHtml()}}};mxGraphView.prototype.installListeners=function(){var A=this.graph;var B=A.container;if(B!=null){if(mxClient.IS_TOUCH){mxEvent.addListener(B,"gesturestart",mxUtils.bind(this,function(D){A.fireGestureEvent(D);mxEvent.consume(D)}));mxEvent.addListener(B,"gesturechange",mxUtils.bind(this,function(D){A.fireGestureEvent(D);mxEvent.consume(D)}));mxEvent.addListener(B,"gestureend",mxUtils.bind(this,function(D){A.fireGestureEvent(D);mxEvent.consume(D)}))}mxEvent.addGestureListeners(B,mxUtils.bind(this,function(D){if(this.isContainerEvent(D)&&((!mxClient.IS_IE&&!mxClient.IS_IE11&&!mxClient.IS_GC&&!mxClient.IS_OP&&!mxClient.IS_SF)||!this.isScrollEvent(D))){A.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(D))}}),mxUtils.bind(this,function(D){if(this.isContainerEvent(D)){A.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(D))}}),mxUtils.bind(this,function(D){if(this.isContainerEvent(D)){A.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(D))}}));mxEvent.addListener(B,"dblclick",mxUtils.bind(this,function(D){if(this.isContainerEvent(D)){A.dblClick(D)}}));var C=function(E){var H=null;if(mxClient.IS_TOUCH){var F=mxEvent.getClientX(E);var G=mxEvent.getClientY(E);var D=mxUtils.convertPoint(B,F,G);H=A.view.getState(A.getCellAt(D.x,D.y))}return H};A.addMouseListener({mouseDown:function(D,E){A.popupMenuHandler.hideMenu()},mouseMove:function(){},mouseUp:function(){}});this.moveHandler=mxUtils.bind(this,function(D){if(A.tooltipHandler!=null&&A.tooltipHandler.isHideOnHover()){A.tooltipHandler.hide()}if(this.captureDocumentGesture&&A.isMouseDown&&A.container!=null&&!this.isContainerEvent(D)&&A.container.style.display!="none"&&A.container.style.visibility!="hidden"&&!mxEvent.isConsumed(D)){A.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(D,C(D)))}});this.endHandler=mxUtils.bind(this,function(D){if(this.captureDocumentGesture&&A.isMouseDown&&A.container!=null&&!this.isContainerEvent(D)&&A.container.style.display!="none"&&A.container.style.visibility!="hidden"){A.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(D))}});mxEvent.addGestureListeners(document,null,this.moveHandler,this.endHandler)}};mxGraphView.prototype.createHtml=function(){var A=this.graph.container;if(A!=null){this.canvas=this.createHtmlPane("100%","100%");this.canvas.style.overflow="hidden";this.backgroundPane=this.createHtmlPane("1px","1px");this.drawPane=this.createHtmlPane("1px","1px");this.overlayPane=this.createHtmlPane("1px","1px");this.decoratorPane=this.createHtmlPane("1px","1px");this.canvas.appendChild(this.backgroundPane);this.canvas.appendChild(this.drawPane);this.canvas.appendChild(this.overlayPane);this.canvas.appendChild(this.decoratorPane);A.appendChild(this.canvas);this.updateContainerStyle(A);if(mxClient.IS_QUIRKS){var B=mxUtils.bind(this,function(E){var D=this.getGraphBounds();var F=D.x+D.width+this.graph.border;var C=D.y+D.height+this.graph.border;this.updateHtmlCanvasSize(F,C)});mxEvent.addListener(window,"resize",B)}}};mxGraphView.prototype.updateHtmlCanvasSize=function(D,A){if(this.graph.container!=null){var C=this.graph.container.offsetWidth;var B=this.graph.container.offsetHeight;if(C<D){this.canvas.style.width=D+"px"}else{this.canvas.style.width="100%"}if(B<A){this.canvas.style.height=A+"px"}else{this.canvas.style.height="100%"}}};mxGraphView.prototype.createHtmlPane=function(C,A){var B=document.createElement("DIV");if(C!=null&&A!=null){B.style.position="absolute";B.style.left="0px";B.style.top="0px";B.style.width=C;B.style.height=A}else{B.style.position="relative"}return B};mxGraphView.prototype.createVml=function(){var B=this.graph.container;if(B!=null){var C=B.offsetWidth;var A=B.offsetHeight;this.canvas=this.createVmlPane(C,A);this.canvas.style.overflow="hidden";this.backgroundPane=this.createVmlPane(C,A);this.drawPane=this.createVmlPane(C,A);this.overlayPane=this.createVmlPane(C,A);this.decoratorPane=this.createVmlPane(C,A);this.canvas.appendChild(this.backgroundPane);this.canvas.appendChild(this.drawPane);this.canvas.appendChild(this.overlayPane);this.canvas.appendChild(this.decoratorPane);B.appendChild(this.canvas)}};mxGraphView.prototype.createVmlPane=function(C,A){var B=document.createElement(mxClient.VML_PREFIX+":group");B.style.position="absolute";B.style.left="0px";B.style.top="0px";B.style.width=C+"px";B.style.height=A+"px";B.setAttribute("coordsize",C+","+A);B.setAttribute("coordorigin","0,0");return B};mxGraphView.prototype.createSvg=function(){var B=this.graph.container;this.canvas=document.createElementNS(mxConstants.NS_SVG,"g");this.backgroundPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.backgroundPane);this.drawPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.drawPane);this.overlayPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.overlayPane);this.decoratorPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.decoratorPane);var A=document.createElementNS(mxConstants.NS_SVG,"svg");A.style.width="100%";A.style.height="100%";A.style.display="block";A.appendChild(this.canvas);if(mxClient.IS_IE||mxClient.IS_IE11){A.style.overflow="hidden"}if(B!=null){B.appendChild(A);this.updateContainerStyle(B)}};mxGraphView.prototype.updateContainerStyle=function(A){var B=mxUtils.getCurrentStyle(A);if(B!=null&&B.position=="static"){A.style.position="relative"}if(mxClient.IS_POINTER){A.style.touchAction="none"}};mxGraphView.prototype.destroy=function(){var A=(this.canvas!=null)?this.canvas.ownerSVGElement:null;if(A==null){A=this.canvas}if(A!=null&&A.parentNode!=null){this.clear(this.currentRoot,true);mxEvent.removeGestureListeners(document,null,this.moveHandler,this.endHandler);mxEvent.release(this.graph.container);A.parentNode.removeChild(A);this.moveHandler=null;this.endHandler=null;this.canvas=null;this.backgroundPane=null;this.drawPane=null;this.overlayPane=null;this.decoratorPane=null}};function mxCurrentRootChange(C,B){this.view=C;this.root=B;this.previous=B;this.isUp=B==null;if(!this.isUp){var A=this.view.currentRoot;var D=this.view.graph.getModel();while(A!=null){if(A==B){this.isUp=true;break}A=D.getParent(A)}}}mxCurrentRootChange.prototype.execute=function(){var A=this.view.currentRoot;this.view.currentRoot=this.previous;this.previous=A;var B=this.view.graph.getTranslateForRoot(this.view.currentRoot);if(B!=null){this.view.translate=new mxPoint(-B.x,-B.y)}if(this.isUp){this.view.clear(this.view.currentRoot,true);this.view.validate()}else{this.view.refresh()}var C=(this.isUp)?mxEvent.UP:mxEvent.DOWN;this.view.fireEvent(new mxEventObject(C,"root",this.view.currentRoot,"previous",this.previous));this.isUp=!this.isUp};function mxGraph(C,D,A,B){this.mouseListeners=null;this.renderHint=A;if(mxClient.IS_SVG){this.dialect=mxConstants.DIALECT_SVG}else{if(A==mxConstants.RENDERING_HINT_EXACT&&mxClient.IS_VML){this.dialect=mxConstants.DIALECT_VML}else{if(A==mxConstants.RENDERING_HINT_FASTEST){this.dialect=mxConstants.DIALECT_STRICTHTML}else{if(A==mxConstants.RENDERING_HINT_FASTER){this.dialect=mxConstants.DIALECT_PREFERHTML}else{this.dialect=mxConstants.DIALECT_MIXEDHTML}}}}this.model=(D!=null)?D:new mxGraphModel();this.multiplicities=[];this.imageBundles=[];this.cellRenderer=this.createCellRenderer();this.setSelectionModel(this.createSelectionModel());this.setStylesheet((B!=null)?B:this.createStylesheet());this.view=this.createGraphView();this.graphModelChangeListener=mxUtils.bind(this,function(E,F){this.graphModelChanged(F.getProperty("edit").changes)});this.model.addListener(mxEvent.CHANGE,this.graphModelChangeListener);this.createHandlers();if(C!=null){this.init(C)}this.view.revalidate()}if(mxLoadResources){mxResources.add(mxClient.basePath+"/resources/graph")}mxGraph.prototype=new mxEventSource();mxGraph.prototype.constructor=mxGraph;mxGraph.prototype.EMPTY_ARRAY=[];mxGraph.prototype.mouseListeners=null;mxGraph.prototype.isMouseDown=false;mxGraph.prototype.model=null;mxGraph.prototype.view=null;mxGraph.prototype.stylesheet=null;mxGraph.prototype.selectionModel=null;mxGraph.prototype.cellEditor=null;mxGraph.prototype.cellRenderer=null;mxGraph.prototype.multiplicities=null;mxGraph.prototype.renderHint=null;mxGraph.prototype.dialect=null;mxGraph.prototype.gridSize=10;mxGraph.prototype.gridEnabled=true;mxGraph.prototype.portsEnabled=true;mxGraph.prototype.nativeDblClickEnabled=true;mxGraph.prototype.doubleTapEnabled=true;mxGraph.prototype.doubleTapTimeout=500;mxGraph.prototype.doubleTapTolerance=25;mxGraph.prototype.lastTouchY=0;mxGraph.prototype.lastTouchY=0;mxGraph.prototype.lastTouchTime=0;mxGraph.prototype.tapAndHoldEnabled=true;mxGraph.prototype.tapAndHoldDelay=500;mxGraph.prototype.tapAndHoldInProgress=false;mxGraph.prototype.tapAndHoldValid=false;mxGraph.prototype.initialTouchX=0;mxGraph.prototype.initialTouchY=0;mxGraph.prototype.tolerance=4;mxGraph.prototype.defaultOverlap=0.5;mxGraph.prototype.defaultParent=null;mxGraph.prototype.alternateEdgeStyle=null;mxGraph.prototype.backgroundImage=null;mxGraph.prototype.pageVisible=false;mxGraph.prototype.pageBreaksVisible=false;mxGraph.prototype.pageBreakColor="gray";mxGraph.prototype.pageBreakDashed=true;mxGraph.prototype.minPageBreakDist=20;mxGraph.prototype.preferPageSize=false;mxGraph.prototype.pageFormat=mxConstants.PAGE_FORMAT_A4_PORTRAIT;mxGraph.prototype.pageScale=1.5;mxGraph.prototype.enabled=true;mxGraph.prototype.escapeEnabled=true;mxGraph.prototype.invokesStopCellEditing=true;mxGraph.prototype.enterStopsCellEditing=false;mxGraph.prototype.useScrollbarsForPanning=true;mxGraph.prototype.exportEnabled=true;mxGraph.prototype.importEnabled=true;mxGraph.prototype.cellsLocked=false;mxGraph.prototype.cellsCloneable=true;mxGraph.prototype.foldingEnabled=true;mxGraph.prototype.cellsEditable=true;mxGraph.prototype.cellsDeletable=true;mxGraph.prototype.cellsMovable=true;mxGraph.prototype.edgeLabelsMovable=true;mxGraph.prototype.vertexLabelsMovable=false;mxGraph.prototype.dropEnabled=false;mxGraph.prototype.splitEnabled=true;mxGraph.prototype.cellsResizable=true;mxGraph.prototype.cellsBendable=true;mxGraph.prototype.cellsSelectable=true;mxGraph.prototype.cellsDisconnectable=true;mxGraph.prototype.autoSizeCells=false;mxGraph.prototype.autoSizeCellsOnAdd=false;mxGraph.prototype.autoScroll=true;mxGraph.prototype.ignoreScrollbars=false;mxGraph.prototype.translateToScrollPosition=false;mxGraph.prototype.timerAutoScroll=false;mxGraph.prototype.allowAutoPanning=false;mxGraph.prototype.autoExtend=true;mxGraph.prototype.maximumGraphBounds=null;mxGraph.prototype.minimumGraphSize=null;mxGraph.prototype.minimumContainerSize=null;mxGraph.prototype.maximumContainerSize=null;mxGraph.prototype.resizeContainer=false;mxGraph.prototype.border=0;mxGraph.prototype.keepEdgesInForeground=false;mxGraph.prototype.keepEdgesInBackground=false;mxGraph.prototype.allowNegativeCoordinates=true;mxGraph.prototype.constrainChildren=true;mxGraph.prototype.constrainRelativeChildren=false;mxGraph.prototype.extendParents=true;mxGraph.prototype.extendParentsOnAdd=true;mxGraph.prototype.extendParentsOnMove=false;mxGraph.prototype.recursiveResize=false;mxGraph.prototype.collapseToPreferredSize=true;mxGraph.prototype.zoomFactor=1.2;mxGraph.prototype.keepSelectionVisibleOnZoom=false;mxGraph.prototype.centerZoom=true;mxGraph.prototype.resetViewOnRootChange=true;mxGraph.prototype.resetEdgesOnResize=false;mxGraph.prototype.resetEdgesOnMove=false;mxGraph.prototype.resetEdgesOnConnect=true;mxGraph.prototype.allowLoops=false;mxGraph.prototype.defaultLoopStyle=mxEdgeStyle.Loop;mxGraph.prototype.multigraph=true;mxGraph.prototype.connectableEdges=false;mxGraph.prototype.allowDanglingEdges=true;mxGraph.prototype.cloneInvalidEdges=false;mxGraph.prototype.disconnectOnMove=true;mxGraph.prototype.labelsVisible=true;mxGraph.prototype.htmlLabels=false;mxGraph.prototype.swimlaneSelectionEnabled=true;mxGraph.prototype.swimlaneNesting=true;mxGraph.prototype.swimlaneIndicatorColorAttribute=mxConstants.STYLE_FILLCOLOR;mxGraph.prototype.imageBundles=null;mxGraph.prototype.minFitScale=0.1;mxGraph.prototype.maxFitScale=8;mxGraph.prototype.panDx=0;mxGraph.prototype.panDy=0;mxGraph.prototype.collapsedImage=new mxImage(mxClient.imageBasePath+"/collapsed.gif",9,9);mxGraph.prototype.expandedImage=new mxImage(mxClient.imageBasePath+"/expanded.gif",9,9);mxGraph.prototype.warningImage=new mxImage(mxClient.imageBasePath+"/warning"+((mxClient.IS_MAC)?".png":".gif"),16,16);mxGraph.prototype.alreadyConnectedResource=(mxClient.language!="none")?"alreadyConnected":"";mxGraph.prototype.containsValidationErrorsResource=(mxClient.language!="none")?"containsValidationErrors":"";mxGraph.prototype.collapseExpandResource=(mxClient.language!="none")?"collapse-expand":"";mxGraph.prototype.init=function(A){this.container=A;this.cellEditor=this.createCellEditor();this.view.init();this.sizeDidChange();mxEvent.addListener(A,"mouseleave",mxUtils.bind(this,function(){if(this.tooltipHandler!=null){this.tooltipHandler.hide()}}));if(mxClient.IS_IE){mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()}));mxEvent.addListener(A,"selectstart",mxUtils.bind(this,function(B){return this.isEditing()||(!this.isMouseDown&&!mxEvent.isShiftDown(B))}))}if(document.documentMode==8){A.insertAdjacentHTML("beforeend","<"+mxClient.VML_PREFIX+':group style="DISPLAY: none;"></'+mxClient.VML_PREFIX+":group>")}};mxGraph.prototype.createHandlers=function(){this.tooltipHandler=this.createTooltipHandler();this.tooltipHandler.setEnabled(false);this.selectionCellsHandler=this.createSelectionCellsHandler();this.connectionHandler=this.createConnectionHandler();this.connectionHandler.setEnabled(false);this.graphHandler=this.createGraphHandler();this.panningHandler=this.createPanningHandler();this.panningHandler.panningEnabled=false;this.popupMenuHandler=this.createPopupMenuHandler()};mxGraph.prototype.createTooltipHandler=function(){return new mxTooltipHandler(this)};mxGraph.prototype.createSelectionCellsHandler=function(){return new mxSelectionCellsHandler(this)};mxGraph.prototype.createConnectionHandler=function(){return new mxConnectionHandler(this)};mxGraph.prototype.createGraphHandler=function(){return new mxGraphHandler(this)};mxGraph.prototype.createPanningHandler=function(){return new mxPanningHandler(this)};mxGraph.prototype.createPopupMenuHandler=function(){return new mxPopupMenuHandler(this)};mxGraph.prototype.createSelectionModel=function(){return new mxGraphSelectionModel(this)};mxGraph.prototype.createStylesheet=function(){return new mxStylesheet()};mxGraph.prototype.createGraphView=function(){return new mxGraphView(this)};mxGraph.prototype.createCellRenderer=function(){return new mxCellRenderer()};mxGraph.prototype.createCellEditor=function(){return new mxCellEditor(this)};mxGraph.prototype.getModel=function(){return this.model};mxGraph.prototype.getView=function(){return this.view};mxGraph.prototype.getStylesheet=function(){return this.stylesheet};mxGraph.prototype.setStylesheet=function(A){this.stylesheet=A};mxGraph.prototype.getSelectionModel=function(){return this.selectionModel};mxGraph.prototype.setSelectionModel=function(A){this.selectionModel=A};mxGraph.prototype.getSelectionCellsForChanges=function(D){var C=[];for(var A=0;A<D.length;A++){var B=D[A];if(B.constructor!=mxRootChange){var E=null;if(B instanceof mxChildChange&&B.previous==null){E=B.child}else{if(B.cell!=null&&B.cell instanceof mxCell){E=B.cell}}if(E!=null&&mxUtils.indexOf(C,E)<0){C.push(E)}}}return this.getModel().getTopmostCells(C)};mxGraph.prototype.graphModelChanged=function(B){for(var A=0;A<B.length;A++){this.processChange(B[A])}this.removeSelectionCells(this.getRemovedCellsForChanges(B));this.view.validate();this.sizeDidChange()};mxGraph.prototype.getRemovedCellsForChanges=function(D){var C=[];for(var A=0;A<D.length;A++){var B=D[A];if(B instanceof mxRootChange){break}else{if(B instanceof mxChildChange){if(B.previous!=null&&B.parent==null){C=C.concat(this.model.getDescendants(B.child))}}else{if(B instanceof mxVisibleChange){C=C.concat(this.model.getDescendants(B.cell))}}}}return C};mxGraph.prototype.processChange=function(A){if(A instanceof mxRootChange){this.clearSelection();this.setDefaultParent(null);this.removeStateForCell(A.previous);if(this.resetViewOnRootChange){this.view.scale=1;this.view.translate.x=0;this.view.translate.y=0}this.fireEvent(new mxEventObject(mxEvent.ROOT))}else{if(A instanceof mxChildChange){var C=this.model.getParent(A.child);this.view.invalidate(A.child,true,true);if(C==null||this.isCellCollapsed(C)){this.view.invalidate(A.child,true,true);this.removeStateForCell(A.child);if(this.view.currentRoot==A.child){this.home()}}if(C!=A.previous){if(C!=null){this.view.invalidate(C,false,false)}if(A.previous!=null){this.view.invalidate(A.previous,false,false)}}}else{if(A instanceof mxTerminalChange||A instanceof mxGeometryChange){if(A instanceof mxTerminalChange||((A.previous==null&&A.geometry!=null)||(A.previous!=null&&!A.previous.equals(A.geometry)))){this.view.invalidate(A.cell)}}else{if(A instanceof mxValueChange){this.view.invalidate(A.cell,false,false)}else{if(A instanceof mxStyleChange){this.view.invalidate(A.cell,true,true);var B=this.view.getState(A.cell);if(B!=null){B.style=null}}else{if(A.cell!=null&&A.cell instanceof mxCell){this.removeStateForCell(A.cell)}}}}}}};mxGraph.prototype.removeStateForCell=function(C){var A=this.model.getChildCount(C);for(var B=0;B<A;B++){this.removeStateForCell(this.model.getChildAt(C,B))}this.view.invalidate(C,false,true);this.view.removeState(C)};mxGraph.prototype.addCellOverlay=function(B,A){if(B.overlays==null){B.overlays=[]}B.overlays.push(A);var C=this.view.getState(B);if(C!=null){this.cellRenderer.redraw(C)}this.fireEvent(new mxEventObject(mxEvent.ADD_OVERLAY,"cell",B,"overlay",A));return A};mxGraph.prototype.getCellOverlays=function(A){return A.overlays};mxGraph.prototype.removeCellOverlay=function(C,B){if(B==null){this.removeCellOverlays(C)}else{var A=mxUtils.indexOf(C.overlays,B);if(A>=0){C.overlays.splice(A,1);if(C.overlays.length==0){C.overlays=null}var D=this.view.getState(C);if(D!=null){this.cellRenderer.redraw(D)}this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",C,"overlay",B))}else{B=null}}return B};mxGraph.prototype.removeCellOverlays=function(C){var B=C.overlays;if(B!=null){C.overlays=null;var D=this.view.getState(C);if(D!=null){this.cellRenderer.redraw(D)}for(var A=0;A<B.length;A++){this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",C,"overlay",B[A]))}}return B};mxGraph.prototype.clearCellOverlays=function(D){D=(D!=null)?D:this.model.getRoot();this.removeCellOverlays(D);var A=this.model.getChildCount(D);for(var B=0;B<A;B++){var C=this.model.getChildAt(D,B);this.clearCellOverlays(C)}};mxGraph.prototype.setCellWarning=function(D,B,E,A){if(B!=null&&B.length>0){E=(E!=null)?E:this.warningImage;var C=new mxCellOverlay(E,"<font color=red>"+B+"</font>");if(A){C.addListener(mxEvent.CLICK,mxUtils.bind(this,function(F,G){if(this.isEnabled()){this.setSelectionCell(D)}}))}return this.addCellOverlay(D,C)}else{this.removeCellOverlays(D)}return null};mxGraph.prototype.startEditing=function(A){this.startEditingAtCell(null,A)};mxGraph.prototype.startEditingAtCell=function(B,A){if(A==null||!mxEvent.isMultiTouchEvent(A)){if(B==null){B=this.getSelectionCell();if(B!=null&&!this.isCellEditable(B)){B=null}}if(B!=null){this.fireEvent(new mxEventObject(mxEvent.START_EDITING,"cell",B,"event",A));this.cellEditor.startEditing(B,A);this.fireEvent(new mxEventObject(mxEvent.EDITING_STARTED,"cell",B,"event",A))}}};mxGraph.prototype.getEditingValue=function(B,A){return this.convertValueToString(B)};mxGraph.prototype.stopEditing=function(A){this.cellEditor.stopEditing(A);this.fireEvent(new mxEventObject(mxEvent.EDITING_STOPPED,"cancel",A))};mxGraph.prototype.labelChanged=function(D,C,B){this.model.beginUpdate();try{var A=D.value;this.cellLabelChanged(D,C,this.isAutoSizeCell(D));this.fireEvent(new mxEventObject(mxEvent.LABEL_CHANGED,"cell",D,"value",C,"old",A,"event",B))}finally{this.model.endUpdate()}return D};mxGraph.prototype.cellLabelChanged=function(C,B,A){this.model.beginUpdate();try{this.model.setValue(C,B);if(A){this.cellSizeUpdated(C,false)}}finally{this.model.endUpdate()}};mxGraph.prototype.escape=function(A){this.fireEvent(new mxEventObject(mxEvent.ESCAPE,"event",A))};mxGraph.prototype.click=function(C){var B=C.getEvent();var E=C.getCell();var D=new mxEventObject(mxEvent.CLICK,"event",B,"cell",E);if(C.isConsumed()){D.consume()}this.fireEvent(D);if(this.isEnabled()&&!mxEvent.isConsumed(B)&&!D.isConsumed()){if(E!=null){this.selectCellForEvent(E,B)}else{var A=null;if(this.isSwimlaneSelectionEnabled()){A=this.getSwimlaneAt(C.getGraphX(),C.getGraphY())}if(A!=null){this.selectCellForEvent(A,B)}else{if(!this.isToggleEvent(B)){this.clearSelection()}}}}};mxGraph.prototype.dblClick=function(A,C){var B=new mxEventObject(mxEvent.DOUBLE_CLICK,"event",A,"cell",C);this.fireEvent(B);if(this.isEnabled()&&!mxEvent.isConsumed(A)&&!B.isConsumed()&&C!=null&&this.isCellEditable(C)&&!this.isEditing(C)){this.startEditingAtCell(C,A);mxEvent.consume(A)}};mxGraph.prototype.tapAndHold=function(B){var A=B.getEvent();var C=new mxEventObject(mxEvent.TAP_AND_HOLD,"event",A,"cell",B.getCell());this.fireEvent(C);if(C.isConsumed()){this.panningHandler.panningTrigger=false}if(this.isEnabled()&&!mxEvent.isConsumed(A)&&!C.isConsumed()&&this.connectionHandler.isEnabled()){var D=this.view.getState(this.connectionHandler.marker.getCell(B));if(D!=null){this.connectionHandler.marker.currentColor=this.connectionHandler.marker.validColor;this.connectionHandler.marker.markedState=D;this.connectionHandler.marker.mark();this.connectionHandler.first=new mxPoint(B.getGraphX(),B.getGraphY());this.connectionHandler.edgeState=this.connectionHandler.createEdgeState(B);this.connectionHandler.previous=D;this.connectionHandler.fireEvent(new mxEventObject(mxEvent.START,"state",this.connectionHandler.previous))}}};mxGraph.prototype.scrollPointToVisible=function(I,J,D,K){if(!this.timerAutoScroll&&(this.ignoreScrollbars||mxUtils.hasScrollbars(this.container))){var L=this.container;K=(K!=null)?K:20;if(I>=L.scrollLeft&&J>=L.scrollTop&&I<=L.scrollLeft+L.clientWidth&&J<=L.scrollTop+L.clientHeight){var H=L.scrollLeft+L.clientWidth-I;if(H<K){var B=L.scrollLeft;L.scrollLeft+=K-H;if(D&&B==L.scrollLeft){if(this.dialect==mxConstants.DIALECT_SVG){var A=this.view.getDrawPane().ownerSVGElement;var G=this.container.scrollWidth+K-H;A.style.width=G+"px"}else{var G=Math.max(L.clientWidth,L.scrollWidth)+K-H;var F=this.view.getCanvas();F.style.width=G+"px"}L.scrollLeft+=K-H}}else{H=I-L.scrollLeft;if(H<K){L.scrollLeft-=K-H}}var E=L.scrollTop+L.clientHeight-J;if(E<K){var B=L.scrollTop;L.scrollTop+=K-E;if(B==L.scrollTop&&D){if(this.dialect==mxConstants.DIALECT_SVG){var A=this.view.getDrawPane().ownerSVGElement;var C=this.container.scrollHeight+K-E;A.style.height=C+"px"}else{var C=Math.max(L.clientHeight,L.scrollHeight)+K-E;var F=this.view.getCanvas();F.style.height=C+"px"}L.scrollTop+=K-E}}else{E=J-L.scrollTop;if(E<K){L.scrollTop-=K-E}}}}else{if(this.allowAutoPanning&&!this.panningHandler.isActive()){if(this.panningManager==null){this.panningManager=this.createPanningManager()}this.panningManager.panTo(I+this.panDx,J+this.panDy)}}};mxGraph.prototype.createPanningManager=function(){return new mxPanningManager(this)};mxGraph.prototype.getBorderSizes=function(){var A=mxUtils.getCurrentStyle(this.container);return new mxRectangle(mxUtils.parseCssNumber(A.paddingLeft)+((A.borderLeftStyle!="none")?mxUtils.parseCssNumber(A.borderLeftWidth):0),mxUtils.parseCssNumber(A.paddingTop)+((A.borderTopStyle!="none")?mxUtils.parseCssNumber(A.borderTopWidth):0),mxUtils.parseCssNumber(A.paddingRight)+((A.borderRightStyle!="none")?mxUtils.parseCssNumber(A.borderRightWidth):0),mxUtils.parseCssNumber(A.paddingBottom)+((A.borderBottomStyle!="none")?mxUtils.parseCssNumber(A.borderBottomWidth):0))};mxGraph.prototype.getPreferredPageSize=function(B,H,A){var C=this.view.scale;var I=this.view.translate;var E=this.pageFormat;var G=this.pageScale;var D=new mxRectangle(0,0,Math.ceil(E.width*G),Math.ceil(E.height*G));var F=(this.pageBreaksVisible)?Math.ceil(H/D.width):1;var J=(this.pageBreaksVisible)?Math.ceil(A/D.height):1;return new mxRectangle(0,0,F*D.width+2+I.x,J*D.height+2+I.y)};mxGraph.prototype.fit=function(I,O,E,P,Q,R){if(this.container!=null){I=(I!=null)?I:this.getBorder();O=(O!=null)?O:false;E=(E!=null)?E:0;P=(P!=null)?P:true;Q=(Q!=null)?Q:false;R=(R!=null)?R:false;var L=this.getBorderSizes();var A=this.container.offsetWidth-L.x-L.width-1;var C=this.container.offsetHeight-L.y-L.height-1;var N=this.view.getGraphBounds();if(N.width>0&&N.height>0){if(O&&N.x!=null&&N.y!=null){N=N.clone();N.width+=N.x;N.height+=N.y;N.x=0;N.y=0}var M=this.view.scale;var D=N.width/M;var H=N.height/M;if(this.backgroundImage!=null){D=Math.max(D,this.backgroundImage.width-N.x/M);H=Math.max(H,this.backgroundImage.height-N.y/M)}var J=((O)?I:2*I)+E;A-=J;C-=J;var B=(((Q)?C/H:(R)?A/D:Math.min(A/D,C/H)));if(this.minFitScale!=null){B=Math.max(B,this.minFitScale)}if(this.maxFitScale!=null){B=Math.min(B,this.maxFitScale)}if(P){if(!O){if(!mxUtils.hasScrollbars(this.container)){var G=(N.x!=null)?Math.floor(this.view.translate.x-N.x/M+I/B+E/2):I;var F=(N.y!=null)?Math.floor(this.view.translate.y-N.y/M+I/B+E/2):I;this.view.scaleAndTranslate(B,G,F)}else{this.view.setScale(B);var K=this.getGraphBounds();if(K.x!=null){this.container.scrollLeft=K.x}if(K.y!=null){this.container.scrollTop=K.y}}}else{if(this.view.scale!=B){this.view.setScale(B)}}}else{return B}}}return this.view.scale};mxGraph.prototype.sizeDidChange=function(){var D=this.getGraphBounds();if(this.container!=null){var A=this.getBorder();var F=Math.max(0,D.x+D.width+A);var B=Math.max(0,D.y+D.height+A);if(this.minimumContainerSize!=null){F=Math.max(F,this.minimumContainerSize.width);B=Math.max(B,this.minimumContainerSize.height)}if(this.resizeContainer){this.doResizeContainer(F,B)}if(this.preferPageSize||(!mxClient.IS_IE&&this.pageVisible)){var E=this.getPreferredPageSize(D,Math.max(1,F),Math.max(1,B));if(E!=null){F=E.width*this.view.scale;B=E.height*this.view.scale}}if(this.minimumGraphSize!=null){F=Math.max(F,this.minimumGraphSize.width*this.view.scale);B=Math.max(B,this.minimumGraphSize.height*this.view.scale)}F=Math.ceil(F);B=Math.ceil(B);if(this.dialect==mxConstants.DIALECT_SVG){var C=this.view.getDrawPane().ownerSVGElement;C.style.minWidth=Math.max(1,F)+"px";C.style.minHeight=Math.max(1,B)+"px";C.style.width="100%";C.style.height="100%"}else{if(mxClient.IS_QUIRKS){this.view.updateHtmlCanvasSize(Math.max(1,F),Math.max(1,B))}else{this.view.canvas.style.minWidth=Math.max(1,F)+"px";this.view.canvas.style.minHeight=Math.max(1,B)+"px"}}this.updatePageBreaks(this.pageBreaksVisible,F,B)}this.fireEvent(new mxEventObject(mxEvent.SIZE,"bounds",D))};mxGraph.prototype.doResizeContainer=function(B,A){if(this.maximumContainerSize!=null){B=Math.min(this.maximumContainerSize.width,B);A=Math.min(this.maximumContainerSize.height,A)}this.container.style.width=Math.ceil(B)+"px";this.container.style.height=Math.ceil(A)+"px"};mxGraph.prototype.updatePageBreaks=function(F,I,B){var D=this.view.scale;var K=this.view.translate;var G=this.pageFormat;var H=D*this.pageScale;var C=new mxRectangle(0,0,G.width*H,G.height*H);var L=mxRectangle.fromRectangle(this.getGraphBounds());L.width=Math.max(1,L.width);L.height=Math.max(1,L.height);C.x=Math.floor((L.x-K.x*D)/C.width)*C.width+K.x*D;C.y=Math.floor((L.y-K.y*D)/C.height)*C.height+K.y*D;L.width=Math.ceil((L.width+(L.x-C.x))/C.width)*C.width;L.height=Math.ceil((L.height+(L.y-C.y))/C.height)*C.height;F=F&&Math.min(C.width,C.height)>this.minPageBreakDist;var A=(F)?Math.ceil(L.height/C.height)+1:0;var J=(F)?Math.ceil(L.width/C.width)+1:0;var M=(J-1)*C.width;var N=(A-1)*C.height;if(this.horizontalPageBreaks==null&&A>0){this.horizontalPageBreaks=[]}if(this.verticalPageBreaks==null&&J>0){this.verticalPageBreaks=[]}var E=mxUtils.bind(this,function(S){if(S!=null){var P=(S==this.horizontalPageBreaks)?A:J;for(var O=0;O<=P;O++){var Q=(S==this.horizontalPageBreaks)?[new mxPoint(Math.round(C.x),Math.round(C.y+O*C.height)),new mxPoint(Math.round(C.x+M),Math.round(C.y+O*C.height))]:[new mxPoint(Math.round(C.x+O*C.width),Math.round(C.y)),new mxPoint(Math.round(C.x+O*C.width),Math.round(C.y+N))];if(S[O]!=null){S[O].points=Q;S[O].redraw()}else{var R=new mxPolyline(Q,this.pageBreakColor);R.dialect=this.dialect;R.pointerEvents=false;R.isDashed=this.pageBreakDashed;R.init(this.view.backgroundPane);R.redraw();S[O]=R}}for(var O=P;O<S.length;O++){S[O].destroy()}S.splice(P,S.length-P)}});E(this.horizontalPageBreaks);E(this.verticalPageBreaks)};mxGraph.prototype.getCellStyle=function(C){var A=this.model.getStyle(C);var B=null;if(this.model.isEdge(C)){B=this.stylesheet.getDefaultEdgeStyle()}else{B=this.stylesheet.getDefaultVertexStyle()}if(A!=null){B=this.postProcessCellStyle(this.stylesheet.getCellStyle(A,B))}if(B==null){B=mxGraph.prototype.EMPTY_ARRAY}return B};mxGraph.prototype.postProcessCellStyle=function(C){if(C!=null){var A=C[mxConstants.STYLE_IMAGE];var B=this.getImageFromBundles(A);if(B!=null){C[mxConstants.STYLE_IMAGE]=B}else{B=A}if(B!=null&&B.substring(0,11)=="data:image/"){if(B.substring(0,20)=="data:image/svg+xml,<"){B=B.substring(0,19)+encodeURIComponent(B.substring(19))}else{if(B.substring(0,22)!="data:image/svg+xml,%3C"){var D=B.indexOf(",");if(D>0&&B.substring(D-7,D+1)!=";base64,"){B=B.substring(0,D)+";base64,"+B.substring(D+1)}}}C[mxConstants.STYLE_IMAGE]=B}}return C};mxGraph.prototype.setCellStyle=function(B,C){C=C||this.getSelectionCells();if(C!=null){this.model.beginUpdate();try{for(var A=0;A<C.length;A++){this.model.setStyle(C[A],B)}}finally{this.model.endUpdate()}}};mxGraph.prototype.toggleCellStyle=function(A,B,C){C=C||this.getSelectionCell();return this.toggleCellStyles(A,B,[C])};mxGraph.prototype.toggleCellStyles=function(B,E,D){E=(E!=null)?E:false;D=D||this.getSelectionCells();var A=null;if(D!=null&&D.length>0){var F=this.view.getState(D[0]);var C=(F!=null)?F.style:this.getCellStyle(D[0]);if(C!=null){A=(mxUtils.getValue(C,B,E))?0:1;this.setCellStyles(B,A,D)}}return A};mxGraph.prototype.setCellStyles=function(A,C,B){B=B||this.getSelectionCells();mxUtils.setCellStyles(this.model,B,A,C)};mxGraph.prototype.toggleCellStyleFlags=function(A,C,B){this.setCellStyleFlags(A,C,null,B)};mxGraph.prototype.setCellStyleFlags=function(A,F,E,D){D=D||this.getSelectionCells();if(D!=null&&D.length>0){if(E==null){var G=this.view.getState(D[0]);var C=(G!=null)?G.style:this.getCellStyle(D[0]);if(C!=null){var B=parseInt(C[A]||0);E=!((B&F)==F)}}mxUtils.setCellStyleFlags(this.model,D,A,F,E)}};mxGraph.prototype.alignCells=function(D,E,F){if(E==null){E=this.getSelectionCells()}if(E!=null&&E.length>1){if(F==null){for(var A=0;A<E.length;A++){var G=this.view.getState(E[A]);if(G!=null&&!this.model.isEdge(E[A])){if(F==null){if(D==mxConstants.ALIGN_CENTER){F=G.x+G.width/2;break}else{if(D==mxConstants.ALIGN_RIGHT){F=G.x+G.width}else{if(D==mxConstants.ALIGN_TOP){F=G.y}else{if(D==mxConstants.ALIGN_MIDDLE){F=G.y+G.height/2;break}else{if(D==mxConstants.ALIGN_BOTTOM){F=G.y+G.height}else{F=G.x}}}}}}else{if(D==mxConstants.ALIGN_RIGHT){F=Math.max(F,G.x+G.width)}else{if(D==mxConstants.ALIGN_TOP){F=Math.min(F,G.y)}else{if(D==mxConstants.ALIGN_BOTTOM){F=Math.max(F,G.y+G.height)}else{F=Math.min(F,G.x)}}}}}}}if(F!=null){var B=this.view.scale;this.model.beginUpdate();try{for(var A=0;A<E.length;A++){var G=this.view.getState(E[A]);if(G!=null){var C=this.getCellGeometry(E[A]);if(C!=null&&!this.model.isEdge(E[A])){C=C.clone();if(D==mxConstants.ALIGN_CENTER){C.x+=(F-G.x-G.width/2)/B}else{if(D==mxConstants.ALIGN_RIGHT){C.x+=(F-G.x-G.width)/B}else{if(D==mxConstants.ALIGN_TOP){C.y+=(F-G.y)/B}else{if(D==mxConstants.ALIGN_MIDDLE){C.y+=(F-G.y-G.height/2)/B}else{if(D==mxConstants.ALIGN_BOTTOM){C.y+=(F-G.y-G.height)/B}else{C.x+=(F-G.x)/B}}}}}this.resizeCell(E[A],C)}}}this.fireEvent(new mxEventObject(mxEvent.ALIGN_CELLS,"align",D,"cells",E))}finally{this.model.endUpdate()}}}return E};mxGraph.prototype.flipEdge=function(A){if(A!=null&&this.alternateEdgeStyle!=null){this.model.beginUpdate();try{var B=this.model.getStyle(A);if(B==null||B.length==0){this.model.setStyle(A,this.alternateEdgeStyle)}else{this.model.setStyle(A,null)}this.resetEdge(A);this.fireEvent(new mxEventObject(mxEvent.FLIP_EDGE,"edge",A))}finally{this.model.endUpdate()}}return A};mxGraph.prototype.addImageBundle=function(A){this.imageBundles.push(A)};mxGraph.prototype.removeImageBundle=function(B){var A=[];for(var C=0;C<this.imageBundles.length;C++){if(this.imageBundles[C]!=B){A.push(this.imageBundles[C])}}this.imageBundles=A};mxGraph.prototype.getImageFromBundles=function(A){if(A!=null){for(var B=0;B<this.imageBundles.length;B++){var C=this.imageBundles[B].getImage(A);if(C!=null){return C}}}return null};mxGraph.prototype.orderCells=function(A,B){if(B==null){B=mxUtils.sortCells(this.getSelectionCells(),true)}this.model.beginUpdate();try{this.cellsOrdered(B,A);this.fireEvent(new mxEventObject(mxEvent.ORDER_CELLS,"back",A,"cells",B))}finally{this.model.endUpdate()}return B};mxGraph.prototype.cellsOrdered=function(C,A){if(C!=null){this.model.beginUpdate();try{for(var B=0;B<C.length;B++){var D=this.model.getParent(C[B]);if(A){this.model.add(D,C[B],B)}else{this.model.add(D,C[B],this.model.getChildCount(D)-1)}}this.fireEvent(new mxEventObject(mxEvent.CELLS_ORDERED,"back",A,"cells",C))}finally{this.model.endUpdate()}}};mxGraph.prototype.groupCells=function(B,A,D){if(D==null){D=mxUtils.sortCells(this.getSelectionCells(),true)}D=this.getCellsForGroup(D);if(B==null){B=this.createGroupCell(D)}var C=this.getBoundsForGroup(B,D,A);if(D.length>0&&C!=null){var F=this.model.getParent(B);if(F==null){F=this.model.getParent(D[0])}this.model.beginUpdate();try{if(this.getCellGeometry(B)==null){this.model.setGeometry(B,new mxGeometry())}var E=this.model.getChildCount(F);this.cellsAdded([B],F,E,null,null,false);E=this.model.getChildCount(B);this.cellsAdded(D,B,E,null,null,false,false);this.cellsMoved(D,-C.x,-C.y,false,true);this.cellsResized([B],[C],false);this.fireEvent(new mxEventObject(mxEvent.GROUP_CELLS,"group",B,"border",A,"cells",D))}finally{this.model.endUpdate()}}return B};mxGraph.prototype.getCellsForGroup=function(C){var B=[];if(C!=null&&C.length>0){var D=this.model.getParent(C[0]);B.push(C[0]);for(var A=1;A<C.length;A++){if(this.model.getParent(C[A])==D){B.push(C[A])}}}return B};mxGraph.prototype.getBoundsForGroup=function(B,E,A){var C=this.getBoundingBoxFromGeometry(E,true);if(C!=null){if(this.isSwimlane(B)){var D=this.getStartSize(B);C.x-=D.width;C.y-=D.height;C.width+=D.width;C.height+=D.height}if(A!=null){C.x-=A;C.y-=A;C.width+=2*A;C.height+=2*A}}return C};mxGraph.prototype.createGroupCell=function(B){var A=new mxCell("");A.setVertex(true);A.setConnectable(false);return A};mxGraph.prototype.ungroupCells=function(D){var C=[];if(D==null){D=this.getSelectionCells();var A=[];for(var B=0;B<D.length;B++){if(this.model.getChildCount(D[B])>0){A.push(D[B])}}D=A}if(D!=null&&D.length>0){this.model.beginUpdate();try{for(var B=0;B<D.length;B++){var G=this.model.getChildren(D[B]);if(G!=null&&G.length>0){G=G.slice();var F=this.model.getParent(D[B]);var E=this.model.getChildCount(F);this.cellsAdded(G,F,E,null,null,true);C=C.concat(G)}}this.removeCellsAfterUngroup(D);this.fireEvent(new mxEventObject(mxEvent.UNGROUP_CELLS,"cells",D))}finally{this.model.endUpdate()}}return C};mxGraph.prototype.removeCellsAfterUngroup=function(A){this.cellsRemoved(this.addAllEdges(A))};mxGraph.prototype.removeCellsFromParent=function(A){if(A==null){A=this.getSelectionCells()}this.model.beginUpdate();try{var C=this.getDefaultParent();var B=this.model.getChildCount(C);this.cellsAdded(A,C,B,null,null,true);this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS_FROM_PARENT,"cells",A))}finally{this.model.endUpdate()}return A};mxGraph.prototype.updateGroupBounds=function(L,M,B,K,I,A,N){if(L==null){L=this.getSelectionCells()}M=(M!=null)?M:0;B=(B!=null)?B:false;K=(K!=null)?K:0;I=(I!=null)?I:0;A=(A!=null)?A:0;N=(N!=null)?N:0;this.model.beginUpdate();try{for(var H=L.length-1;H>=0;H--){var D=this.getCellGeometry(L[H]);if(D!=null){var E=this.getChildCells(L[H]);if(E!=null&&E.length>0){var C=this.getBoundingBoxFromGeometry(E,true);if(C!=null&&C.width>0&&C.height>0){var G=0;var F=0;if(this.isSwimlane(L[H])){var J=this.getStartSize(L[H]);G=J.width;F=J.height}D=D.clone();if(B){D.x=Math.round(D.x+C.x-M-G-N);D.y=Math.round(D.y+C.y-M-F-K)}D.width=Math.round(C.width+2*M+G+N+I);D.height=Math.round(C.height+2*M+F+K+A);this.model.setGeometry(L[H],D);this.moveCells(E,M+G-C.x+N,M+F-C.y+K)}}}}}finally{this.model.endUpdate()}return L};mxGraph.prototype.getBoundingBox=function(C){var B=null;if(C!=null&&C.length>0){for(var A=0;A<C.length;A++){if(this.model.isVertex(C[A])||this.model.isEdge(C[A])){var D=this.view.getBoundingBox(this.view.getState(C[A]),true);if(D!=null){if(B==null){B=mxRectangle.fromRectangle(D)}else{B.add(D)}}}}}return B};mxGraph.prototype.cloneCells=function(M,C,D){C=(C!=null)?C:true;var A=null;if(M!=null){var T=new mxDictionary();var B=[];for(var E=0;E<M.length;E++){T.put(M[E],true);B.push(M[E])}if(B.length>0){var K=this.view.scale;var J=this.view.translate;A=this.model.cloneCells(M,true,D);for(var E=0;E<M.length;E++){if(!C&&this.model.isEdge(A[E])&&this.getEdgeValidationError(A[E],this.model.getTerminal(A[E],true),this.model.getTerminal(A[E],false))!=null){A[E]=null}else{var I=this.model.getGeometry(A[E]);if(I!=null){var F=this.view.getState(M[E]);var P=this.view.getState(this.model.getParent(M[E]));if(F!=null&&P!=null){var G=P.origin.x;var O=P.origin.y;if(this.model.isEdge(A[E])){var N=F.absolutePoints;var H=this.model.getTerminal(M[E],true);while(H!=null&&!T.get(H)){H=this.model.getParent(H)}if(H==null){I.setTerminalPoint(new mxPoint(N[0].x/K-J.x,N[0].y/K-J.y),true)}var R=this.model.getTerminal(M[E],false);while(R!=null&&!T.get(R)){R=this.model.getParent(R)}if(R==null){var S=N.length-1;I.setTerminalPoint(new mxPoint(N[S].x/K-J.x,N[S].y/K-J.y),false)}var L=I.points;if(L!=null){for(var Q=0;Q<L.length;Q++){L[Q].x+=G;L[Q].y+=O}}}else{I.translate(G,O)}}}}}}else{A=[]}}return A};mxGraph.prototype.insertVertex=function(I,F,C,G,H,B,A,D,J){var E=this.createVertex(I,F,C,G,H,B,A,D,J);return this.addCell(E,I)};mxGraph.prototype.createVertex=function(J,G,D,H,I,B,A,E,K){var C=new mxGeometry(H,I,B,A);C.relative=(K!=null)?K:false;var F=new mxCell(D,C,E);F.setId(G);F.setVertex(true);F.setConnectable(true);return F};mxGraph.prototype.insertEdge=function(F,G,E,A,D,C){var B=this.createEdge(F,G,E,A,D,C);return this.addEdge(B,F,A,D)};mxGraph.prototype.createEdge=function(F,G,E,A,D,C){var B=new mxCell(E,new mxGeometry(),C);B.setId(G);B.setEdge(true);B.geometry.relative=true;return B};mxGraph.prototype.addEdge=function(B,D,A,C,E){return this.addCell(B,D,E,A,C)};mxGraph.prototype.addCell=function(D,E,C,A,B){return this.addCells([D],E,C,A,B)[0]};mxGraph.prototype.addCells=function(C,E,D,A,B){if(E==null){E=this.getDefaultParent()}if(D==null){D=this.model.getChildCount(E)}this.model.beginUpdate();try{this.cellsAdded(C,E,D,A,B,false,true);this.fireEvent(new mxEventObject(mxEvent.ADD_CELLS,"cells",C,"parent",E,"index",D,"source",A,"target",B))}finally{this.model.endUpdate()}return C};mxGraph.prototype.cellsAdded=function(L,K,D,I,O,Q,A){if(L!=null&&K!=null&&D!=null){this.model.beginUpdate();try{var B=(Q)?this.view.getState(K):null;var E=(B!=null)?B.origin:null;var P=new mxPoint(0,0);for(var F=0;F<L.length;F++){if(L[F]==null){D--}else{var N=this.model.getParent(L[F]);if(E!=null&&L[F]!=K&&K!=N){var C=this.view.getState(N);var H=(C!=null)?C.origin:P;var J=this.model.getGeometry(L[F]);if(J!=null){var G=H.x-E.x;var M=H.y-E.y;J=J.clone();J.translate(G,M);if(!J.relative&&this.model.isVertex(L[F])&&!this.isAllowNegativeCoordinates()){J.x=Math.max(0,J.x);J.y=Math.max(0,J.y)}this.model.setGeometry(L[F],J)}}if(K==N&&D+F>this.model.getChildCount(K)){D--}this.model.add(K,L[F],D+F);if(this.autoSizeCellsOnAdd){this.autoSizeCell(L[F],true)}if(this.isExtendParentsOnAdd(L[F])&&this.isExtendParent(L[F])){this.extendParent(L[F])}if(A==null||A){this.constrainChild(L[F])}if(I!=null){this.cellConnected(L[F],I,true)}if(O!=null){this.cellConnected(L[F],O,false)}}}this.fireEvent(new mxEventObject(mxEvent.CELLS_ADDED,"cells",L,"parent",K,"index",D,"source",I,"target",O,"absolute",Q))}finally{this.model.endUpdate()}}};mxGraph.prototype.autoSizeCell=function(D,B){B=(B!=null)?B:true;if(B){var A=this.model.getChildCount(D);for(var C=0;C<A;C++){this.autoSizeCell(this.model.getChildAt(D,C))}}if(this.getModel().isVertex(D)&&this.isAutoSizeCell(D)){this.updateCellSize(D)}};mxGraph.prototype.removeCells=function(B,A){A=(A!=null)?A:true;if(B==null){B=this.getDeletableCells(this.getSelectionCells())}if(A){B=this.getDeletableCells(this.addAllEdges(B))}this.model.beginUpdate();try{this.cellsRemoved(B);this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS,"cells",B,"includeEdges",A))}finally{this.model.endUpdate()}return B};mxGraph.prototype.cellsRemoved=function(H){if(H!=null&&H.length>0){var B=this.view.scale;var G=this.view.translate;this.model.beginUpdate();try{var D=new mxDictionary();for(var E=0;E<H.length;E++){D.put(H[E],true)}for(var E=0;E<H.length;E++){var A=this.getAllEdges([H[E]]);var C=mxUtils.bind(this,function(Q,K){var S=this.model.getGeometry(Q);if(S!=null){var N=this.view.getState(Q);if(N!=null){var M=N.getVisibleTerminal(K);var J=false;while(M!=null){if(H[E]==M){J=true;break}M=this.model.getParent(M)}if(J){var R=G.x;var P=G.y;var L=this.view.getState(this.model.getParent(Q));if(L!=null&&this.model.isVertex(L.cell)){R=L.x/B;P=L.y/B}S=S.clone();var I=N.absolutePoints;var O=(K)?0:I.length-1;S.setTerminalPoint(new mxPoint(I[O].x/B-R,I[O].y/B-P),K);this.model.setTerminal(A[F],null,K);this.model.setGeometry(A[F],S)}}}});for(var F=0;F<A.length;F++){if(!D.get(A[F])){C(A[F],true);C(A[F],false)}}this.model.remove(H[E])}this.fireEvent(new mxEventObject(mxEvent.CELLS_REMOVED,"cells",H))}finally{this.model.endUpdate()}}};mxGraph.prototype.splitEdge=function(G,J,L,I,F){I=I||0;F=F||0;var K=this.model.getParent(G);var H=this.model.getTerminal(G,true);this.model.beginUpdate();try{if(L==null){L=this.cloneCells([G])[0];var E=this.view.getState(G);var B=this.getCellGeometry(L);if(B!=null&&B.points!=null&&E!=null){var C=this.view.translate;var A=this.view.scale;var D=mxUtils.findNearestSegment(E,(I+C.x)*A,(F+C.y)*A);B.points=B.points.slice(0,D);B=this.getCellGeometry(G);if(B!=null&&B.points!=null){B=B.clone();B.points=B.points.slice(D);this.model.setGeometry(G,B)}}}this.cellsMoved(J,I,F,false,false);this.cellsAdded(J,K,this.model.getChildCount(K),null,null,true);this.cellsAdded([L],K,this.model.getChildCount(K),H,J[0],false);this.cellConnected(G,J[0],true);this.fireEvent(new mxEventObject(mxEvent.SPLIT_EDGE,"edge",G,"cells",J,"newEdge",L,"dx",I,"dy",F))}finally{this.model.endUpdate()}return L};mxGraph.prototype.toggleCells=function(A,C,B){if(C==null){C=this.getSelectionCells()}if(B){C=this.addAllEdges(C)}this.model.beginUpdate();try{this.cellsToggled(C,A);this.fireEvent(new mxEventObject(mxEvent.TOGGLE_CELLS,"show",A,"cells",C,"includeEdges",B))}finally{this.model.endUpdate()}return C};mxGraph.prototype.cellsToggled=function(C,B){if(C!=null&&C.length>0){this.model.beginUpdate();try{for(var A=0;A<C.length;A++){this.model.setVisible(C[A],B)}}finally{this.model.endUpdate()}}};mxGraph.prototype.foldCells=function(A,B,D,C,E){B=(B!=null)?B:false;if(D==null){D=this.getFoldableCells(this.getSelectionCells(),A)}this.stopEditing(false);this.model.beginUpdate();try{this.cellsFolded(D,A,B,C);this.fireEvent(new mxEventObject(mxEvent.FOLD_CELLS,"collapse",A,"recurse",B,"cells",D))}finally{this.model.endUpdate()}return D};mxGraph.prototype.cellsFolded=function(E,A,B,D){if(E!=null&&E.length>0){this.model.beginUpdate();try{for(var C=0;C<E.length;C++){if((!D||this.isCellFoldable(E[C],A))&&A!=this.isCellCollapsed(E[C])){this.model.setCollapsed(E[C],A);this.swapBounds(E[C],A);if(this.isExtendParent(E[C])){this.extendParent(E[C])}if(B){var F=this.model.getChildren(E[C]);this.foldCells(F,A,B)}this.constrainChild(E[C])}}this.fireEvent(new mxEventObject(mxEvent.CELLS_FOLDED,"cells",E,"collapse",A,"recurse",B))}finally{this.model.endUpdate()}}};mxGraph.prototype.swapBounds=function(B,A){if(B!=null){var C=this.model.getGeometry(B);if(C!=null){C=C.clone();this.updateAlternateBounds(B,C,A);C.swap();this.model.setGeometry(B,C)}}};mxGraph.prototype.updateAlternateBounds=function(O,N,M){if(O!=null&&N!=null){var H=this.view.getState(O);var I=(H!=null)?H.style:this.getCellStyle(O);if(N.alternateBounds==null){var B=N;if(this.collapseToPreferredSize){var F=this.getPreferredSizeForCell(O);if(F!=null){B=F;var C=mxUtils.getValue(I,mxConstants.STYLE_STARTSIZE);if(C>0){B.height=Math.max(B.height,C)}}}N.alternateBounds=new mxRectangle(0,0,B.width,B.height)}if(N.alternateBounds!=null){N.alternateBounds.x=N.x;N.alternateBounds.y=N.y;var G=mxUtils.toRadians(I[mxConstants.STYLE_ROTATION]||0);if(G!=0){var J=N.alternateBounds.getCenterX()-N.getCenterX();var K=N.alternateBounds.getCenterY()-N.getCenterY();var E=Math.cos(G);var D=Math.sin(G);var L=E*J-D*K;var A=D*J+E*K;N.alternateBounds.x+=L-J;N.alternateBounds.y+=A-K}}}};mxGraph.prototype.addAllEdges=function(A){var B=A.slice();return mxUtils.removeDuplicates(B.concat(this.getAllEdges(A)))};mxGraph.prototype.getAllEdges=function(D){var B=[];if(D!=null){for(var A=0;A<D.length;A++){var C=this.model.getEdgeCount(D[A]);for(var E=0;E<C;E++){B.push(this.model.getEdgeAt(D[A],E))}var F=this.model.getChildren(D[A]);B=B.concat(this.getAllEdges(F))}}return B};mxGraph.prototype.updateCellSize=function(A,B){B=(B!=null)?B:false;this.model.beginUpdate();try{this.cellSizeUpdated(A,B);this.fireEvent(new mxEventObject(mxEvent.UPDATE_CELL_SIZE,"cell",A,"ignoreChildren",B))}finally{this.model.endUpdate()}return A};mxGraph.prototype.cellSizeUpdated=function(M,D){if(M!=null){this.model.beginUpdate();try{var E=this.getPreferredSizeForCell(M);var K=this.model.getGeometry(M);if(E!=null&&K!=null){var L=this.isCellCollapsed(M);K=K.clone();if(this.isSwimlane(M)){var F=this.view.getState(M);var G=(F!=null)?F.style:this.getCellStyle(M);var J=this.model.getStyle(M);if(J==null){J=""}if(mxUtils.getValue(G,mxConstants.STYLE_HORIZONTAL,true)){J=mxUtils.setStyle(J,mxConstants.STYLE_STARTSIZE,E.height+8);if(L){K.height=E.height+8}K.width=E.width}else{J=mxUtils.setStyle(J,mxConstants.STYLE_STARTSIZE,E.width+8);if(L){K.width=E.width+8}K.height=E.height}this.model.setStyle(M,J)}else{K.width=E.width;K.height=E.height}if(!D&&!L){var B=this.view.getBounds(this.model.getChildren(M));if(B!=null){var I=this.view.translate;var C=this.view.scale;var H=(B.x+B.width)/C-K.x-I.x;var A=(B.y+B.height)/C-K.y-I.y;K.width=Math.max(K.width,H);K.height=Math.max(K.height,A)}}this.cellsResized([M],[K],false)}}finally{this.model.endUpdate()}}};mxGraph.prototype.getPreferredSizeForCell=function(N){var A=null;if(N!=null){var G=this.view.getState(N)||this.view.createState(N);var H=G.style;if(!this.model.isEdge(N)){var D=H[mxConstants.STYLE_FONTSIZE]||mxConstants.DEFAULT_FONTSIZE;var K=0;var I=0;if(this.getImage(G)!=null||H[mxConstants.STYLE_IMAGE]!=null){if(H[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_LABEL){if(H[mxConstants.STYLE_VERTICAL_ALIGN]==mxConstants.ALIGN_MIDDLE){K+=parseFloat(H[mxConstants.STYLE_IMAGE_WIDTH])||mxLabel.prototype.imageSize}if(H[mxConstants.STYLE_ALIGN]!=mxConstants.ALIGN_CENTER){I+=parseFloat(H[mxConstants.STYLE_IMAGE_HEIGHT])||mxLabel.prototype.imageSize}}}K+=2*(H[mxConstants.STYLE_SPACING]||0);K+=H[mxConstants.STYLE_SPACING_LEFT]||0;K+=H[mxConstants.STYLE_SPACING_RIGHT]||0;I+=2*(H[mxConstants.STYLE_SPACING]||0);I+=H[mxConstants.STYLE_SPACING_TOP]||0;I+=H[mxConstants.STYLE_SPACING_BOTTOM]||0;var M=this.getFoldingImage(G);if(M!=null){K+=M.width+8}var F=this.cellRenderer.getLabelValue(G);if(F!=null&&F.length>0){if(!this.isHtmlLabel(G.cell)){F=mxUtils.htmlEntities(F)}F=F.replace(/\n/g,"<br>");var C=mxUtils.getSizeForString(F,D,H[mxConstants.STYLE_FONTFAMILY]);var J=C.width+K;var B=C.height+I;if(!mxUtils.getValue(H,mxConstants.STYLE_HORIZONTAL,true)){var E=B;B=J;J=E}if(this.gridEnabled){J=this.snap(J+this.gridSize/2);B=this.snap(B+this.gridSize/2)}A=new mxRectangle(0,0,J,B)}else{var L=4*this.gridSize;A=new mxRectangle(0,0,L,L)}}}return A};mxGraph.prototype.resizeCell=function(C,B,A){return this.resizeCells([C],[B],A)[0]};mxGraph.prototype.resizeCells=function(C,B,A){A=(A!=null)?A:this.isRecursiveResize();this.model.beginUpdate();try{this.cellsResized(C,B,A);this.fireEvent(new mxEventObject(mxEvent.RESIZE_CELLS,"cells",C,"bounds",B))}finally{this.model.endUpdate()}return C};mxGraph.prototype.cellsResized=function(D,C,B){B=(B!=null)?B:false;if(D!=null&&C!=null&&D.length==C.length){this.model.beginUpdate();try{for(var A=0;A<D.length;A++){this.cellResized(D[A],C[A],false,B);if(this.isExtendParent(D[A])){this.extendParent(D[A])}this.constrainChild(D[A])}if(this.resetEdgesOnResize){this.resetEdges(D)}this.fireEvent(new mxEventObject(mxEvent.CELLS_RESIZED,"cells",D,"bounds",C))}finally{this.model.endUpdate()}}};mxGraph.prototype.cellResized=function(E,C,D,B){var F=this.model.getGeometry(E);if(F!=null&&(F.x!=C.x||F.y!=C.y||F.width!=C.width||F.height!=C.height)){F=F.clone();if(!D&&F.relative){var A=F.offset;if(A!=null){A.x+=C.x-F.x;A.y+=C.y-F.y}}else{F.x=C.x;F.y=C.y}F.width=C.width;F.height=C.height;if(!F.relative&&this.model.isVertex(E)&&!this.isAllowNegativeCoordinates()){F.x=Math.max(0,F.x);F.y=Math.max(0,F.y)}this.model.beginUpdate();try{if(B){this.resizeChildCells(E,F)}this.model.setGeometry(E,F);this.constrainChildCells(E)}finally{this.model.endUpdate()}}};mxGraph.prototype.resizeChildCells=function(F,E){var G=this.model.getGeometry(F);var C=E.width/G.width;var D=E.height/G.height;var A=this.model.getChildCount(F);for(var B=0;B<A;B++){this.scaleCell(this.model.getChildAt(F,B),C,D,true)}};mxGraph.prototype.constrainChildCells=function(C){var A=this.model.getChildCount(C);for(var B=0;B<A;B++){this.constrainChild(this.model.getChildAt(C,B))}};mxGraph.prototype.scaleCell=function(K,F,E,B){var J=this.model.getGeometry(K);if(J!=null){var C=this.view.getState(K);var D=(C!=null)?C.style:this.getCellStyle(K);J=J.clone();var G=J.x;var H=J.y;var A=J.width;var I=J.height;J.scale(F,E,D[mxConstants.STYLE_ASPECT]=="fixed");if(D[mxConstants.STYLE_RESIZE_WIDTH]=="1"){J.width=A*F}else{if(D[mxConstants.STYLE_RESIZE_WIDTH]=="0"){J.width=A}}if(D[mxConstants.STYLE_RESIZE_HEIGHT]=="1"){J.height=I*E}else{if(D[mxConstants.STYLE_RESIZE_HEIGHT]=="0"){J.height=I}}if(!this.isCellMovable(K)){J.x=G;J.y=H}if(!this.isCellResizable(K)){J.width=A;J.height=I}if(this.model.isVertex(K)){this.cellResized(K,J,true,B)}else{this.model.setGeometry(K,J)}}};mxGraph.prototype.extendParent=function(C){if(C!=null){var D=this.model.getParent(C);var B=this.getCellGeometry(D);if(D!=null&&B!=null&&!this.isCellCollapsed(D)){var A=this.getCellGeometry(C);if(A!=null&&!A.relative&&(B.width<A.x+A.width||B.height<A.y+A.height)){B=B.clone();B.width=Math.max(B.width,A.x+A.width);B.height=Math.max(B.height,A.y+A.height);this.cellsResized([D],[B],false)}}}};mxGraph.prototype.importCells=function(E,C,B,F,A,D){return this.moveCells(E,C,B,true,F,A,D)};mxGraph.prototype.moveCells=function(L,H,I,B,K,A,O){H=(H!=null)?H:0;I=(I!=null)?I:0;B=(B!=null)?B:false;if(L!=null&&(H!=0||I!=0||B||K!=null)){L=this.model.getTopmostCells(L);this.model.beginUpdate();try{var F=new mxDictionary();for(var G=0;G<L.length;G++){F.put(L[G],true)}var M=mxUtils.bind(this,function(P){while(P!=null){if(F.get(P)){return true}P=this.model.getParent(P)}return false});var N=[];for(var G=0;G<L.length;G++){var D=this.getCellGeometry(L[G]);var E=this.model.getParent(L[G]);if((D==null||!D.relative)||!this.model.isEdge(E)||(!M(this.model.getTerminal(E,true))&&!M(this.model.getTerminal(E,false)))){N.push(L[G])}}L=N;if(B){L=this.cloneCells(L,this.isCloneInvalidEdges(),O);if(K==null){K=this.getDefaultParent()}}var J=this.isAllowNegativeCoordinates();if(K!=null){this.setAllowNegativeCoordinates(true)}this.cellsMoved(L,H,I,!B&&this.isDisconnectOnMove()&&this.isAllowDanglingEdges(),K==null,this.isExtendParentsOnMove()&&K==null);this.setAllowNegativeCoordinates(J);if(K!=null){var C=this.model.getChildCount(K);this.cellsAdded(L,K,C,null,null,true)}this.fireEvent(new mxEventObject(mxEvent.MOVE_CELLS,"cells",L,"dx",H,"dy",I,"clone",B,"target",K,"event",A))}finally{this.model.endUpdate()}}return L};mxGraph.prototype.cellsMoved=function(E,C,B,D,G,F){if(E!=null&&(C!=0||B!=0)){F=(F!=null)?F:false;this.model.beginUpdate();try{if(D){this.disconnectGraph(E)}for(var A=0;A<E.length;A++){this.translateCell(E[A],C,B);if(F&&this.isExtendParent(E[A])){this.extendParent(E[A])}else{if(G){this.constrainChild(E[A])}}}if(this.resetEdgesOnMove){this.resetEdges(E)}this.fireEvent(new mxEventObject(mxEvent.CELLS_MOVED,"cells",E,"dx",C,"dy",B,"disconnect",D))}finally{this.model.endUpdate()}}};mxGraph.prototype.translateCell=function(L,F,I){var K=this.model.getGeometry(L);if(K!=null){F=parseFloat(F);I=parseFloat(I);K=K.clone();K.translate(F,I);if(!K.relative&&this.model.isVertex(L)&&!this.isAllowNegativeCoordinates()){K.x=Math.max(0,parseFloat(K.x));K.y=Math.max(0,parseFloat(K.y))}if(K.relative&&!this.model.isEdge(L)){var B=this.model.getParent(L);var J=0;if(this.model.isVertex(B)){var G=this.view.getState(B);var H=(G!=null)?G.style:this.getCellStyle(B);J=mxUtils.getValue(H,mxConstants.STYLE_ROTATION,0)}if(J!=0){var E=mxUtils.toRadians(-J);var D=Math.cos(E);var C=Math.sin(E);var A=mxUtils.getRotatedPoint(new mxPoint(F,I),D,C,new mxPoint(0,0));F=A.x;I=A.y}if(K.offset==null){K.offset=new mxPoint(F,I)}else{K.offset.x=parseFloat(K.offset.x)+F;K.offset.y=parseFloat(K.offset.y)+I}}this.model.setGeometry(L,K)}};mxGraph.prototype.getCellContainmentArea=function(N){if(N!=null&&!this.model.isEdge(N)){var L=this.model.getParent(N);if(L!=null&&L!=this.getDefaultParent()){var M=this.model.getGeometry(L);if(M!=null){var J=0;var K=0;var D=M.width;var F=M.height;if(this.isSwimlane(L)){var C=this.getStartSize(L);var G=this.view.getState(L);var H=(G!=null)?G.style:this.getCellStyle(L);var B=mxUtils.getValue(H,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST);var I=mxUtils.getValue(H,mxConstants.STYLE_FLIPH,0)==1;var A=mxUtils.getValue(H,mxConstants.STYLE_FLIPV,0)==1;if(B==mxConstants.DIRECTION_SOUTH||B==mxConstants.DIRECTION_NORTH){var E=C.width;C.width=C.height;C.height=E}if((B==mxConstants.DIRECTION_EAST&&!A)||(B==mxConstants.DIRECTION_NORTH&&!I)||(B==mxConstants.DIRECTION_WEST&&A)||(B==mxConstants.DIRECTION_SOUTH&&I)){J=C.width;K=C.height}D-=C.width;F-=C.height}return new mxRectangle(J,K,D,F)}}}return null};mxGraph.prototype.getMaximumGraphBounds=function(){return this.maximumGraphBounds};mxGraph.prototype.constrainChild=function(O,I){I=(I!=null)?I:true;if(O!=null){var M=this.getCellGeometry(O);if(M!=null&&(this.isConstrainRelativeChildren()||!M.relative)){var G=this.model.getParent(O);var K=this.getCellGeometry(G);var B=this.getMaximumGraphBounds();if(B!=null){var N=this.getBoundingBoxFromGeometry([G],false);if(N!=null){B=mxRectangle.fromRectangle(B);B.x-=N.x;B.y-=N.y}}if(this.isConstrainChild(O)){var D=this.getCellContainmentArea(O);if(D!=null){var C=this.getOverlap(O);if(C>0){D=mxRectangle.fromRectangle(D);D.x-=D.width*C;D.y-=D.height*C;D.width+=2*D.width*C;D.height+=2*D.height*C}if(B==null){B=D}else{B=mxRectangle.fromRectangle(B);B.intersect(D)}}}if(B!=null){var A=[O];if(!this.isCellCollapsed(O)){var F=this.model.getDescendants(O);for(var E=0;E<F.length;E++){if(this.isCellVisible(F[E])){A.push(F[E])}}}var L=this.getBoundingBoxFromGeometry(A,false);if(L!=null){M=M.clone();var J=0;if(M.width>B.width){J=M.width-B.width;M.width-=J}if(L.x+L.width>B.x+B.width){J-=L.x+L.width-B.x-B.width-J}var H=0;if(M.height>B.height){H=M.height-B.height;M.height-=H}if(L.y+L.height>B.y+B.height){H-=L.y+L.height-B.y-B.height-H}if(L.x<B.x){J-=L.x-B.x}if(L.y<B.y){H-=L.y-B.y}if(J!=0||H!=0){if(M.relative){if(M.offset==null){M.offset=new mxPoint()}M.offset.x+=J;M.offset.y+=H}else{M.x+=J;M.y+=H}}this.model.setGeometry(O,M)}}}}};mxGraph.prototype.resetEdges=function(H){if(H!=null){var D=new mxDictionary();for(var E=0;E<H.length;E++){D.put(H[E],true)}this.model.beginUpdate();try{for(var E=0;E<H.length;E++){var A=this.model.getEdges(H[E]);if(A!=null){for(var B=0;B<A.length;B++){var C=this.view.getState(A[B]);var F=(C!=null)?C.getVisibleTerminal(true):this.view.getVisibleTerminal(A[B],true);var G=(C!=null)?C.getVisibleTerminal(false):this.view.getVisibleTerminal(A[B],false);if(!D.get(F)||!D.get(G)){this.resetEdge(A[B])}}}this.resetEdges(this.model.getChildren(H[E]))}}finally{this.model.endUpdate()}}};mxGraph.prototype.resetEdge=function(A){var B=this.model.getGeometry(A);if(B!=null&&B.points!=null&&B.points.length>0){B=B.clone();B.points=[];this.model.setGeometry(A,B)}return A};mxGraph.prototype.getOutlineConstraint=function(C,D,B){if(D.shape!=null){var F=this.view.getPerimeterBounds(D);var G=D.style[mxConstants.STYLE_DIRECTION];if(G==mxConstants.DIRECTION_NORTH||G==mxConstants.DIRECTION_SOUTH){F.x+=F.width/2-F.height/2;F.y+=F.height/2-F.width/2;var A=F.width;F.width=F.height;F.height=A}var L=mxUtils.toRadians(D.shape.getShapeRotation());if(L!=0){var M=Math.cos(-L);var O=Math.sin(-L);var E=new mxPoint(F.getCenterX(),F.getCenterY());C=mxUtils.getRotatedPoint(C,M,O,E)}var P=1;var I=1;var K=0;var H=0;if(this.getModel().isVertex(D.cell)){var J=D.style[mxConstants.STYLE_FLIPH];var N=D.style[mxConstants.STYLE_FLIPV];if(D.shape!=null&&D.shape.stencil!=null){J=mxUtils.getValue(D.style,"stencilFlipH",0)==1||J;N=mxUtils.getValue(D.style,"stencilFlipV",0)==1||N}if(G==mxConstants.DIRECTION_NORTH||G==mxConstants.DIRECTION_SOUTH){var A=J;J=N;N=A}if(J){P=-1;K=-F.width}if(N){I=-1;H=-F.height}}C=new mxPoint((C.x-F.x)*P-K+F.x,(C.y-F.y)*I-H+F.y);var Q=Math.round((C.x-F.x)*1000/F.width)/1000;var R=Math.round((C.y-F.y)*1000/F.height)/1000;return new mxConnectionConstraint(new mxPoint(Q,R),false)}return null};mxGraph.prototype.getAllConnectionConstraints=function(B,A){if(B!=null&&B.shape!=null&&B.shape.stencil!=null){return B.shape.stencil.constraints}return null};mxGraph.prototype.getConnectionConstraint=function(D,G,C){var A=null;var E=D.style[(C)?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X];if(E!=null){var F=D.style[(C)?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y];if(F!=null){A=new mxPoint(parseFloat(E),parseFloat(F))}}var B=false;if(A!=null){B=mxUtils.getValue(D.style,(C)?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,true)}return new mxConnectionConstraint(A,B)};mxGraph.prototype.setConnectionConstraint=function(B,D,A,C){if(C!=null){this.model.beginUpdate();try{if(C==null||C.point==null){this.setCellStyles((A)?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,null,[B]);this.setCellStyles((A)?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,null,[B]);this.setCellStyles((A)?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[B])}else{if(C.point!=null){this.setCellStyles((A)?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,C.point.x,[B]);this.setCellStyles((A)?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,C.point.y,[B]);if(!C.perimeter){this.setCellStyles((A)?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,"0",[B])}else{this.setCellStyles((A)?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[B])}}}}finally{this.model.endUpdate()}}};mxGraph.prototype.getConnectionPoint=function(L,K){var B=null;if(L!=null&&K.point!=null){var D=this.view.getPerimeterBounds(L);var E=new mxPoint(D.getCenterX(),D.getCenterY());var G=L.style[mxConstants.STYLE_DIRECTION];var R=0;if(G!=null){if(G==mxConstants.DIRECTION_NORTH){R+=270}else{if(G==mxConstants.DIRECTION_WEST){R+=180}else{if(G==mxConstants.DIRECTION_SOUTH){R+=90}}}if(G==mxConstants.DIRECTION_NORTH||G==mxConstants.DIRECTION_SOUTH){D.rotate90()}}if(K.point!=null){var Q=1;var I=1;var H=0;var P=0;if(this.getModel().isVertex(L.cell)){var J=L.style[mxConstants.STYLE_FLIPH];var O=L.style[mxConstants.STYLE_FLIPV];if(L.shape!=null&&L.shape.stencil!=null){J=mxUtils.getValue(L.style,"stencilFlipH",0)==1||J;O=mxUtils.getValue(L.style,"stencilFlipV",0)==1||O}if(G==mxConstants.DIRECTION_NORTH||G==mxConstants.DIRECTION_SOUTH){var C=J;J=O;O=C}if(J){Q=-1;H=-D.width}if(O){I=-1;P=-D.height}}B=new mxPoint(D.x+K.point.x*D.width*Q-H,D.y+K.point.y*D.height*I-P)}var A=L.style[mxConstants.STYLE_ROTATION]||0;if(K.perimeter){if(R!=0&&B!=null){var N=0;var M=0;if(R==90){M=1}else{if(R==180){N=-1}else{if(R==270){M=-1}}}B=mxUtils.getRotatedPoint(B,N,M,E)}if(B!=null&&K.perimeter){B=this.view.getPerimeterPoint(L,B,false)}}else{A+=R}if(A!=0&&B!=null){var F=mxUtils.toRadians(A);var N=Math.cos(F);var M=Math.sin(F);B=mxUtils.getRotatedPoint(B,N,M,E)}}if(B!=null){B.x=Math.round(B.x);B.y=Math.round(B.y)}return B};mxGraph.prototype.connectCell=function(B,E,A,D){this.model.beginUpdate();try{var C=this.model.getTerminal(B,A);this.cellConnected(B,E,A,D);this.fireEvent(new mxEventObject(mxEvent.CONNECT_CELL,"edge",B,"terminal",E,"source",A,"previous",C))}finally{this.model.endUpdate()}return B};mxGraph.prototype.cellConnected=function(D,G,C,F){if(D!=null){this.model.beginUpdate();try{var E=this.model.getTerminal(D,C);this.setConnectionConstraint(D,G,C,F);if(this.isPortsEnabled()){var B=null;if(this.isPort(G)){B=G.getId();G=this.getTerminalForPort(G,C)}var A=(C)?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT;this.setCellStyles(A,B,[D])}this.model.setTerminal(D,G,C);if(this.resetEdgesOnConnect){this.resetEdge(D)}this.fireEvent(new mxEventObject(mxEvent.CELL_CONNECTED,"edge",D,"terminal",G,"source",C,"previous",E))}finally{this.model.endUpdate()}}};mxGraph.prototype.disconnectGraph=function(L){if(L!=null){this.model.beginUpdate();try{var C=this.view.scale;var K=this.view.translate;var D=new mxDictionary();for(var I=0;I<L.length;I++){D.put(L[I],true)}for(var I=0;I<L.length;I++){if(this.model.isEdge(L[I])){var M=this.model.getGeometry(L[I]);if(M!=null){var F=this.view.getState(L[I]);var E=this.view.getState(this.model.getParent(L[I]));if(F!=null&&E!=null){M=M.clone();var J=-E.origin.x;var H=-E.origin.y;var A=F.absolutePoints;var B=this.model.getTerminal(L[I],true);if(B!=null&&this.isCellDisconnectable(L[I],B,true)){while(B!=null&&!D.get(B)){B=this.model.getParent(B)}if(B==null){M.setTerminalPoint(new mxPoint(A[0].x/C-K.x+J,A[0].y/C-K.y+H),true);this.model.setTerminal(L[I],null,true)}}var N=this.model.getTerminal(L[I],false);if(N!=null&&this.isCellDisconnectable(L[I],N,false)){while(N!=null&&!D.get(N)){N=this.model.getParent(N)}if(N==null){var G=A.length-1;M.setTerminalPoint(new mxPoint(A[G].x/C-K.x+J,A[G].y/C-K.y+H),false);this.model.setTerminal(L[I],null,false)}}this.model.setGeometry(L[I],M)}}}}}finally{this.model.endUpdate()}}};mxGraph.prototype.getCurrentRoot=function(){return this.view.currentRoot};mxGraph.prototype.getTranslateForRoot=function(A){return null};mxGraph.prototype.isPort=function(A){return false};mxGraph.prototype.getTerminalForPort=function(B,A){return this.model.getParent(B)};mxGraph.prototype.getChildOffsetForCell=function(A){return null};mxGraph.prototype.enterGroup=function(A){A=A||this.getSelectionCell();if(A!=null&&this.isValidRoot(A)){this.view.setCurrentRoot(A);this.clearSelection()}};mxGraph.prototype.exitGroup=function(){var A=this.model.getRoot();var C=this.getCurrentRoot();if(C!=null){var B=this.model.getParent(C);while(B!=A&&!this.isValidRoot(B)&&this.model.getParent(B)!=A){B=this.model.getParent(B)}if(B==A||this.model.getParent(B)==A){this.view.setCurrentRoot(null)}else{this.view.setCurrentRoot(B)}var D=this.view.getState(C);if(D!=null){this.setSelectionCell(C)}}};mxGraph.prototype.home=function(){var A=this.getCurrentRoot();if(A!=null){this.view.setCurrentRoot(null);var B=this.view.getState(A);if(B!=null){this.setSelectionCell(A)}}};mxGraph.prototype.isValidRoot=function(A){return(A!=null)};mxGraph.prototype.getGraphBounds=function(){return this.view.getGraphBounds()};mxGraph.prototype.getCellBounds=function(H,F,E){var G=[H];if(F){G=G.concat(this.model.getEdges(H))}var B=this.view.getBounds(G);if(E){var A=this.model.getChildCount(H);for(var D=0;D<A;D++){var C=this.getCellBounds(this.model.getChildAt(H,D),F,true);if(B!=null){B.add(C)}else{B=C}}}return B};mxGraph.prototype.getBoundingBoxFromGeometry=function(I,H){H=(H!=null)?H:false;var B=null;if(I!=null){for(var F=0;F<I.length;F++){if(H||this.model.isVertex(I[F])){var K=this.getCellGeometry(I[F]);if(K!=null){var J=null;if(this.model.isEdge(I[F])){var C=function(L){if(L!=null){if(E==null){E=new mxRectangle(L.x,L.y,0,0)}else{E.add(new mxRectangle(L.x,L.y,0,0))}}};C(K.getTerminalPoint(true));C(K.getTerminalPoint(false));var A=K.points;if(A!=null&&A.length>0){var E=new mxRectangle(A[0].x,A[0].y,0,0);for(var D=1;D<A.length;D++){C(A[D])}}J=E}else{var G=this.model.getParent(I[F]);if(K.relative){if(this.model.isVertex(G)&&G!=this.view.currentRoot){var E=this.getBoundingBoxFromGeometry([G],false);if(E!=null){J=new mxRectangle(K.x*E.width,K.y*E.height,K.width,K.height);if(mxUtils.indexOf(I,G)>=0){J.x+=E.x;J.y+=E.y}}}}else{J=mxRectangle.fromRectangle(K);if(this.model.isVertex(G)&&mxUtils.indexOf(I,G)>=0){var E=this.getBoundingBoxFromGeometry([G],false);if(E!=null){J.x+=E.x;J.y+=E.y}}}if(J!=null&&K.offset!=null){J.x+=K.offset.x;J.y+=K.offset.y}}if(J!=null){if(B==null){B=mxRectangle.fromRectangle(J)}else{B.add(J)}}}}}}return B};mxGraph.prototype.refresh=function(A){this.view.clear(A,A==null);this.view.validate();this.sizeDidChange();this.fireEvent(new mxEventObject(mxEvent.REFRESH))};mxGraph.prototype.snap=function(A){if(this.gridEnabled){A=Math.round(A/this.gridSize)*this.gridSize}return A};mxGraph.prototype.panGraph=function(C,E){if(this.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.container)){this.container.scrollLeft=-C;this.container.scrollTop=-E}else{var D=this.view.getCanvas();if(this.dialect==mxConstants.DIALECT_SVG){if(C==0&&E==0){if(mxClient.IS_IE){D.setAttribute("transform","translate("+C+","+E+")")}else{D.removeAttribute("transform")}if(this.shiftPreview1!=null){var A=this.shiftPreview1.firstChild;while(A!=null){var F=A.nextSibling;this.container.appendChild(A);A=F}if(this.shiftPreview1.parentNode!=null){this.shiftPreview1.parentNode.removeChild(this.shiftPreview1)}this.shiftPreview1=null;this.container.appendChild(D.parentNode);A=this.shiftPreview2.firstChild;while(A!=null){var F=A.nextSibling;this.container.appendChild(A);A=F}if(this.shiftPreview2.parentNode!=null){this.shiftPreview2.parentNode.removeChild(this.shiftPreview2)}this.shiftPreview2=null}}else{D.setAttribute("transform","translate("+C+","+E+")");if(this.shiftPreview1==null){this.shiftPreview1=document.createElement("div");this.shiftPreview1.style.position="absolute";this.shiftPreview1.style.overflow="visible";this.shiftPreview2=document.createElement("div");this.shiftPreview2.style.position="absolute";this.shiftPreview2.style.overflow="visible";var B=this.shiftPreview1;var A=this.container.firstChild;while(A!=null){var F=A.nextSibling;if(A!=D.parentNode){B.appendChild(A)}else{B=this.shiftPreview2}A=F}if(this.shiftPreview1.firstChild!=null){this.container.insertBefore(this.shiftPreview1,D.parentNode)}if(this.shiftPreview2.firstChild!=null){this.container.appendChild(this.shiftPreview2)}}this.shiftPreview1.style.left=C+"px";this.shiftPreview1.style.top=E+"px";this.shiftPreview2.style.left=C+"px";this.shiftPreview2.style.top=E+"px"}}else{D.style.left=C+"px";D.style.top=E+"px"}this.panDx=C;this.panDy=E;this.fireEvent(new mxEventObject(mxEvent.PAN))}};mxGraph.prototype.zoomIn=function(){this.zoom(this.zoomFactor)};mxGraph.prototype.zoomOut=function(){this.zoom(1/this.zoomFactor)};mxGraph.prototype.zoomActual=function(){if(this.view.scale==1){this.view.setTranslate(0,0)}else{this.view.translate.x=0;this.view.translate.y=0;this.view.setScale(1)}};mxGraph.prototype.zoomTo=function(B,A){this.zoom(B/this.view.scale,A)};mxGraph.prototype.center=function(M,D,H,F){M=(M!=null)?M:true;D=(D!=null)?D:true;H=(H!=null)?H:0.5;F=(F!=null)?F:0.5;var L=mxUtils.hasScrollbars(this.container);var N=this.container.clientWidth;var G=this.container.clientHeight;var A=this.getGraphBounds();var E=this.view.translate;var B=this.view.scale;var J=(M)?N-A.width:0;var K=(D)?G-A.height:0;if(!L){this.view.setTranslate((M)?Math.floor(E.x-A.x*B+J*H/B):E.x,(D)?Math.floor(E.y-A.y*B+K*F/B):E.y)}else{A.x-=E.x;A.y-=E.y;var C=this.container.scrollWidth;var I=this.container.scrollHeight;if(C>N){J=0}if(I>G){K=0}this.view.setTranslate(Math.floor(J/2-A.x),Math.floor(K/2-A.y));this.container.scrollLeft=(C-N)/2;this.container.scrollTop=(I-G)/2}};mxGraph.prototype.zoom=function(F,A){A=(A!=null)?A:this.centerZoom;var C=Math.round(this.view.scale*F*100)/100;var E=this.view.getState(this.getSelectionCell());F=C/this.view.scale;if(this.keepSelectionVisibleOnZoom&&E!=null){var B=new mxRectangle(E.x*F,E.y*F,E.width*F,E.height*F);this.view.scale=C;if(!this.scrollRectToVisible(B)){this.view.revalidate();this.view.setScale(C)}}else{var I=mxUtils.hasScrollbars(this.container);if(A&&!I){var G=this.container.offsetWidth;var H=this.container.offsetHeight;if(F>1){var L=(F-1)/(C*2);G*=-L;H*=-L}else{var L=(1/F-1)/(this.view.scale*2);G*=L;H*=L}this.view.scaleAndTranslate(C,this.view.translate.x+G,this.view.translate.y+H)}else{var K=this.view.translate.x;var M=this.view.translate.y;var J=this.container.scrollLeft;var D=this.container.scrollTop;this.view.setScale(C);if(I){var G=0;var H=0;if(A){G=this.container.offsetWidth*(F-1)/2;H=this.container.offsetHeight*(F-1)/2}this.container.scrollLeft=(this.view.translate.x-K)*this.view.scale+Math.round(J*F+G);this.container.scrollTop=(this.view.translate.y-M)*this.view.scale+Math.round(D*F+H)}}}};mxGraph.prototype.zoomToRect=function(B){var H=this.container.clientWidth/B.width;var K=this.container.clientHeight/B.height;var N=H/K;B.x=Math.max(0,B.x);B.y=Math.max(0,B.y);var A=Math.min(this.container.scrollWidth,B.x+B.width);var F=Math.min(this.container.scrollHeight,B.y+B.height);B.width=A-B.x;B.height=F-B.y;if(N<1){var D=B.height/N;var L=(D-B.height)/2;B.height=D;var M=Math.min(B.y,L);B.y=B.y-M;F=Math.min(this.container.scrollHeight,B.y+B.height);B.height=F-B.y}else{var I=B.width*N;var G=(I-B.width)/2;B.width=I;var E=Math.min(B.x,G);B.x=B.x-E;A=Math.min(this.container.scrollWidth,B.x+B.width);B.width=A-B.x}var C=this.container.clientWidth/B.width;var J=this.view.scale*C;if(!mxUtils.hasScrollbars(this.container)){this.view.scaleAndTranslate(J,(this.view.translate.x-B.x/this.view.scale),(this.view.translate.y-B.y/this.view.scale))}else{this.view.setScale(J);this.container.scrollLeft=Math.round(B.x*C);this.container.scrollTop=Math.round(B.y*C)}};mxGraph.prototype.scrollCellToVisible=function(J,A){var H=-this.view.translate.x;var I=-this.view.translate.y;var F=this.view.getState(J);if(F!=null){var B=new mxRectangle(H+F.x,I+F.y,F.width,F.height);if(A&&this.container!=null){var C=this.container.clientWidth;var E=this.container.clientHeight;B.x=B.getCenterX()-C/2;B.width=C;B.y=B.getCenterY()-E/2;B.height=E}var D=new mxPoint(this.view.translate.x,this.view.translate.y);if(this.scrollRectToVisible(B)){var G=new mxPoint(this.view.translate.x,this.view.translate.y);this.view.translate.x=D.x;this.view.translate.y=D.y;this.view.setTranslate(G.x,G.y)}}};mxGraph.prototype.scrollRectToVisible=function(B){var E=false;if(B!=null){var C=this.container.offsetWidth;var G=this.container.offsetHeight;var K=Math.min(C,B.width);var F=Math.min(G,B.height);if(mxUtils.hasScrollbars(this.container)){var J=this.container;B.x+=this.view.translate.x;B.y+=this.view.translate.y;var I=J.scrollLeft-B.x;var D=Math.max(I-J.scrollLeft,0);if(I>0){J.scrollLeft-=I+2}else{I=B.x+K-J.scrollLeft-J.clientWidth;if(I>0){J.scrollLeft+=I+2}}var H=J.scrollTop-B.y;var L=Math.max(0,H-J.scrollTop);if(H>0){J.scrollTop-=H+2}else{H=B.y+F-J.scrollTop-J.clientHeight;if(H>0){J.scrollTop+=H+2}}if(!this.useScrollbarsForPanning&&(D!=0||L!=0)){this.view.setTranslate(D,L)}}else{var M=-this.view.translate.x;var N=-this.view.translate.y;var A=this.view.scale;if(B.x+K>M+C){this.view.translate.x-=(B.x+K-C-M)/A;E=true}if(B.y+F>N+G){this.view.translate.y-=(B.y+F-G-N)/A;E=true}if(B.x<M){this.view.translate.x+=(M-B.x)/A;E=true}if(B.y<N){this.view.translate.y+=(N-B.y)/A;E=true}if(E){this.view.refresh();if(this.selectionCellsHandler!=null){this.selectionCellsHandler.refresh()}}}}return E};mxGraph.prototype.getCellGeometry=function(A){return this.model.getGeometry(A)};mxGraph.prototype.isCellVisible=function(A){return this.model.isVisible(A)};mxGraph.prototype.isCellCollapsed=function(A){return this.model.isCollapsed(A)};mxGraph.prototype.isCellConnectable=function(A){return this.model.isConnectable(A)};mxGraph.prototype.isOrthogonal=function(B){var C=B.style[mxConstants.STYLE_ORTHOGONAL];if(C!=null){return C}var A=this.view.getEdgeStyle(B);return A==mxEdgeStyle.SegmentConnector||A==mxEdgeStyle.ElbowConnector||A==mxEdgeStyle.SideToSide||A==mxEdgeStyle.TopToBottom||A==mxEdgeStyle.EntityRelation||A==mxEdgeStyle.OrthConnector};mxGraph.prototype.isLoop=function(C){var B=C.getVisibleTerminalState(true);var A=C.getVisibleTerminalState(false);return(B!=null&&B==A)};mxGraph.prototype.isCloneEvent=function(A){return mxEvent.isControlDown(A)};mxGraph.prototype.isToggleEvent=function(A){return(mxClient.IS_MAC)?mxEvent.isMetaDown(A):mxEvent.isControlDown(A)};mxGraph.prototype.isGridEnabledEvent=function(A){return A!=null&&!mxEvent.isAltDown(A)};mxGraph.prototype.isConstrainedEvent=function(A){return mxEvent.isShiftDown(A)};mxGraph.prototype.isIgnoreTerminalEvent=function(A){return false};mxGraph.prototype.validationAlert=function(A){mxUtils.alert(A)};mxGraph.prototype.isEdgeValid=function(B,A,C){return this.getEdgeValidationError(B,A,C)==null};mxGraph.prototype.getEdgeValidationError=function(H,C,I){if(H!=null&&!this.isAllowDanglingEdges()&&(C==null||I==null)){return""}if(H!=null&&this.model.getTerminal(H,true)==null&&this.model.getTerminal(H,false)==null){return null}if(!this.allowLoops&&C==I&&C!=null){return""}if(!this.isValidConnection(C,I)){return""}if(C!=null&&I!=null){var D="";if(!this.multigraph){var E=this.model.getEdgesBetween(C,I,true);if(E.length>1||(E.length==1&&E[0]!=H)){D+=(mxResources.get(this.alreadyConnectedResource)||this.alreadyConnectedResource)+"\n"}}var A=this.model.getDirectedEdgeCount(C,true,H);var B=this.model.getDirectedEdgeCount(I,false,H);if(this.multiplicities!=null){for(var G=0;G<this.multiplicities.length;G++){var F=this.multiplicities[G].check(this,H,C,I,A,B);if(F!=null){D+=F}}}var F=this.validateEdge(H,C,I);if(F!=null){D+=F}return(D.length>0)?D:null}return(this.allowDanglingEdges)?null:""};mxGraph.prototype.validateEdge=function(B,A,C){return null};mxGraph.prototype.validateGraph=function(J,C){J=(J!=null)?J:this.model.getRoot();C=(C!=null)?C:new Object();var H=true;var A=this.model.getChildCount(J);for(var I=0;I<A;I++){var E=this.model.getChildAt(J,I);var G=C;if(this.isValidRoot(E)){G=new Object()}var D=this.validateGraph(E,G);if(D!=null){this.setCellWarning(E,D.replace(/\n/g,"<br>"))}else{this.setCellWarning(E,null)}H=H&&D==null}var F="";if(this.isCellCollapsed(J)&&!H){F+=(mxResources.get(this.containsValidationErrorsResource)||this.containsValidationErrorsResource)+"\n"}if(this.model.isEdge(J)){F+=this.getEdgeValidationError(J,this.model.getTerminal(J,true),this.model.getTerminal(J,false))||""}else{F+=this.getCellValidationError(J)||""}var B=this.validateCell(J,C);if(B!=null){F+=B}if(this.model.getParent(J)==null){this.view.validate()}return(F.length>0||!H)?F:null};mxGraph.prototype.getCellValidationError=function(G){var E=this.model.getDirectedEdgeCount(G,true);var B=this.model.getDirectedEdgeCount(G,false);var F=this.model.getValue(G);var D="";if(this.multiplicities!=null){for(var C=0;C<this.multiplicities.length;C++){var A=this.multiplicities[C];if(A.source&&mxUtils.isNode(F,A.type,A.attr,A.value)&&((A.max==0&&E>0)||(A.min==1&&E==0)||(A.max==1&&E>1))){D+=A.countError+"\n"}else{if(!A.source&&mxUtils.isNode(F,A.type,A.attr,A.value)&&((A.max==0&&B>0)||(A.min==1&&B==0)||(A.max==1&&B>1))){D+=A.countError+"\n"}}}}return(D.length>0)?D:null};mxGraph.prototype.validateCell=function(B,A){return null};mxGraph.prototype.getBackgroundImage=function(){return this.backgroundImage};mxGraph.prototype.setBackgroundImage=function(A){this.backgroundImage=A};mxGraph.prototype.getFoldingImage=function(B){if(B!=null&&this.foldingEnabled&&!this.getModel().isEdge(B.cell)){var A=this.isCellCollapsed(B.cell);if(this.isCellFoldable(B.cell,!A)){return(A)?this.collapsedImage:this.expandedImage}}return null};mxGraph.prototype.convertValueToString=function(B){var A=this.model.getValue(B);if(A!=null){if(mxUtils.isNode(A)){return A.nodeName}else{if(typeof(A.toString)=="function"){return A.toString()}}}return""};mxGraph.prototype.getLabel=function(C){var A="";if(this.labelsVisible&&C!=null){var D=this.view.getState(C);var B=(D!=null)?D.style:this.getCellStyle(C);if(!mxUtils.getValue(B,mxConstants.STYLE_NOLABEL,false)){A=this.convertValueToString(C)}}return A};mxGraph.prototype.isHtmlLabel=function(A){return this.isHtmlLabels()};mxGraph.prototype.isHtmlLabels=function(){return this.htmlLabels};mxGraph.prototype.setHtmlLabels=function(A){this.htmlLabels=A};mxGraph.prototype.isWrapping=function(B){var C=this.view.getState(B);var A=(C!=null)?C.style:this.getCellStyle(B);return(A!=null)?A[mxConstants.STYLE_WHITE_SPACE]=="wrap":false};mxGraph.prototype.isLabelClipped=function(B){var C=this.view.getState(B);var A=(C!=null)?C.style:this.getCellStyle(B);return(A!=null)?A[mxConstants.STYLE_OVERFLOW]=="hidden":false};mxGraph.prototype.getTooltip=function(F,C,D,E){var A=null;if(F!=null){if(F.control!=null&&(C==F.control.node||C.parentNode==F.control.node)){A=this.collapseExpandResource;A=mxUtils.htmlEntities(mxResources.get(A)||A).replace(/\\n/g,"<br>")}if(A==null&&F.overlays!=null){F.overlays.visit(function(H,G){if(A==null&&(C==G.node||C.parentNode==G.node)){A=G.overlay.toString()}})}if(A==null){var B=this.selectionCellsHandler.getHandler(F.cell);if(B!=null&&typeof(B.getTooltipForNode)=="function"){A=B.getTooltipForNode(C)}}if(A==null){A=this.getTooltipForCell(F.cell)}}return A};mxGraph.prototype.getTooltipForCell=function(B){var A=null;if(B!=null&&B.getTooltip!=null){A=B.getTooltip()}else{A=this.convertValueToString(B)}return A};mxGraph.prototype.getCursorForMouseEvent=function(A){return this.getCursorForCell(A.getCell())};mxGraph.prototype.getCursorForCell=function(A){return null};mxGraph.prototype.getStartSize=function(B){var D=new mxRectangle();var E=this.view.getState(B);var C=(E!=null)?E.style:this.getCellStyle(B);if(C!=null){var A=parseInt(mxUtils.getValue(C,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));if(mxUtils.getValue(C,mxConstants.STYLE_HORIZONTAL,true)){D.height=A}else{D.width=A}}return D};mxGraph.prototype.getImage=function(A){return(A!=null&&A.style!=null)?A.style[mxConstants.STYLE_IMAGE]:null};mxGraph.prototype.getVerticalAlign=function(A){return(A!=null&&A.style!=null)?(A.style[mxConstants.STYLE_VERTICAL_ALIGN]||mxConstants.ALIGN_MIDDLE):null};mxGraph.prototype.getIndicatorColor=function(A){return(A!=null&&A.style!=null)?A.style[mxConstants.STYLE_INDICATOR_COLOR]:null};mxGraph.prototype.getIndicatorGradientColor=function(A){return(A!=null&&A.style!=null)?A.style[mxConstants.STYLE_INDICATOR_GRADIENTCOLOR]:null};mxGraph.prototype.getIndicatorShape=function(A){return(A!=null&&A.style!=null)?A.style[mxConstants.STYLE_INDICATOR_SHAPE]:null};mxGraph.prototype.getIndicatorImage=function(A){return(A!=null&&A.style!=null)?A.style[mxConstants.STYLE_INDICATOR_IMAGE]:null};mxGraph.prototype.getBorder=function(){return this.border};mxGraph.prototype.setBorder=function(A){this.border=A};mxGraph.prototype.isSwimlane=function(B){if(B!=null){if(this.model.getParent(B)!=this.model.getRoot()){var C=this.view.getState(B);var A=(C!=null)?C.style:this.getCellStyle(B);if(A!=null&&!this.model.isEdge(B)){return A[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_SWIMLANE}}}return false};mxGraph.prototype.isResizeContainer=function(){return this.resizeContainer};mxGraph.prototype.setResizeContainer=function(A){this.resizeContainer=A};mxGraph.prototype.isEnabled=function(){return this.enabled};mxGraph.prototype.setEnabled=function(A){this.enabled=A};mxGraph.prototype.isEscapeEnabled=function(){return this.escapeEnabled};mxGraph.prototype.setEscapeEnabled=function(A){this.escapeEnabled=A};mxGraph.prototype.isInvokesStopCellEditing=function(){return this.invokesStopCellEditing};mxGraph.prototype.setInvokesStopCellEditing=function(A){this.invokesStopCellEditing=A};mxGraph.prototype.isEnterStopsCellEditing=function(){return this.enterStopsCellEditing};mxGraph.prototype.setEnterStopsCellEditing=function(A){this.enterStopsCellEditing=A};mxGraph.prototype.isCellLocked=function(B){var A=this.model.getGeometry(B);return this.isCellsLocked()||(A!=null&&this.model.isVertex(B)&&A.relative)};mxGraph.prototype.isCellsLocked=function(){return this.cellsLocked};mxGraph.prototype.setCellsLocked=function(A){this.cellsLocked=A};mxGraph.prototype.getCloneableCells=function(A){return this.model.filterCells(A,mxUtils.bind(this,function(B){return this.isCellCloneable(B)}))};mxGraph.prototype.isCellCloneable=function(B){var C=this.view.getState(B);var A=(C!=null)?C.style:this.getCellStyle(B);return this.isCellsCloneable()&&A[mxConstants.STYLE_CLONEABLE]!=0};mxGraph.prototype.isCellsCloneable=function(){return this.cellsCloneable};mxGraph.prototype.setCellsCloneable=function(A){this.cellsCloneable=A};mxGraph.prototype.getExportableCells=function(A){return this.model.filterCells(A,mxUtils.bind(this,function(B){return this.canExportCell(B)}))};mxGraph.prototype.canExportCell=function(A){return this.exportEnabled};mxGraph.prototype.getImportableCells=function(A){return this.model.filterCells(A,mxUtils.bind(this,function(B){return this.canImportCell(B)}))};mxGraph.prototype.canImportCell=function(A){return this.importEnabled};mxGraph.prototype.isCellSelectable=function(A){return this.isCellsSelectable()};mxGraph.prototype.isCellsSelectable=function(){return this.cellsSelectable};mxGraph.prototype.setCellsSelectable=function(A){this.cellsSelectable=A};mxGraph.prototype.getDeletableCells=function(A){return this.model.filterCells(A,mxUtils.bind(this,function(B){return this.isCellDeletable(B)}))};mxGraph.prototype.isCellDeletable=function(B){var C=this.view.getState(B);var A=(C!=null)?C.style:this.getCellStyle(B);return this.isCellsDeletable()&&A[mxConstants.STYLE_DELETABLE]!=0};mxGraph.prototype.isCellsDeletable=function(){return this.cellsDeletable};mxGraph.prototype.setCellsDeletable=function(A){this.cellsDeletable=A};mxGraph.prototype.isLabelMovable=function(A){return !this.isCellLocked(A)&&((this.model.isEdge(A)&&this.edgeLabelsMovable)||(this.model.isVertex(A)&&this.vertexLabelsMovable))};mxGraph.prototype.isCellRotatable=function(B){var C=this.view.getState(B);var A=(C!=null)?C.style:this.getCellStyle(B);return A[mxConstants.STYLE_ROTATABLE]!=0};mxGraph.prototype.getMovableCells=function(A){return this.model.filterCells(A,mxUtils.bind(this,function(B){return this.isCellMovable(B)}))};mxGraph.prototype.isCellMovable=function(B){var C=this.view.getState(B);var A=(C!=null)?C.style:this.getCellStyle(B);return this.isCellsMovable()&&!this.isCellLocked(B)&&A[mxConstants.STYLE_MOVABLE]!=0};mxGraph.prototype.isCellsMovable=function(){return this.cellsMovable};mxGraph.prototype.setCellsMovable=function(A){this.cellsMovable=A};mxGraph.prototype.isGridEnabled=function(){return this.gridEnabled};mxGraph.prototype.setGridEnabled=function(A){this.gridEnabled=A};mxGraph.prototype.isPortsEnabled=function(){return this.portsEnabled};mxGraph.prototype.setPortsEnabled=function(A){this.portsEnabled=A};mxGraph.prototype.getGridSize=function(){return this.gridSize};mxGraph.prototype.setGridSize=function(A){this.gridSize=A};mxGraph.prototype.getTolerance=function(){return this.tolerance};mxGraph.prototype.setTolerance=function(A){this.tolerance=A};mxGraph.prototype.isVertexLabelsMovable=function(){return this.vertexLabelsMovable};mxGraph.prototype.setVertexLabelsMovable=function(A){this.vertexLabelsMovable=A};mxGraph.prototype.isEdgeLabelsMovable=function(){return this.edgeLabelsMovable};mxGraph.prototype.setEdgeLabelsMovable=function(A){this.edgeLabelsMovable=A};mxGraph.prototype.isSwimlaneNesting=function(){return this.swimlaneNesting};mxGraph.prototype.setSwimlaneNesting=function(A){this.swimlaneNesting=A};mxGraph.prototype.isSwimlaneSelectionEnabled=function(){return this.swimlaneSelectionEnabled};mxGraph.prototype.setSwimlaneSelectionEnabled=function(A){this.swimlaneSelectionEnabled=A};mxGraph.prototype.isMultigraph=function(){return this.multigraph};mxGraph.prototype.setMultigraph=function(A){this.multigraph=A};mxGraph.prototype.isAllowLoops=function(){return this.allowLoops};mxGraph.prototype.setAllowDanglingEdges=function(A){this.allowDanglingEdges=A};mxGraph.prototype.isAllowDanglingEdges=function(){return this.allowDanglingEdges};mxGraph.prototype.setConnectableEdges=function(A){this.connectableEdges=A};mxGraph.prototype.isConnectableEdges=function(){return this.connectableEdges};mxGraph.prototype.setCloneInvalidEdges=function(A){this.cloneInvalidEdges=A};mxGraph.prototype.isCloneInvalidEdges=function(){return this.cloneInvalidEdges};mxGraph.prototype.setAllowLoops=function(A){this.allowLoops=A};mxGraph.prototype.isDisconnectOnMove=function(){return this.disconnectOnMove};mxGraph.prototype.setDisconnectOnMove=function(A){this.disconnectOnMove=A};mxGraph.prototype.isDropEnabled=function(){return this.dropEnabled};mxGraph.prototype.setDropEnabled=function(A){this.dropEnabled=A};mxGraph.prototype.isSplitEnabled=function(){return this.splitEnabled};mxGraph.prototype.setSplitEnabled=function(A){this.splitEnabled=A};mxGraph.prototype.isCellResizable=function(B){var C=this.view.getState(B);var A=(C!=null)?C.style:this.getCellStyle(B);return this.isCellsResizable()&&!this.isCellLocked(B)&&mxUtils.getValue(A,mxConstants.STYLE_RESIZABLE,"1")!="0"};mxGraph.prototype.isCellsResizable=function(){return this.cellsResizable};mxGraph.prototype.setCellsResizable=function(A){this.cellsResizable=A};mxGraph.prototype.isTerminalPointMovable=function(B,A){return true};mxGraph.prototype.isCellBendable=function(B){var C=this.view.getState(B);var A=(C!=null)?C.style:this.getCellStyle(B);return this.isCellsBendable()&&!this.isCellLocked(B)&&A[mxConstants.STYLE_BENDABLE]!=0};mxGraph.prototype.isCellsBendable=function(){return this.cellsBendable};mxGraph.prototype.setCellsBendable=function(A){this.cellsBendable=A};mxGraph.prototype.isCellEditable=function(B){var C=this.view.getState(B);var A=(C!=null)?C.style:this.getCellStyle(B);return this.isCellsEditable()&&!this.isCellLocked(B)&&A[mxConstants.STYLE_EDITABLE]!=0};mxGraph.prototype.isCellsEditable=function(){return this.cellsEditable};mxGraph.prototype.setCellsEditable=function(A){this.cellsEditable=A};mxGraph.prototype.isCellDisconnectable=function(B,C,A){return this.isCellsDisconnectable()&&!this.isCellLocked(B)};mxGraph.prototype.isCellsDisconnectable=function(){return this.cellsDisconnectable};mxGraph.prototype.setCellsDisconnectable=function(A){this.cellsDisconnectable=A};mxGraph.prototype.isValidSource=function(A){return(A==null&&this.allowDanglingEdges)||(A!=null&&(!this.model.isEdge(A)||this.connectableEdges)&&this.isCellConnectable(A))};mxGraph.prototype.isValidTarget=function(A){return this.isValidSource(A)};mxGraph.prototype.isValidConnection=function(A,B){return this.isValidSource(A)&&this.isValidTarget(B)};mxGraph.prototype.setConnectable=function(A){this.connectionHandler.setEnabled(A)};mxGraph.prototype.isConnectable=function(A){return this.connectionHandler.isEnabled()};mxGraph.prototype.setTooltips=function(A){this.tooltipHandler.setEnabled(A)};mxGraph.prototype.setPanning=function(A){this.panningHandler.panningEnabled=A};mxGraph.prototype.isEditing=function(B){if(this.cellEditor!=null){var A=this.cellEditor.getEditingCell();return(B==null)?A!=null:B==A}return false};mxGraph.prototype.isAutoSizeCell=function(B){var C=this.view.getState(B);var A=(C!=null)?C.style:this.getCellStyle(B);return this.isAutoSizeCells()||A[mxConstants.STYLE_AUTOSIZE]==1};mxGraph.prototype.isAutoSizeCells=function(){return this.autoSizeCells};mxGraph.prototype.setAutoSizeCells=function(A){this.autoSizeCells=A};mxGraph.prototype.isExtendParent=function(A){return !this.getModel().isEdge(A)&&this.isExtendParents()};mxGraph.prototype.isExtendParents=function(){return this.extendParents};mxGraph.prototype.setExtendParents=function(A){this.extendParents=A};mxGraph.prototype.isExtendParentsOnAdd=function(A){return this.extendParentsOnAdd};mxGraph.prototype.setExtendParentsOnAdd=function(A){this.extendParentsOnAdd=A};mxGraph.prototype.isExtendParentsOnMove=function(){return this.extendParentsOnMove};mxGraph.prototype.setExtendParentsOnMove=function(A){this.extendParentsOnMove=A};mxGraph.prototype.isRecursiveResize=function(A){return this.recursiveResize};mxGraph.prototype.setRecursiveResize=function(A){this.recursiveResize=A};mxGraph.prototype.isConstrainChild=function(A){return this.isConstrainChildren()&&!this.getModel().isEdge(this.getModel().getParent(A))};mxGraph.prototype.isConstrainChildren=function(){return this.constrainChildren};mxGraph.prototype.setConstrainChildren=function(A){this.constrainChildren=A};mxGraph.prototype.isConstrainRelativeChildren=function(){return this.constrainRelativeChildren};mxGraph.prototype.setConstrainRelativeChildren=function(A){this.constrainRelativeChildren=A};mxGraph.prototype.isAllowNegativeCoordinates=function(){return this.allowNegativeCoordinates};mxGraph.prototype.setAllowNegativeCoordinates=function(A){this.allowNegativeCoordinates=A};mxGraph.prototype.getOverlap=function(A){return(this.isAllowOverlapParent(A))?this.defaultOverlap:0};mxGraph.prototype.isAllowOverlapParent=function(A){return false};mxGraph.prototype.getFoldableCells=function(B,A){return this.model.filterCells(B,mxUtils.bind(this,function(C){return this.isCellFoldable(C,A)}))};mxGraph.prototype.isCellFoldable=function(C,A){var D=this.view.getState(C);var B=(D!=null)?D.style:this.getCellStyle(C);return this.model.getChildCount(C)>0&&B[mxConstants.STYLE_FOLDABLE]!=0};mxGraph.prototype.isValidDropTarget=function(C,B,A){return C!=null&&((this.isSplitEnabled()&&this.isSplitTarget(C,B,A))||(!this.model.isEdge(C)&&(this.isSwimlane(C)||(this.model.getChildCount(C)>0&&!this.isCellCollapsed(C)))))};mxGraph.prototype.isSplitTarget=function(E,C,B){if(this.model.isEdge(E)&&C!=null&&C.length==1&&this.isCellConnectable(C[0])&&this.getEdgeValidationError(E,this.model.getTerminal(E,true),C[0])==null){var A=this.model.getTerminal(E,true);var D=this.model.getTerminal(E,false);return(!this.model.isAncestor(C[0],A)&&!this.model.isAncestor(C[0],D))}return false};mxGraph.prototype.getDropTarget=function(G,B,I,C){if(!this.isSwimlaneNesting()){for(var E=0;E<G.length;E++){if(this.isSwimlane(G[E])){return null}}}var A=mxUtils.convertPoint(this.container,mxEvent.getClientX(B),mxEvent.getClientY(B));A.x-=this.panDx;A.y-=this.panDy;var F=this.getSwimlaneAt(A.x,A.y);if(I==null){I=F}else{if(F!=null){var D=this.model.getParent(F);while(D!=null&&this.isSwimlane(D)&&D!=I){D=this.model.getParent(D)}if(D==I){I=F}}}while(I!=null&&!this.isValidDropTarget(I,G,B)&&!this.model.isLayer(I)){I=this.model.getParent(I)}if(C==null||!C){var H=I;while(H!=null&&mxUtils.indexOf(G,H)<0){H=this.model.getParent(H)}}return(!this.model.isLayer(I)&&H==null)?I:null};mxGraph.prototype.getDefaultParent=function(){var B=this.getCurrentRoot();if(B==null){B=this.defaultParent;if(B==null){var A=this.model.getRoot();B=this.model.getChildAt(A,0)}}return B};mxGraph.prototype.setDefaultParent=function(A){this.defaultParent=A};mxGraph.prototype.getSwimlane=function(A){while(A!=null&&!this.isSwimlane(A)){A=this.model.getParent(A)}return A};mxGraph.prototype.getSwimlaneAt=function(E,F,G){G=G||this.getDefaultParent();if(G!=null){var A=this.model.getChildCount(G);for(var C=0;C<A;C++){var D=this.model.getChildAt(G,C);var B=this.getSwimlaneAt(E,F,D);if(B!=null){return B}else{if(this.isSwimlane(D)){var H=this.view.getState(D);if(this.intersects(H,E,F)){return D}}}}}return null};mxGraph.prototype.getCellAt=function(G,H,I,F,C,B){F=(F!=null)?F:true;C=(C!=null)?C:true;if(I==null){I=this.getCurrentRoot();if(I==null){I=this.getModel().getRoot()}}if(I!=null){var A=this.model.getChildCount(I);for(var E=A-1;E>=0;E--){var K=this.model.getChildAt(I,E);var D=this.getCellAt(G,H,K,F,C,B);if(D!=null){return D}else{if(this.isCellVisible(K)&&(C&&this.model.isEdge(K)||F&&this.model.isVertex(K))){var J=this.view.getState(K);if(J!=null&&(B==null||!B(J,G,H))&&this.intersects(J,G,H)){return K}}}}}return null};mxGraph.prototype.intersects=function(G,J,K){if(G!=null){var A=G.absolutePoints;if(A!=null){var L=this.tolerance*this.tolerance;var B=A[0];for(var H=1;H<A.length;H++){var M=A[H];var I=mxUtils.ptSegDistSq(B.x,B.y,M.x,M.y,J,K);if(I<=L){return true}B=M}}else{var F=mxUtils.toRadians(mxUtils.getValue(G.style,mxConstants.STYLE_ROTATION)||0);if(F!=0){var E=Math.cos(-F);var D=Math.sin(-F);var C=new mxPoint(G.getCenterX(),G.getCenterY());var B=mxUtils.getRotatedPoint(new mxPoint(J,K),E,D,C);J=B.x;K=B.y}if(mxUtils.contains(G,J,K)){return true}}}return false};mxGraph.prototype.hitsSwimlaneContent=function(B,C,D){var F=this.getView().getState(B);var A=this.getStartSize(B);if(F!=null){var E=this.getView().getScale();C-=F.x;D-=F.y;if(A.width>0&&C>0&&C>A.width*E){return true}else{if(A.height>0&&D>0&&D>A.height*E){return true}}}return false};mxGraph.prototype.getChildVertices=function(A){return this.getChildCells(A,true,false)};mxGraph.prototype.getChildEdges=function(A){return this.getChildCells(A,false,true)};mxGraph.prototype.getChildCells=function(F,D,B){F=(F!=null)?F:this.getDefaultParent();D=(D!=null)?D:false;B=(B!=null)?B:false;var E=this.model.getChildCells(F,D,B);var C=[];for(var A=0;A<E.length;A++){if(this.isCellVisible(E[A])){C.push(E[A])}}return C};mxGraph.prototype.getConnections=function(A,B){return this.getEdges(A,B,true,true,false)};mxGraph.prototype.getIncomingEdges=function(A,B){return this.getEdges(A,B,true,false,false)};mxGraph.prototype.getOutgoingEdges=function(A,B){return this.getEdges(A,B,false,true,false)};mxGraph.prototype.getEdges=function(O,M,L,A,C,K){L=(L!=null)?L:true;A=(A!=null)?A:true;C=(C!=null)?C:true;K=(K!=null)?K:false;var E=[];var B=this.isCellCollapsed(O);var G=this.model.getChildCount(O);for(var H=0;H<G;H++){var J=this.model.getChildAt(O,H);if(B||!this.isCellVisible(J)){E=E.concat(this.model.getEdges(J,L,A))}}E=E.concat(this.model.getEdges(O,L,A));var F=[];for(var H=0;H<E.length;H++){var N=this.view.getState(E[H]);var D=(N!=null)?N.getVisibleTerminal(true):this.view.getVisibleTerminal(E[H],true);var I=(N!=null)?N.getVisibleTerminal(false):this.view.getVisibleTerminal(E[H],false);if((C&&D==I)||((D!=I)&&((L&&I==O&&(M==null||this.isValidAncestor(D,M,K)))||(A&&D==O&&(M==null||this.isValidAncestor(I,M,K)))))){F.push(E[H])}}return F};mxGraph.prototype.isValidAncestor=function(B,C,A){return(A?this.model.isAncestor(C,B):this.model.getParent(B)==C)};mxGraph.prototype.getOpposites=function(A,C,E,F){E=(E!=null)?E:true;F=(F!=null)?F:true;var I=[];var B=new mxDictionary();if(A!=null){for(var D=0;D<A.length;D++){var J=this.view.getState(A[D]);var G=(J!=null)?J.getVisibleTerminal(true):this.view.getVisibleTerminal(A[D],true);var H=(J!=null)?J.getVisibleTerminal(false):this.view.getVisibleTerminal(A[D],false);if(G==C&&H!=null&&H!=C&&F){if(!B.get(H)){B.put(H,true);I.push(H)}}else{if(H==C&&G!=null&&G!=C&&E){if(!B.get(G)){B.put(G,true);I.push(G)}}}}}return I};mxGraph.prototype.getEdgesBetween=function(G,H,I){I=(I!=null)?I:false;var C=this.getEdges(G);var A=[];for(var F=0;F<C.length;F++){var E=this.view.getState(C[F]);var B=(E!=null)?E.getVisibleTerminal(true):this.view.getVisibleTerminal(C[F],true);var D=(E!=null)?E.getVisibleTerminal(false):this.view.getVisibleTerminal(C[F],false);if((B==G&&D==H)||(!I&&B==H&&D==G)){A.push(C[F])}}return A};mxGraph.prototype.getPointForEvent=function(D,F){var C=mxUtils.convertPoint(this.container,mxEvent.getClientX(D),mxEvent.getClientY(D));var B=this.view.scale;var E=this.view.translate;var A=(F!=false)?this.gridSize/2:0;C.x=this.snap(C.x/B-E.x-A);C.y=this.snap(C.y/B-E.y-A);return C};mxGraph.prototype.getCells=function(K,L,I,C,M,B){B=(B!=null)?B:[];if(I>0||C>0){var N=this.getModel();var H=K+I;var J=L+C;if(M==null){M=this.getCurrentRoot();if(M==null){M=N.getRoot()}}if(M!=null){var A=N.getChildCount(M);for(var F=0;F<A;F++){var O=N.getChildAt(M,F);var D=this.view.getState(O);if(D!=null&&this.isCellVisible(O)){var G=mxUtils.getValue(D.style,mxConstants.STYLE_ROTATION)||0;var E=D;if(G!=0){E=mxUtils.getBoundingBox(E,G)}if((N.isEdge(O)||N.isVertex(O))&&E.x>=K&&E.y+E.height<=J&&E.y>=L&&E.x+E.width<=H){B.push(O)}else{this.getCells(K,L,I,C,O,B)}}}}}return B};mxGraph.prototype.getCellsBeyond=function(C,D,I,H,E){var B=[];if(H||E){if(I==null){I=this.getDefaultParent()}if(I!=null){var A=this.model.getChildCount(I);for(var F=0;F<A;F++){var G=this.model.getChildAt(I,F);var J=this.view.getState(G);if(this.isCellVisible(G)&&J!=null){if((!H||J.x>=C)&&(!E||J.y>=D)){B.push(G)}}}}}return B};mxGraph.prototype.findTreeRoots=function(N,C,B){C=(C!=null)?C:false;B=(B!=null)?B:false;var K=[];if(N!=null){var O=this.getModel();var A=O.getChildCount(N);var H=null;var J=0;for(var I=0;I<A;I++){var P=O.getChildAt(N,I);if(this.model.isVertex(P)&&this.isCellVisible(P)){var G=this.getConnections(P,(C)?N:null);var E=0;var L=0;for(var F=0;F<G.length;F++){var D=this.view.getVisibleTerminal(G[F],true);if(D==P){E++}else{L++}}if((B&&E==0&&L>0)||(!B&&L==0&&E>0)){K.push(P)}var M=(B)?L-E:E-L;if(M>J){J=M;H=P}}}if(K.length==0&&H!=null){K.push(H)}}return K};mxGraph.prototype.traverse=function(F,J,K,E,G){if(K!=null&&F!=null){J=(J!=null)?J:true;G=G||new mxDictionary();if(!G.get(F)){G.put(F,true);var B=K(F,E);if(B==null||B){var I=this.model.getEdgeCount(F);if(I>0){for(var D=0;D<I;D++){var A=this.model.getEdgeAt(F,D);var H=this.model.getTerminal(A,true)==F;if(!J||H){var C=this.model.getTerminal(A,!H);this.traverse(C,J,K,A,G)}}}}}}};mxGraph.prototype.isCellSelected=function(A){return this.getSelectionModel().isSelected(A)};mxGraph.prototype.isSelectionEmpty=function(){return this.getSelectionModel().isEmpty()};mxGraph.prototype.clearSelection=function(){return this.getSelectionModel().clear()};mxGraph.prototype.getSelectionCount=function(){return this.getSelectionModel().cells.length};mxGraph.prototype.getSelectionCell=function(){return this.getSelectionModel().cells[0]};mxGraph.prototype.getSelectionCells=function(){return this.getSelectionModel().cells.slice()};mxGraph.prototype.setSelectionCell=function(A){this.getSelectionModel().setCell(A)};mxGraph.prototype.setSelectionCells=function(A){this.getSelectionModel().setCells(A)};mxGraph.prototype.addSelectionCell=function(A){this.getSelectionModel().addCell(A)};mxGraph.prototype.addSelectionCells=function(A){this.getSelectionModel().addCells(A)};mxGraph.prototype.removeSelectionCell=function(A){this.getSelectionModel().removeCell(A)};mxGraph.prototype.removeSelectionCells=function(A){this.getSelectionModel().removeCells(A)};mxGraph.prototype.selectRegion=function(A,C){var B=this.getCells(A.x,A.y,A.width,A.height);this.selectCellsForEvent(B,C);return B};mxGraph.prototype.selectNextCell=function(){this.selectCell(true)};mxGraph.prototype.selectPreviousCell=function(){this.selectCell()};mxGraph.prototype.selectParentCell=function(){this.selectCell(false,true)};mxGraph.prototype.selectChildCell=function(){this.selectCell(false,false,true)};mxGraph.prototype.selectCell=function(G,B,A){var E=this.selectionModel;var K=(E.cells.length>0)?E.cells[0]:null;if(E.cells.length>1){E.clear()}var J=(K!=null)?this.model.getParent(K):this.getDefaultParent();var H=this.model.getChildCount(J);if(K==null&&H>0){var C=this.model.getChildAt(J,0);this.setSelectionCell(C)}else{if((K==null||B)&&this.view.getState(J)!=null&&this.model.getGeometry(J)!=null){if(this.getCurrentRoot()!=J){this.setSelectionCell(J)}}else{if(K!=null&&A){var D=this.model.getChildCount(K);if(D>0){var C=this.model.getChildAt(K,0);this.setSelectionCell(C)}}else{if(H>0){var F=J.getIndex(K);if(G){F++;var C=this.model.getChildAt(J,F%H);this.setSelectionCell(C)}else{F--;var I=(F<0)?H-1:F;var C=this.model.getChildAt(J,I);this.setSelectionCell(C)}}}}}};mxGraph.prototype.selectAll=function(C,B){C=C||this.getDefaultParent();var A=(B)?this.model.filterDescendants(function(D){return D!=C},C):this.model.getChildren(C);if(A!=null){this.setSelectionCells(A)}};mxGraph.prototype.selectVertices=function(A){this.selectCells(true,false,A)};mxGraph.prototype.selectEdges=function(A){this.selectCells(false,true,A)};mxGraph.prototype.selectCells=function(B,A,E){E=E||this.getDefaultParent();var D=mxUtils.bind(this,function(F){return this.view.getState(F)!=null&&((this.model.getChildCount(F)==0&&this.model.isVertex(F)&&B&&!this.model.isEdge(this.model.getParent(F)))||(this.model.isEdge(F)&&A))});var C=this.model.filterDescendants(D,E);this.setSelectionCells(C)};mxGraph.prototype.selectCellForEvent=function(C,B){var A=this.isCellSelected(C);if(this.isToggleEvent(B)){if(A){this.removeSelectionCell(C)}else{this.addSelectionCell(C)}}else{if(!A||this.getSelectionCount()!=1){this.setSelectionCell(C)}}};mxGraph.prototype.selectCellsForEvent=function(B,A){if(this.isToggleEvent(A)){this.addSelectionCells(B)}else{this.setSelectionCells(B)}};mxGraph.prototype.createHandler=function(F){var B=null;if(F!=null){if(this.model.isEdge(F.cell)){var C=F.getVisibleTerminalState(true);var E=F.getVisibleTerminalState(false);var A=this.getCellGeometry(F.cell);var D=this.view.getEdgeStyle(F,(A!=null)?A.points:null,C,E);B=this.createEdgeHandler(F,D)}else{B=this.createVertexHandler(F)}}return B};mxGraph.prototype.createVertexHandler=function(A){return new mxVertexHandler(A)};mxGraph.prototype.createEdgeHandler=function(C,A){var B=null;if(A==mxEdgeStyle.Loop||A==mxEdgeStyle.ElbowConnector||A==mxEdgeStyle.SideToSide||A==mxEdgeStyle.TopToBottom){B=this.createElbowEdgeHandler(C)}else{if(A==mxEdgeStyle.SegmentConnector||A==mxEdgeStyle.OrthConnector){B=this.createEdgeSegmentHandler(C)}else{B=new mxEdgeHandler(C)}}return B};mxGraph.prototype.createEdgeSegmentHandler=function(A){return new mxEdgeSegmentHandler(A)};mxGraph.prototype.createElbowEdgeHandler=function(A){return new mxElbowEdgeHandler(A)};mxGraph.prototype.addMouseListener=function(A){if(this.mouseListeners==null){this.mouseListeners=[]}this.mouseListeners.push(A)};mxGraph.prototype.removeMouseListener=function(B){if(this.mouseListeners!=null){for(var A=0;A<this.mouseListeners.length;A++){if(this.mouseListeners[A]==B){this.mouseListeners.splice(A,1);break}}}};mxGraph.prototype.updateMouseEvent=function(B,C){if(B.graphX==null||B.graphY==null){var A=mxUtils.convertPoint(this.container,B.getX(),B.getY());B.graphX=A.x-this.panDx;B.graphY=A.y-this.panDy;if(B.getCell()==null&&this.isMouseDown&&C==mxEvent.MOUSE_MOVE){B.state=this.view.getState(this.getCellAt(A.x,A.y,null,null,null,function(D){return D.shape==null||D.shape.paintBackground!=mxRectangleShape.prototype.paintBackground||mxUtils.getValue(D.style,mxConstants.STYLE_POINTER_EVENTS,"1")=="1"||(D.shape.fill!=null&&D.shape.fill!=mxConstants.NONE)}))}}return B};mxGraph.prototype.getStateForTouchEvent=function(B){var C=mxEvent.getClientX(B);var D=mxEvent.getClientY(B);var A=mxUtils.convertPoint(this.container,C,D);return this.view.getState(this.getCellAt(A.x,A.y))};mxGraph.prototype.isEventIgnored=function(E,D,B){var A=mxEvent.isMouseEvent(D.getEvent());var C=false;if(D.getEvent()==this.lastEvent){C=true}else{this.lastEvent=D.getEvent()}if(this.eventSource!=null&&E!=mxEvent.MOUSE_MOVE){mxEvent.removeGestureListeners(this.eventSource,null,this.mouseMoveRedirect,this.mouseUpRedirect);this.mouseMoveRedirect=null;this.mouseUpRedirect=null;this.eventSource=null}else{if(this.eventSource!=null&&D.getSource()!=this.eventSource){C=true}else{if(mxClient.IS_TOUCH&&E==mxEvent.MOUSE_DOWN&&!A){this.eventSource=D.getSource();this.mouseMoveRedirect=mxUtils.bind(this,function(F){this.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(F,this.getStateForTouchEvent(F)))});this.mouseUpRedirect=mxUtils.bind(this,function(F){this.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(F,this.getStateForTouchEvent(F)))});mxEvent.addGestureListeners(this.eventSource,null,this.mouseMoveRedirect,this.mouseUpRedirect)}}}if(this.isSyntheticEventIgnored(E,D,B)){C=true}if(!mxEvent.isPopupTrigger(this.lastEvent)&&E!=mxEvent.MOUSE_MOVE&&this.lastEvent.detail==2){return true}if(E==mxEvent.MOUSE_UP&&this.isMouseDown){this.isMouseDown=false}else{if(E==mxEvent.MOUSE_DOWN&&!this.isMouseDown){this.isMouseDown=true;this.isMouseTrigger=A}else{if(!C&&(((!mxClient.IS_FF||E!=mxEvent.MOUSE_MOVE)&&this.isMouseDown&&this.isMouseTrigger!=A)||(E==mxEvent.MOUSE_DOWN&&this.isMouseDown)||(E==mxEvent.MOUSE_UP&&!this.isMouseDown))){C=true}}}if(!C&&E==mxEvent.MOUSE_DOWN){this.lastMouseX=D.getX();this.lastMouseY=D.getY()}return C};mxGraph.prototype.isSyntheticEventIgnored=function(E,D,B){var C=false;var A=mxEvent.isMouseEvent(D.getEvent());if(this.ignoreMouseEvents&&A&&E!=mxEvent.MOUSE_MOVE){this.ignoreMouseEvents=E!=mxEvent.MOUSE_UP;C=true}else{if(mxClient.IS_FF&&!A&&E==mxEvent.MOUSE_UP){this.ignoreMouseEvents=true}}return C};mxGraph.prototype.isEventSourceIgnored=function(E,C){var B=C.getSource();var D=(B.nodeName!=null)?B.nodeName.toLowerCase():"";var A=!mxEvent.isMouseEvent(C.getEvent())||mxEvent.isLeftMouseButton(C.getEvent());return E==mxEvent.MOUSE_DOWN&&A&&(D=="select"||D=="option"||(D=="input"&&B.type!="checkbox"&&B.type!="radio"&&B.type!="button"&&B.type!="submit"&&B.type!="file"))};mxGraph.prototype.getEventState=function(A){return A};mxGraph.prototype.fireMouseEvent=function(H,J,D){if(this.isEventSourceIgnored(H,J)){if(this.tooltipHandler!=null){this.tooltipHandler.hide()}return}if(D==null){D=this}J=this.updateMouseEvent(J,H);if((!this.nativeDblClickEnabled&&!mxEvent.isPopupTrigger(J.getEvent()))||(this.doubleTapEnabled&&mxClient.IS_TOUCH&&mxEvent.isTouchEvent(J.getEvent()))){var F=new Date().getTime();if((!mxClient.IS_QUIRKS&&H==mxEvent.MOUSE_DOWN)||(mxClient.IS_QUIRKS&&H==mxEvent.MOUSE_UP&&!this.fireDoubleClick)){if(this.lastTouchEvent!=null&&this.lastTouchEvent!=J.getEvent()&&F-this.lastTouchTime<this.doubleTapTimeout&&Math.abs(this.lastTouchX-J.getX())<this.doubleTapTolerance&&Math.abs(this.lastTouchY-J.getY())<this.doubleTapTolerance&&this.doubleClickCounter<2){this.doubleClickCounter++;var L=false;if(H==mxEvent.MOUSE_UP){if(J.getCell()==this.lastTouchCell&&this.lastTouchCell!=null){this.lastTouchTime=0;var M=this.lastTouchCell;this.lastTouchCell=null;if(mxClient.IS_QUIRKS){J.getSource().fireEvent("ondblclick")}this.dblClick(J.getEvent(),M);L=true}}else{this.fireDoubleClick=true;this.lastTouchTime=0}if(!mxClient.IS_QUIRKS||L){mxEvent.consume(J.getEvent());return}}else{if(this.lastTouchEvent==null||this.lastTouchEvent!=J.getEvent()){this.lastTouchCell=J.getCell();this.lastTouchX=J.getX();this.lastTouchY=J.getY();this.lastTouchTime=F;this.lastTouchEvent=J.getEvent();this.doubleClickCounter=0}}}else{if((this.isMouseDown||H==mxEvent.MOUSE_UP)&&this.fireDoubleClick){this.fireDoubleClick=false;var M=this.lastTouchCell;this.lastTouchCell=null;this.isMouseDown=false;var C=(M!=null)||(mxEvent.isTouchEvent(J.getEvent())&&(mxClient.IS_GC||mxClient.IS_SF));if(C&&Math.abs(this.lastTouchX-J.getX())<this.doubleTapTolerance&&Math.abs(this.lastTouchY-J.getY())<this.doubleTapTolerance){this.dblClick(J.getEvent(),M)}else{mxEvent.consume(J.getEvent())}return}}}if(!this.isEventIgnored(H,J,D)){J.state=this.getEventState(J.getState());this.fireEvent(new mxEventObject(mxEvent.FIRE_MOUSE_EVENT,"eventName",H,"event",J));if((mxClient.IS_OP||mxClient.IS_SF||mxClient.IS_GC||mxClient.IS_IE11||(mxClient.IS_IE&&mxClient.IS_SVG)||J.getEvent().target!=this.container)){if(H==mxEvent.MOUSE_MOVE&&this.isMouseDown&&this.autoScroll&&!mxEvent.isMultiTouchEvent(J.getEvent)){this.scrollPointToVisible(J.getGraphX(),J.getGraphY(),this.autoExtend)}else{if(H==mxEvent.MOUSE_UP&&this.ignoreScrollbars&&this.translateToScrollPosition&&(this.container.scrollLeft!=0||this.container.scrollTop!=0)){var A=this.view.scale;var K=this.view.translate;this.view.setTranslate(K.x-this.container.scrollLeft/A,K.y-this.container.scrollTop/A);this.container.scrollLeft=0;this.container.scrollTop=0}}if(this.mouseListeners!=null){var B=[D,J];if(!J.getEvent().preventDefault){J.getEvent().returnValue=true}for(var G=0;G<this.mouseListeners.length;G++){var I=this.mouseListeners[G];if(H==mxEvent.MOUSE_DOWN){I.mouseDown.apply(I,B)}else{if(H==mxEvent.MOUSE_MOVE){I.mouseMove.apply(I,B)}else{if(H==mxEvent.MOUSE_UP){I.mouseUp.apply(I,B)}}}}}if(H==mxEvent.MOUSE_UP){this.click(J)}}if(mxEvent.isTouchEvent(J.getEvent())&&H==mxEvent.MOUSE_DOWN&&this.tapAndHoldEnabled&&!this.tapAndHoldInProgress){this.tapAndHoldInProgress=true;this.initialTouchX=J.getGraphX();this.initialTouchY=J.getGraphY();var E=function(){if(this.tapAndHoldValid){this.tapAndHold(J)}this.tapAndHoldInProgress=false;this.tapAndHoldValid=false};if(this.tapAndHoldThread){window.clearTimeout(this.tapAndHoldThread)}this.tapAndHoldThread=window.setTimeout(mxUtils.bind(this,E),this.tapAndHoldDelay);this.tapAndHoldValid=true}else{if(H==mxEvent.MOUSE_UP){this.tapAndHoldInProgress=false;this.tapAndHoldValid=false}else{if(this.tapAndHoldValid){this.tapAndHoldValid=Math.abs(this.initialTouchX-J.getGraphX())<this.tolerance&&Math.abs(this.initialTouchY-J.getGraphY())<this.tolerance}}}if(H==mxEvent.MOUSE_DOWN&&this.isEditing()&&!this.cellEditor.isEventSource(J.getEvent())){this.stopEditing(!this.isInvokesStopCellEditing())}this.consumeMouseEvent(H,J,D)}};mxGraph.prototype.consumeMouseEvent=function(C,B,A){if(C==mxEvent.MOUSE_DOWN&&mxEvent.isTouchEvent(B.getEvent())){B.consume(false)}};mxGraph.prototype.fireGestureEvent=function(A,B){this.lastTouchTime=0;this.fireEvent(new mxEventObject(mxEvent.GESTURE,"event",A,"cell",B))};mxGraph.prototype.destroy=function(){if(!this.destroyed){this.destroyed=true;if(this.tooltipHandler!=null){this.tooltipHandler.destroy()}if(this.selectionCellsHandler!=null){this.selectionCellsHandler.destroy()}if(this.panningHandler!=null){this.panningHandler.destroy()}if(this.popupMenuHandler!=null){this.popupMenuHandler.destroy()}if(this.connectionHandler!=null){this.connectionHandler.destroy()}if(this.graphHandler!=null){this.graphHandler.destroy()}if(this.cellEditor!=null){this.cellEditor.destroy()}if(this.view!=null){this.view.destroy()}if(this.model!=null&&this.graphModelChangeListener!=null){this.model.removeListener(this.graphModelChangeListener);this.graphModelChangeListener=null}this.container=null}};function mxCellOverlay(C,E,D,F,B,A){this.image=C;this.tooltip=E;this.align=(D!=null)?D:this.align;this.verticalAlign=(F!=null)?F:this.verticalAlign;this.offset=(B!=null)?B:new mxPoint();this.cursor=(A!=null)?A:"help"}mxCellOverlay.prototype=new mxEventSource();mxCellOverlay.prototype.constructor=mxCellOverlay;mxCellOverlay.prototype.image=null;mxCellOverlay.prototype.tooltip=null;mxCellOverlay.prototype.align=mxConstants.ALIGN_RIGHT;mxCellOverlay.prototype.verticalAlign=mxConstants.ALIGN_BOTTOM;mxCellOverlay.prototype.offset=null;mxCellOverlay.prototype.cursor=null;mxCellOverlay.prototype.defaultOverlap=0.5;mxCellOverlay.prototype.getBounds=function(G){var H=G.view.graph.getModel().isEdge(G.cell);var C=G.view.scale;var B=null;var D=this.image.width;var F=this.image.height;if(H){var A=G.absolutePoints;if(A.length%2==1){B=A[Math.floor(A.length/2)]}else{var E=A.length/2;var J=A[E-1];var I=A[E];B=new mxPoint(J.x+(I.x-J.x)/2,J.y+(I.y-J.y)/2)}}else{B=new mxPoint();if(this.align==mxConstants.ALIGN_LEFT){B.x=G.x}else{if(this.align==mxConstants.ALIGN_CENTER){B.x=G.x+G.width/2}else{B.x=G.x+G.width}}if(this.verticalAlign==mxConstants.ALIGN_TOP){B.y=G.y}else{if(this.verticalAlign==mxConstants.ALIGN_MIDDLE){B.y=G.y+G.height/2}else{B.y=G.y+G.height}}}return new mxRectangle(Math.round(B.x-(D*this.defaultOverlap-this.offset.x)*C),Math.round(B.y-(F*this.defaultOverlap-this.offset.y)*C),D*C,F*C)};mxCellOverlay.prototype.toString=function(){return this.tooltip};function mxOutline(A,B){this.source=A;if(B!=null){this.init(B)}}mxOutline.prototype.source=null;mxOutline.prototype.outline=null;mxOutline.prototype.graphRenderHint=mxConstants.RENDERING_HINT_FASTER;mxOutline.prototype.enabled=true;mxOutline.prototype.showViewport=true;mxOutline.prototype.border=10;mxOutline.prototype.sizerSize=8;mxOutline.prototype.labelsVisible=false;mxOutline.prototype.updateOnPan=false;mxOutline.prototype.sizerImage=null;mxOutline.prototype.minScale=0.0001;mxOutline.prototype.suspended=false;mxOutline.prototype.forceVmlHandles=document.documentMode==8;mxOutline.prototype.createGraph=function(B){var A=new mxGraph(B,this.source.getModel(),this.graphRenderHint,this.source.getStylesheet());A.foldingEnabled=false;A.autoScroll=false;return A};mxOutline.prototype.init=function(C){this.outline=this.createGraph(C);var B=this.outline.graphModelChanged;this.outline.graphModelChanged=mxUtils.bind(this,function(F){if(!this.suspended&&this.outline!=null){B.apply(this.outline,arguments)}});if(mxClient.IS_SVG){var A=this.outline.getView().getCanvas().parentNode;A.setAttribute("shape-rendering","optimizeSpeed");A.setAttribute("image-rendering","optimizeSpeed")}this.outline.labelsVisible=this.labelsVisible;this.outline.setEnabled(false);this.updateHandler=mxUtils.bind(this,function(F,G){if(!this.suspended&&!this.active){this.update()}});this.source.getModel().addListener(mxEvent.CHANGE,this.updateHandler);this.outline.addMouseListener(this);var E=this.source.getView();E.addListener(mxEvent.SCALE,this.updateHandler);E.addListener(mxEvent.TRANSLATE,this.updateHandler);E.addListener(mxEvent.SCALE_AND_TRANSLATE,this.updateHandler);E.addListener(mxEvent.DOWN,this.updateHandler);E.addListener(mxEvent.UP,this.updateHandler);mxEvent.addListener(this.source.container,"scroll",this.updateHandler);this.panHandler=mxUtils.bind(this,function(F){if(this.updateOnPan){this.updateHandler.apply(this,arguments)}});this.source.addListener(mxEvent.PAN,this.panHandler);this.refreshHandler=mxUtils.bind(this,function(F){this.outline.setStylesheet(this.source.getStylesheet());this.outline.refresh()});this.source.addListener(mxEvent.REFRESH,this.refreshHandler);this.bounds=new mxRectangle(0,0,0,0);this.selectionBorder=new mxRectangleShape(this.bounds,null,mxConstants.OUTLINE_COLOR,mxConstants.OUTLINE_STROKEWIDTH);this.selectionBorder.dialect=this.outline.dialect;if(this.forceVmlHandles){this.selectionBorder.isHtmlAllowed=function(){return false}}this.selectionBorder.init(this.outline.getView().getOverlayPane());var D=mxUtils.bind(this,function(G){var H=mxEvent.getSource(G);var I=mxUtils.bind(this,function(J){this.outline.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(J))});var F=mxUtils.bind(this,function(J){mxEvent.removeGestureListeners(H,null,I,F);this.outline.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(J))});mxEvent.addGestureListeners(H,null,I,F);this.outline.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(G))});mxEvent.addGestureListeners(this.selectionBorder.node,D);this.sizer=this.createSizer();if(this.forceVmlHandles){this.sizer.isHtmlAllowed=function(){return false}}this.sizer.init(this.outline.getView().getOverlayPane());if(this.enabled){this.sizer.node.style.cursor="nwse-resize"}mxEvent.addGestureListeners(this.sizer.node,D);this.selectionBorder.node.style.display=(this.showViewport)?"":"none";this.sizer.node.style.display=this.selectionBorder.node.style.display;this.selectionBorder.node.style.cursor="move";this.update(false)};mxOutline.prototype.isEnabled=function(){return this.enabled};mxOutline.prototype.setEnabled=function(A){this.enabled=A};mxOutline.prototype.setZoomEnabled=function(A){this.sizer.node.style.visibility=(A)?"visible":"hidden"};mxOutline.prototype.refresh=function(){this.update(true)};mxOutline.prototype.createSizer=function(){if(this.sizerImage!=null){var A=new mxImageShape(new mxRectangle(0,0,this.sizerImage.width,this.sizerImage.height),this.sizerImage.src);A.dialect=this.outline.dialect;return A}else{var A=new mxRectangleShape(new mxRectangle(0,0,this.sizerSize,this.sizerSize),mxConstants.OUTLINE_HANDLE_FILLCOLOR,mxConstants.OUTLINE_HANDLE_STROKECOLOR);A.dialect=this.outline.dialect;return A}};mxOutline.prototype.getSourceContainerSize=function(){return new mxRectangle(0,0,this.source.container.scrollWidth,this.source.container.scrollHeight)};mxOutline.prototype.getOutlineOffset=function(A){return null};mxOutline.prototype.getSourceGraphBounds=function(){return this.source.getGraphBounds()};mxOutline.prototype.update=function(B){if(this.source!=null&&this.outline!=null){var N=this.source.view.scale;var O=this.getSourceGraphBounds();var T=new mxRectangle(O.x/N+this.source.panDx,O.y/N+this.source.panDy,O.width/N,O.height/N);var Q=new mxRectangle(0,0,this.source.container.clientWidth/N,this.source.container.clientHeight/N);var V=T.clone();V.add(Q);var E=this.getSourceContainerSize();var P=Math.max(E.width/N,V.width);var S=Math.max(E.height/N,V.height);var X=Math.max(0,this.outline.container.clientWidth-this.border);var W=Math.max(0,this.outline.container.clientHeight-this.border);var L=Math.min(X/P,W/S);var M=(isNaN(L))?this.minScale:Math.max(this.minScale,L);if(M>0){if(this.outline.getView().scale!=M){this.outline.getView().scale=M;B=true}var R=this.outline.getView();if(R.currentRoot!=this.source.getView().currentRoot){R.setCurrentRoot(this.source.getView().currentRoot)}var C=this.source.view.translate;var F=C.x+this.source.panDx;var I=C.y+this.source.panDy;var H=this.getOutlineOffset(M);if(H!=null){F+=H.x;I+=H.y}if(T.x<0){F=F-T.x}if(T.y<0){I=I-T.y}if(R.translate.x!=F||R.translate.y!=I){R.translate.x=F;R.translate.y=I;B=true}var A=R.translate;M=this.source.getView().scale;var U=M/R.scale;var K=1/R.scale;var J=this.source.container;this.bounds=new mxRectangle((A.x-C.x-this.source.panDx)/K,(A.y-C.y-this.source.panDy)/K,(J.clientWidth/U),(J.clientHeight/U));this.bounds.x+=this.source.container.scrollLeft*R.scale/M;this.bounds.y+=this.source.container.scrollTop*R.scale/M;var G=this.selectionBorder.bounds;if(G.x!=this.bounds.x||G.y!=this.bounds.y||G.width!=this.bounds.width||G.height!=this.bounds.height){this.selectionBorder.bounds=this.bounds;this.selectionBorder.redraw()}var G=this.sizer.bounds;var D=new mxRectangle(this.bounds.x+this.bounds.width-G.width/2,this.bounds.y+this.bounds.height-G.height/2,G.width,G.height);if(G.x!=D.x||G.y!=D.y||G.width!=D.width||G.height!=D.height){this.sizer.bounds=D;if(this.sizer.node.style.visibility!="hidden"){this.sizer.redraw()}}if(B){this.outline.view.revalidate()}}}};mxOutline.prototype.mouseDown=function(A,B){if(this.enabled&&this.showViewport){var D=(!mxEvent.isMouseEvent(B.getEvent()))?this.source.tolerance:0;var C=(this.source.allowHandleBoundsCheck&&(mxClient.IS_IE||D>0))?new mxRectangle(B.getGraphX()-D,B.getGraphY()-D,2*D,2*D):null;this.zoom=B.isSource(this.sizer)||(C!=null&&mxUtils.intersects(shape.bounds,C));this.startX=B.getX();this.startY=B.getY();this.active=true;if(this.source.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.source.container)){this.dx0=this.source.container.scrollLeft;this.dy0=this.source.container.scrollTop}else{this.dx0=0;this.dy0=0}}B.consume()};mxOutline.prototype.mouseMove=function(J,G){if(this.active){this.selectionBorder.node.style.display=(this.showViewport)?"":"none";this.sizer.node.style.display=this.selectionBorder.node.style.display;var H=this.getTranslateForEvent(G);var D=H.x;var E=H.y;var A=null;if(!this.zoom){var B=this.outline.getView().scale;A=new mxRectangle(this.bounds.x+D,this.bounds.y+E,this.bounds.width,this.bounds.height);this.selectionBorder.bounds=A;this.selectionBorder.redraw();D/=B;D*=this.source.getView().scale;E/=B;E*=this.source.getView().scale;this.source.panGraph(-D-this.dx0,-E-this.dy0)}else{var F=this.source.container;var C=F.clientWidth/F.clientHeight;E=D/C;A=new mxRectangle(this.bounds.x,this.bounds.y,Math.max(1,this.bounds.width+D),Math.max(1,this.bounds.height+E));this.selectionBorder.bounds=A;this.selectionBorder.redraw()}var I=this.sizer.bounds;this.sizer.bounds=new mxRectangle(A.x+A.width-I.width/2,A.y+A.height-I.height/2,I.width,I.height);if(this.sizer.node.style.visibility!="hidden"){this.sizer.redraw()}G.consume()}};mxOutline.prototype.getTranslateForEvent=function(A){return new mxPoint(A.getX()-this.startX,A.getY()-this.startY)};mxOutline.prototype.mouseUp=function(H,F){if(this.active){var G=this.getTranslateForEvent(F);var D=G.x;var E=G.y;if(Math.abs(D)>0||Math.abs(E)>0){if(!this.zoom){if(!this.source.useScrollbarsForPanning||!mxUtils.hasScrollbars(this.source.container)){this.source.panGraph(0,0);D/=this.outline.getView().scale;E/=this.outline.getView().scale;var C=this.source.getView().translate;this.source.getView().setTranslate(C.x-D,C.y-E)}}else{var B=this.selectionBorder.bounds.width;var A=this.source.getView().scale;this.source.zoomTo(Math.max(this.minScale,A-(D*A)/B),false)}this.update();F.consume()}this.index=null;this.active=false}};mxOutline.prototype.destroy=function(){if(this.source!=null){this.source.removeListener(this.panHandler);this.source.removeListener(this.refreshHandler);this.source.getModel().removeListener(this.updateHandler);this.source.getView().removeListener(this.updateHandler);mxEvent.addListener(this.source.container,"scroll",this.updateHandler);this.source=null}if(this.outline!=null){this.outline.removeMouseListener(this);this.outline.destroy();this.outline=null}if(this.selectionBorder!=null){this.selectionBorder.destroy();this.selectionBorder=null}if(this.sizer!=null){this.sizer.destroy();this.sizer=null}};function mxMultiplicity(G,I,D,E,B,C,H,A,F,J){this.source=G;this.type=I;this.attr=D;this.value=E;this.min=(B!=null)?B:0;this.max=(C!=null)?C:"n";this.validNeighbors=H;this.countError=mxResources.get(A)||A;this.typeError=mxResources.get(F)||F;this.validNeighborsAllowed=(J!=null)?J:true}mxMultiplicity.prototype.type=null;mxMultiplicity.prototype.attr=null;mxMultiplicity.prototype.value=null;mxMultiplicity.prototype.source=null;mxMultiplicity.prototype.min=null;mxMultiplicity.prototype.max=null;mxMultiplicity.prototype.validNeighbors=null;mxMultiplicity.prototype.validNeighborsAllowed=true;mxMultiplicity.prototype.countError=null;mxMultiplicity.prototype.typeError=null;mxMultiplicity.prototype.check=function(C,F,G,H,A,B){var D="";if((this.source&&this.checkTerminal(C,G,F))||(!this.source&&this.checkTerminal(C,H,F))){if(this.countError!=null&&((this.source&&(this.max==0||(A>=this.max)))||(!this.source&&(this.max==0||(B>=this.max))))){D+=this.countError+"\n"}if(this.validNeighbors!=null&&this.typeError!=null&&this.validNeighbors.length>0){var E=this.checkNeighbors(C,F,G,H);if(!E){D+=this.typeError+"\n"}}}return(D.length>0)?D:null};mxMultiplicity.prototype.checkNeighbors=function(B,F,G,E){var I=B.model.getValue(G);var H=B.model.getValue(E);var D=!this.validNeighborsAllowed;var A=this.validNeighbors;for(var C=0;C<A.length;C++){if(this.source&&this.checkType(B,H,A[C])){D=this.validNeighborsAllowed;break}else{if(!this.source&&this.checkType(B,I,A[C])){D=this.validNeighborsAllowed;break}}}return D};mxMultiplicity.prototype.checkTerminal=function(B,D,A){var C=B.model.getValue(D);return this.checkType(B,C,this.type,this.attr,this.value)};mxMultiplicity.prototype.checkType=function(B,D,A,E,C){if(D!=null){if(!isNaN(D.nodeType)){return mxUtils.isNode(D,A,E,C)}else{return D==A}}return false};function mxLayoutManager(A){this.undoHandler=mxUtils.bind(this,function(B,C){if(this.isEnabled()){this.beforeUndo(C.getProperty("edit"))}});this.moveHandler=mxUtils.bind(this,function(B,C){if(this.isEnabled()){this.cellsMoved(C.getProperty("cells"),C.getProperty("event"))}});this.setGraph(A)}mxLayoutManager.prototype=new mxEventSource();mxLayoutManager.prototype.constructor=mxLayoutManager;mxLayoutManager.prototype.graph=null;mxLayoutManager.prototype.bubbling=true;mxLayoutManager.prototype.enabled=true;mxLayoutManager.prototype.updateHandler=null;mxLayoutManager.prototype.moveHandler=null;mxLayoutManager.prototype.isEnabled=function(){return this.enabled};mxLayoutManager.prototype.setEnabled=function(A){this.enabled=A};mxLayoutManager.prototype.isBubbling=function(){return this.bubbling};mxLayoutManager.prototype.setBubbling=function(A){this.bubbling=A};mxLayoutManager.prototype.getGraph=function(){return this.graph};mxLayoutManager.prototype.setGraph=function(A){if(this.graph!=null){var B=this.graph.getModel();B.removeListener(this.undoHandler);this.graph.removeListener(this.moveHandler)}this.graph=A;if(this.graph!=null){var B=this.graph.getModel();B.addListener(mxEvent.BEFORE_UNDO,this.undoHandler);this.graph.addListener(mxEvent.MOVE_CELLS,this.moveHandler)}};mxLayoutManager.prototype.getLayout=function(A){return null};mxLayoutManager.prototype.beforeUndo=function(D){var C=this.getCellsForChanges(D.changes);var E=this.getGraph().getModel();var A=[];for(var B=0;B<C.length;B++){A=A.concat(E.getDescendants(C[B]))}C=A;if(this.isBubbling()){A=E.getParents(C);while(A.length>0){C=C.concat(A);A=E.getParents(A)}}this.executeLayoutForCells(C)};mxLayoutManager.prototype.executeLayoutForCells=function(B){var A=mxUtils.sortCells(B,true);A=A.concat(A.slice().reverse());this.layoutCells(A)};mxLayoutManager.prototype.cellsMoved=function(D,C){if(D!=null&&C!=null){var B=mxUtils.convertPoint(this.getGraph().container,mxEvent.getClientX(C),mxEvent.getClientY(C));var G=this.getGraph().getModel();for(var A=0;A<D.length;A++){var F=G.getParent(D[A]);if(mxUtils.indexOf(D,F)<0){var E=this.getLayout(F);if(E!=null){E.moveCell(D[A],B.x,B.y)}}}}};mxLayoutManager.prototype.getCellsForChanges=function(F){var A=new mxDictionary();var D=[];for(var B=0;B<F.length;B++){var C=F[B];if(C instanceof mxRootChange){return[]}else{var E=this.getCellsForChange(C);for(var G=0;G<E.length;G++){if(E[G]!=null&&!A.get(E[G])){A.put(E[G],true);D.push(E[G])}}}}return D};mxLayoutManager.prototype.getCellsForChange=function(A){var B=this.getGraph().getModel();if(A instanceof mxChildChange){return[A.child,A.previous,B.getParent(A.child)]}else{if(A instanceof mxTerminalChange||A instanceof mxGeometryChange){return[A.cell,B.getParent(A.cell)]}else{if(A instanceof mxVisibleChange||A instanceof mxStyleChange){return[A.cell]}}}return[]};mxLayoutManager.prototype.layoutCells=function(B){if(B.length>0){var D=this.getGraph().getModel();D.beginUpdate();try{var C=null;for(var A=0;A<B.length;A++){if(B[A]!=D.getRoot()&&B[A]!=C){if(this.executeLayout(this.getLayout(B[A]),B[A])){C=B[A]}}}this.fireEvent(new mxEventObject(mxEvent.LAYOUT_CELLS,"cells",B))}finally{D.endUpdate()}}};mxLayoutManager.prototype.executeLayout=function(B,C){var A=false;if(B!=null&&C!=null){B.execute(C);A=true}return A};mxLayoutManager.prototype.destroy=function(){this.setGraph(null)};function mxSwimlaneManager(B,C,A,D){this.horizontal=(C!=null)?C:true;this.addEnabled=(A!=null)?A:true;this.resizeEnabled=(D!=null)?D:true;this.addHandler=mxUtils.bind(this,function(E,F){if(this.isEnabled()&&this.isAddEnabled()){this.cellsAdded(F.getProperty("cells"))}});this.resizeHandler=mxUtils.bind(this,function(E,F){if(this.isEnabled()&&this.isResizeEnabled()){this.cellsResized(F.getProperty("cells"))}});this.setGraph(B)}mxSwimlaneManager.prototype=new mxEventSource();mxSwimlaneManager.prototype.constructor=mxSwimlaneManager;mxSwimlaneManager.prototype.graph=null;mxSwimlaneManager.prototype.enabled=true;mxSwimlaneManager.prototype.horizontal=true;mxSwimlaneManager.prototype.addEnabled=true;mxSwimlaneManager.prototype.resizeEnabled=true;mxSwimlaneManager.prototype.addHandler=null;mxSwimlaneManager.prototype.resizeHandler=null;mxSwimlaneManager.prototype.isEnabled=function(){return this.enabled};mxSwimlaneManager.prototype.setEnabled=function(A){this.enabled=A};mxSwimlaneManager.prototype.isHorizontal=function(){return this.horizontal};mxSwimlaneManager.prototype.setHorizontal=function(A){this.horizontal=A};mxSwimlaneManager.prototype.isAddEnabled=function(){return this.addEnabled};mxSwimlaneManager.prototype.setAddEnabled=function(A){this.addEnabled=A};mxSwimlaneManager.prototype.isResizeEnabled=function(){return this.resizeEnabled};mxSwimlaneManager.prototype.setResizeEnabled=function(A){this.resizeEnabled=A};mxSwimlaneManager.prototype.getGraph=function(){return this.graph};mxSwimlaneManager.prototype.setGraph=function(A){if(this.graph!=null){this.graph.removeListener(this.addHandler);this.graph.removeListener(this.resizeHandler)}this.graph=A;if(this.graph!=null){this.graph.addListener(mxEvent.ADD_CELLS,this.addHandler);this.graph.addListener(mxEvent.CELLS_RESIZED,this.resizeHandler)}};mxSwimlaneManager.prototype.isSwimlaneIgnored=function(A){return !this.getGraph().isSwimlane(A)};mxSwimlaneManager.prototype.isCellHorizontal=function(B){if(this.graph.isSwimlane(B)){var A=this.graph.getCellStyle(B);return mxUtils.getValue(A,mxConstants.STYLE_HORIZONTAL,1)==1}return !this.isHorizontal()};mxSwimlaneManager.prototype.cellsAdded=function(B){if(B!=null){var C=this.getGraph().getModel();C.beginUpdate();try{for(var A=0;A<B.length;A++){if(!this.isSwimlaneIgnored(B[A])){this.swimlaneAdded(B[A])}}}finally{C.endUpdate()}}};mxSwimlaneManager.prototype.swimlaneAdded=function(D){var G=this.getGraph().getModel();var C=G.getParent(D);var A=G.getChildCount(C);var F=null;for(var B=0;B<A;B++){var E=G.getChildAt(C,B);if(E!=D&&!this.isSwimlaneIgnored(E)){F=G.getGeometry(E);if(F!=null){break}}}if(F!=null){var H=(C!=null)?this.isCellHorizontal(C):this.horizontal;this.resizeSwimlane(D,F.width,F.height,H)}};mxSwimlaneManager.prototype.cellsResized=function(F){if(F!=null){var H=this.getGraph().getModel();H.beginUpdate();try{for(var E=0;E<F.length;E++){if(!this.isSwimlaneIgnored(F[E])){var G=H.getGeometry(F[E]);if(G!=null){var D=new mxRectangle(0,0,G.width,G.height);var C=F[E];var A=C;while(A!=null){C=A;A=H.getParent(A);var B=(this.graph.isSwimlane(A))?this.graph.getStartSize(A):new mxRectangle();D.width+=B.width;D.height+=B.height}var I=(A!=null)?this.isCellHorizontal(A):this.horizontal;this.resizeSwimlane(C,D.width,D.height,I)}}}}finally{H.endUpdate()}}};mxSwimlaneManager.prototype.resizeSwimlane=function(F,B,D,K){var J=this.getGraph().getModel();J.beginUpdate();try{var H=this.isCellHorizontal(F);if(!this.isSwimlaneIgnored(F)){var I=J.getGeometry(F);if(I!=null){if((K&&I.height!=D)||(!K&&I.width!=B)){I=I.clone();if(K){I.height=D}else{I.width=B}J.setGeometry(F,I)}}}var C=(this.graph.isSwimlane(F))?this.graph.getStartSize(F):new mxRectangle();B-=C.width;D-=C.height;var A=J.getChildCount(F);for(var E=0;E<A;E++){var G=J.getChildAt(F,E);this.resizeSwimlane(G,B,D,H)}}finally{J.endUpdate()}};mxSwimlaneManager.prototype.destroy=function(){this.setGraph(null)};function mxTemporaryCellStates(A,C,G,E){C=(C!=null)?C:1;this.view=A;this.oldValidateCellState=A.validateCellState;this.oldBounds=A.getGraphBounds();this.oldStates=A.getStates();this.oldScale=A.getScale();var F=this;A.validateCellState=function(J,I){if(J==null||E==null||E(J)){return F.oldValidateCellState.apply(A,arguments)}return null};A.setStates(new mxDictionary());A.setScale(C);if(G!=null){A.resetValidationState();var H=null;for(var D=0;D<G.length;D++){var B=A.getBoundingBox(A.validateCellState(A.validateCell(G[D])));if(H==null){H=B}else{H.add(B)}}A.setGraphBounds(H||new mxRectangle())}}mxTemporaryCellStates.prototype.view=null;mxTemporaryCellStates.prototype.oldStates=null;mxTemporaryCellStates.prototype.oldBounds=null;mxTemporaryCellStates.prototype.oldScale=null;mxTemporaryCellStates.prototype.destroy=function(){this.view.setScale(this.oldScale);this.view.setStates(this.oldStates);this.view.setGraphBounds(this.oldBounds);this.view.validateCellState=this.oldValidateCellState};function mxCellStatePreview(A){this.deltas=new mxDictionary();this.graph=A}mxCellStatePreview.prototype.graph=null;mxCellStatePreview.prototype.deltas=null;mxCellStatePreview.prototype.count=0;mxCellStatePreview.prototype.isEmpty=function(){return this.count==0};mxCellStatePreview.prototype.moveState=function(F,B,D,E,C){E=(E!=null)?E:true;C=(C!=null)?C:true;var A=this.deltas.get(F.cell);if(A==null){A={point:new mxPoint(B,D),state:F};this.deltas.put(F.cell,A);this.count++}else{if(E){A.point.x+=B;A.point.y+=D}else{A.point.x=B;A.point.y=D}}if(C){this.addEdges(F)}return A.point};mxCellStatePreview.prototype.show=function(A){this.deltas.visit(mxUtils.bind(this,function(B,C){this.translateState(C.state,C.point.x,C.point.y)}));this.deltas.visit(mxUtils.bind(this,function(B,C){this.revalidateState(C.state,C.point.x,C.point.y,A)}))};mxCellStatePreview.prototype.translateState=function(G,D,E){if(G!=null){var F=this.graph.getModel();if(F.isVertex(G.cell)){G.view.updateCellState(G);var B=F.getGeometry(G.cell);if((D!=0||E!=0)&&B!=null&&(!B.relative||this.deltas.get(G.cell)!=null)){G.x+=D;G.y+=E}}var A=F.getChildCount(G.cell);for(var C=0;C<A;C++){this.translateState(G.view.getState(F.getChildAt(G.cell,C)),D,E)}}};mxCellStatePreview.prototype.revalidateState=function(D,G,E,H){if(D!=null){var I=this.graph.getModel();if(I.isEdge(D.cell)){D.view.updateCellState(D)}var C=this.graph.getCellGeometry(D.cell);var B=D.view.getState(I.getParent(D.cell));if((G!=0||E!=0)&&C!=null&&C.relative&&I.isVertex(D.cell)&&(B==null||I.isVertex(B.cell)||this.deltas.get(D.cell)!=null)){D.x+=G;D.y+=E}this.graph.cellRenderer.redraw(D);if(H!=null){H(D)}var A=I.getChildCount(D.cell);for(var F=0;F<A;F++){this.revalidateState(this.graph.view.getState(I.getChildAt(D.cell,F)),G,E,H)}}};mxCellStatePreview.prototype.addEdges=function(E){var D=this.graph.getModel();var C=D.getEdgeCount(E.cell);for(var A=0;A<C;A++){var B=E.view.getState(D.getEdgeAt(E.cell,A));if(B!=null){this.moveState(B,0,0)}}};function mxConnectionConstraint(B,A,C){this.point=B;this.perimeter=(A!=null)?A:true;this.name=C}mxConnectionConstraint.prototype.point=null;mxConnectionConstraint.prototype.perimeter=null;mxConnectionConstraint.prototype.name=null;