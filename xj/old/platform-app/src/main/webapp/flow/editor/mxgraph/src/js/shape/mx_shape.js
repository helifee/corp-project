function mxStencil(A){this.desc=A;this.parseDescription();this.parseConstraints()}mxStencil.defaultLocalized=false;mxStencil.allowEval=false;mxStencil.prototype.desc=null;mxStencil.prototype.constraints=null;mxStencil.prototype.aspect=null;mxStencil.prototype.w0=null;mxStencil.prototype.h0=null;mxStencil.prototype.bgNode=null;mxStencil.prototype.fgNode=null;mxStencil.prototype.strokewidth=null;mxStencil.prototype.parseDescription=function(){this.fgNode=this.desc.getElementsByTagName("foreground")[0];this.bgNode=this.desc.getElementsByTagName("background")[0];this.w0=Number(this.desc.getAttribute("w")||100);this.h0=Number(this.desc.getAttribute("h")||100);var B=this.desc.getAttribute("aspect");this.aspect=(B!=null)?B:"variable";var A=this.desc.getAttribute("strokewidth");this.strokewidth=(A!=null)?A:"1"};mxStencil.prototype.parseConstraints=function(){var C=this.desc.getElementsByTagName("connections")[0];if(C!=null){var A=mxUtils.getChildNodes(C);if(A!=null&&A.length>0){this.constraints=[];for(var B=0;B<A.length;B++){this.constraints.push(this.parseConstraint(A[B]))}}}};mxStencil.prototype.parseConstraint=function(B){var D=Number(B.getAttribute("x"));var E=Number(B.getAttribute("y"));var A=B.getAttribute("perimeter")=="1";var C=B.getAttribute("name");return new mxConnectionConstraint(new mxPoint(D,E),A,C)};mxStencil.prototype.evaluateTextAttribute=function(C,A,E){var B=this.evaluateAttribute(C,A,E);var D=C.getAttribute("localized");if((mxStencil.defaultLocalized&&D==null)||D=="1"){B=mxResources.get(B)}return B};mxStencil.prototype.evaluateAttribute=function(node,attribute,shape){var result=node.getAttribute(attribute);if(result==null){var text=mxUtils.getTextContent(node);if(text!=null&&mxStencil.allowEval){var funct=mxUtils.eval(text);if(typeof(funct)=="function"){result=funct(shape)}}}return result};mxStencil.prototype.drawShape=function(B,D,I,J,E,G){var A=mxUtils.getValue(D.style,mxConstants.STYLE_DIRECTION,null);var H=this.computeAspect(D.style,I,J,E,G,A);var F=Math.min(H.width,H.height);var C=(this.strokewidth=="inherit")?Number(mxUtils.getNumber(D.style,mxConstants.STYLE_STROKEWIDTH,1)):Number(this.strokewidth)*F;B.setStrokeWidth(C);this.drawChildren(B,D,I,J,E,G,this.bgNode,H,false);this.drawChildren(B,D,I,J,E,G,this.fgNode,H,true)};mxStencil.prototype.drawChildren=function(A,B,I,J,D,F,G,H,E){if(G!=null&&D>0&&F>0){var C=G.firstChild;while(C!=null){if(C.nodeType==mxConstants.NODETYPE_ELEMENT){this.drawNode(A,B,C,H,E)}C=C.nextSibling}}};mxStencil.prototype.computeAspect=function(B,I,J,D,E,A){var C=I;var H=J;var F=D/this.w0;var G=E/this.h0;var K=(A==mxConstants.DIRECTION_NORTH||A==mxConstants.DIRECTION_SOUTH);if(K){G=D/this.h0;F=E/this.w0;var L=(D-E)/2;C+=L;H-=L}if(this.aspect=="fixed"){G=Math.min(F,G);F=G;if(K){C+=(E-this.w0*F)/2;H+=(D-this.h0*G)/2}else{C+=(D-this.w0*F)/2;H+=(E-this.h0*G)/2}}return new mxRectangle(C,H,F,G)};mxStencil.prototype.drawNode=function(E,P,V,B,a){var d=V.nodeName;var K=B.x;var L=B.y;var Z=B.width;var J=B.height;var R=Math.min(Z,J);if(d=="save"){E.save()}else{if(d=="restore"){E.restore()}else{if(d=="path"){E.begin();var D=V.firstChild;while(D!=null){if(D.nodeType==mxConstants.NODETYPE_ELEMENT){this.drawNode(E,P,D,B,a)}D=D.nextSibling}}else{if(d=="close"){E.close()}else{if(d=="move"){E.moveTo(K+Number(V.getAttribute("x"))*Z,L+Number(V.getAttribute("y"))*J)}else{if(d=="line"){E.lineTo(K+Number(V.getAttribute("x"))*Z,L+Number(V.getAttribute("y"))*J)}else{if(d=="quad"){E.quadTo(K+Number(V.getAttribute("x1"))*Z,L+Number(V.getAttribute("y1"))*J,K+Number(V.getAttribute("x2"))*Z,L+Number(V.getAttribute("y2"))*J)}else{if(d=="curve"){E.curveTo(K+Number(V.getAttribute("x1"))*Z,L+Number(V.getAttribute("y1"))*J,K+Number(V.getAttribute("x2"))*Z,L+Number(V.getAttribute("y2"))*J,K+Number(V.getAttribute("x3"))*Z,L+Number(V.getAttribute("y3"))*J)}else{if(d=="arc"){E.arcTo(Number(V.getAttribute("rx"))*Z,Number(V.getAttribute("ry"))*J,Number(V.getAttribute("x-axis-rotation")),Number(V.getAttribute("large-arc-flag")),Number(V.getAttribute("sweep-flag")),K+Number(V.getAttribute("x"))*Z,L+Number(V.getAttribute("y"))*J)}else{if(d=="rect"){E.rect(K+Number(V.getAttribute("x"))*Z,L+Number(V.getAttribute("y"))*J,Number(V.getAttribute("w"))*Z,Number(V.getAttribute("h"))*J)}else{if(d=="roundrect"){var T=Number(V.getAttribute("arcsize"));if(T==0){T=mxConstants.RECTANGLE_ROUNDING_FACTOR*100}var C=Number(V.getAttribute("w"))*Z;var G=Number(V.getAttribute("h"))*J;var F=Number(T)/100;var A=Math.min(C*F,G*F);E.roundrect(K+Number(V.getAttribute("x"))*Z,L+Number(V.getAttribute("y"))*J,C,G,A,A)}else{if(d=="ellipse"){E.ellipse(K+Number(V.getAttribute("x"))*Z,L+Number(V.getAttribute("y"))*J,Number(V.getAttribute("w"))*Z,Number(V.getAttribute("h"))*J)}else{if(d=="image"){if(!P.outline){var N=this.evaluateAttribute(V,"src",P);E.image(K+Number(V.getAttribute("x"))*Z,L+Number(V.getAttribute("y"))*J,Number(V.getAttribute("w"))*Z,Number(V.getAttribute("h"))*J,N,false,V.getAttribute("flipH")=="1",V.getAttribute("flipV")=="1")}}else{if(d=="text"){if(!P.outline){var I=this.evaluateTextAttribute(V,"str",P);var M=V.getAttribute("vertical")=="1"?-90:0;if(V.getAttribute("align-shape")=="0"){var e=P.rotation;var O=mxUtils.getValue(P.style,mxConstants.STYLE_FLIPH,0)==1;var W=mxUtils.getValue(P.style,mxConstants.STYLE_FLIPV,0)==1;if(O&&W){M-=e}else{if(O||W){M+=e}else{M-=e}}}M-=V.getAttribute("rotation");E.text(K+Number(V.getAttribute("x"))*Z,L+Number(V.getAttribute("y"))*J,0,0,I,V.getAttribute("align")||"left",V.getAttribute("valign")||"top",false,"",null,false,M)}}else{if(d=="include-shape"){var Y=mxStencilRegistry.getStencil(V.getAttribute("name"));if(Y!=null){var b=K+Number(V.getAttribute("x"))*Z;var c=L+Number(V.getAttribute("y"))*J;var C=Number(V.getAttribute("w"))*Z;var G=Number(V.getAttribute("h"))*J;Y.drawShape(E,P,b,c,C,G)}}else{if(d=="fillstroke"){E.fillAndStroke()}else{if(d=="fill"){E.fill()}else{if(d=="stroke"){E.stroke()}else{if(d=="strokewidth"){var S=(V.getAttribute("fixed")=="1")?1:R;E.setStrokeWidth(Number(V.getAttribute("width"))*S)}else{if(d=="dashed"){E.setDashed(V.getAttribute("dashed")=="1")}else{if(d=="dashpattern"){var Q=V.getAttribute("pattern");if(Q!=null){var X=Q.split(" ");var U=[];for(var H=0;H<X.length;H++){if(X[H].length>0){U.push(Number(X[H])*R)}}Q=U.join(" ");E.setDashPattern(Q)}}else{if(d=="strokecolor"){E.setStrokeColor(V.getAttribute("color"))}else{if(d=="linecap"){E.setLineCap(V.getAttribute("cap"))}else{if(d=="linejoin"){E.setLineJoin(V.getAttribute("join"))}else{if(d=="miterlimit"){E.setMiterLimit(Number(V.getAttribute("limit")))}else{if(d=="fillcolor"){E.setFillColor(V.getAttribute("color"))}else{if(d=="alpha"){E.setAlpha(V.getAttribute("alpha"))}else{if(d=="fontcolor"){E.setFontColor(V.getAttribute("color"))}else{if(d=="fontstyle"){E.setFontStyle(V.getAttribute("style"))}else{if(d=="fontfamily"){E.setFontFamily(V.getAttribute("family"))}else{if(d=="fontsize"){E.setFontSize(Number(V.getAttribute("size"))*R)}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}if(a&&(d=="fillstroke"||d=="fill"||d=="stroke")){a=false;E.setShadow(false)}};function mxShape(A){this.stencil=A;this.initStyles()}mxShape.prototype.dialect=null;mxShape.prototype.scale=1;mxShape.prototype.antiAlias=true;mxShape.prototype.bounds=null;mxShape.prototype.points=null;mxShape.prototype.node=null;mxShape.prototype.state=null;mxShape.prototype.style=null;mxShape.prototype.boundingBox=null;mxShape.prototype.stencil=null;mxShape.prototype.svgStrokeTolerance=8;mxShape.prototype.pointerEvents=true;mxShape.prototype.svgPointerEvents="all";mxShape.prototype.shapePointerEvents=false;mxShape.prototype.stencilPointerEvents=false;mxShape.prototype.vmlScale=1;mxShape.prototype.outline=false;mxShape.prototype.visible=true;mxShape.prototype.useSvgBoundingBox=false;mxShape.prototype.init=function(A){if(this.node==null){this.node=this.create(A);if(A!=null){A.appendChild(this.node)}}};mxShape.prototype.initStyles=function(A){this.strokewidth=1;this.rotation=0;this.opacity=100;this.fillOpacity=100;this.strokeOpacity=100;this.flipH=false;this.flipV=false};mxShape.prototype.isParseVml=function(){return true};mxShape.prototype.isHtmlAllowed=function(){return false};mxShape.prototype.getSvgScreenOffset=function(){var A=this.stencil&&this.stencil.strokewidth!="inherit"?Number(this.stencil.strokewidth):this.strokewidth;return(mxUtils.mod(Math.max(1,Math.round(A*this.scale)),2)==1)?0.5:0};mxShape.prototype.create=function(B){var A=null;if(B!=null&&B.ownerSVGElement!=null){A=this.createSvg(B)}else{if(document.documentMode==8||!mxClient.IS_VML||(this.dialect!=mxConstants.DIALECT_VML&&this.isHtmlAllowed())){A=this.createHtml(B)}else{A=this.createVml(B)}}return A};mxShape.prototype.createSvg=function(){return document.createElementNS(mxConstants.NS_SVG,"g")};mxShape.prototype.createVml=function(){var A=document.createElement(mxClient.VML_PREFIX+":group");A.style.position="absolute";return A};mxShape.prototype.createHtml=function(){var A=document.createElement("div");A.style.position="absolute";return A};mxShape.prototype.reconfigure=function(){this.redraw()};mxShape.prototype.redraw=function(){this.updateBoundsFromPoints();if(this.visible&&this.checkBounds()){this.node.style.visibility="visible";this.clear();if(this.node.nodeName=="DIV"&&(this.isHtmlAllowed()||!mxClient.IS_VML)){this.redrawHtmlShape()}else{this.redrawShape()}this.updateBoundingBox()}else{this.node.style.visibility="hidden";this.boundingBox=null}};mxShape.prototype.clear=function(){if(this.node.ownerSVGElement!=null){while(this.node.lastChild!=null){this.node.removeChild(this.node.lastChild)}}else{this.node.style.cssText="position:absolute;"+((this.cursor!=null)?("cursor:"+this.cursor+";"):"");this.node.innerHTML=""}};mxShape.prototype.updateBoundsFromPoints=function(){var B=this.points;if(B!=null&&B.length>0&&B[0]!=null){this.bounds=new mxRectangle(Number(B[0].x),Number(B[0].y),1,1);for(var A=1;A<this.points.length;A++){if(B[A]!=null){this.bounds.add(new mxRectangle(Number(B[A].x),Number(B[A].y),1,1))}}}};mxShape.prototype.getLabelBounds=function(A){return A};mxShape.prototype.checkBounds=function(){return(!isNaN(this.scale)&&isFinite(this.scale)&&this.scale>0&&this.bounds!=null&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)&&this.bounds.width>0&&this.bounds.height>0)};mxShape.prototype.createVmlGroup=function(){var A=document.createElement(mxClient.VML_PREFIX+":group");A.style.position="absolute";A.style.width=this.node.style.width;A.style.height=this.node.style.height;return A};mxShape.prototype.redrawShape=function(){var A=this.createCanvas();if(A!=null){A.pointerEvents=this.pointerEvents;this.paint(A);if(this.node!=A.root){this.node.insertAdjacentHTML("beforeend",A.root.outerHTML)}if(this.node.nodeName=="DIV"&&document.documentMode==8){this.node.style.filter="";mxUtils.addTransparentBackgroundFilter(this.node)}this.destroyCanvas(A)}};mxShape.prototype.createCanvas=function(){var A=null;if(this.node.ownerSVGElement!=null){A=this.createSvgCanvas()}else{if(mxClient.IS_VML){this.updateVmlContainer();A=this.createVmlCanvas()}}if(A!=null&&this.outline){A.setStrokeWidth(this.strokewidth);A.setStrokeColor(this.stroke);if(this.isDashed!=null){A.setDashed(this.isDashed)}A.setStrokeWidth=function(){};A.setStrokeColor=function(){};A.setFillColor=function(){};A.setGradient=function(){};A.setDashed=function(){}}return A};mxShape.prototype.createSvgCanvas=function(){var B=new mxSvgCanvas2D(this.node,false);B.strokeTolerance=(this.pointerEvents)?this.svgStrokeTolerance:0;B.pointerEventsValue=this.svgPointerEvents;B.blockImagePointerEvents=mxClient.IS_FF;var A=this.getSvgScreenOffset();if(A!=0){this.node.setAttribute("transform","translate("+A+","+A+")")}else{this.node.removeAttribute("transform")}if(!this.antiAlias){B.format=function(C){return Math.round(parseFloat(C))}}return B};mxShape.prototype.createVmlCanvas=function(){var C=(document.documentMode==8&&this.isParseVml())?this.createVmlGroup():this.node;var D=new mxVmlCanvas2D(C,false);if(C.tagUrn!=""){var E=Math.max(1,Math.round(this.bounds.width));var A=Math.max(1,Math.round(this.bounds.height));C.coordsize=(E*this.vmlScale)+","+(A*this.vmlScale);D.scale(this.vmlScale);D.vmlScale=this.vmlScale}var B=this.scale;D.translate(-Math.round(this.bounds.x/B),-Math.round(this.bounds.y/B));return D};mxShape.prototype.updateVmlContainer=function(){this.node.style.left=Math.round(this.bounds.x)+"px";this.node.style.top=Math.round(this.bounds.y)+"px";var B=Math.max(1,Math.round(this.bounds.width));var A=Math.max(1,Math.round(this.bounds.height));this.node.style.width=B+"px";this.node.style.height=A+"px";this.node.style.overflow="visible"};mxShape.prototype.redrawHtmlShape=function(){this.updateHtmlBounds(this.node);this.updateHtmlFilters(this.node);this.updateHtmlColors(this.node)};mxShape.prototype.updateHtmlFilters=function(E){var H="";if(this.opacity<100){H+="alpha(opacity="+(this.opacity)+")"}if(this.isShadow){H+="progid:DXImageTransform.Microsoft.dropShadow (OffX='"+Math.round(mxConstants.SHADOW_OFFSET_X*this.scale)+"', OffY='"+Math.round(mxConstants.SHADOW_OFFSET_Y*this.scale)+"', Color='"+mxConstants.VML_SHADOWCOLOR+"')"}if(this.fill!=null&&this.fill!=mxConstants.NONE&&this.gradient&&this.gradient!=mxConstants.NONE){var A=this.fill;var B=this.gradient;var G="0";var F={east:0,south:1,west:2,north:3};var C=(this.direction!=null)?F[this.direction]:0;if(this.gradientDirection!=null){C=mxUtils.mod(C+F[this.gradientDirection]-1,4)}if(C==1){G="1";var D=A;A=B;B=D}else{if(C==2){var D=A;A=B;B=D}else{if(C==3){G="1"}}}H+="progid:DXImageTransform.Microsoft.gradient(startColorStr='"+A+"', endColorStr='"+B+"', gradientType='"+G+"')"}E.style.filter=H};mxShape.prototype.updateHtmlColors=function(A){var B=this.stroke;if(B!=null&&B!=mxConstants.NONE){A.style.borderColor=B;if(this.isDashed){A.style.borderStyle="dashed"}else{if(this.strokewidth>0){A.style.borderStyle="solid"}}A.style.borderWidth=Math.max(1,Math.ceil(this.strokewidth*this.scale))+"px"}else{A.style.borderWidth="0px"}B=(this.outline)?null:this.fill;if(B!=null&&B!=mxConstants.NONE){A.style.backgroundColor=B;A.style.backgroundImage="none"}else{if(this.pointerEvents){A.style.backgroundColor="transparent"}else{if(document.documentMode==8){mxUtils.addTransparentBackgroundFilter(A)}else{this.setTransparentBackgroundImage(A)}}}};mxShape.prototype.updateHtmlBounds=function(B){var A=(document.documentMode>=9)?0:Math.ceil(this.strokewidth*this.scale);B.style.borderWidth=Math.max(1,A)+"px";B.style.overflow="hidden";B.style.left=Math.round(this.bounds.x-A/2)+"px";B.style.top=Math.round(this.bounds.y-A/2)+"px";if(document.compatMode=="CSS1Compat"){A=-A}B.style.width=Math.round(Math.max(0,this.bounds.width+A))+"px";B.style.height=Math.round(Math.max(0,this.bounds.height+A))+"px"};mxShape.prototype.destroyCanvas=function(B){if(B instanceof mxSvgCanvas2D){for(var A in B.gradients){var C=B.gradients[A];if(C!=null){C.mxRefCount=(C.mxRefCount||0)+1}}this.releaseSvgGradients(this.oldGradients);this.oldGradients=B.gradients}};mxShape.prototype.paint=function(K){var B=this.scale;var M=this.bounds.x/B;var L=this.bounds.y/B;var E=this.bounds.width/B;var H=this.bounds.height/B;if(this.isPaintBoundsInverted()){var F=(E-H)/2;M+=F;L-=F;var G=E;E=H;H=G}this.updateTransform(K,M,L,E,H);this.configureCanvas(K,M,L,E,H);var A=null;if((this.stencil==null&&this.points==null&&this.shapePointerEvents)||(this.stencil!=null&&this.stencilPointerEvents)){var C=this.createBoundingBox();if(this.dialect==mxConstants.DIALECT_SVG){A=this.createTransparentSvgRectangle(C.x,C.y,C.width,C.height);this.node.appendChild(A)}else{var D=K.createRect("rect",C.x/B,C.y/B,C.width/B,C.height/B);D.appendChild(K.createTransparentFill());D.stroked="false";K.root.appendChild(D)}}if(this.stencil!=null){this.stencil.drawShape(K,this,M,L,E,H)}else{K.setStrokeWidth(this.strokewidth);if(this.points!=null){var J=[];for(var I=0;I<this.points.length;I++){if(this.points[I]!=null){J.push(new mxPoint(this.points[I].x/B,this.points[I].y/B))}}this.paintEdgeShape(K,J)}else{this.paintVertexShape(K,M,L,E,H)}}if(A!=null&&K.state!=null&&K.state.transform!=null){A.setAttribute("transform",K.state.transform)}};mxShape.prototype.configureCanvas=function(D,C,E,F,A){var G=null;if(this.style!=null){G=this.style["dashPattern"]}D.setAlpha(this.opacity/100);D.setFillAlpha(this.fillOpacity/100);D.setStrokeAlpha(this.strokeOpacity/100);if(this.isShadow!=null){D.setShadow(this.isShadow)}if(this.isDashed!=null){D.setDashed(this.isDashed)}if(G!=null){D.setDashPattern(G)}if(this.fill!=null&&this.fill!=mxConstants.NONE&&this.gradient&&this.gradient!=mxConstants.NONE){var B=this.getGradientBounds(D,C,E,F,A);D.setGradient(this.fill,this.gradient,B.x,B.y,B.width,B.height,this.gradientDirection)}else{D.setFillColor(this.fill)}D.setStrokeColor(this.stroke)};mxShape.prototype.getGradientBounds=function(C,B,D,E,A){return new mxRectangle(B,D,E,A)};mxShape.prototype.updateTransform=function(C,B,D,E,A){C.scale(this.scale);C.rotate(this.getShapeRotation(),this.flipH,this.flipV,B+E/2,D+A/2)};mxShape.prototype.paintVertexShape=function(C,B,D,E,A){this.paintBackground(C,B,D,E,A);C.setShadow(false);this.paintForeground(C,B,D,E,A)};mxShape.prototype.paintBackground=function(C,B,D,E,A){};mxShape.prototype.paintForeground=function(C,B,D,E,A){};mxShape.prototype.paintEdgeShape=function(A,B){};mxShape.prototype.getArcSize=function(B,A){var C=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100;return Math.min(B*C,A*C)};mxShape.prototype.paintGlassEffect=function(F,H,G,C,E,D){var A=Math.ceil(this.strokewidth/2);var B=0.4;F.setGradient("#ffffff","#ffffff",H,G,C,E*0.6,"south",0.9,0.1);F.begin();D+=2*A;if(this.isRounded){F.moveTo(H-A+D,G-A);F.quadTo(H-A,G-A,H-A,G-A+D);F.lineTo(H-A,G+E*B);F.quadTo(H+C*0.5,G+E*0.7,H+C+A,G+E*B);F.lineTo(H+C+A,G-A+D);F.quadTo(H+C+A,G-A,H+C+A-D,G-A)}else{F.moveTo(H-A,G-A);F.lineTo(H-A,G+E*B);F.quadTo(H+C*0.5,G+E*0.7,H+C+A,G+E*B);F.lineTo(H+C+A,G-A)}F.close();F.fill()};mxShape.prototype.addPoints=function(G,Q,J,M,I){var A=Q[Q.length-1];if(I&&J){Q=Q.slice();var K=Q[0];var L=new mxPoint(A.x+(K.x-A.x)/2,A.y+(K.y-A.y)/2);Q.splice(0,0,L)}var T=Q[0];var D=1;G.moveTo(T.x,T.y);while(D<((I)?Q.length:Q.length-1)){var B=Q[mxUtils.mod(D,Q.length)];var F=T.x-B.x;var R=T.y-B.y;if(J&&(F!=0||R!=0)){var O=Math.sqrt(F*F+R*R);var S=F*Math.min(M,O/2)/O;var E=R*Math.min(M,O/2)/O;var H=B.x+S;var C=B.y+E;G.lineTo(H,C);var N=Q[mxUtils.mod(D+1,Q.length)];while(D<Q.length-2&&Math.round(N.x-B.x)==0&&Math.round(N.y-B.y)==0){N=Q[mxUtils.mod(D+2,Q.length)];D++}F=N.x-B.x;R=N.y-B.y;O=Math.max(1,Math.sqrt(F*F+R*R));var U=F*Math.min(M,O/2)/O;var P=R*Math.min(M,O/2)/O;var V=B.x+U;var W=B.y+P;G.quadTo(B.x,B.y,V,W);B=new mxPoint(V,W)}else{G.lineTo(B.x,B.y)}T=B;D++}if(I){G.close()}else{G.lineTo(A.x,A.y)}};mxShape.prototype.resetStyles=function(){this.initStyles();this.spacing=0;delete this.fill;delete this.gradient;delete this.gradientDirection;delete this.stroke;delete this.startSize;delete this.endSize;delete this.startArrow;delete this.endArrow;delete this.direction;delete this.isShadow;delete this.isDashed;delete this.isRounded;delete this.glass};mxShape.prototype.apply=function(B){this.state=B;this.style=B.style;if(this.style!=null){this.fill=mxUtils.getValue(this.style,mxConstants.STYLE_FILLCOLOR,this.fill);this.gradient=mxUtils.getValue(this.style,mxConstants.STYLE_GRADIENTCOLOR,this.gradient);this.gradientDirection=mxUtils.getValue(this.style,mxConstants.STYLE_GRADIENT_DIRECTION,this.gradientDirection);this.opacity=mxUtils.getValue(this.style,mxConstants.STYLE_OPACITY,this.opacity);this.fillOpacity=mxUtils.getValue(this.style,mxConstants.STYLE_FILL_OPACITY,this.fillOpacity);this.strokeOpacity=mxUtils.getValue(this.style,mxConstants.STYLE_STROKE_OPACITY,this.strokeOpacity);this.stroke=mxUtils.getValue(this.style,mxConstants.STYLE_STROKECOLOR,this.stroke);this.strokewidth=mxUtils.getNumber(this.style,mxConstants.STYLE_STROKEWIDTH,this.strokewidth);this.arrowStrokewidth=mxUtils.getNumber(this.style,mxConstants.STYLE_STROKEWIDTH,this.strokewidth);this.spacing=mxUtils.getValue(this.style,mxConstants.STYLE_SPACING,this.spacing);this.startSize=mxUtils.getNumber(this.style,mxConstants.STYLE_STARTSIZE,this.startSize);this.endSize=mxUtils.getNumber(this.style,mxConstants.STYLE_ENDSIZE,this.endSize);this.startArrow=mxUtils.getValue(this.style,mxConstants.STYLE_STARTARROW,this.startArrow);this.endArrow=mxUtils.getValue(this.style,mxConstants.STYLE_ENDARROW,this.endArrow);this.rotation=mxUtils.getValue(this.style,mxConstants.STYLE_ROTATION,this.rotation);this.direction=mxUtils.getValue(this.style,mxConstants.STYLE_DIRECTION,this.direction);this.flipH=mxUtils.getValue(this.style,mxConstants.STYLE_FLIPH,0)==1;this.flipV=mxUtils.getValue(this.style,mxConstants.STYLE_FLIPV,0)==1;if(this.stencil!=null){this.flipH=mxUtils.getValue(this.style,"stencilFlipH",0)==1||this.flipH;this.flipV=mxUtils.getValue(this.style,"stencilFlipV",0)==1||this.flipV}if(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH){var A=this.flipH;this.flipH=this.flipV;this.flipV=A}this.isShadow=mxUtils.getValue(this.style,mxConstants.STYLE_SHADOW,this.isShadow)==1;this.isDashed=mxUtils.getValue(this.style,mxConstants.STYLE_DASHED,this.isDashed)==1;this.isRounded=mxUtils.getValue(this.style,mxConstants.STYLE_ROUNDED,this.isRounded)==1;this.glass=mxUtils.getValue(this.style,mxConstants.STYLE_GLASS,this.glass)==1;if(this.fill==mxConstants.NONE){this.fill=null}if(this.gradient==mxConstants.NONE){this.gradient=null}if(this.stroke==mxConstants.NONE){this.stroke=null}}};mxShape.prototype.setCursor=function(A){if(A==null){A=""}this.cursor=A;if(this.node!=null){this.node.style.cursor=A}};mxShape.prototype.getCursor=function(){return this.cursor};mxShape.prototype.updateBoundingBox=function(){if(this.useSvgBoundingBox&&this.node!=null&&this.node.ownerSVGElement!=null){try{var C=this.node.getBBox();if(C.width>0&&C.height>0){this.boundingBox=new mxRectangle(C.x,C.y,C.width,C.height);this.boundingBox.grow(this.strokewidth*this.scale/2);return}}catch(B){}}if(this.bounds!=null){var D=this.createBoundingBox();if(D!=null){this.augmentBoundingBox(D);var A=this.getShapeRotation();if(A!=0){D=mxUtils.getBoundingBox(D,A)}}this.boundingBox=D}};mxShape.prototype.createBoundingBox=function(){var A=this.bounds.clone();if((this.stencil!=null&&(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH))||this.isPaintBoundsInverted()){A.rotate90()}return A};mxShape.prototype.augmentBoundingBox=function(A){if(this.isShadow){A.width+=Math.ceil(mxConstants.SHADOW_OFFSET_X*this.scale);A.height+=Math.ceil(mxConstants.SHADOW_OFFSET_Y*this.scale)}A.grow(this.strokewidth*this.scale/2)};mxShape.prototype.isPaintBoundsInverted=function(){return this.stencil==null&&(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH)};mxShape.prototype.getRotation=function(){return(this.rotation!=null)?this.rotation:0};mxShape.prototype.getTextRotation=function(){var A=this.getRotation();if(mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,1)!=1){A+=mxText.prototype.verticalTextRotation}return A};mxShape.prototype.getShapeRotation=function(){var A=this.getRotation();if(this.direction!=null){if(this.direction==mxConstants.DIRECTION_NORTH){A+=270}else{if(this.direction==mxConstants.DIRECTION_WEST){A+=180}else{if(this.direction==mxConstants.DIRECTION_SOUTH){A+=90}}}}return A};mxShape.prototype.createTransparentSvgRectangle=function(C,D,E,A){var B=document.createElementNS(mxConstants.NS_SVG,"rect");B.setAttribute("x",C);B.setAttribute("y",D);B.setAttribute("width",E);B.setAttribute("height",A);B.setAttribute("fill","none");B.setAttribute("stroke","none");B.setAttribute("pointer-events","all");return B};mxShape.prototype.setTransparentBackgroundImage=function(A){A.style.backgroundImage="url('"+mxClient.imageBasePath+"/transparent.gif')"};mxShape.prototype.releaseSvgGradients=function(B){if(B!=null){for(var A in B){var C=B[A];if(C!=null){C.mxRefCount=(C.mxRefCount||0)-1;if(C.mxRefCount==0&&C.parentNode!=null){C.parentNode.removeChild(C)}}}}};mxShape.prototype.destroy=function(){if(this.node!=null){mxEvent.release(this.node);if(this.node.parentNode!=null){this.node.parentNode.removeChild(this.node)}this.node=null}this.releaseSvgGradients(this.oldGradients);this.oldGradients=null};var mxStencilRegistry={stencils:{},addStencil:function(A,B){mxStencilRegistry.stencils[A]=B},getStencil:function(A){return mxStencilRegistry.stencils[A]}};var mxMarker={markers:[],addMarker:function(A,B){mxMarker.markers[A]=B},createMarker:function(A,C,H,B,J,K,F,G,E,D){var I=mxMarker.markers[H];return(I!=null)?I(A,C,H,B,J,K,F,G,E,D):null}};(function(){function B(D){D=(D!=null)?D:2;return function(F,H,N,G,P,Q,L,M,J,I){var R=P*J*1.118;var O=Q*J*1.118;P=P*(L+J);Q=Q*(L+J);var E=G.clone();E.x-=R;E.y-=O;var K=(N!=mxConstants.ARROW_CLASSIC&&N!=mxConstants.ARROW_CLASSIC_THIN)?1:3/4;G.x+=-P*K-R;G.y+=-Q*K-O;return function(){F.begin();F.moveTo(E.x,E.y);F.lineTo(E.x-P-Q/D,E.y-Q+P/D);if(N==mxConstants.ARROW_CLASSIC||N==mxConstants.ARROW_CLASSIC_THIN){F.lineTo(E.x-P*3/4,E.y-Q*3/4)}F.lineTo(E.x+Q/D-P,E.y-Q-P/D);F.close();if(I){F.fillAndStroke()}else{F.stroke()}}}}mxMarker.addMarker("classic",B(2));mxMarker.addMarker("classicThin",B(3));mxMarker.addMarker("block",B(2));mxMarker.addMarker("blockThin",B(3));function C(D){D=(D!=null)?D:2;return function(F,H,M,G,O,P,K,L,J,I){var Q=O*J*1.118;var N=P*J*1.118;O=O*(K+J);P=P*(K+J);var E=G.clone();E.x-=Q;E.y-=N;G.x+=-Q*2;G.y+=-N*2;return function(){F.begin();F.moveTo(E.x-O-P/D,E.y-P+O/D);F.lineTo(E.x,E.y);F.lineTo(E.x+P/D-O,E.y-P-O/D);F.stroke()}}}mxMarker.addMarker("open",C(2));mxMarker.addMarker("openThin",C(3));mxMarker.addMarker("oval",function(E,G,L,F,N,O,J,K,I,H){var M=J/2;var D=F.clone();F.x-=N*M;F.y-=O*M;return function(){E.ellipse(D.x-M,D.y-M,J,J);if(H){E.fillAndStroke()}else{E.stroke()}}});function A(E,G,N,F,P,Q,K,L,I,H){var M=(N==mxConstants.ARROW_DIAMOND)?0.7071:0.9862;var R=P*I*M;var O=Q*I*M;P=P*(K+I);Q=Q*(K+I);var D=F.clone();D.x-=R;D.y-=O;F.x+=-P-R;F.y+=-Q-O;var J=((N==mxConstants.ARROW_DIAMOND)?2:3.4);return function(){E.begin();E.moveTo(D.x,D.y);E.lineTo(D.x-P/2-Q/J,D.y+P/J-Q/2);E.lineTo(D.x-P,D.y-Q);E.lineTo(D.x-P/2+Q/J,D.y-Q/2-P/J);E.close();if(H){E.fillAndStroke()}else{E.stroke()}}}mxMarker.addMarker("diamond",A);mxMarker.addMarker("diamondThin",A)})();function mxActor(B,A,C,D){mxShape.call(this);this.bounds=B;this.fill=A;this.stroke=C;this.strokewidth=(D!=null)?D:1}mxUtils.extend(mxActor,mxShape);mxActor.prototype.paintVertexShape=function(C,B,D,E,A){C.translate(B,D);C.begin();this.redrawPath(C,B,D,E,A);C.fillAndStroke()};mxActor.prototype.redrawPath=function(D,C,E,F,A){var B=F/3;D.moveTo(0,A);D.curveTo(0,3*A/5,0,2*A/5,F/2,2*A/5);D.curveTo(F/2-B,2*A/5,F/2-B,0,F/2,0);D.curveTo(F/2+B,0,F/2+B,2*A/5,F/2,2*A/5);D.curveTo(F,2*A/5,F,3*A/5,F,A);D.close()};function mxCloud(B,A,C,D){mxActor.call(this);this.bounds=B;this.fill=A;this.stroke=C;this.strokewidth=(D!=null)?D:1}mxUtils.extend(mxCloud,mxActor);mxCloud.prototype.redrawPath=function(C,B,D,E,A){C.moveTo(0.25*E,0.25*A);C.curveTo(0.05*E,0.25*A,0,0.5*A,0.16*E,0.55*A);C.curveTo(0,0.66*A,0.18*E,0.9*A,0.31*E,0.8*A);C.curveTo(0.4*E,A,0.7*E,A,0.8*E,0.8*A);C.curveTo(E,0.8*A,E,0.6*A,0.875*E,0.5*A);C.curveTo(E,0.3*A,0.8*E,0.1*A,0.625*E,0.2*A);C.curveTo(0.5*E,0.05*A,0.3*E,0.05*A,0.25*E,0.25*A);C.close()};function mxRectangleShape(B,A,C,D){mxShape.call(this);this.bounds=B;this.fill=A;this.stroke=C;this.strokewidth=(D!=null)?D:1}mxUtils.extend(mxRectangleShape,mxShape);mxRectangleShape.prototype.isHtmlAllowed=function(){var A=true;if(this.style!=null){A=mxUtils.getValue(this.style,mxConstants.STYLE_POINTER_EVENTS,"1")=="1"}return !this.isRounded&&!this.glass&&this.rotation==0&&(A||(this.fill!=null&&this.fill!=mxConstants.NONE))};mxRectangleShape.prototype.paintBackground=function(F,A,G,C,E){var D=true;if(this.style!=null){D=mxUtils.getValue(this.style,mxConstants.STYLE_POINTER_EVENTS,"1")=="1"}if(D||(this.fill!=null&&this.fill!=mxConstants.NONE)||(this.stroke!=null&&this.stroke!=mxConstants.NONE)){if(!D&&(this.fill==null||this.fill==mxConstants.NONE)){F.pointerEvents=false}if(this.isRounded){var H=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100;var B=Math.min(C*H,E*H);F.roundrect(A,G,C,E,B,B)}else{F.rect(A,G,C,E)}F.fillAndStroke()}};mxRectangleShape.prototype.paintForeground=function(C,B,D,E,A){if(this.glass&&!this.outline&&this.fill!=null&&this.fill!=mxConstants.NONE){this.paintGlassEffect(C,B,D,E,A,this.getArcSize(E+this.strokewidth,A+this.strokewidth))}};function mxEllipse(B,A,C,D){mxShape.call(this);this.bounds=B;this.fill=A;this.stroke=C;this.strokewidth=(D!=null)?D:1}mxUtils.extend(mxEllipse,mxShape);mxEllipse.prototype.paintVertexShape=function(C,B,D,E,A){C.ellipse(B,D,E,A);C.fillAndStroke()};function mxDoubleEllipse(B,A,C,D){mxShape.call(this);this.bounds=B;this.fill=A;this.stroke=C;this.strokewidth=(D!=null)?D:1}mxUtils.extend(mxDoubleEllipse,mxShape);mxDoubleEllipse.prototype.vmlScale=10;mxDoubleEllipse.prototype.paintBackground=function(C,B,D,E,A){C.ellipse(B,D,E,A);C.fillAndStroke()};mxDoubleEllipse.prototype.paintForeground=function(D,C,E,F,A){if(!this.outline){var B=mxUtils.getValue(this.style,mxConstants.STYLE_MARGIN,Math.min(3+this.strokewidth,Math.min(F/5,A/5)));C+=B;E+=B;F-=2*B;A-=2*B;if(F>0&&A>0){D.ellipse(C,E,F,A)}D.stroke()}};mxDoubleEllipse.prototype.getLabelBounds=function(B){var A=(mxUtils.getValue(this.style,mxConstants.STYLE_MARGIN,Math.min(3+this.strokewidth,Math.min(B.width/5/this.scale,B.height/5/this.scale))))*this.scale;return new mxRectangle(B.x+A,B.y+A,B.width-2*A,B.height-2*A)};function mxRhombus(B,A,C,D){mxShape.call(this);this.bounds=B;this.fill=A;this.stroke=C;this.strokewidth=(D!=null)?D:1}mxUtils.extend(mxRhombus,mxShape);mxRhombus.prototype.paintVertexShape=function(E,H,F,B,C){var D=B/2;var A=C/2;var G=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;E.begin();this.addPoints(E,[new mxPoint(H+D,F),new mxPoint(H+B,F+A),new mxPoint(H+D,F+C),new mxPoint(H,F+A)],this.isRounded,G,true);E.fillAndStroke()};function mxPolyline(C,B,A){mxShape.call(this);this.points=C;this.stroke=B;this.strokewidth=(A!=null)?A:1}mxUtils.extend(mxPolyline,mxShape);mxPolyline.prototype.getRotation=function(){return 0};mxPolyline.prototype.getShapeRotation=function(){return 0};mxPolyline.prototype.isPaintBoundsInverted=function(){return false};mxPolyline.prototype.paintEdgeShape=function(A,B){if(this.style==null||this.style[mxConstants.STYLE_CURVED]!=1){this.paintLine(A,B,this.isRounded)}else{this.paintCurvedLine(A,B)}};mxPolyline.prototype.paintLine=function(C,D,B){var A=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;C.begin();this.addPoints(C,D,B,A,false);C.stroke()};mxPolyline.prototype.paintCurvedLine=function(H,A){H.begin();var B=A[0];var I=A.length;H.moveTo(B.x,B.y);for(var E=1;E<I-2;E++){var G=A[E];var F=A[E+1];var D=(G.x+F.x)/2;var C=(G.y+F.y)/2;H.quadTo(G.x,G.y,D,C)}var G=A[I-2];var F=A[I-1];H.quadTo(G.x,G.y,F.x,F.y);H.stroke()};function mxArrow(E,A,D,F,B,G,C){mxShape.call(this);this.points=E;this.fill=A;this.stroke=D;this.strokewidth=(F!=null)?F:1;this.arrowWidth=(B!=null)?B:mxConstants.ARROW_WIDTH;this.spacing=(G!=null)?G:mxConstants.ARROW_SPACING;this.endSize=(C!=null)?C:mxConstants.ARROW_SIZE}mxUtils.extend(mxArrow,mxShape);mxArrow.prototype.augmentBoundingBox=function(B){mxShape.prototype.augmentBoundingBox.apply(this,arguments);var A=Math.max(this.arrowWidth,this.endSize);B.grow((A/2+this.strokewidth)*this.scale)};mxArrow.prototype.paintEdgeShape=function(K,S){var E=mxConstants.ARROW_SPACING;var Z=mxConstants.ARROW_WIDTH;var Q=mxConstants.ARROW_SIZE;var L=S[0];var N=S[S.length-1];var G=N.x-L.x;var T=N.y-L.y;var R=Math.sqrt(G*G+T*T);var A=R-2*E-Q;var C=G/R;var O=T/R;var X=A*C;var J=A*O;var D=Z*O/3;var W=-Z*C/3;var F=L.x-D/2+E*C;var a=L.y-W/2+E*O;var U=F+D;var V=a+W;var M=U+X;var Y=V+J;var I=M+D;var H=Y+W;var B=I-3*D;var P=H-3*W;K.begin();K.moveTo(F,a);K.lineTo(U,V);K.lineTo(M,Y);K.lineTo(I,H);K.lineTo(N.x-E*C,N.y-E*O);K.lineTo(B,P);K.lineTo(B+D,P+W);K.close();K.fillAndStroke()};function mxArrowConnector(E,A,D,F,B,G,C){mxShape.call(this);this.points=E;this.fill=A;this.stroke=D;this.strokewidth=(F!=null)?F:1;this.arrowWidth=(B!=null)?B:mxConstants.ARROW_WIDTH;this.arrowSpacing=(G!=null)?G:mxConstants.ARROW_SPACING;this.startSize=mxConstants.ARROW_SIZE/5;this.endSize=mxConstants.ARROW_SIZE/5}mxUtils.extend(mxArrowConnector,mxShape);mxArrowConnector.prototype.useSvgBoundingBox=true;mxArrowConnector.prototype.resetStyles=function(){mxShape.prototype.resetStyles.apply(this,arguments);this.arrowSpacing=mxConstants.ARROW_SPACING};mxArrowConnector.prototype.apply=function(A){mxShape.prototype.apply.apply(this,arguments);if(this.style!=null){this.startSize=mxUtils.getNumber(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.ARROW_SIZE/5)*3;this.endSize=mxUtils.getNumber(this.style,mxConstants.STYLE_ENDSIZE,mxConstants.ARROW_SIZE/5)*3}};mxArrowConnector.prototype.augmentBoundingBox=function(B){mxShape.prototype.augmentBoundingBox.apply(this,arguments);var A=this.getEdgeWidth();if(this.isMarkerStart()){A=Math.max(A,this.getStartArrowWidth())}if(this.isMarkerEnd()){A=Math.max(A,this.getEndArrowWidth())}B.grow((A/2+this.strokewidth)*this.scale)};mxArrowConnector.prototype.paintEdgeShape=function(z,E){var D=this.strokewidth;if(this.outline){D=Math.max(1,mxUtils.getNumber(this.style,mxConstants.STYLE_STROKEWIDTH,this.strokewidth))}var C=this.getStartArrowWidth()+D;var Aa=this.getEndArrowWidth()+D;var Ab=this.outline?this.getEdgeWidth()+D:this.getEdgeWidth();var F=this.isOpenEnded();var B=this.isMarkerStart();var R=this.isMarkerEnd();var Y=(F)?0:this.arrowSpacing+D/2;var T=this.startSize+D;var o=this.endSize+D;var I=this.isArrowRounded();var m=E[E.length-1];var e=1;while(e<E.length-1&&E[e].x==E[0].x&&E[e].y==E[0].y){e++}var p=E[e].x-E[0].x;var g=E[e].y-E[0].y;var h=Math.sqrt(p*p+g*g);if(h==0){return}var k=p/h;var W,V=k;var X=g/h;var P,n=X;var w=Ab*X;var v=-Ab*k;var O=[];if(I){z.setLineJoin("round")}else{if(E.length>2){z.setMiterLimit(1.42)}}z.begin();var U=k;var Q=X;if(B&&!F){this.paintMarker(z,E[0].x,E[0].y,k,X,T,C,Ab,Y,true)}else{var r=E[0].x+w/2+Y*k;var q=E[0].y+v/2+Y*X;var x=E[0].x-w/2+Y*k;var S=E[0].y-v/2+Y*X;if(F){z.moveTo(r,q);O.push(function(){z.lineTo(x,S)})}else{z.moveTo(x,S);z.lineTo(r,q)}}var b=0;var N=0;var f=0;for(var u=0;u<E.length-2;u++){var H=mxUtils.relativeCcw(E[u].x,E[u].y,E[u+1].x,E[u+1].y,E[u+2].x,E[u+2].y);b=E[u+2].x-E[u+1].x;N=E[u+2].y-E[u+1].y;f=Math.sqrt(b*b+N*N);if(f!=0){V=b/f;n=N/f;var G=k*V+X*n;tmp=Math.max(Math.sqrt((G+1)/2),0.04);W=(k+V);P=(X+n);var j=Math.sqrt(W*W+P*P);if(j!=0){W=W/j;P=P/j;var A=Math.max(tmp,Math.min(this.strokewidth/200+0.04,0.35));var M=(H!=0&&I)?Math.max(0.1,A):Math.max(tmp,0.06);var s=E[u+1].x+P*Ab/2/M;var a=E[u+1].y-W*Ab/2/M;var Z=E[u+1].x-P*Ab/2/M;var l=E[u+1].y+W*Ab/2/M;if(H==0||!I){z.lineTo(s,a);(function(c,i){O.push(function(){z.lineTo(c,i)})})(Z,l)}else{if(H==-1){var J=Z+X*Ab;var d=l-k*Ab;var y=Z+n*Ab;var L=l-V*Ab;z.lineTo(J,d);z.quadTo(s,a,y,L);(function(c,i){O.push(function(){z.lineTo(c,i)})})(Z,l)}else{z.lineTo(s,a);(function(Ac,Ad){var Af=s-X*Ab;var Ae=a+k*Ab;var i=s-n*Ab;var c=a+V*Ab;O.push(function(){z.quadTo(Ac,Ad,Af,Ae)});O.push(function(){z.lineTo(i,c)})})(Z,l)}}k=V;X=n}}}w=Ab*n;v=-Ab*V;if(R&&!F){this.paintMarker(z,m.x,m.y,-k,-X,o,Aa,Ab,Y,false)}else{z.lineTo(m.x-Y*V+w/2,m.y-Y*n+v/2);var t=m.x-Y*V-w/2;var K=m.y-Y*n-v/2;if(!F){z.lineTo(t,K)}else{z.moveTo(t,K);O.splice(0,0,function(){z.moveTo(t,K)})}}for(var u=O.length-1;u>=0;u--){O[u]()}if(F){z.end();z.stroke()}else{z.close();z.fillAndStroke()}z.setShadow(false);z.setMiterLimit(4);if(I){z.setLineJoin("flat")}if(E.length>2){z.setMiterLimit(4);if(B&&!F){z.begin();this.paintMarker(z,E[0].x,E[0].y,U,Q,T,C,Ab,Y,true);z.stroke();z.end()}if(R&&!F){z.begin();this.paintMarker(z,m.x,m.y,-k,-X,o,Aa,Ab,Y,true);z.stroke();z.end()}}};mxArrowConnector.prototype.paintMarker=function(L,F,G,E,B,H,K,C,I,M){var N=C/K;var O=C*B/2;var A=-C*E/2;var D=(I+H)*E;var J=(I+H)*B;if(M){L.moveTo(F-O+D,G-A+J)}else{L.lineTo(F-O+D,G-A+J)}L.lineTo(F-O/N+D,G-A/N+J);L.lineTo(F+I*E,G+I*B);L.lineTo(F+O/N+D,G+A/N+J);L.lineTo(F+O+D,G+A+J)};mxArrowConnector.prototype.isArrowRounded=function(){return this.isRounded};mxArrowConnector.prototype.getStartArrowWidth=function(){return mxConstants.ARROW_WIDTH};mxArrowConnector.prototype.getEndArrowWidth=function(){return mxConstants.ARROW_WIDTH};mxArrowConnector.prototype.getEdgeWidth=function(){return mxConstants.ARROW_WIDTH/3};mxArrowConnector.prototype.isOpenEnded=function(){return false};mxArrowConnector.prototype.isMarkerStart=function(){return(mxUtils.getValue(this.style,mxConstants.STYLE_STARTARROW,mxConstants.NONE)!=mxConstants.NONE)};mxArrowConnector.prototype.isMarkerEnd=function(){return(mxUtils.getValue(this.style,mxConstants.STYLE_ENDARROW,mxConstants.NONE)!=mxConstants.NONE)};function mxText(S,N,E,H,A,Q,F,O,D,M,R,B,C,I,T,G,U,J,P,L,K){mxShape.call(this);this.value=S;this.bounds=N;this.color=(A!=null)?A:"black";this.align=(E!=null)?E:mxConstants.ALIGN_CENTER;this.valign=(H!=null)?H:mxConstants.ALIGN_MIDDLE;this.family=(Q!=null)?Q:mxConstants.DEFAULT_FONTFAMILY;this.size=(F!=null)?F:mxConstants.DEFAULT_FONTSIZE;this.fontStyle=(O!=null)?O:mxConstants.DEFAULT_FONTSTYLE;this.spacing=parseInt(D||2);this.spacingTop=this.spacing+parseInt(M||0);this.spacingRight=this.spacing+parseInt(R||0);this.spacingBottom=this.spacing+parseInt(B||0);this.spacingLeft=this.spacing+parseInt(C||0);this.horizontal=(I!=null)?I:true;this.background=T;this.border=G;this.wrap=(U!=null)?U:false;this.clipped=(J!=null)?J:false;this.overflow=(P!=null)?P:"visible";this.labelPadding=(L!=null)?L:0;this.textDirection=K;this.rotation=0;this.updateMargin()}mxUtils.extend(mxText,mxShape);mxText.prototype.baseSpacingTop=0;mxText.prototype.baseSpacingBottom=0;mxText.prototype.baseSpacingLeft=0;mxText.prototype.baseSpacingRight=0;mxText.prototype.replaceLinefeeds=true;mxText.prototype.verticalTextRotation=-90;mxText.prototype.ignoreClippedStringSize=true;mxText.prototype.ignoreStringSize=false;mxText.prototype.textWidthPadding=(document.documentMode==8&&!mxClient.IS_EM)?4:3;mxText.prototype.lastValue=null;mxText.prototype.cacheEnabled=true;mxText.prototype.isParseVml=function(){return false};mxText.prototype.isHtmlAllowed=function(){return document.documentMode!=8||mxClient.IS_EM};mxText.prototype.getSvgScreenOffset=function(){return 0};mxText.prototype.checkBounds=function(){return(!isNaN(this.scale)&&isFinite(this.scale)&&this.scale>0&&this.bounds!=null&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height))};mxText.prototype.paint=function(J,F){var B=this.scale;var L=this.bounds.x/B;var K=this.bounds.y/B;var D=this.bounds.width/B;var G=this.bounds.height/B;this.updateTransform(J,L,K,D,G);this.configureCanvas(J,L,K,D,G);if(F){var A=(this.state!=null)?this.state.unscaledWidth:null;if(this.node.firstChild!=null&&this.lastUnscaledWidth!=A){J.invalidateCachedOffsetSize(this.node)}J.updateText(L,K,D,G,this.align,this.valign,this.wrap,this.overflow,this.clipped,this.getTextRotation(),this.node)}else{var E=mxUtils.isNode(this.value)||this.dialect==mxConstants.DIALECT_STRICTHTML;var I=(E||J instanceof mxVmlCanvas2D)?"html":"";var H=this.value;if(!E&&I=="html"){H=mxUtils.htmlEntities(H,false)}if(I=="html"&&!mxUtils.isNode(this.value)){H=mxUtils.replaceTrailingNewlines(H,"<div><br></div>")}H=(!mxUtils.isNode(this.value)&&this.replaceLinefeeds&&I=="html")?H.replace(/\n/g,"<br/>"):H;var C=this.textDirection;if(C==mxConstants.TEXT_DIRECTION_AUTO&&!E){C=this.getAutoDirection()}if(C!=mxConstants.TEXT_DIRECTION_LTR&&C!=mxConstants.TEXT_DIRECTION_RTL){C=null}J.text(L,K,D,G,H,this.align,this.valign,this.wrap,I,this.overflow,this.clipped,this.getTextRotation(),C)}this.lastUnscaledWidth=(this.state!=null)?this.state.unscaledWidth:null};mxText.prototype.redraw=function(){if(this.visible&&this.checkBounds()&&this.cacheEnabled&&this.lastValue==this.value&&(mxUtils.isNode(this.value)||this.dialect==mxConstants.DIALECT_STRICTHTML)){if(this.node.nodeName=="DIV"&&(this.isHtmlAllowed()||!mxClient.IS_VML)){this.updateSize(this.node,(this.state==null||this.state.view.textDiv==null));if(mxClient.IS_IE&&(document.documentMode==null||document.documentMode<=8)){this.updateHtmlFilter()}else{this.updateHtmlTransform()}this.updateBoundingBox()}else{var A=this.createCanvas();if(A!=null&&A.updateText!=null&&A.invalidateCachedOffsetSize!=null){this.paint(A,true);this.destroyCanvas(A);this.updateBoundingBox()}else{mxShape.prototype.redraw.apply(this,arguments)}}}else{mxShape.prototype.redraw.apply(this,arguments);if(mxUtils.isNode(this.value)||this.dialect==mxConstants.DIALECT_STRICTHTML){this.lastValue=this.value}else{this.lastValue=null}}};mxText.prototype.resetStyles=function(){mxShape.prototype.resetStyles.apply(this,arguments);this.color="black";this.align=mxConstants.ALIGN_CENTER;this.valign=mxConstants.ALIGN_MIDDLE;this.family=mxConstants.DEFAULT_FONTFAMILY;this.size=mxConstants.DEFAULT_FONTSIZE;this.fontStyle=mxConstants.DEFAULT_FONTSTYLE;this.spacing=2;this.spacingTop=0;this.spacingRight=0;this.spacingBottom=0;this.spacingLeft=0;this.horizontal=true;delete this.background;delete this.border;this.textDirection=mxConstants.DEFAULT_TEXT_DIRECTION;delete this.margin};mxText.prototype.apply=function(A){mxShape.prototype.apply.apply(this,arguments);if(this.style!=null){this.fontStyle=mxUtils.getValue(this.style,mxConstants.STYLE_FONTSTYLE,this.fontStyle);this.family=mxUtils.getValue(this.style,mxConstants.STYLE_FONTFAMILY,this.family);this.size=mxUtils.getValue(this.style,mxConstants.STYLE_FONTSIZE,this.size);this.color=mxUtils.getValue(this.style,mxConstants.STYLE_FONTCOLOR,this.color);this.align=mxUtils.getValue(this.style,mxConstants.STYLE_ALIGN,this.align);this.valign=mxUtils.getValue(this.style,mxConstants.STYLE_VERTICAL_ALIGN,this.valign);this.spacing=mxUtils.getValue(this.style,mxConstants.STYLE_SPACING,this.spacing);this.spacingTop=mxUtils.getValue(this.style,mxConstants.STYLE_SPACING_TOP,this.spacingTop)+this.spacing;this.spacingRight=mxUtils.getValue(this.style,mxConstants.STYLE_SPACING_RIGHT,this.spacingRight)+this.spacing;this.spacingBottom=mxUtils.getValue(this.style,mxConstants.STYLE_SPACING_BOTTOM,this.spacingBottom)+this.spacing;this.spacingLeft=mxUtils.getValue(this.style,mxConstants.STYLE_SPACING_LEFT,this.spacingLeft)+this.spacing;this.horizontal=mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,this.horizontal);this.background=mxUtils.getValue(this.style,mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,this.background);this.border=mxUtils.getValue(this.style,mxConstants.STYLE_LABEL_BORDERCOLOR,this.border);this.textDirection=mxUtils.getValue(this.style,mxConstants.STYLE_TEXT_DIRECTION,mxConstants.DEFAULT_TEXT_DIRECTION);this.opacity=mxUtils.getValue(this.style,mxConstants.STYLE_TEXT_OPACITY,100);this.updateMargin()}this.flipV=null;this.flipH=null};mxText.prototype.getAutoDirection=function(){var A=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(this.value);return(A!=null&&A.length>0&&A[0]>"z")?mxConstants.TEXT_DIRECTION_RTL:mxConstants.TEXT_DIRECTION_LTR};mxText.prototype.updateBoundingBox=function(){var H=this.node;this.boundingBox=this.bounds.clone();var F=this.getTextRotation();var G=(this.style!=null)?mxUtils.getValue(this.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER):null;var C=(this.style!=null)?mxUtils.getValue(this.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE):null;if(!this.ignoreStringSize&&H!=null&&this.overflow!="fill"&&(!this.clipped||!this.ignoreClippedStringSize||G!=mxConstants.ALIGN_CENTER||C!=mxConstants.ALIGN_MIDDLE)){var J=null;var E=null;if(H.ownerSVGElement!=null){if(H.firstChild!=null&&H.firstChild.firstChild!=null&&H.firstChild.firstChild.nodeName=="foreignObject"){H=H.firstChild.firstChild;J=parseInt(H.getAttribute("width"))*this.scale;E=parseInt(H.getAttribute("height"))*this.scale}else{try{var K=H.getBBox();if(typeof(this.value)=="string"&&mxUtils.trim(this.value)==0){this.boundingBox=null}else{if(K.width==0&&K.height==0){this.boundingBox=null}else{this.boundingBox=new mxRectangle(K.x,K.y,K.width,K.height)}}return}catch(A){}}}else{var I=(this.state!=null)?this.state.view.textDiv:null;if(this.offsetWidth!=null&&this.offsetHeight!=null){J=this.offsetWidth*this.scale;E=this.offsetHeight*this.scale}else{if(I!=null){this.updateFont(I);this.updateSize(I,false);this.updateInnerHtml(I);H=I}var M=H;if(document.documentMode==8&&!mxClient.IS_EM){var D=Math.round(this.bounds.width/this.scale);if(this.wrap&&D>0){H.style.wordWrap=mxConstants.WORD_WRAP;H.style.whiteSpace="normal";if(H.style.wordWrap!="break-word"){var L=M.getElementsByTagName("div");if(L.length>0){M=L[L.length-1]}J=M.offsetWidth+2;L=this.node.getElementsByTagName("div");if(this.clipped){J=Math.min(D,J)}if(L.length>1){L[L.length-2].style.width=J+"px"}}}else{H.style.whiteSpace="nowrap"}}else{if(M.firstChild!=null&&M.firstChild.nodeName=="DIV"){M=M.firstChild}}this.offsetWidth=M.offsetWidth+this.textWidthPadding;this.offsetHeight=M.offsetHeight;J=this.offsetWidth*this.scale;E=this.offsetHeight*this.scale}}if(J!=null&&E!=null){this.boundingBox=new mxRectangle(this.bounds.x,this.bounds.y,J,E)}}if(this.boundingBox!=null){if(F!=0){var B=mxUtils.getBoundingBox(new mxRectangle(this.margin.x*this.boundingBox.width,this.margin.y*this.boundingBox.height,this.boundingBox.width,this.boundingBox.height),F,new mxPoint(0,0));this.unrotatedBoundingBox=mxRectangle.fromRectangle(this.boundingBox);this.unrotatedBoundingBox.x+=this.margin.x*this.unrotatedBoundingBox.width;this.unrotatedBoundingBox.y+=this.margin.y*this.unrotatedBoundingBox.height;this.boundingBox.x+=B.x;this.boundingBox.y+=B.y;this.boundingBox.width=B.width;this.boundingBox.height=B.height}else{this.boundingBox.x+=this.margin.x*this.boundingBox.width;this.boundingBox.y+=this.margin.y*this.boundingBox.height;this.unrotatedBoundingBox=null}}};mxText.prototype.getShapeRotation=function(){return 0};mxText.prototype.getTextRotation=function(){return(this.state!=null&&this.state.shape!=null)?this.state.shape.getTextRotation():0};mxText.prototype.isPaintBoundsInverted=function(){return !this.horizontal&&this.state!=null&&this.state.view.graph.model.isVertex(this.state.cell)};mxText.prototype.configureCanvas=function(C,B,D,E,A){mxShape.prototype.configureCanvas.apply(this,arguments);C.setFontColor(this.color);C.setFontBackgroundColor(this.background);C.setFontBorderColor(this.border);C.setFontFamily(this.family);C.setFontSize(this.size);C.setFontStyle(this.fontStyle)};mxText.prototype.updateVmlContainer=function(){this.node.style.left=Math.round(this.bounds.x)+"px";this.node.style.top=Math.round(this.bounds.y)+"px";this.node.style.width="1px";this.node.style.height="1px";this.node.style.overflow="visible"};mxText.prototype.redrawHtmlShape=function(){var A=this.node.style;A.whiteSpace="normal";A.overflow="";A.width="";A.height="";this.updateValue();this.updateFont(this.node);this.updateSize(this.node,(this.state==null||this.state.view.textDiv==null));this.offsetWidth=null;this.offsetHeight=null;if(mxClient.IS_IE&&(document.documentMode==null||document.documentMode<=8)){this.updateHtmlFilter()}else{this.updateHtmlTransform()}};mxText.prototype.updateHtmlTransform=function(){var D=this.getTextRotation();var B=this.node.style;var A=this.margin.x;var C=this.margin.y;if(D!=0){mxUtils.setPrefixedStyle(B,"transformOrigin",(-A*100)+"% "+(-C*100)+"%");mxUtils.setPrefixedStyle(B,"transform","translate("+(A*100)+"%,"+(C*100)+"%)scale("+this.scale+") rotate("+D+"deg)")}else{mxUtils.setPrefixedStyle(B,"transformOrigin","0% 0%");mxUtils.setPrefixedStyle(B,"transform","scale("+this.scale+")translate("+(A*100)+"%,"+(C*100)+"%)")}B.left=Math.round(this.bounds.x-Math.ceil(A*((this.overflow!="fill"&&this.overflow!="width")?3:1)))+"px";B.top=Math.round(this.bounds.y-C*((this.overflow!="fill")?3:1))+"px";if(this.opacity<100){B.opacity=this.opacity/100}else{B.opacity=""}};mxText.prototype.updateInnerHtml=function(A){if(mxUtils.isNode(this.value)){A.innerHTML=this.value.outerHTML}else{var B=this.value;if(this.dialect!=mxConstants.DIALECT_STRICTHTML){B=mxUtils.htmlEntities(B,false)}B=mxUtils.replaceTrailingNewlines(B,"<div>&nbsp;</div>");B=(this.replaceLinefeeds)?B.replace(/\n/g,"<br/>"):B;B='<div style="display:inline-block;_display:inline;">'+B+"</div>";A.innerHTML=B}};mxText.prototype.updateHtmlFilter=function(){var T=this.node.style;var F=this.margin.x;var P=this.margin.y;var A=this.scale;mxUtils.setOpacity(this.node,this.opacity);var L=0;var G=0;var N=(this.state!=null)?this.state.view.textDiv:null;var O=this.node;if(N!=null){N.style.overflow="";N.style.height="";N.style.width="";this.updateFont(N);this.updateSize(N,false);this.updateInnerHtml(N);var C=Math.round(this.bounds.width/this.scale);if(this.wrap&&C>0){N.style.whiteSpace="normal";N.style.wordWrap=mxConstants.WORD_WRAP;L=C;if(this.clipped){L=Math.min(L,this.bounds.width)}N.style.width=L+"px"}else{N.style.whiteSpace="nowrap"}O=N;if(O.firstChild!=null&&O.firstChild.nodeName=="DIV"){O=O.firstChild;if(this.wrap&&N.style.wordWrap=="break-word"){O.style.width="100%"}}if(!this.clipped&&this.wrap&&C>0){L=O.offsetWidth+this.textWidthPadding;N.style.width=L+"px"}G=O.offsetHeight+2;if(mxClient.IS_QUIRKS&&this.border!=null&&this.border!=mxConstants.NONE){G+=3}}else{if(O.firstChild!=null&&O.firstChild.nodeName=="DIV"){O=O.firstChild;G=O.offsetHeight}}L=O.offsetWidth+this.textWidthPadding;if(this.clipped){G=Math.min(G,this.bounds.height)}var C=this.bounds.width/A;var D=this.bounds.height/A;if(this.overflow=="fill"){G=D;L=C}else{if(this.overflow=="width"){G=O.scrollHeight;L=C}}this.offsetWidth=L;this.offsetHeight=G;if(mxClient.IS_QUIRKS&&(this.clipped||(this.overflow=="width"&&D>0))){D=Math.min(D,G);T.height=Math.round(D)+"px"}else{D=G}if(this.overflow!="fill"&&this.overflow!="width"){if(this.clipped){L=Math.min(C,L)}C=L;if((mxClient.IS_QUIRKS&&this.clipped)||this.wrap){T.width=Math.round(C)+"px"}}D*=A;C*=A;var E=this.getTextRotation()*(Math.PI/180);var K=parseFloat(parseFloat(Math.cos(E)).toFixed(8));var J=parseFloat(parseFloat(Math.sin(-E)).toFixed(8));E%=2*Math.PI;if(E<0){E+=2*Math.PI}E%=Math.PI;if(E>Math.PI/2){E=Math.PI-E}var M=Math.cos(E);var Q=Math.sin(-E);var S=C*-(F+0.5);var H=D*-(P+0.5);var B=(D-D*M+C*Q)/2+J*S-K*H;var R=(C-C*M+D*Q)/2-K*S-J*H;if(E!=0){var I="progid:DXImageTransform.Microsoft.Matrix(M11="+K+", M12="+J+", M21="+(-J)+", M22="+K+", sizingMethod='auto expand')";if(T.filter!=null&&T.filter.length>0){T.filter+=" "+I}else{T.filter=I}}var P=0;if(this.overflow!="fill"&&mxClient.IS_QUIRKS){if(this.valign==mxConstants.ALIGN_TOP){P-=1}else{if(this.valign==mxConstants.ALIGN_BOTTOM){P+=2}else{P+=1}}}T.zoom=A;T.left=Math.round(this.bounds.x+R-C/2)+"px";T.top=Math.round(this.bounds.y+B-D/2+P)+"px"};mxText.prototype.updateValue=function(){if(mxUtils.isNode(this.value)){this.node.innerHTML="";this.node.appendChild(this.value)}else{var F=this.value;if(this.dialect!=mxConstants.DIALECT_STRICTHTML){F=mxUtils.htmlEntities(F,false)}F=mxUtils.replaceTrailingNewlines(F,"<div><br></div>");F=(this.replaceLinefeeds)?F.replace(/\n/g,"<br/>"):F;var A=(this.background!=null&&this.background!=mxConstants.NONE)?this.background:null;var C=(this.border!=null&&this.border!=mxConstants.NONE)?this.border:null;if(this.overflow=="fill"||this.overflow=="width"){if(A!=null){this.node.style.backgroundColor=A}if(C!=null){this.node.style.border="1px solid "+C}}else{var D="";if(A!=null){D+="background-color:"+A+";"}if(C!=null){D+="border:1px solid "+C+";"}var B=(mxConstants.ABSOLUTE_LINE_HEIGHT)?(this.size*mxConstants.LINE_HEIGHT)+"px":mxConstants.LINE_HEIGHT;F='<div style="zoom:1;'+D+"display:inline-block;_display:inline;text-decoration:inherit;padding-bottom:1px;padding-right:1px;line-height:"+B+'">'+F+"</div>"}this.node.innerHTML=F;var G=this.node.getElementsByTagName("div");if(G.length>0){var E=this.textDirection;if(E==mxConstants.TEXT_DIRECTION_AUTO&&this.dialect!=mxConstants.DIALECT_STRICTHTML){E=this.getAutoDirection()}if(E==mxConstants.TEXT_DIRECTION_LTR||E==mxConstants.TEXT_DIRECTION_RTL){G[G.length-1].setAttribute("dir",E)}else{G[G.length-1].removeAttribute("dir")}}}};mxText.prototype.updateFont=function(A){var B=A.style;B.lineHeight=(mxConstants.ABSOLUTE_LINE_HEIGHT)?(this.size*mxConstants.LINE_HEIGHT)+"px":mxConstants.LINE_HEIGHT;B.fontSize=this.size+"px";B.fontFamily=this.family;B.verticalAlign="top";B.color=this.color;if((this.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD){B.fontWeight="bold"}else{B.fontWeight=""}if((this.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC){B.fontStyle="italic"}else{B.fontStyle=""}if((this.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE){B.textDecoration="underline"}else{B.textDecoration=""}if(this.align==mxConstants.ALIGN_CENTER){B.textAlign="center"}else{if(this.align==mxConstants.ALIGN_RIGHT){B.textAlign="right"}else{B.textAlign="left"}}};mxText.prototype.updateSize=function(F,G){var B=Math.max(0,Math.round(this.bounds.width/this.scale));var D=Math.max(0,Math.round(this.bounds.height/this.scale));var E=F.style;if(this.clipped){E.overflow="hidden";if(!mxClient.IS_QUIRKS){E.maxHeight=D+"px";E.maxWidth=B+"px"}else{E.width=B+"px"}}else{if(this.overflow=="fill"){E.width=(B+1)+"px";E.height=(D+1)+"px";E.overflow="hidden"}else{if(this.overflow=="width"){E.width=(B+1)+"px";E.maxHeight=(D+1)+"px";E.overflow="hidden"}}}if(this.wrap&&B>0){E.wordWrap=mxConstants.WORD_WRAP;E.whiteSpace="normal";E.width=B+"px";if(G&&this.overflow!="fill"&&this.overflow!="width"){var H=F;if(H.firstChild!=null&&H.firstChild.nodeName=="DIV"){H=H.firstChild;if(F.style.wordWrap=="break-word"){H.style.width="100%"}}var C=H.offsetWidth;if(C==0){var A=F.parentNode;F.style.visibility="hidden";document.body.appendChild(F);C=H.offsetWidth;F.style.visibility="";A.appendChild(F)}C+=3;if(this.clipped){C=Math.min(C,B)}E.width=C+"px"}}else{E.whiteSpace="nowrap"}};mxText.prototype.updateMargin=function(){this.margin=mxUtils.getAlignmentAsPoint(this.align,this.valign)};mxText.prototype.getSpacing=function(){var A=0;var B=0;if(this.align==mxConstants.ALIGN_CENTER){A=(this.spacingLeft-this.spacingRight)/2}else{if(this.align==mxConstants.ALIGN_RIGHT){A=-this.spacingRight-this.baseSpacingRight}else{A=this.spacingLeft+this.baseSpacingLeft}}if(this.valign==mxConstants.ALIGN_MIDDLE){B=(this.spacingTop-this.spacingBottom)/2}else{if(this.valign==mxConstants.ALIGN_BOTTOM){B=-this.spacingBottom-this.baseSpacingBottom}else{B=this.spacingTop+this.baseSpacingTop}}return new mxPoint(A,B)};function mxTriangle(){mxActor.call(this)}mxUtils.extend(mxTriangle,mxActor);mxTriangle.prototype.redrawPath=function(D,C,E,F,A){var B=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(D,[new mxPoint(0,0),new mxPoint(F,0.5*A),new mxPoint(0,A)],this.isRounded,B,true)};function mxHexagon(){mxActor.call(this)}mxUtils.extend(mxHexagon,mxActor);mxHexagon.prototype.redrawPath=function(D,C,E,F,A){var B=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(D,[new mxPoint(0.25*F,0),new mxPoint(0.75*F,0),new mxPoint(F,0.5*A),new mxPoint(0.75*F,A),new mxPoint(0.25*F,A),new mxPoint(0,0.5*A)],this.isRounded,B,true)};function mxLine(B,C,A){mxShape.call(this);this.bounds=B;this.stroke=C;this.strokewidth=(A!=null)?A:1}mxUtils.extend(mxLine,mxShape);mxLine.prototype.paintVertexShape=function(D,C,E,F,A){var B=E+A/2;D.begin();D.moveTo(C,B);D.lineTo(C+F,B);D.stroke()};function mxImageShape(B,C,A,D,E){mxShape.call(this);this.bounds=B;this.image=C;this.fill=A;this.stroke=D;this.strokewidth=(E!=null)?E:1;this.shadow=false}mxUtils.extend(mxImageShape,mxRectangleShape);mxImageShape.prototype.preserveImageAspect=true;mxImageShape.prototype.getSvgScreenOffset=function(){return 0};mxImageShape.prototype.apply=function(A){mxShape.prototype.apply.apply(this,arguments);this.fill=null;this.stroke=null;this.gradient=null;if(this.style!=null){this.preserveImageAspect=mxUtils.getNumber(this.style,mxConstants.STYLE_IMAGE_ASPECT,1)==1;this.flipH=this.flipH||mxUtils.getValue(this.style,"imageFlipH",0)==1;this.flipV=this.flipV||mxUtils.getValue(this.style,"imageFlipV",0)==1}};mxImageShape.prototype.isHtmlAllowed=function(){return !this.preserveImageAspect};mxImageShape.prototype.createHtml=function(){var A=document.createElement("div");A.style.position="absolute";return A};mxImageShape.prototype.paintVertexShape=function(E,D,F,G,A){if(this.image!=null){var C=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BACKGROUND,null);var B=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BORDER,null);if(C!=null){E.setFillColor(C);E.setStrokeColor(B);E.rect(D,F,G,A);E.fillAndStroke()}E.image(D,F,G,A,this.image,this.preserveImageAspect,false,false);var B=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BORDER,null);if(B!=null){E.setShadow(false);E.setStrokeColor(B);E.rect(D,F,G,A);E.stroke()}}else{mxRectangleShape.prototype.paintBackground.apply(this,arguments)}};mxImageShape.prototype.redrawHtmlShape=function(){this.node.style.left=Math.round(this.bounds.x)+"px";this.node.style.top=Math.round(this.bounds.y)+"px";this.node.style.width=Math.max(0,Math.round(this.bounds.width))+"px";this.node.style.height=Math.max(0,Math.round(this.bounds.height))+"px";this.node.innerHTML="";if(this.image!=null){var A=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BACKGROUND,"");var B=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BORDER,"");this.node.style.backgroundColor=A;this.node.style.borderColor=B;var D=mxClient.IS_IE6||((document.documentMode==null||document.documentMode<=8)&&this.rotation!=0);var E=document.createElement((D)?mxClient.VML_PREFIX+":image":"img");E.setAttribute("border","0");E.style.position="absolute";E.src=this.image;var C=(this.opacity<100)?"alpha(opacity="+this.opacity+")":"";this.node.style.filter=C;if(this.flipH&&this.flipV){C+="progid:DXImageTransform.Microsoft.BasicImage(rotation=2)"}else{if(this.flipH){C+="progid:DXImageTransform.Microsoft.BasicImage(mirror=1)"}else{if(this.flipV){C+="progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)"}}}if(E.style.filter!=C){E.style.filter=C}if(E.nodeName=="image"){E.style.rotation=this.rotation}else{if(this.rotation!=0){mxUtils.setPrefixedStyle(E.style,"transform","rotate("+this.rotation+"deg)")}else{mxUtils.setPrefixedStyle(E.style,"transform","")}}E.style.width=this.node.style.width;E.style.height=this.node.style.height;this.node.style.backgroundImage="";this.node.appendChild(E)}else{this.setTransparentBackgroundImage(this.node)}};function mxLabel(B,A,C,D){mxRectangleShape.call(this,B,A,C,D)}mxUtils.extend(mxLabel,mxRectangleShape);mxLabel.prototype.imageSize=mxConstants.DEFAULT_IMAGESIZE;mxLabel.prototype.spacing=2;mxLabel.prototype.indicatorSize=10;mxLabel.prototype.indicatorSpacing=2;mxLabel.prototype.init=function(A){mxShape.prototype.init.apply(this,arguments);if(this.indicatorShape!=null){this.indicator=new this.indicatorShape();this.indicator.dialect=this.dialect;this.indicator.init(this.node)}};mxLabel.prototype.redraw=function(){if(this.indicator!=null){this.indicator.fill=this.indicatorColor;this.indicator.stroke=this.indicatorStrokeColor;this.indicator.gradient=this.indicatorGradientColor;this.indicator.direction=this.indicatorDirection}mxShape.prototype.redraw.apply(this,arguments)};mxLabel.prototype.isHtmlAllowed=function(){return mxRectangleShape.prototype.isHtmlAllowed.apply(this,arguments)&&this.indicatorColor==null&&this.indicatorShape==null};mxLabel.prototype.paintForeground=function(C,B,D,E,A){this.paintImage(C,B,D,E,A);this.paintIndicator(C,B,D,E,A);mxRectangleShape.prototype.paintForeground.apply(this,arguments)};mxLabel.prototype.paintImage=function(D,C,E,F,A){if(this.image!=null){var B=this.getImageBounds(C,E,F,A);D.image(B.x,B.y,B.width,B.height,this.image,false,false,false)}};mxLabel.prototype.getImageBounds=function(H,I,C,F){var E=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_ALIGN,mxConstants.ALIGN_LEFT);var A=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE);var G=mxUtils.getNumber(this.style,mxConstants.STYLE_IMAGE_WIDTH,mxConstants.DEFAULT_IMAGESIZE);var B=mxUtils.getNumber(this.style,mxConstants.STYLE_IMAGE_HEIGHT,mxConstants.DEFAULT_IMAGESIZE);var D=mxUtils.getNumber(this.style,mxConstants.STYLE_SPACING,this.spacing)+5;if(E==mxConstants.ALIGN_CENTER){H+=(C-G)/2}else{if(E==mxConstants.ALIGN_RIGHT){H+=C-G-D}else{H+=D}}if(A==mxConstants.ALIGN_TOP){I+=D}else{if(A==mxConstants.ALIGN_BOTTOM){I+=F-B-D}else{I+=(F-B)/2}}return new mxRectangle(H,I,G,B)};mxLabel.prototype.paintIndicator=function(D,C,E,F,A){if(this.indicator!=null){this.indicator.bounds=this.getIndicatorBounds(C,E,F,A);this.indicator.paint(D)}else{if(this.indicatorImage!=null){var B=this.getIndicatorBounds(C,E,F,A);D.image(B.x,B.y,B.width,B.height,this.indicatorImage,false,false,false)}}};mxLabel.prototype.getIndicatorBounds=function(H,I,C,F){var E=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_ALIGN,mxConstants.ALIGN_LEFT);var A=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE);var G=mxUtils.getNumber(this.style,mxConstants.STYLE_INDICATOR_WIDTH,this.indicatorSize);var B=mxUtils.getNumber(this.style,mxConstants.STYLE_INDICATOR_HEIGHT,this.indicatorSize);var D=this.spacing+5;if(E==mxConstants.ALIGN_RIGHT){H+=C-G-D}else{if(E==mxConstants.ALIGN_CENTER){H+=(C-G)/2}else{H+=D}}if(A==mxConstants.ALIGN_BOTTOM){I+=F-B-D}else{if(A==mxConstants.ALIGN_TOP){I+=D}else{I+=(F-B)/2}}return new mxRectangle(H,I,G,B)};mxLabel.prototype.redrawHtmlShape=function(){mxRectangleShape.prototype.redrawHtmlShape.apply(this,arguments);while(this.node.hasChildNodes()){this.node.removeChild(this.node.lastChild)}if(this.image!=null){var B=document.createElement("img");B.style.position="relative";B.setAttribute("border","0");var A=this.getImageBounds(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height);A.x-=this.bounds.x;A.y-=this.bounds.y;B.style.left=Math.round(A.x)+"px";B.style.top=Math.round(A.y)+"px";B.style.width=Math.round(A.width)+"px";B.style.height=Math.round(A.height)+"px";B.src=this.image;this.node.appendChild(B)}};function mxCylinder(B,A,C,D){mxShape.call(this);this.bounds=B;this.fill=A;this.stroke=C;this.strokewidth=(D!=null)?D:1}mxUtils.extend(mxCylinder,mxShape);mxCylinder.prototype.maxHeight=40;mxCylinder.prototype.svgStrokeTolerance=0;mxCylinder.prototype.paintVertexShape=function(C,B,D,E,A){C.translate(B,D);C.begin();this.redrawPath(C,B,D,E,A,false);C.fillAndStroke();C.setShadow(false);C.begin();this.redrawPath(C,B,D,E,A,true);C.stroke()};mxCylinder.prototype.redrawPath=function(E,D,F,G,A,C){var B=Math.min(this.maxHeight,Math.round(A/5));if((C&&this.fill!=null)||(!C&&this.fill==null)){E.moveTo(0,B);E.curveTo(0,2*B,G,2*B,G,B);if(!C){E.stroke();E.begin()}}if(!C){E.moveTo(0,B);E.curveTo(0,-B/3,G,-B/3,G,B);E.lineTo(G,A-B);E.curveTo(G,A+B/3,0,A+B/3,0,A-B);E.close()}};function mxConnector(C,B,A){mxPolyline.call(this,C,B,A)}mxUtils.extend(mxConnector,mxPolyline);mxConnector.prototype.updateBoundingBox=function(){this.useSvgBoundingBox=this.style!=null&&this.style[mxConstants.STYLE_CURVED]==1;mxShape.prototype.updateBoundingBox.apply(this,arguments)};mxConnector.prototype.paintEdgeShape=function(B,C){var A=this.createMarker(B,C,true);var D=this.createMarker(B,C,false);mxPolyline.prototype.paintEdgeShape.apply(this,arguments);B.setFillColor(this.stroke);B.setShadow(false);B.setDashed(false);if(A!=null){A()}if(D!=null){D()}};mxConnector.prototype.createMarker=function(L,A,J){var C=null;var H=A.length;var M=mxUtils.getValue(this.style,(J)?mxConstants.STYLE_STARTARROW:mxConstants.STYLE_ENDARROW);var B=(J)?A[1]:A[H-2];var D=(J)?A[0]:A[H-1];if(M!=null&&B!=null&&D!=null){var E=1;while(E<H-1&&Math.round(B.x-D.x)==0&&Math.round(B.y-D.y)==0){B=(J)?A[1+E]:A[H-2-E];E++}var K=D.x-B.x;var I=D.y-B.y;var N=Math.max(1,Math.sqrt(K*K+I*I));var O=K/N;var P=I/N;var G=mxUtils.getNumber(this.style,(J)?mxConstants.STYLE_STARTSIZE:mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE);var F=this.style[(J)?mxConstants.STYLE_STARTFILL:mxConstants.STYLE_ENDFILL]!=0;C=mxMarker.createMarker(L,this,M,D,O,P,G,J,this.arrowStrokewidth,F)}return C};mxConnector.prototype.augmentBoundingBox=function(B){mxShape.prototype.augmentBoundingBox.apply(this,arguments);var A=0;if(mxUtils.getValue(this.style,mxConstants.STYLE_STARTARROW,mxConstants.NONE)!=mxConstants.NONE){A=mxUtils.getNumber(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE)+1}if(mxUtils.getValue(this.style,mxConstants.STYLE_ENDARROW,mxConstants.NONE)!=mxConstants.NONE){A=Math.max(A,mxUtils.getNumber(this.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE))+1}B.grow(A*this.scale)};function mxSwimlane(B,A,C,D){mxShape.call(this);this.bounds=B;this.fill=A;this.stroke=C;this.strokewidth=(D!=null)?D:1}mxUtils.extend(mxSwimlane,mxShape);mxSwimlane.prototype.imageSize=16;mxSwimlane.prototype.getTitleSize=function(){return Math.max(0,mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE))};mxSwimlane.prototype.getLabelBounds=function(D){var C=this.getTitleSize();var A=new mxRectangle(D.x,D.y,D.width,D.height);var J=this.isHorizontal();var H=mxUtils.getValue(this.style,mxConstants.STYLE_FLIPH,0)==1;var B=mxUtils.getValue(this.style,mxConstants.STYLE_FLIPV,0)==1;var G=(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH);var I=J==!G;var E=!I&&H!=(this.direction==mxConstants.DIRECTION_SOUTH||this.direction==mxConstants.DIRECTION_WEST);var K=I&&B!=(this.direction==mxConstants.DIRECTION_SOUTH||this.direction==mxConstants.DIRECTION_WEST);if(!G){var F=Math.min(A.height,C*this.scale);if(E||K){A.y+=A.height-F}A.height=F}else{var F=Math.min(A.width,C*this.scale);if(E||K){A.x+=A.width-F}A.width=F}return A};mxSwimlane.prototype.getGradientBounds=function(C,B,D,E,A){var F=this.getTitleSize();if(this.isHorizontal()){F=Math.min(F,A);return new mxRectangle(B,D,E,F)}else{F=Math.min(F,E);return new mxRectangle(B,D,F,A)}};mxSwimlane.prototype.getArcSize=function(B,A,C){var D=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100;return C*D*3};mxSwimlane.prototype.isHorizontal=function(){return mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,1)==1};mxSwimlane.prototype.paintVertexShape=function(H,K,I,D,F){var B=this.getTitleSize();var J=mxUtils.getValue(this.style,mxConstants.STYLE_SWIMLANE_FILLCOLOR,mxConstants.NONE);var C=mxUtils.getValue(this.style,mxConstants.STYLE_SWIMLANE_LINE,1)==1;var A=0;if(this.isHorizontal()){B=Math.min(B,F)}else{B=Math.min(B,D)}H.translate(K,I);if(!this.isRounded){this.paintSwimlane(H,K,I,D,F,B,J,C)}else{A=this.getArcSize(D,F,B);this.paintRoundedSwimlane(H,K,I,D,F,B,A,J,C)}var E=mxUtils.getValue(this.style,mxConstants.STYLE_SEPARATORCOLOR,mxConstants.NONE);this.paintSeparator(H,K,I,D,F,B,E);if(this.image!=null){var G=this.getImageBounds(K,I,D,F);H.image(G.x-K,G.y-I,G.width,G.height,this.image,false,false,false)}if(this.glass){H.setShadow(false);this.paintGlassEffect(H,0,0,D,B,A)}};mxSwimlane.prototype.paintSwimlane=function(E,H,F,C,D,A,G,B){if(G!=mxConstants.NONE){E.save();E.setFillColor(G);E.rect(0,0,C,D);E.fillAndStroke();E.restore();E.setShadow(false)}E.begin();if(this.isHorizontal()){E.moveTo(0,A);E.lineTo(0,0);E.lineTo(C,0);E.lineTo(C,A);if(B||A>=D){E.close()}E.fillAndStroke();if(A<D&&G==mxConstants.NONE){E.pointerEvents=false;E.begin();E.moveTo(0,A);E.lineTo(0,D);E.lineTo(C,D);E.lineTo(C,A);E.stroke()}}else{E.moveTo(A,0);E.lineTo(0,0);E.lineTo(0,D);E.lineTo(A,D);if(B||A>=C){E.close()}E.fillAndStroke();if(A<C&&G==mxConstants.NONE){E.pointerEvents=false;E.begin();E.moveTo(A,0);E.lineTo(C,0);E.lineTo(C,D);E.lineTo(A,D);E.stroke()}}};mxSwimlane.prototype.paintRoundedSwimlane=function(F,I,G,D,E,B,A,H,C){if(H!=mxConstants.NONE){F.save();F.setFillColor(H);F.roundrect(0,0,D,E,A,A);F.fillAndStroke();F.restore();F.setShadow(false)}F.begin();if(this.isHorizontal()){F.moveTo(D,B);F.lineTo(D,A);F.quadTo(D,0,D-Math.min(D/2,A),0);F.lineTo(Math.min(D/2,A),0);F.quadTo(0,0,0,A);F.lineTo(0,B);if(C||B>=E){F.close()}F.fillAndStroke();if(B<E&&H==mxConstants.NONE){F.pointerEvents=false;F.begin();F.moveTo(0,B);F.lineTo(0,E-A);F.quadTo(0,E,Math.min(D/2,A),E);F.lineTo(D-Math.min(D/2,A),E);F.quadTo(D,E,D,E-A);F.lineTo(D,B);F.stroke()}}else{F.moveTo(B,0);F.lineTo(A,0);F.quadTo(0,0,0,Math.min(E/2,A));F.lineTo(0,E-Math.min(E/2,A));F.quadTo(0,E,A,E);F.lineTo(B,E);if(C||B>=D){F.close()}F.fillAndStroke();if(B<D&&H==mxConstants.NONE){F.pointerEvents=false;F.begin();F.moveTo(B,E);F.lineTo(D-A,E);F.quadTo(D,E,D,E-Math.min(E/2,A));F.lineTo(D,Math.min(E/2,A));F.quadTo(D,0,D-A,0);F.lineTo(B,0);F.stroke()}}};mxSwimlane.prototype.paintSeparator=function(D,C,E,F,A,G,B){if(B!=mxConstants.NONE){D.setStrokeColor(B);D.setDashed(true);D.begin();if(this.isHorizontal()){D.moveTo(F,G);D.lineTo(F,A)}else{D.moveTo(G,0);D.lineTo(F,0)}D.stroke();D.setDashed(false)}};mxSwimlane.prototype.getImageBounds=function(B,C,D,A){if(this.isHorizontal()){return new mxRectangle(B+D-this.imageSize,C,this.imageSize,this.imageSize)}else{return new mxRectangle(B,C,this.imageSize,this.imageSize)}};