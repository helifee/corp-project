/*
 * Copyright (c) 2009-2010 by DaLian YuDong Computer System CO.,LTD
 * All rights reserved.
 *      Project: SSH
 *    SubSystem: 会议室管理子系统
 */

package com.ysys.www.hy.dao.impl;

import java.util.List;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.orm.hibernate3.support.HibernateDaoSupport;

import com.ysys.www.hy.dao.HybaseDao;

/**
 *  @see com.ysys.www.hy.dao.HybaseDao
 */
public class HybaseDaoImpl extends HibernateDaoSupport implements HybaseDao {
	private static final Log log = LogFactory.getLog(HybaseDaoImpl.class);

	 /**
	 * {@inheritDoc}
	 */
	@SuppressWarnings("unchecked")
	public List findmrhyyl(String inputdate) {
		log.debug("Init");
		try {
			String queryString = "select t.id," + " u.empName," + " m.cjzrs,"
					+ " m.id.hykssj," + " m.hyjssj," + " m.zqhyqf," + " u.id"
					+ " from TabMrhyyl m, TabHysyl t, Tempinfo u "
					+ " where t.id = m.id.hysid" + " and u.id = m.yyrid"
					+ " and m.id.hyrq = '" + inputdate + "'"
					+ " order by t.sortid, t.id, m.id.hykssj";

			return getHibernateTemplate().find(queryString);
		} catch (RuntimeException re) {
			log.error("find all failed", re);
			throw re;
		}
	}

	 /**
	 * {@inheritDoc}
	 */
	@SuppressWarnings("unchecked")
	public List findhysyl() {
		log.debug("Init");
		try {
			String queryString = "select t.id," + " t.hysmc"
					+ " from TabHysyl t" + " order by t.sortid";
			return getHibernateTemplate().find(queryString);
		} catch (RuntimeException re) {
			log.error("find all failed", re);
			throw re;
		}
	}
}
