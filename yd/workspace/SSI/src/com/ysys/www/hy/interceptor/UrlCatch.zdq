/*
 * Copyright (c) 2009-2010 by DaLian YuDong Computer System CO.,LTD
 * All rights reserved.
 *      Project: SSH
 *    SubSystem: 会议室管理子系统
 */
package com.ysys.www.hy.interceptor;

/**
 * Copyright (c) 2009-2010 by DaLian YuDong Computer System CO.,LTD
 * All rights reserved.
 *      Project: SSH
 * 拦截器
 * 
 * */

import java.util.Map;

import org.apache.struts2.ServletActionContext;

import com.opensymphony.xwork2.ActionInvocation;
import com.opensymphony.xwork2.interceptor.AbstractInterceptor;
import com.ysys.www.hy.service.common.CommonConstants;
import com.ysys.www.hy.service.common.UrlPath;

/**
 * URL拦截器
 * @author zhaodong
 * @version 1.00 2009/09/22
 */
public class UrlCatch extends AbstractInterceptor {

	private static final long serialVersionUID = 7151809710421086016L;

	/**
	 * 根据请求URL的不同确定不同的机能/画面名称
	 * 
	 * @param invocation invocation
	 * @return invocation.invoke()
	 */
	@Override
	public String intercept(ActionInvocation invocation) throws Exception {
		Map<String,Object> session = invocation.getInvocationContext().getSession();


		String requestUrl = ServletActionContext.getRequest()
				.getServletPath();
		requestUrl = requestUrl.replaceFirst("/", "");
		requestUrl = requestUrl.replaceAll("/", "_");
		requestUrl = requestUrl.replaceAll("\\.action", "");
		//UrlPath urlPath = new UrlPath(); 
        String dis_Name = UrlPath.URLPATHEER.get(requestUrl);
        if ( null == dis_Name || "".equals(dis_Name) ){
        	dis_Name = "未知机能/未知画面";
        }
		
		session.put(CommonConstants.DISPLAYFNCNAME, dis_Name);

		return invocation.invoke();

	}

}
