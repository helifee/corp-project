<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="SearchPhoneNODao">
	
	<!-- 获取电话号码 --> 
	<select id="getPhoneNO" resultClass="String" parameterClass="String">
	<![CDATA[
		SELECT DISTINCT 
			spacelist.phone_no 
		FROM spacelist 
		INNER JOIN seatmanage 
			ON spacelist.location = CONCAT(seatmanage.room_id,seatmanage.desk_id)
		WHERE 
			seatmanage.date_sta<=NOW() 
			AND seatmanage.date_end >=NOW() 
			AND seatmanage.persion_id=#userId#
			AND spacelist.date_sta<=NOW() 
			AND spacelist.date_end>=NOW() 
		LIMIT 1;
	]]>
	</select>
	
	<select id="getSeatId" resultClass="String" parameterClass="String">
	<![CDATA[
		SELECT DISTINCT 
			CONCAT(room_id,'_',desk_id)
		FROM seatmanage
		WHERE persion_id=#userId#
			AND date_sta<=NOW() 
			AND date_end>=NOW() 
		LIMIT 1;
	]]>
	</select>
</sqlMap>
