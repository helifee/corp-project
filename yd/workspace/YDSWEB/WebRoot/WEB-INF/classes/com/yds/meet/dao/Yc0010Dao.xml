<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Yc0010Dao">
    <typeAlias alias="metRoomInfo" type="com.yds.meet.bean.MetRoomInfo"/>  

    <!-- 会议室信息更新 --> 	
    <update id="updateMetRoomInfo" parameterClass="metRoomInfo">
        UPDATE met_room_info SET
	        MET_NM = #metNm# ,
	        MET_RNM = #metRnm# ,
	        CONTAIN_CNT = #containCnt# ,
	        TEL = #tel# ,
	        EQUIPMENT = #equipment# ,
	        NET_INTERFACE = #netInterface# ,
			<isEqual property="metState" compareValue="1">
				MET_STATE = #metState# ,			
			</isEqual>
			<isNotEqual property="metState"  compareValue="1">
				MET_STATE = '0' ,			
			</isNotEqual>
	        IMAGEFROMX = #imagefromx# ,
	        IMAGEFROMY = #imagefromy# ,
	        IMAGETOX = #imagetox# ,
	        IMAGETOY = #imagetoy# ,
	        UPDATETIME = NOW()
        WHERE 
	        MET_ID = #metId# 
    </update>
	
    <!-- 会议室排序更新 --> 	
    <update id="updateMetRoomSort" parameterClass="metRoomInfo">
        UPDATE met_room_info SET
	        SORT_ID = #sortId#
        WHERE 
	        MET_ID = #metId# 
    </update>
		
    <!-- 会议室信息插入 --> 	
    <insert id="insertMetRoomInfo" parameterClass="metRoomInfo">
        INSERT INTO
        met_room_info (
        	MET_ID ,
        	MET_NM ,
        	MET_RNM ,
        	CONTAIN_CNT ,
        	TEL ,
        	EQUIPMENT ,
        	NET_INTERFACE ,
        	SORT_ID ,
			MET_STATE ,
        	IMAGEFROMX ,
        	IMAGEFROMY ,
        	IMAGETOX ,
        	IMAGETOY ,
        	UPDATETIME 	
        ) VALUES (			    
			#metId# ,
        	#metNm# ,
        	#metRnm# ,
        	#containCnt# ,
        	#tel# ,
        	#equipment# ,
        	#netInterface# ,
			(SELECT IF ((SELECT COUNT(*)  FROM   met_room_info F) =0,1,(SELECT MAX(K.SORT_ID + 1) FROM met_room_info K)) AS `SORT_ID`),
			<isEqual property="metState" compareValue="1">
        	#metState# ,			
			</isEqual>
			<isNotEqual property="metState" compareValue="1">
				'0' ,
			</isNotEqual>					
        	#imagefromx# ,
        	#imagefromy# ,
        	#imagetox# ,
        	#imagetoy# ,
        	NOW() 
        );
    </insert>
</sqlMap>  

