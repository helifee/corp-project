<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="BookuserinsertDao">
<!--用户信息登录用bean-->
	<typeAlias alias="bookuserinsert" type="com.yds.library.bean.Bookinfo"/>	
	<!--成功页面用户可借书上限bean-->
<typeAlias alias="serbklimitsuccess" type="com.yds.library.bean.Finishheadinfo"/>	
  	
	<!-- 用户借书信息登录检索 --> 
	<insert id="insertuserbook" parameterClass="bookuserinsert"> 
		insert into ydb_book_info
		 (
			ISBN,USER_ID,BOOK_NAME,BOOK_VOLUME,VOLUME_NUM,CLASS_ID,AUTHOR,PUB,PUBLISH_DATE,INTRODUCE,REMARK,CREATE_USERID,CREATE_TIME,UPDATE_USERID,UPDATE_TIME,DEL_FLG
		 ) values (
		 	#isbn#, #purseid#,#bookname#,#bookvolume#,#volumenum#,#booksort#,#bookauthor#,#bookpublisher#,#bookpublishdate#,#booksummary#,#bookpicadd#, #purseid#, now(), #purseid#, now(),'0'
		 )
	</insert>
	
		<!-- 成功页面用户可借书上限 --> 
	<select id="getbooklimitsuccess" parameterClass="String" resultClass="serbklimitsuccess"> 		  
		SELECT   
         v.contribute_book booknumlimit,
         v.borrow_book booklendednum,
         v.contribute_book - v.borrow_book bookreadnum
  		FROM   v_ydb_user_book v
  		where v.user_id=#userid#
	</select>			  
</sqlMap>  
