<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Ya0010Dao">
	<typeAlias alias="positionRoleInfo" type="com.yds.perm.bean.PositionRoleInfo"/>
	<typeAlias alias="positionInfo" type="com.yds.common.bean.PositionInfo"/>	
	<typeAlias alias="roleInfo" type="com.yds.perm.bean.RoleInfo"/>	
	<!--获取职位角色对应关系-->
	<select id="getRolePosInfos"  resultClass="positionRoleInfo">
		SELECT POS_ID AS posId,
		       ROLE_ID AS roleId,
			   UPDATETIME AS updateTime
		FROM PER_ROLE_POSTION
	</select>
	<select id="getRolePosInfo"  resultClass="positionRoleInfo">
		SELECT POS_ID AS posId,
		       ROLE_ID AS roleId,
			   UPDATETIME AS updateTime
		FROM PER_ROLE_POSTION
		WHERE POS_ID = #posId# AND ROLE_ID = #roleId#
	</select>
	<!--添加职位角色-->
	<insert id="insertPositionRole" parameterClass="positionRoleInfo">
		INSERT INTO PER_ROLE_POSTION 
		(
			POS_ID,
			ROLE_ID,
			OPERATOR,
			UPDATETIME
		) 
		VALUES 
		(
			#posId#,
			#roleId#,
			#operator#,
			NOW()
		)	
	</insert>
	<!--删除职位角色-->
	<delete id="deletePositionRole" parameterClass="positionRoleInfo">
		DELETE FROM PER_ROLE_POSTION
		WHERE POS_ID = #posId#
		AND ROLE_ID = #roleId#
	</delete>
	<!--获取角色信息一览-->
	<select id="getRoleInfos" resultClass="roleInfo">
		SELECT ROLE_ID AS roleId,
		       ROLE_NM AS roleName
	    FROM  PER_ROLE
		ORDER BY ROLE_ID
	</select>
	<!--获取职位信息一览-->
	<select id="getPositionInfos" resultClass="positionInfo">
		SELECT T1.POS_ID AS posId,
		       T1.POS_SNAME AS posName
		FROM EMP_POS T1
		INNER JOIN sys_code_mst T2
		ON T1.POS_TYPE_ID = T2.DIFF_NO
		WHERE T2.SUB_SYS = 'EMP'
		AND T2.TYPE_ID = 'POS_TYPE'
		ORDER BY T2.DISP_SEQ,
		       T1.DISP_SEQ
	</select>
</sqlMap>