<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="AssistantDao">
	<typeAlias alias="leakAttendanceInfo" type="com.yds.gadget.bean.LeakAttendanceInfo"/>
	
	<!-- 取得用户审批信息-->
	<select id="getLeakAttendanceInfoList" parameterClass="leakAttendanceInfo" resultClass="leakAttendanceInfo">
		<![CDATA[
		  SELECT T1.LEAK_NIAN AS leakNian,
				 T1.LEAK_YUE AS leakYue,
				 T1.LEAK_RI AS leakRi
  		  FROM TLEAKMGRS T1 LEFT JOIN THOLMGRS T2
		  ON T1.LEAK_ID = T2.HOL_ID
		  WHERE T1.LEAK_EMPID = #userId# 
		  AND T1.LEAK_TYPE IN ('ws','wx','ks','kx','O ')
		  AND (T1.LEAK_REASON IS NULL OR T1.LEAK_REASON = '')
		  AND (T1.LEAK_NIAN <> #leakNian# OR T1.LEAK_YUE <> #leakYue# OR T1.LEAK_RI <> #leakRi#)
		  AND T1.LEAK_NIAN > '2007'
		  AND (T2.HOL_REASON IS NULL OR T2.HOL_REASON = ''
		      OR CONCAT(T1.LEAK_NIAN ,LPAD(T1.LEAK_YUE,2,'0') ,LPAD(T1.LEAK_RI,2,'0')) NOT BETWEEN T2.HOL_BVDATE AND T2.HOL_EVDATE)
		]]>
	</select>
</sqlMap>