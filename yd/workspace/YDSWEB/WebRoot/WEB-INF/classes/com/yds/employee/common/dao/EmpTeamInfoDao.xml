<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="EmpTeamInfoDao">
	<typeAlias alias="empTeamInfo" type="com.yds.common.bean.EmpTeamInfo"/>
	
	<!-- 组别List取得 -->
	<select id="getTeamList" parameterClass="empTeamInfo" resultClass="empTeamInfo">
		SELECT 
			T1.TEAM_ID AS teamId,
			T1.TEAM_SNM AS teamSnm
        FROM
	    EMP_TEAM T1			
		WHERE ((T1.TEAM_FLG = '01' AND T1.TEAM_LEADER_ID=#userId#)
		   OR (T1.TEAM_FLG = '02' AND ((T1.TEAM_LEADER_ID=#userId#)
	       OR((SELECT COUNT(T2.TEAM_USER_ID) FROM EMP_TEAM_USER T2 
						 WHERE T1.TEAM_ID = T2.TEAM_ID 
						   AND T2.TEAM_USER_ID = #userId#
						   <![CDATA[AND T2.USER_STATE_FLG <> '02']]>)>0)))
		   OR (T1.TEAM_FLG = '03'))
		GROUP BY T1.TEAM_ID
		ORDER BY T1.TEAM_FLG,
				 T1.TEAM_ID
	</select>
</sqlMap>  
