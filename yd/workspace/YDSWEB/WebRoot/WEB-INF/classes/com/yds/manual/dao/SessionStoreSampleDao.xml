<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="SessionStoreSampleDao">

	<!-- 人员查询 -->
	<select id="getPersons" parameterClass="com.yds.manual.bean.Person" resultClass="com.yds.manual.bean.Person">
		SELECT 
			OB_ID AS id, 
			OB_NAME AS name,
			PRO1_VAR AS department,
			PRO2_VAR AS position,
			PRO3_VAR AS phoneNumber
		FROM 
			MAN_MAJOR_INFO 
		WHERE 
			MOD_TYPE = 'sessionStore'
		<isNotEmpty prepend="AND" property="id"> 
			OB_ID LIKE CONCAT(#id#, '%')
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="name"> 
			OB_NAME LIKE CONCAT('%', #name#, '%')
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="department"> 
			PRO1_VAR LIKE CONCAT(#department#, '%')
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="position"> 
			PRO2_VAR LIKE CONCAT(#position#, '%')
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="phoneNumber"> 
			PRO3_VAR LIKE CONCAT(#phoneNumber#, '%')
		</isNotEmpty>
	</select>

	<!-- 人员删除 -->
	<delete id="deletePerson" parameterClass="com.yds.manual.bean.Person">
		DELETE FROM 
			MAN_MAJOR_INFO 
		WHERE 
			MOD_TYPE = 'sessionStore'
			AND OB_ID = #id#
	</delete>

	<!-- 人员添加 -->
	<insert id="addPerson" parameterClass="com.yds.manual.bean.Person">		
		INSERT INTO MAN_MAJOR_INFO  
			(
			OB_ID,
			OB_NAME,
			PRO1_VAR,
			PRO2_VAR,
			PRO3_VAR
			)
		VALUES
			(
			#id#,
			#name#,
			#department#, 
			#position#,
			#phoneNumber#
			);
	</insert>

	<update id="savePerson" parameterClass="com.yds.manual.bean.Person">
		UPDATE MAN_MAJOR_INFO 
		   SET OB_NAME = #name#
		 WHERE   
			    MOD_TYPE = 'sessionStore'
				AND OB_ID = #id#		 
	</update>
</sqlMap>  
