<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="LoginDao">
	<typeAlias alias="userResult" type="com.yds.common.bean.UserResult"/>

	<!-- 登录 新数据库 --> 
	<select id="login" parameterClass="String" resultClass="userResult">  
		SELECT
		  EMP_ID AS userId,
		  PASSWORD AS userPassword,
		  EMP_CNM AS userName
		FROM V_EMP_LIST_QUIT
		WHERE EMP_ID = #userId#
		  AND USER_STATE = '1';
	</select>
	<!-- 判断版本号-->
	<select id="verCheck" parameterClass="String" resultClass="String">  
		SELECT
		  PASSWORD_VER AS passwordVer
		FROM COM_USER
		WHERE USER_ID = #userId#
		  AND USER_STATE = '1';
	</select>
	<!-- 更改新数据库的密码信息-->
	<update id="updatePW" parameterClass="userResult">
		UPDATE COM_USER
		   SET PASSWORD=#userPassword#,
               PASSWORD_VER='1'
         WHERE USER_ID= #userId#		
	</update>
	<!-- 登录 旧数据库 --> 
	<select id="oldlogin" parameterClass="String" resultClass="userResult">  
		SELECT
		  EMP_ID AS userId,
		  EMP_PASSWD AS userPassword,
		  EMP_NAME AS userName
		  FROM TEMPINFO
		WHERE EMP_ID = #userId#
		  AND EMP_FLAG = '0'
	</select>    
	<!-- 域用户登录 新系统 --> 
	<select id="domainlogin" parameterClass="String" resultClass="userResult">  
		SELECT
		  EMP_ID AS userId,
		  EMP_CNM AS userName
		FROM V_EMP_LIST_QUIT
		WHERE EMP_DMNM = #userId#
		  AND USER_STATE = '1';
	</select>	
</sqlMap>
