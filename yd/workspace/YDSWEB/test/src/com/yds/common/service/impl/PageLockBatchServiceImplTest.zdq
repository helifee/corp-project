/*
 * @(#)PageLockBatchServiceImplTest.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东公司内部网
 *    SubSystem: 共通系统
 */
package com.yds.common.service.impl;
import static com.yds.base.test.BeanAssert.assertListEquals;
import java.util.List;
import javax.annotation.Resource;
import org.junit.Before;
import org.junit.Test;
import com.yds.base.test.AbstractSpringTransTest;
import com.yds.common.bean.PageLockInfo;
import com.yds.common.service.PageLockBatchService;

/**
 * 画面排他用户信息删除处理BATCH（数据库操作）测试.
 * 
 * @author mengxiaoyan
 * @version 1.00 2010/06/05
 */
public class PageLockBatchServiceImplTest extends AbstractSpringTransTest {
		/** 注入Service */
		@Resource
		private PageLockBatchService pageLockBatchService;

		/**
		 * 初始化测试信息
		 * 
		 * @throws java.lang.Exception
		 */
		@Before
		public void setUp() throws Exception {

			// 删除表中数据(避免和测试数据冲突)
			this.deleteFromTables("com_page_lock");

			initCommonData(PageLockBatchServiceImpl.class);
		}

		/**
		 * Test method for
		 * {@link com.yds.common.service.impl.PageLockBatchServiceImpl#deleteLockUser()}
		 * 
		 */
		@Test
		public final void testDeleteLockUser()throws Exception {
			// 初始化数据库
			initData("input01.xls", "result01.xls");
			
			// 调用被测试方法
			pageLockBatchService.deleteLockUser();
			
			// 检索不满足条件的数据
			List<PageLockInfo> actualInfoBef = findListBeanByCondition(PageLockInfo.class,
			"param_com_page_lock");

			// 得到预期值
			List<PageLockInfo>  expectLogInfo = getExpectList(PageLockInfo.class, "expect");

			// 断言检索结果和预期是不是一致
			assertListEquals(actualInfoBef,expectLogInfo);

		}
}
