package com.yds.common.service.impl;

import static com.yds.base.test.BeanAssert.assertBeanLenientEquals;
import static com.yds.base.test.BeanAssert.assertListLenientEquals;

import java.util.List;

import javax.annotation.Resource;
import org.junit.Before;
import org.junit.Test;

import com.yds.base.test.AbstractSpringTransTest;

import com.yds.common.bean.SysLogSearchInfo;
import com.yds.common.service.SysLogSearchService;

public class SysLogSearchServiceImplTest extends AbstractSpringTransTest{

	/** @Resource，自动注入Service */
	@Resource
	private SysLogSearchService sysLogSearchService;
	
	@Before
	public void setUp() throws Exception {
		
        initCommonData(SysLogSearchServiceImpl.class);
		
		// 删除表中数据
		this.deleteFromTables("COM_LOG_MST", "SYS_CODE_MST", "EMP_INFO", "COM_USER" );
	}


	@Test
	public void testGetSysLogInfo() throws Exception{
		
		// 初始化数据库
		initData("input01.xls","result01.xls");
		
		// 参数
		SysLogSearchInfo sysLogSearchInfo1 = getParamObject(SysLogSearchInfo.class, "param_False");
		
		// 调用被测试方法
		List<SysLogSearchInfo> actualResults1 = sysLogSearchService.getSysLogInfo(sysLogSearchInfo1, 0, 20);
		
		// 得到预期值
		List<SysLogSearchInfo> expectResults1 = getExpectList(SysLogSearchInfo.class, "expect_False");
		
		assertListLenientEquals(expectResults1, actualResults1);
		
		// 参数
		SysLogSearchInfo sysLogSearchInfo2 = getParamObject(SysLogSearchInfo.class, "param_True");
		
		// 调用被测试方法
		List<SysLogSearchInfo> actualResults2 = sysLogSearchService.getSysLogInfo(sysLogSearchInfo2, 0, 20);
		
		// 得到预期值
		List<SysLogSearchInfo> expectResults2 = getExpectList(SysLogSearchInfo.class, "expect_True");
		
		assertListLenientEquals(expectResults2, actualResults2);
		
	}

	@Test
	public void testGetTotalCount() throws Exception{
		
		// 初始化数据库
		initData("input01.xls", "result01.xls");
		
		// 参数
		SysLogSearchInfo sysLogSearchInfo1 = getParamObject(SysLogSearchInfo.class, "param_False");
		
		// 调用被测试方法
		Long actualResult1 = sysLogSearchService.getTotalCount(sysLogSearchInfo1);
		
		// 得到预期值
		Long expectResult1 =  getParamObject(Long.class, "expect_Total1");
		
		assertBeanLenientEquals(expectResult1, actualResult1);
		
		// 参数
		SysLogSearchInfo sysLogSearchInfo2 = getParamObject(SysLogSearchInfo.class, "param_True");
		
		// 调用被测试方法
		Long actualResult2 = sysLogSearchService.getTotalCount(sysLogSearchInfo2);
		
		// 得到预期值
		Long expectResult2 =  getParamObject(Long.class, "expect_Total2");
		
		assertBeanLenientEquals(expectResult2, actualResult2);
	}

}
