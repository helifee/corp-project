/*
 * @(#)ComSequenceServiceImplTest.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东公司内部网
 *    SubSystem: 共通系统
 */
package com.yds.common.service.impl;

import static org.junit.Assert.*;
import static com.yds.base.test.BeanAssert.assertBeanLenientEquals;

import javax.annotation.Resource;

import org.junit.Before;
import org.junit.Test;

import com.yds.base.test.AbstractSpringTransTest;
import com.yds.common.bean.ComSeq;
import com.yds.common.service.ComSequenceService;

/**
 * @author tianjian
 *
 */
public class ComSequenceServiceImplTest extends AbstractSpringTransTest  {
	/** @Resource，自动注入Service */
	@Resource
	private ComSequenceService comSequenceService;
	
	/**
	 * @throws java.lang.Exception
	 */
	@Before
	public void setUp() throws Exception {
		// 删除表中数据
		deleteFromTables("com_seq");
		// 共通数据
		initCommonData(ComSequenceServiceImpl.class);
	}

	/**
	 * Test method for {@link com.yds.common.service.impl.ComSequenceServiceImpl#getNextSequence(java.lang.String, java.lang.String, int)}.
	 */
	@Test
	public void testGetNextSequence() throws Exception{
		initData("input01.xls", "result01.xls");
		String tableNm = getParamObject(String.class, "param1");
		String colunmNm = getParamObject(String.class, "param2");
		int valueSize = getParamObject(Integer.class, "param3");
		String actual = comSequenceService.getNextSequence(tableNm,colunmNm,valueSize);
		String expected = getExpectObject(String.class);
		assertEquals(expected, actual);
		actual = comSequenceService.getNextSequence(tableNm,colunmNm,0);
		expected = getExpectObject(String.class,"expect2");
		assertEquals(expected, actual);
	}
	
	@Test(expected=Exception.class)
	public void testGetNextSequence2() throws Exception{
		initData("input02.xls","result01.xls");
		String tableNm = getParamObject(String.class, "param1");
		String colunmNm = getParamObject(String.class, "param2");
		int valueSize = getParamObject(Integer.class, "param3");
		comSequenceService.getNextSequence(tableNm,colunmNm,valueSize);	
	}
	/**
	 * Test method for {@link com.yds.common.service.impl.ComSequenceServiceImpl#getNextSequence(java.lang.String, java.lang.String, int)}.
	 */
	@Test
	public void testGetNextSequence3() throws Exception{
		initData("", "result03.xls");
		String tableNm = getParamObject(String.class, "param1");
		String colunmNm = getParamObject(String.class, "param2");
		int valueSize = getParamObject(Integer.class, "param3");
		comSequenceService.getNextSequence(tableNm,colunmNm,valueSize);
		ComSeq actual = findBeanByCondition(ComSeq.class,"param_COM_SEQ");
		ComSeq expected = getExpectObject(ComSeq.class);
		assertBeanLenientEquals(expected, actual);
	}
}
