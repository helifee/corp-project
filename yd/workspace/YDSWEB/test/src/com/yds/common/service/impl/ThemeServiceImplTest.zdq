/**
 * 
 */
package com.yds.common.service.impl;

import static com.yds.base.test.BeanAssert.assertBeanLenientEquals;

import java.util.Map;

import javax.annotation.Resource;

import org.junit.After;
import org.junit.AfterClass;
import org.junit.Before;
import org.junit.BeforeClass;
import org.junit.Test;

import com.yds.base.test.AbstractSpringTransTest;
import com.yds.base.test.ExcelUtil;
import com.yds.common.service.SessionConstants;
import com.yds.common.service.ThemeService;

/**
 * @author lincheng
 *
 */
public class ThemeServiceImplTest extends AbstractSpringTransTest {
	
	/** @Resource，自动注入Service */
	@Resource
	private ThemeService themeService;
	// 全局session变量
	private static Map<String, Object> session;

	/**
	 * @throws java.lang.Exception
	 */
	@BeforeClass
	public static void setUpBeforeClass() throws Exception {
		// 模拟session，并实例化
		session = ExcelUtil.getSession();
	}

	/**
	 * @throws java.lang.Exception
	 */
	@AfterClass
	public static void tearDownAfterClass() throws Exception {
	}

	/**
	 * @throws java.lang.Exception
	 */
	@Before
	public void setUp() throws Exception {
		
		// 删除主题信息表
		deleteFromTables("com_theme_info","com_theme");
		
		// 初始化数据
		initCommonData(ThemeServiceImpl.class,"init.xls");
	}

	/**
	 * @throws java.lang.Exception
	 */
	@After
	public void tearDown() throws Exception {
	}


	/**
	 * Test method for {@link com.yds.common.service.impl.ThemeServiceImpl#getThemeNm(java.lang.String)}.
	 * @throws Exception 
	 */
	@Test
	public void testGetThemeNm() throws Exception {
		//插入测试数据
		initData("" , "result01.xls");
		// 初始化测试方法参数
		String userId = getParamObject(String.class);
		// 调用测试方法
		themeService.getThemeNm(userId);
		// 取得测试结果
		String actualInfo = (String) session.get(SessionConstants.USERTHEME);
		// 取得预期值
		String expectInfo = getExpectObject(String.class);
		// 断言检索结果和预期是否一致
		assertBeanLenientEquals(expectInfo, actualInfo);
	}

}
