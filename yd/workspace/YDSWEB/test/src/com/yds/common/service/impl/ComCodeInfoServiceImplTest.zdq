/*
 * @(#)ComCodeInfoServiceImplTest.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东公司内部网
 *    SubSystem: 共通系统
 */
package com.yds.common.service.impl;

import static org.junit.Assert.*;
import static com.yds.base.test.BeanAssert.*;

import java.util.List;

import javax.annotation.Resource;

import org.junit.Before;
import org.junit.Test;

import com.yds.base.test.AbstractSpringTransTest;
import com.yds.common.bean.ComCodeInfo;
import com.yds.common.service.ComCodeInfoService;

/**
 * @author tianjian
 * 
 */
public class ComCodeInfoServiceImplTest extends AbstractSpringTransTest {
	/** @Resource，自动注入Service */
	@Resource
	private ComCodeInfoService comCodeInfoService;

	/**
	 * @throws java.lang.Exception
	 */
	@Before
	public void setUp() throws Exception {
		// 删除表中数据
		deleteFromTables("SYS_CODE_MST");
		// 共通数据
		initCommonData(ComCodeInfoServiceImpl.class, "init.xls");
	}

	/**
	 * Test method for
	 * {@link com.yds.common.service.impl.ComCodeInfoServiceImpl#getComCodeInfo(java.lang.String, java.lang.String, java.lang.String[])}
	 * .
	 */
	@Test
	public void testGetComCodeInfo() throws Exception {
		initData("", "result01.xls");
		// 区分结果里不需要追加项目的情况
		ComCodeInfo comCodeInfo = getParamObject(ComCodeInfo.class, "param1");
		String subSys = comCodeInfo.getSubSys();
		String typeId = comCodeInfo.getTypeId();
		List<ComCodeInfo> actualList1 = comCodeInfoService.getComCodeInfo(
				subSys, typeId);
		List<ComCodeInfo> expectList1 = getExpectList(ComCodeInfo.class,
				"expect1");
		assertListEquals(expectList1, actualList1);

		// 区分结果里追加空行的的情况
		List<ComCodeInfo> actualList2 = comCodeInfoService.getComCodeInfo(
				subSys, typeId, " ");
		List<ComCodeInfo> expectList2 = getExpectList(ComCodeInfo.class,
				"expect2");
		assertListEquals(expectList2, actualList2);

		// 区分结果里追加一行的的情况
		List<ComCodeInfo> actualList3 = comCodeInfoService.getComCodeInfo(
				subSys, typeId, "00", "全部");
		List<ComCodeInfo> expectList3 = getExpectList(ComCodeInfo.class,
				"expect3");
		assertListEquals(expectList3, actualList3);
	}

	/**
	 * Test method for
	 * {@link com.yds.common.service.impl.ComCodeInfoServiceImpl#getDiffName(java.lang.String, java.lang.String, java.lang.String)}
	 * .
	 */
	@Test
	public void testGetDiffName() throws Exception {
		initData("", "result02.xls");
		// 根据区分No能检索出数据的时候
		ComCodeInfo comCodeInfo = getParamObject(ComCodeInfo.class, "param1");
		String subSys = comCodeInfo.getSubSys();
		String typeId = comCodeInfo.getTypeId();
		String diffNo = comCodeInfo.getDiffNo();
		String actualDiffName = comCodeInfoService.getDiffName(subSys, typeId,
				diffNo);
		String expectDiffName = getExpectObject(String.class, "expect1");
		assertEquals(expectDiffName, actualDiffName);

		// 根据区分No能检索不出数据的时候
		ComCodeInfo comCodeInfo2 = getParamObject(ComCodeInfo.class, "param2");
		subSys = comCodeInfo2.getSubSys();
		typeId = comCodeInfo2.getTypeId();
		diffNo = comCodeInfo2.getDiffNo();
		actualDiffName = comCodeInfoService.getDiffName(subSys, typeId, diffNo);
		assertEquals("", actualDiffName);

	}
}
