/**
 * 
 */
package com.yds.att.service.impl;

import java.util.List;
import java.util.Map;

import javax.annotation.Resource;

import org.junit.After;
import org.junit.Before;
import org.junit.BeforeClass;
import org.junit.Test;

import com.yds.att.bean.AttRestApp;
import com.yds.att.bean.Ye0040CondA;
import com.yds.att.service.Ye0040Service;
import com.yds.base.test.AbstractSpringTransTest;
import com.yds.base.test.BeanAssert;
import com.yds.base.test.ExcelUtil;
import com.yds.common.bean.UserInfo;
import com.yds.common.service.SessionConstants;

/**
 * @author lincheng
 *
 */
//@TransactionConfiguration(defaultRollback = false)
public class Ye0040ServiceImplTest extends AbstractSpringTransTest {

	@Resource
	private Ye0040Service ye0040Service;
	/**
	 * @throws java.lang.Exception
	 */
	@BeforeClass
	public static void setUpBeforeClass() throws Exception {
		
	}
	/**
	 * @throws java.lang.Exception
	 */
	@Before
	public void setUp() throws Exception {
		initCommonData(Ye0040ServiceImpl.class);
		
		// 删除表中数据(避免和测试数据冲突)
		deleteFromTables("ATT_REST_APP", "ATT_EXAMIN", "COM_HOLIDAY", "emp_info", "EMP_ORG_INFO", "com_user","sys_code_mst");
	}

	/**
	 * @throws java.lang.Exception
	 */
	@After
	public void tearDown() throws Exception {
	}

	/**
	 * Test method for {@link com.yds.att.service.impl.Ye0040ServiceImpl#getAttRestAppList(com.yds.att.bean.Ye0040CondA)}.
	 * @throws Exception 
	 */
	@Test
	public final void testGetAttRestAppList() throws Exception {
		// 初始化数据库
		super.initData("input.xls", "result.xls");
		
		// 初始化测试方法参数
		Ye0040CondA ye0040CondA = getParamObject(Ye0040CondA.class,"param");
		ye0040CondA.setAttFlag(true);
		
		//取得插入的数据
		List<AttRestApp> actual = ye0040Service.getAttRestAppList(ye0040CondA);
		
		//取得期望数据
		List<AttRestApp> expect = super.getExpectList(AttRestApp.class, "expect_ATT_REST_APP");
		
		//断言检索结果和预期是否一致
		BeanAssert.assertListLenientEquals(expect, actual);
	}

	/**
	 * Test method for {@link com.yds.att.service.impl.Ye0040ServiceImpl#updateAttPend(java.lang.String, boolean, java.lang.String)}.
	 */
	@Test
	public final void testUpdateAttPend() throws Exception {
		// 初始化数据库
		super.initData("input.xls", "result.xls");
		
		// 初始化测试方法参数
		String appId = "00000000000001";
		boolean agree = true;
		String exaSuggestion = "OK";
		// 模拟Session设值
		UserInfo userInfo = new UserInfo();
		userInfo.setUserId("YD200509");
		Map<String, Object> session = ExcelUtil.getSession();
		session.put(SessionConstants.USERINFO, userInfo);
		
//		ye0040Service.updateAttPend(appId, agree, exaSuggestion);
		
		//取得插入的数据
		List<AttRestApp> actualARA = findListBeanByCondition(AttRestApp.class, "param1_ATT_REST_APP");
		
		//取得期望数据
		List<AttRestApp> expectARA = super.getExpectList(AttRestApp.class, "expect1_ATT_REST_APP");
		
		//断言检索结果和预期是否一致
//		BeanAssert.assertListLenientEquals(expectARA, actualARA);
	}

	public void setYe0040Service(Ye0040Service ye0040Service) {
		this.ye0040Service = ye0040Service;
	}

}
