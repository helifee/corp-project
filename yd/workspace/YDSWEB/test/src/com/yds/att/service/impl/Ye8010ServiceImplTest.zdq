package com.yds.att.service.impl;

import java.util.List;

import javax.annotation.Resource;

import org.junit.After;
import org.junit.Before;
import org.junit.Ignore;
import org.junit.Test;

import com.yds.att.bean.AttInfo;
import com.yds.base.test.AbstractSpringTransTest;
import com.yds.base.test.BeanAssert;
import com.yds.common.bean.ComIoData;
import com.yds.ws.service.HandleService;

/**
 * 
 * @author zhangdaoqiang
 *
 */
public class Ye8010ServiceImplTest extends AbstractSpringTransTest {
	
	@Resource
	private HandleService ye8010Service;

	@Before
	public void setUp() throws Exception {
		initCommonData(Ye8010ServiceImpl.class);
		
		// 删除表中数据(避免和测试数据冲突)
		deleteFromTables("COM_IODATA", "COM_SERVICE", "ATT_INFO", "ATT_EMP_TYPE");
	}

	@After
	public void tearDown() throws Exception {
	}
	
	/**
	 * 开始时间为空
	 * 
	 * @throws Exception
	 */
	@Test
	@Ignore
	public void testHandle() throws Exception {
		
		// 初始化数据库
		super.initData("input.xls", "result.xls");
		
		// 初始化测试方法参数
		List<ComIoData> ioDataList = super.getParamList(ComIoData.class, "param1_COM_IODATA");
		
		// 调用被测试方法
		ye8010Service.handle(ioDataList);
		
		//取得插入的数据
		List<AttInfo> actual = super.findListBeanByCondition(AttInfo.class, "param_ATT_INFO");
		
		//取得期望数据
		List<AttInfo> expect = super.getExpectList(AttInfo.class, "expect1_ATT_INFO");
		
		//断言检索结果和预期是否一致
		BeanAssert.assertListLenientEquals(expect, actual);
	}
	
	/**
	 * 开始时间非空
	 * 
	 * @throws Exception
	 */
	@Test
	@Ignore
	public void testHandle2() throws Exception {
		
		// 初始化数据库
		super.initData("input2.xls", "result.xls");
		
		// 初始化测试方法参数
		List<ComIoData> ioDataList = super.getParamList(ComIoData.class, "param2_COM_IODATA");
		
		// 调用被测试方法
		ye8010Service.handle(ioDataList);
		
		//取得插入的数据
		List<AttInfo> actual = super.findListBeanByCondition(AttInfo.class, "param_ATT_INFO");
		
		//取得期望数据
		List<AttInfo> expect = super.getExpectList(AttInfo.class, "expect2_ATT_INFO");
		
		//断言检索结果和预期是否一致
		BeanAssert.assertListLenientEquals(expect, actual);
	}

}
