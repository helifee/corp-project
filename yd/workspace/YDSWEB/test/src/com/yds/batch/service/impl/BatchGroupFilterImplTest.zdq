/*
 * @(#)BatchGroupFilterImplTest.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东公司内部网
 *    SubSystem: 批处理系统
 */

package com.yds.batch.service.impl;

import java.util.List;

import javax.annotation.Resource;

import org.junit.After;
import org.junit.Before;
import org.junit.Test;

import com.yds.base.test.AbstractSpringTransTest;
import com.yds.base.test.BeanAssert;
import com.yds.batch.bean.BatchGroup;
import com.yds.batch.service.BatchGroupFilter;

/**
 * 批处理任务筛选类测试
 * 
 * @author wangduo
 * @version 1.0 2010/05/26
 */
public class BatchGroupFilterImplTest extends AbstractSpringTransTest {

	@Resource
	BatchGroupFilter batchGroupFilter;
	
	/**
	 * @throws java.lang.Exception
	 */
	@Before
	public void setUp() throws Exception {
		initCommonData(BatchGroupFilterImpl.class);
		deleteFromTables("BAT_GROUP");
	}

	/**
	 * @throws java.lang.Exception
	 */
	@After
	public void tearDown() throws Exception {
	}

	/**
	 * Test method for {@link com.yds.batch.service.impl.BatchGroupFilterImpl#getValidJobGroups()}.
	 * @throws Exception 
	 */
	@Test
	public void testGetValidJobGroups() throws Exception {

		//插入测试数据
		initData("input01.xls" , "result01.xls");
		
		// 任务组期望结果
		List<BatchGroup> expectJobGroups = getExpectList(BatchGroup.class);

		
		// 任务组实际结果
		List<BatchGroup> actualJobGroups = batchGroupFilter.getValidJobGroups();
	
		
		BeanAssert.assertListLenientEquals(expectJobGroups, actualJobGroups);
	}

}
