/*
 * @(#)PageLockBatchServiceImplTest.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东公司内部网
 *    SubSystem: 权限系统
 */
package com.yds.perm.service.impl;
import java.util.List;
import javax.annotation.Resource;
import org.junit.Before;
import org.junit.Test;
import static org.junit.Assert.assertTrue;
import com.yds.base.test.AbstractSpringTransTest;
import com.yds.perm.bean.PerUserPermitInfo;
import com.yds.perm.service.UserPermitTimeBatchService;

/**
 * 授权过期用户信息删除处理BATCH（数据库操作）测试.
 * 
 * @author mengxiaoyan
 * @version 1.00 2010/06/05
 */

public class UserPermitTimeBatchServiceImplTest extends AbstractSpringTransTest {
	/** 注入Service */
	@Resource
	private UserPermitTimeBatchService userPermitTimeBatchService;

	/**
	 * 初始化测试信息
	 * 
	 * @throws java.lang.Exception
	 */
	@Before
	public void setUp() throws Exception {

		// 删除表中数据(避免和测试数据冲突)
		this.deleteFromTables("PER_USER_PERMIT");

		initCommonData(UserPermitTimeBatchServiceImpl.class);
	}

	/**
	 * Test method for
	 * {@link com.yds.perm.service.impl.UserPermitTimeBatchServiceImpl#deleteOverdueUser()}
	 * .
	 */
	@Test
	// 删除授权过期用户方法测试
	public void testDeleteOverdueUser() throws Exception {

		// 初始化数据库
		initData("input01.xls", "result01.xls");

		// 调用被测试方法
		userPermitTimeBatchService.deleteOverdueUser();

		// 检索满足删除条件的数据
		List<PerUserPermitInfo> actualInfoAft = findListBeanByCondition(PerUserPermitInfo.class,
		"param_per_user_permit");

		assertTrue(actualInfoAft.size() == 0);
	}

}
