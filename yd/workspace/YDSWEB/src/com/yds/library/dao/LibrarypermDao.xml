<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="LibrarypermDao">
	
	<typeAlias alias="libraryPerm" type="com.yds.library.bean.LibraryPerm"/>
	
	<!-- 用户权限取得 --> 
	<select id="getLibraryPerm" parameterClass="String" resultClass="libraryPerm">
		SELECT
		  T2.NAMESPACE AS nameSpace,
		  T2.ACTION_NAME AS actionName
		FROM
		  V_PER_USER_PERM T1,
		  PER_PERMIT T2
		WHERE
		  T1.USER_ID = #userId#
		AND
		  T1.PERM_ID = T2.PARENT_MODULE
		AND
		  T2.IS_PERM = '1'
		AND
		  (T2.SITE_URL='' OR T2.SITE_URL IS NULL);
	</select>
</sqlMap>  
