<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="J030061Dao">
	<typeAlias alias="bookContent" type="com.yds.tt.training.bean.BookContent"/>
	
		<!-- 教材存在数取得 --> 
		<select id="searchBookEditNum" parameterClass="String" resultClass="Integer">
			SELECT
				COUNT(*)
			FROM   
				TT_JIAOCAI          T1
			WHERE 
				T1.BOOK_ID = #bookId#
		</select>
	
		<!-- 章节信息取得 --> 
		<select id="getChapterInfos" parameterClass="BookContent" resultClass="BookContent"> 
			SELECT T1.BOOK_ID AS bookId,
			       T1.EDIT_NO AS editNo,
				   T1.CHAPTER_NO AS chapterNo,
		           T1.CHAPTER_TITLE AS chapterTitle,
		           T1.SHOW_LEVEL AS showLevel,
				   T1.SHOW_ORDER AS showOrder
			FROM   TT_JIAOCAI_NEIRONG T1

			WHERE  T1.BOOK_ID = #bookId# AND 
				   T1.EDIT_NO = #editNo#
			ORDER BY
				   T1.SHOW_ORDER		
		</select>
	
	<!-- 最大章节编号取得 --> 
	<select id="getMaxChapterNo" parameterClass="BookContent" resultClass="Integer"> 
		SELECT MAX(T1.CHAPTER_NO)
		FROM   TT_JIAOCAI_NEIRONG T1
			WHERE T1.BOOK_ID = #bookId#
			AND T1.EDIT_NO = #editNo#
		
	</select>
	
	<!-- 添加教材内容信息 --> 
	<insert id="insertChapterInfos" parameterClass="bookContent">
		INSERT INTO
        TT_JIAOCAI_NEIRONG (
        	BOOK_ID ,
        	EDIT_NO ,
        	CHAPTER_NO ,
        	CHAPTER_TITLE,
			SHOW_LEVEL,
			SHOW_ORDER,
			BOOK_CONTENT,
			CREATE_USER_ID,
			CREATE_TIME,
			UPDATE_USER_ID,
			UPDATE_TIME			 
        ) VALUES (
        	#bookId#,
        	#editNo#,
        	#chapterNo#,
        	#chapterTitle#,
			#showLevel#,
			#showOrder#,
			#bookContent#,
			#createUserId#,
			NOW(), 
			#updateUserId#,
			NOW()			
        )
	</insert>

	<!-- 删除教材内容信息 --> 
	<delete id="deleteChapterInfos" parameterClass="bookContent">
		DELETE FROM TT_JIAOCAI_NEIRONG
		 WHERE BOOK_ID = #bookId#
		   AND EDIT_NO = #editNo#
		   AND CHAPTER_NO = #chapterNo#         
	</delete>
	
	<!-- 更新教材内容信息 --> 
	<update id="updateChapterInfos" parameterClass="bookContent">
		UPDATE TT_JIAOCAI_NEIRONG 
		   SET CHAPTER_TITLE = #chapterTitle#, 
			   SHOW_LEVEL = #showLevel#,
			   SHOW_ORDER = #showOrder#
		 WHERE BOOK_ID = #bookId#
		   AND EDIT_NO = #editNo#
		   AND CHAPTER_NO = #chapterNo#         
	</update>
	
	<!-- 教材存在数取得 --> 
	<select id="getChapterNum" parameterClass="bookContent" resultClass="Integer">
		SELECT
			COUNT(*)
		FROM   
			TT_JIAOCAI_NEIRONG    T1
		WHERE 
			T1.BOOK_ID = #bookId# AND
			T1.BOOK_ID = #editNo#
	</select>
</sqlMap>  
