/*
 * @(#) K050021DaoImpl.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 教育考试培训系统
 *    SubSystem: 考试子系统
 */

package com.yds.tt.testing.dao.impl;

import java.util.List;
import java.util.Map;

import org.springframework.stereotype.Repository;

import com.yds.base.dao.AbstractBaseDao;
import com.yds.tt.testing.bean.K050021SearchInfo;
import com.yds.tt.testing.bean.TestPaperInfo;
import com.yds.tt.testing.dao.K050021Dao;

/**
 * @see com.yds.tt.testing.dao.K050021Dao
 */
@Repository("k050021Dao")
public class K050021DaoImpl extends AbstractBaseDao implements K050021Dao {

	private List<TestPaperInfo> paperListInfoList;
	private Long sltCount;

	/**
	 * {@inheritDoc}
	 */
	@Override
	@SuppressWarnings("unchecked")
	public List<TestPaperInfo> getPaperListInfos(Integer modeKbn,
			K050021SearchInfo paperListInfo, int offset, int perCounts) {

		if (modeKbn == 1) {
			// 试卷管理模式
			this.paperListInfoList = (List<TestPaperInfo>) super.queryForList(
					"K050021Dao.getPaperListInfosManageMode", paperListInfo,
					offset, perCounts);
		} else if (modeKbn == 2) {
			// 试卷选择模式
			this.paperListInfoList = (List<TestPaperInfo>) super.queryForList(
					"K050021Dao.getPaperListInfosChooseMode", paperListInfo,
					offset, perCounts);
		}
		return paperListInfoList;
	}

	/**
	 * {@inheritDoc}
	 */
	@Override
	public Long getPaperTotalCount(Integer modeKbn,
			K050021SearchInfo paperListInfo) {

		if (modeKbn == 1) {
			// 试卷管理模式
			this.sltCount = (Long) super.queryForObject(
					"K050021Dao.getPaperListInfosCountManageMode",
					paperListInfo);
		} else if (modeKbn == 2) {
			// 试卷选择模式
			this.sltCount = (Long) super.queryForObject(
					"K050021Dao.getPaperListInfosCountChooseMode",
					paperListInfo);
		}
		return sltCount;
	}

	/**
	 * {@inheritDoc}
	 */
	@Override
	public boolean checkTestManager(String loginUserId) {

		this.sltCount = (Long) super.queryForObject(
				"K050021Dao.getTestManagerAuthorityCount", loginUserId);

		if (0 == sltCount) {
			return false;
		}
		return true;
	}

	/**
	 * {@inheritDoc}
	 */
	@Override
	@SuppressWarnings("unchecked")
	public List<String> getExaminePaperRelation(String examineId) {

		return super.queryForList("K050021Dao.getExaminePaperRelation",
				examineId);
	}

	/**
	 * {@inheritDoc}
	 */
	@Override
	public void insertExaminePaperRelation(
			Map<String, String> examinePaperRelation) {
		super.insert("K050021Dao.insertExaminePaperRelation",
				examinePaperRelation);
	}
}
