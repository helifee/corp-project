/*
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东公司内部网
 *    SubSystem: 权限管理
 */

package com.yds.perm.action;

import java.util.List;

import org.springframework.beans.factory.config.BeanDefinition;
import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Controller;

import com.yds.base.action.AbstractBaseAction;
import com.yds.common.bean.PeoOrgInfo;
import com.yds.common.bean.EmpInfo;
import com.yds.common.service.PeoOrgInfoService;
import com.yds.perm.bean.PerRoleInfo;
import com.yds.perm.bean.PerUserPermitInfo;
import com.yds.perm.service.UserRoleMgrService;

/**
 * 用户角色信息一览处理
 * 
 * @author yuanjinling
 * @version 1.00 2010/01/27
 */
@Scope(BeanDefinition.SCOPE_PROTOTYPE)
@Controller("userRoleMgrAction")
public class UserRoleMgrAction extends AbstractBaseAction {

	private static final long serialVersionUID = -2385033882474834775L;
	private PeoOrgInfoService peoOrgInfoService; 	
	private UserRoleMgrService userRoleMgrService;

	private EmpInfo userInfo;  //用户基本信息
	private PerRoleInfo perRoleInfo;  //用户角色信息
	private PerUserPermitInfo perUserPermitInfo;  //用户授权信息
	
	private List<PeoOrgInfo> deptList;  //部门信息一览
	private List<EmpInfo> userInfoList;  //用户列表一览
	private List<PerRoleInfo> perRoleInfoList;  //用户角色信息一览
	private List<PerUserPermitInfo> perUserPermitInfoList;  //用户授权时间表信息一览
	
	private String jsonPermitInfo;  //提交用户角色相关信息用
	
	private String startYear;
	
	/**
	 * 用户角色管理——初期显示
	 * 
	 * @return SUCCESS
	 */
	public String initRolePage() throws Exception {
		
		//取得部门信息
		this.setDeptList(peoOrgInfoService.getDeptList());
		
		//取得用户基本信息
		this.setUserInfoList(userRoleMgrService.getUserInfo(userInfo));
		
		//取得用户角色信息
		this.setPerRoleInfoList(userRoleMgrService.getPerRoleInfo(perRoleInfo));
		
		//取得授权信息
		this.setPerUserPermitInfoList(userRoleMgrService
		                                .getPerUserPermitInfoList(null));
		
		return SUCCESS;
	}
	
	/**
	 * 取得用户列表
	 * 
	 * @return SUCCESS
	 */
	public String searchUserList() throws Exception {
		
		// 取得用户列表一览
		this.setUserInfoList(userRoleMgrService.getUserInfo(userInfo));

		return SUCCESS;
	}	
	
	/**
	 * 提交用户职位信息
	 * 
	 * @return SUCCESS
	 */
	public String submitUserRole()throws Exception {
		
		// 提交用户职位信息
		userRoleMgrService.updateUserRole(jsonPermitInfo);
		
		return SUCCESS;
	}		
	
	/**
	 * @param userRoleMgrService 
	 * the userRoleMgrService to set
	 */
	public void setUserRoleMgrService(UserRoleMgrService userRoleMgrService) {
		this.userRoleMgrService = userRoleMgrService;
	}

	/**
	 * @return the perRoleInfo
	 */
	public PerRoleInfo getPerRoleInfo() {
		return perRoleInfo;
	}

	/**
	 * @param perRoleInfo 
	 * the perRoleInfo to set
	 */
	public void setPerRoleInfo(PerRoleInfo perRoleInfo) {
		this.perRoleInfo = perRoleInfo;
	}

	/**
	 * @return the perUserPermitInfo
	 */
	public PerUserPermitInfo getPerUserPermitInfo() {
		return perUserPermitInfo;
	}

	/**
	 * @param perUserPermitInfo 
	 * the perUserPermitInfo to set
	 */
	public void setPerUserPermitInfo(PerUserPermitInfo perUserPermitInfo) {
		this.perUserPermitInfo = perUserPermitInfo;
	}



	/**
	 * @return the userInfoList
	 */
	public List<EmpInfo> getUserInfoList() {
		return userInfoList;
	}

	/**
	 * @param userInfoList the userInfoList to set
	 */
	public void setUserInfoList(List<EmpInfo> userInfoList) {
		this.userInfoList = userInfoList;
	}

	/**
	 * @param userInfo the userInfo to set
	 */
	public void setUserInfo(EmpInfo userInfo) {
		this.userInfo = userInfo;
	}

	/**
	 * @return the perRoleInfoList
	 */
	public List<PerRoleInfo> getPerRoleInfoList() {
		return perRoleInfoList;
	}

	/**
	 * @param perRoleInfoList 
	 * the perRoleInfoList to set
	 */
	public void setPerRoleInfoList(List<PerRoleInfo> perRoleInfoList) {
		this.perRoleInfoList = perRoleInfoList;
	}

	/**
	 * @return the jsonPermitInfo
	 */
	public String getJsonPermitInfo() {
		return jsonPermitInfo;
	}

	/**
	 * @param jsonPermitInfo 
	 * the jsonPermitInfo to set
	 */
	public void setJsonPermitInfo(String jsonPermitInfo) {
		this.jsonPermitInfo = jsonPermitInfo;
	}

	/**
	 * @param perUserPermitInfoList 
	 * the perUserPermitInfoList to set
	 */
	public void setPerUserPermitInfoList(List<PerUserPermitInfo> perUserPermitInfoList) {
		this.perUserPermitInfoList = perUserPermitInfoList;
	}

	/**
	 * @return the perUserPermitInfoList
	 */
	public List<PerUserPermitInfo> getPerUserPermitInfoList() {
		return perUserPermitInfoList;
	}	
	
	/**
	 * @param peoOrgInfoService the peoOrgInfoService to set
	 */
	public void setPeoOrgInfoService(PeoOrgInfoService peoOrgInfoService) {
		this.peoOrgInfoService = peoOrgInfoService;
	}

	/**
	 * @param deptList the deptList to set
	 */
	public void setDeptList(List<PeoOrgInfo> deptList) {
		this.deptList = deptList;
	}

	/**
	 * @return the deptList
	 */
	public List<PeoOrgInfo> getDeptList() {
		return deptList;
	}

	/**
	 * @return the stateYear
	 */
	public String getStartYear() {
		return startYear;
	}

	/**
	 * @param stateYear the stateYear to set
	 */
	public void setStartYear(String startYear) {
		this.startYear = startYear;
	}
	
	

}


	
