/*
 * @(#)Yb7010ServiceImpl.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东计算机社内网
 *    SubSystem: 人员管理
 */
package com.yds.employee.service.impl;
import org.springframework.stereotype.Service;
import com.yds.batch.service.BatchJobRun;
import com.yds.common.service.CommonConstants.DataSourceEnum;
import com.yds.employee.service.Yb7010Service;
import com.yds.employee.service.Yb7011Service;
import com.yds.util.service.DbContextHolder;

@Service("yb7010Service")
public class Yb7010ServiceImpl implements Yb7010Service,BatchJobRun {
	private Yb7011Service yb7011Service;

	/**
	 * {@inheritDoc}
	 */
	@Override
	public void jobRun() throws Throwable {
		
		// 使用旧数据库源
		DbContextHolder.setDbType(DataSourceEnum.OLD.toString());
		
		// 取得旧数据
		yb7011Service.getOldData();	
		
		// 切换到默认数据库源
		DbContextHolder.setDbType(DataSourceEnum.NEW.toString());;
		DbContextHolder.clearDbType();	
		
		// 操作新表数据
		yb7011Service.newDBOperation();							

	}
	
	/**
	 * @param yb7010Service the yb7010Service to set
	 */
	public void setYb7011Service(Yb7011Service yb7011Service) {
		this.yb7011Service = yb7011Service;
	}
}
