<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="yb0051Dao">
    
	<typeAlias alias="empOrgInfo1" type="com.yds.common.bean.EmpOrgInfo"/>
	<typeAlias alias="yb0051CondA" type="com.yds.employee.bean.Yb0051CondA"/>
	
	<!--级别列表信息取得  --> 
	<select id="getOrgMngerList"  parameterClass="yb0051CondA" resultClass="yb0051CondA"> 
		SELECT
		SUB_SYS AS subSys,
		TYPE_ID AS typeId,
		PRO1 AS pro1,
		DIFF_NO AS diffNO,
		DIFF_NAME AS diffName
		FROM SYS_CODE_MST
		WHERE 
		     1=1
			<isNotEmpty prepend="AND" property="subSys">
				SUB_SYS = #subSys#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="typeId">
				TYPE_ID = #typeId#
			</isNotEmpty>
			<isNotEmpty prepend="AND" >
				<![CDATA[ PRO1 != 'prjt'   ]]>
			</isNotEmpty>
	</select>
	
	
	<!-- 取得部门主管ID -->
	<select id="getOrgMnger"  parameterClass="String" resultClass="yb0051CondA"> 
		SELECT
		SUB_SYS AS subSys,
		TYPE_ID AS typeId,
		DIFF_NO AS diffNo,
		DIFF_NAME AS diffName
		FROM SYS_CODE_MST
		WHERE 
		     
				SUB_SYS = 'EMP'
				AND
				TYPE_ID = 'ORG_TYPE'
				AND
				DIFF_NO = #diffNo#
	</select>
	
	<!-- 取得表示顺序 -->
	<select id="getDispSeq"  parameterClass="String" resultClass="String"> 
		SELECT
		DISP_SEQ AS dispSeq
		FROM SYS_CODE_MST
		WHERE 
		     
				SUB_SYS = 'EMP'
				AND
				TYPE_ID = 'ORG_TYPE'
				AND
				DIFF_NO = #diffNo#
	</select>
	
	<!-- 取得部门信息 -->
	<select id="getOrgInfo"  parameterClass="String" resultClass="empOrgInfo1"> 
		SELECT
		ORG_ID AS orgId,
		ORG_NM AS orgNm,
		ORG_SNM AS orgSnm,
		ORG_PRO_ID AS orgProId,
		ORG_MNGER AS orgMnger,
		ORG_LEV AS orgLev,
		ORG_DESC AS orgDesc
		FROM EMP_ORG_INFO
		WHERE 
		ORG_ID=#orgId#
		
	</select>
	
	<!-- 取得部门略称 -->
	<select id="getOrgSName"  parameterClass="String" resultClass="empOrgInfo1"> 
		SELECT
		ORG_ID AS orgId,
		ORG_NM AS orgNm,
		ORG_SNM AS orgSnm,
		ORG_PRO_ID AS orgProId,
		ORG_MNGER AS orgMnger,
		ORG_LEV AS orgLev,
		ORG_DESC AS orgDesc
		FROM EMP_ORG_INFO
		WHERE 
		ORG_ID=#orgId#
		
	</select>
	
	<!-- 取得部门主管名称 -->
	<select id="getEmpCnm"  parameterClass="String" resultClass="empInfo"> 
		SELECT
		EMP_ID AS empId,
		EMP_CNM AS empCnm
		FROM EMP_INFO
		WHERE 
		EMP_ID=#empId#
		
	</select>
	
	
	<!-- 修改部门信息 -->
	<update id="updateOrgInfo" parameterClass="empOrgInfo1">
		UPDATE EMP_ORG_INFO
		SET	
		ORG_NM=#orgNm#,
		ORG_SNM=#orgSnm#,
		ORG_PRO_ID=#orgProId#,
		ORG_MNGER=#orgMnger#,
		ORG_DESC=#orgDesc#
		WHERE
			ORG_ID=#orgId#
	</update>
	
	
	<!-- 取得部门阶层List -->
	<select id="getOrgLevList"  parameterClass="String"  resultClass="String"> 
		SELECT
		T1.ORG_LEV AS orgLev
		FROM EMP_ORG_INFO T1
		WHERE 
			T1.ORG_LEV LIKE CONCAT(#orgLev#,'%')
	</select>
	
	 <!-- 取得部门阶层 -->
	<select id="getOrgLev"  parameterClass="String" resultClass="String"> 
			SELECT
			ORG_LEV AS orgLev
			FROM EMP_ORG_INFO
			WHERE 
			
			ORG_ID=#orgId#
	</select>
	
	 <!-- 添加部门信息 -->
	<insert id="insertOrgInfo" parameterClass="empOrgInfo1">
		INSERT INTO EMP_ORG_INFO
		   (
		   		ORG_ID ,
				ORG_NM ,
				ORG_SNM,
				ORG_ST_DATE,
				ORG_END_DATE,
				ORG_STATE_FLG,
				ORG_PRO_ID,
				ORG_LEV,
				ORG_VIEW_FLG,
				ORG_MNGER,
				ORG_DESC,
				UPDATE_USER,
				UPDATE_TIME
		   )
		VALUES
		   (
		    #orgId#,
			#orgNm#,
			#orgSnm#,
			NOW(),
			'9999/12/31',
			#orgStateFlg#,
			#orgProId#,
			#orgLev#,
			#orgViewFlg#,
			#orgMnger#,
			#orgDesc#,
			#updateUser#,
			NOW()
	
		   );
	</insert>
	<select id="getEmpInfoListById" resultClass="EmpInfo">
			SELECT 
			    QUIT_DATE AS endDate,
				EMP_CNM   as empCnm
			FROM EMP_INFO 
		
		</select>

</sqlMap> 
