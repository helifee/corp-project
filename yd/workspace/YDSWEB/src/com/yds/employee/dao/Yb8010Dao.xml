<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Yb8010Dao">
    <typeAlias alias="EmpStateInfo" type="com.yds.employee.bean.EmpStateInfo"/>
	
	<!-- 取得员工状态信息表中员工状态 -->
	<select id="getEmpStateInfoList" resultClass="EmpStateInfo">				
		<![CDATA[
		SELECT 
				 EMP_ID             as   empId
				,START_TIME         as   startTime
				,END_TIME           as   endTime
				,EMP_STATE          as   empState
				,UPDATE_USER        as   updateUser
				,UPDATE_TIME        as   updateTime
			FROM  EMP_STATE_INFO
		 WHERE   START_TIME <= LEFT(NOW(),10)
		   AND   END_TIME >= LEFT(NOW(),10)
			]]>
	</select>
	
	<!-- 更新员工基本信息表中员工状态ID --> 
	<update id="updateEmpInfo" parameterClass="EmpStateInfo">
		UPDATE 
			EMP_INFO
		SET
			EMP_STATE_ID = #empState#
		WHERE
			EMP_ID = #empId#
	</update>	
</sqlMap>  
