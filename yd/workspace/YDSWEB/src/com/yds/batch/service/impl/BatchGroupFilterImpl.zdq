/*
 * @(#)BatchGroupFilterImpl.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东公司内部网
 *    SubSystem: 批处理系统
 */

package com.yds.batch.service.impl;

import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

import org.springframework.stereotype.Service;

import com.yds.batch.bean.BatchGroup;
import com.yds.batch.dao.BatchGroupDao;
import com.yds.batch.service.BatchGroupDecorator;
import com.yds.batch.service.BatchGroupFilter;

/**
 * @see BatchGroupFilter
 */
@Service("batchGroupFilter")
public class BatchGroupFilterImpl implements BatchGroupFilter {

	/** BatchGroup功能添加类. */
	private BatchGroupDecorator batchGroupDecorator;
	
	private BatchGroupDao batchGroupDao;

	/**
	 * {@inheritDoc}
	 */
	@Override
	public List<BatchGroup> getValidJobGroups() {

		// 任务组列表
		List<BatchGroup> valJobGroups = new ArrayList<BatchGroup>();

		// 得到任务组列表
		List<BatchGroup> jobGroups = batchGroupDao.getBatchGroups();

		BatchGroup jobGroup = null;

		for (Iterator<BatchGroup> iter = jobGroups.iterator(); iter.hasNext();) {

			jobGroup = iter.next();

			batchGroupDecorator.setJobGroup(jobGroup);
			
			// 判断任务组是否可用
			if (batchGroupDecorator.isValid()) {
				valJobGroups.add(jobGroup);
			}
		}

		return valJobGroups;
	}

	/**
	 * @param batchGroupDecorator the batchGroupDecorator to set
	 */
	public void setBatchGroupDecorator(BatchGroupDecorator batchGroupDecorator) {
		this.batchGroupDecorator = batchGroupDecorator;
	}

	/**
	 * @param batchGroupDao the batchGroupDao to set
	 */
	public void setBatchGroupDao(BatchGroupDao batchGroupDao) {
		this.batchGroupDao = batchGroupDao;
	}

}
