/*
 * @(#)BatchGroupRunnerImpl.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东公司内部网
 *    SubSystem: 批处理系统
 */

package com.yds.batch.service.impl;

import org.springframework.beans.factory.config.BeanDefinition;
import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Service;

import com.yds.batch.bean.BatchGroup;
import com.yds.batch.service.BatchGroupDecorator;
import com.yds.batch.service.BatchGroupRunner;

/**
 * @see BatchGroupRunner
 */
@Scope(BeanDefinition.SCOPE_PROTOTYPE)
@Service("batchGroupRunner")
public class BatchGroupRunnerImpl implements BatchGroupRunner {

	private BatchGroupDecorator batchGroupDecorator;
	
	/** 任务组. */
	private BatchGroup jobGroup;
	
	@Override
	public void run() {
		
		batchGroupDecorator.setJobGroup(jobGroup);
		
		// 任务组执行开始时数据库信息更新
		batchGroupDecorator.updateExecStart();
		
		// 执行任务组
		String execInfo = batchGroupDecorator.executeJobGroup();
		
		// 任务组执行结束时数据库信息更新
		batchGroupDecorator.updateExecEnd(execInfo);

	}

	/**
	 * @param batchGroupDecorator the batchGroupDecorator to set
	 */
	public void setBatchGroupDecorator(BatchGroupDecorator batchGroupDecorator) {
		this.batchGroupDecorator = batchGroupDecorator;
	}

	/**
	 * @param jobGroup the jobGroup to set
	 */
	public void setJobGroup(BatchGroup jobGroup) {
		this.jobGroup = jobGroup;
	}

}
