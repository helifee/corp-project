<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="OrderInfoDao">
    <typeAlias alias="gpsOrderInfo" type="com.yds.gps.common.bean.GpsOrderInfo"/>

	<!-- 取得订单基本信息 --> 
	<select id="getOrderInfo" parameterClass="String" resultClass="gpsOrderInfo">
		SELECT
			ORDER_ID AS orderId,
			ORDER_CONTENT AS orderContent,
			ORDER_CNT AS orderCnt,
			<!-- 开启区分ID和名称-->
			SWITCH_FLAG AS switchFlag,
			(SELECT DIFF_SHORT_NAME FROM SYS_CODE_MST 
			WHERE DIFF_NO = T1.SWITCH_FLAG AND TYPE_ID = 'ORDER_SWCH' AND SUB_SYS = 'GPS') AS switchName,
			<!-- 交易类型ID和名称-->
			BUSS_FLAG AS bussFlag,
			(SELECT DIFF_SHORT_NAME FROM SYS_CODE_MST 
			WHERE DIFF_NO = T1.BUSS_FLAG AND TYPE_ID = 'BUSS_FLAG' AND SUB_SYS = 'GPS') AS bussName,
			
			<!-- 结算方式ID和名称-->
			PAY_FLAG AS payFlag,
			(SELECT DIFF_SHORT_NAME FROM SYS_CODE_MST 
			WHERE DIFF_NO = T1.PAY_FLAG AND TYPE_ID = 'PAYMENT' AND SUB_SYS = 'GPS') AS payName,
			
			<!-- 商品分类ID和名称-->
			GOODS_CATE_ID AS goodsCateId,
			(SELECT CATE_NAME FROM GPS_GOODS_CATE 
			WHERE GOODS_CATE_ID = T1.GOODS_CATE_ID) AS payName,

			GROUP_ID AS groupId,
			ORDER_REMARKS AS orderRemarks,
			CREATE_TIME AS createTime,
			CREATE_USER AS createUser,
			(SELECT EMP_CNM FROM V_EMP_LIST_QUIT 
			WHERE EMP_ID = T1.CREATE_USER) AS createUserName,
			
			UPDATE_TIME AS updateTime,
			UPDATE_USER AS updateUser,
			(SELECT EMP_CNM FROM V_EMP_LIST_QUIT 
			WHERE EMP_ID = T1.UPDATE_USER) AS updateUserName
		FROM 
			gps_order_info T1
		WHERE 
			T1.order_id = #orderId#
	</select>
</sqlMap>