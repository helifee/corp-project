/*
 * @(#)AttInfoDaoImpl.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东公司内部网
 *    SubSystem: 考勤管理
 */

package com.yds.att.common.dao.impl;

import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.stereotype.Repository;

import com.yds.att.bean.AttExrestInfo;
import com.yds.att.bean.AttInfo;
import com.yds.att.bean.AttType;
import com.yds.att.common.dao.AttInfoDao;
import com.yds.base.dao.AbstractBaseDao;

/**
 * @see com.yds.att.common.dao.AttInfoDao
 */
@Repository("attInfoDao")
public class AttInfoDaoImpl extends AbstractBaseDao implements AttInfoDao {

	/** 从员工班型表中取出工作日班型和应出退勤信息
	 *  {@inheritDoc}
	 */
	@Override
	public AttType getAttType(String empId, Date attYmd) {
		DateFormat format=new SimpleDateFormat("yyyy-MM-dd ");
		String attYmdString=format.format(attYmd);
		Map<String,String> map = new HashMap<String,String>();
		map.put("empId", empId);
		map.put("attYmd", attYmdString);
		return (AttType)super.queryForObject("attInfoDao.getAttType",map);						
	}

	/** 从考勤班型表中取出休日班型的应出退勤信息
	 *  {@inheritDoc}
	 */
	@Override
	public AttType getAttLeaveType(String attTypeCd) {
		return (AttType)super.queryForObject("attInfoDao.getAttLeaveType", attTypeCd);
	}

	/** 从考勤信息表中取出考勤信息
	 *  {@inheritDoc}
	 */
	@Override
	public AttInfo getAttInfo(String empId, String year, String month, String day) {
		
		Map<String,String> map = new HashMap<String,String>();
		map.put("empId",empId);
		map.put("year", year);
		map.put("month", month);
		map.put("day", day);
		return (AttInfo)super.queryForObject("attInfoDao.getAttInfo",map);						
	}

	/** 向考勤信息表中插入记录
	 *  {@inheritDoc}
	 */
	@Override
	public void insertBatchAttInfo(AttInfo attInfo) {
		super.insert("attInfoDao.insertBatchAttInfo", attInfo);
	}

	/** 更新考勤信息表的记录
	 *  {@inheritDoc}
	 */
	@Override
	public void updateBatchAttInfo(AttInfo attInfo) {
		super.update("attInfoDao.updateBatchAttInfo", attInfo);
	}
	
	@Override
	public void updateLeaveAttInfo(AttInfo leaveAttInfo) {
		 super.update("attInfoDao.updateLeaveAttInfo", leaveAttInfo);
	}
	
	@Override
	public void updateLeaveAttInfoAddi(AttInfo leaveAttInfo) {
		 super.update("attInfoDao.updateLeaveAttInfoAddi", leaveAttInfo);
	}
	@Override
	public void insertLeaveAttInfo(AttInfo leaveAttInfo) {
		 super.insert("attInfoDao.insertLeaveAttInfo",leaveAttInfo);
	}
	@Override
	public void updateOtAttInfo(AttInfo otAttInfo) {
		 super.update("attInfoDao.updateOtAttInfo", otAttInfo);
	}
	@Override
	public void insertOtAttInfo(AttInfo otAttInfo) {
		 super.insert("attInfoDao.insertOtAttInfo", otAttInfo);
	}
	@Override
	public void updateCdAttInfo(AttInfo otAttInfo) {
		 super.update("attInfoDao.updateCdAttInfo", otAttInfo);
	}
	@Override
	public void insertCdAttInfo(AttInfo otAttInfo) {
		 super.insert("attInfoDao.insertCdAttInfo", otAttInfo);
	}

	/**检索有效换休明细
	 *  {@inheritDoc}
	 */
	@SuppressWarnings("unchecked")
	public List<AttExrestInfo> getExrestInfoByMonth(String empId, Date validDayDate){
		DateFormat format=new SimpleDateFormat("yyyy-MM-dd ");
		String validDayDateStr=format.format(validDayDate);
		Map<String,Object> param = new HashMap<String,Object>();
		param.put("empId", empId);
		param.put("validDayDate", validDayDateStr);
		return (List<AttExrestInfo>) super.queryForList("attInfoDao.getExrestInfoByMonth", param);		
	}

	/** 插入使用换休明细数据
	 *  {@inheritDoc}
	 */
	@Override
	public void insertAttExrestInfo(AttExrestInfo attExrestInfo){
		super.insert("attInfoDao.insertAttExrestInfo", attExrestInfo);
	}

	/** 删除使用换休明细数据
	 *  {@inheritDoc}
	 */
	@Override
	public void deleteAttExrestInfoByAppId(String appId ) {
		super.delete("attInfoDao.deleteAttExrestInfoByAppId", appId);
	}
}
