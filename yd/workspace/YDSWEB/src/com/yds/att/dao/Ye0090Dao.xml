<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Ye0090Dao">
	
	<typeAlias alias="attMonReport" type="com.yds.att.bean.AttMonReport"/>
	<typeAlias alias="ye0090Overtime" type="com.yds.att.bean.Ye0090Overtime"/>
	<typeAlias alias="attInfoUncor" type="com.yds.att.bean.AttInfoUncor"/>
	
	<select id="queryAttMonReport" parameterClass="HashMap" resultClass="attMonReport">	
		SELECT  
			a.EMP_ID AS empId, 
			b.EMP_CNM AS empName,
			a.YEAR AS YEAR, 
			a.MONTH AS MONTH, 
			a.S_ATTEND_DAYS AS sattendDays, 
			a.ATTEND_DAYS AS attendDays, 
			a.ANN_REST_DAYS AS annRestDays, 
			a.SPECIAL_DAYS AS specialDays, 
			a.SICK_DAYS AS sickDays, 
			a.PER_DAYS AS perDays, 
			a.OUT_DAYS AS outDays, 
			a.DUTY_MIN AS dutyMin, 
			a.DUTY_CNT AS dutyCnt, 
			a.SICK_MIN AS sickMin, 
			a.SICK_MIN_DAY AS sickMinDay, 
			a.SICK_CNT AS sickCnt, 
			a.PER_MIN AS perMin, 
			a.PER_MIN_DAY AS perMinDay, 
			a.PER_CNT AS perCnt, 
			a.BELATE_MIN AS belateMin, 
			a.BELATE_MIN_DAY AS belateMinDay, 
			a.BELATE_CNT AS belateCnt, 
			a.LVE_EARLY_MIN AS lveEarlyMin, 
			a.LVE_EARLY_MIN_DAY AS lveEarlyMinDay, 
			a.LVE_EARLY_CNT AS lveEarlyCnt, 
			a.WORKDAY_OT_MIN AS workdayOtMin, 
			a.WORKDAY_OT_CNT AS workdayOtCnt, 
			a.DEEP_OT_MIN AS deepOtMin, 
			a.DEEP_OT_CNT AS deepOtCnt,
			<!--E_REST_MIN_2D AS,--> 
			a.E_REST_MIN AS erestMin, 
			a.USED_E_REST_MIN AS usedErestMin
		FROM att_mon_report a, v_emp_list_quit b
		WHERE YEAR = #year# AND MONTH = #month# AND a.EMP_ID = b.EMP_ID
	</select>
 
	<select id="queryOvertimeReport" parameterClass="HashMap" resultClass="ye0090Overtime">
		SELECT 	
			a.YEAR AS YEAR, 
			a.MONTH AS MONTH, 
			a.DAY AS DAY, 
			a.EMP_ID AS empId, 
			b.EMP_CNM AS empName,
			a.PRJ_ID AS prjId, 
			c.ORG_NM AS prjName,
			a.DPM_ID AS dpmId, 
			a.APP_START_TIME AS appStartTime, 
			a.APP_END_TIME AS appEndTime, 
			a.OVERTIME_COMMENT AS overtimeComment, 
			a.BENEFIT_FLAG AS benefitFlag, 
			a.STATE_FLAG AS stateFlag, 
			a.RATIFY_ID AS ratifyId, 
			a.UPDATE_USER AS updateUser, 
			a.UPDATE_TIME AS updateTime,
			DATE_FORMAT(d.DINNER_TIME_END, '%H:%i:%s') AS dinnerTimeEnd,
			DATE_FORMAT(d.R_END_TIME, '%H:%i:%s') AS rEndTime
		FROM 
			att_overtime a, v_emp_list_quit b, emp_org_info c, att_info d
		WHERE	a.EMP_ID = b.EMP_ID AND a.PRJ_ID = c.ORG_ID AND a.YEAR = d.YEAR 
			AND a.MONTH = d.MONTH AND a.DAY = d.DAY AND a.EMP_ID = d.EMP_ID
			AND a.YEAR = #year# AND a.MONTH = #month#
	</select>
	
	<select id="queryAttInfoUncor"  parameterClass="String" resultClass="attInfoUncor">
		SELECT 	a.ATT_YM AS attYm, 
			a.ATT_PER_ID AS attPerId, 
			b.EMP_CNM AS attperName,
			a.UNCOR_TYPE AS uncorType, 
			a.ORG1 AS org1, 
			a.ORG2 AS org2, 
			a.CNT1 AS cnt1
		FROM 
			att_info_uncor a, v_emp_list_quit b
		WHERE 	a.ATT_YM = #yearMonth# AND a.ATT_PER_ID = b.EMP_ID
		ORDER BY a.ATT_YM, a.ATT_PER_ID, a.UNCOR_TYPE
	</select>
</sqlMap>
