<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Ye0080Dao">
	<typeAlias alias="attInfoApp" type="com.yds.att.bean.AttInfo"/>
	
	<!-- 获取所有人考勤信息 --> 
	<select id="getYe0080ListByDate" parameterClass="attInfoApp" resultClass="attInfoApp">
	<![CDATA[
		SELECT 
	            A.EMP_ID AS empId,
	            (Select EMP_CNM from v_emp_list_quit where EMP_ID=A.EMP_ID) AS empName,
	            A.YEAR AS year,
	            A.MONTH AS month,
	            A.DAY AS day,
	            A.DAY_FLG AS dayFlg,
	            A.TYPE_FLG AS typeFlg,
	            A.CLOCK_IN AS clockIn,
	            A.P_START_TIME AS pstartTime,
	            A.P_END_TIME AS pendTime,
	            A.LUNCH_TIME_ST AS lunchTimeSt,
	            A.LUNCH_TIME_END AS lunchTimeEnd,
	            A.DINNER_TIME_END AS dinnerTimeEnd,
	            A.R_START_TIME AS rstartTime,
	            A.R_END_TIME AS rendTime,
	            A.FIRST_TIME AS firstTime,
	            A.LAST_TIME AS lastTime,
	            A.REST_TYPE AS restType,
	            A.APP_STATUS AS appStatus,
	            A.APP_ID AS appId,
	            A.REST_TYPE_ADDI AS restTypeAddi,
	            A.APP_STATUS_ADDI AS appStatusAddi,
	            A.APP_ID_ADDI AS appIdAddi,
	            A.ATT_STATUS_COR AS attStatusCor,
	            A.APP_ID_COR AS appIdCor,
	            A.ATT_STATUS_OT AS attStatusOt,
	            A.OT_ST_TIME AS otStTime,
	            A.OT_ED_TIME AS otEdTime,
	            A.OT_BENEFIT AS otBenefit
	     FROM
	            ATT_INFO A
		WHERE   
		        A.YEAR     = #year#
		  AND   A.MONTH    = #month#
		  AND   A.P_START_TIME < NOW()
	]]>
	<isNotEmpty prepend="AND" property="empId">
		<![CDATA[
	            A.EMP_ID in ($empId$)
		]]>
	</isNotEmpty>
	<![CDATA[
	    ORDER BY
	            empId  ASC,
			    day    ASC
	]]>
	</select>

</sqlMap>  
