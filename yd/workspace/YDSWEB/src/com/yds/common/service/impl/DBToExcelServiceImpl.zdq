/*
 * @(#)DBToExcelServiceImpl.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东公司内部网
 *    SubSystem: 共通系统
 */
package com.yds.common.service.impl;

import java.util.HashMap;
import java.util.List;
import java.util.Map;
import org.springframework.stereotype.Service;

import com.yds.base.service.AbstractBaseService;
import com.yds.common.dao.DBToExcelDao;
import com.yds.common.service.DBToExcelService;

/**
 * @see DBToExcelService
 */
@Service("dbToExcelService")
public class DBToExcelServiceImpl extends AbstractBaseService implements DBToExcelService {

	private DBToExcelDao dbToExcelDao;
	
	/**
	 * @param dbToExcelDao
	 *            the dbToExcelDao to set
	 */
	public void setDbToExcelDao(DBToExcelDao dbToExcelDao) {
		this.dbToExcelDao = dbToExcelDao;
	}
	
	/* (non-Javadoc)
	 * @see com.yds.common.service.DBToExcelService#getTableDataMap(java.lang.String[])
	 */
	@Override
	public Map<String,List<Map<String, Object>>> getTablesDataMap(String[] tableNames) {
		Map<String,List<Map<String, Object>>> dbMap = new HashMap<String,List<Map<String, Object>>>();
		for(String tableName : tableNames){
			dbMap.put(tableName, dbToExcelDao.getTableData(tableName));
		}
		return dbMap;
	}
	
	/* (non-Javadoc)
	 * @see com.yds.common.service.DBToExcelService#getTablesColunmMap(java.lang.String[])
	 */
	@Override
	public Map<String,List<String>> getTablesColunmMap(String[] tableNames) {
		Map<String,List<String>> dbColumnMap = new HashMap<String,List<String>>();
		String tableSchema = propMgr.getMessage("jdbc.database");
		for(String tableName : tableNames){
			dbColumnMap.put(tableName, dbToExcelDao.getTableColumn(tableName,tableSchema));
		}
		return dbColumnMap;
	}
}
