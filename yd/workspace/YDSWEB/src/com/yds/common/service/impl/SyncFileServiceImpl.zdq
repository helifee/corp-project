/*
 * @(#)SyncFileServiceImpl.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东计算机社内网
 *    SubSystem: 共通系统
 */
package com.yds.common.service.impl;

import java.util.List;

import org.springframework.stereotype.Service;

import com.yds.base.service.AbstractBaseService;
import com.yds.batch.service.BatchJobRun;
import com.yds.common.service.CommonConstants;
import com.yds.common.service.SyncFileService;
import com.yds.util.bean.RSSCfgBean;
import com.yds.util.service.Download;
import com.yds.util.service.RSS;

/**
 * @see com.yds.common.service.syncFileService
 */
@Service("syncFileService")
public class SyncFileServiceImpl extends AbstractBaseService implements BatchJobRun,SyncFileService {

	/**
	 * {@inheritDoc}
	 */
	public void syncRSS() throws Exception {
		List<RSSCfgBean> rsscfgList = RSS.readRSSCfg(false);
		String rssfilepath = propMgr.getParameter("yds.com.rss.filepath");
		for (RSSCfgBean rsscfg : rsscfgList) {
			Download.saveUrlAs(rsscfg.getRssUrl(), rssfilepath + rsscfg.getId() + CommonConstants.RSSFILENAME);
		}
	}

	/**
	 * {@inheritDoc}
	 */
	@Override
	public void jobRun() throws Throwable {
		this.syncRSS();
	}
}
