/*
 * @(#)PageLockServiceImpl.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东公司内部网
 *    SubSystem: 共通系统
 */
package com.yds.common.service.impl;
import java.util.Date;
import javax.annotation.Resource;
import org.springframework.stereotype.Service;
import com.yds.base.service.AbstractBaseService;
import com.yds.batch.service.BatchJobRun;
import com.yds.common.dao.PageLockBatchDao;
import com.yds.common.service.PageLockBatchService;
/**
 * 画面排他用户信息删除处理BATCH（数据库操作）.
 * 
 * @author mengxiaoyan
 * @version 1.00 2010/05/31
 */
/**
 * @see PageLockBatchService,BatchJobRun
 */
@Service("pageLockBatchServiceImpl")
public class PageLockBatchServiceImpl extends AbstractBaseService implements PageLockBatchService, BatchJobRun {
	@Resource
	PageLockBatchDao pageLockBatchDao;

	/**
	 * {@inheritDoc}
	 */
	@Override
	public void deleteLockUser() {

		// 取得现在时间
		Date deleteTime = new Date();
		Date currentTime = new Date();
		long delTime = (currentTime.getTime() / 1000) - 60 * 20;
		deleteTime.setTime(delTime * 1000);
		// 删除过期的用户信息
		pageLockBatchDao.deleteLockUser(deleteTime);
	}

	/**
	 * {@inheritDoc}
	 */
	@Override
	public void jobRun() throws Throwable {
		deleteLockUser();
	}
	/**
	 * {@inheritDoc}
	 */
	/**
	 * @param dao
	 *            the PageLockBatchDao to set
	 */
	public void setPageLockBatchDao(PageLockBatchDao dao) {
		pageLockBatchDao = dao;
	}

}
