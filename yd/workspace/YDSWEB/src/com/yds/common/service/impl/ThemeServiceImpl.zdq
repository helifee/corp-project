/*
 * @(#)ThemeServiceImpl.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东公司内部网
 *    SubSystem: 共通系统
 */

package com.yds.common.service.impl;

import java.util.List;

import org.springframework.stereotype.Service;

import com.yds.base.service.AbstractBaseService;
import com.yds.common.bean.ThemeInfo;
import com.yds.common.dao.UserThemeDao;
import com.yds.common.service.SessionConstants;
import com.yds.common.service.SessionService;
import com.yds.common.service.ThemeService;

/**
 * @see ThemeService
 */
@Service("themeService")
public class ThemeServiceImpl extends AbstractBaseService implements ThemeService {

	private UserThemeDao userThemeDao;

	@Override
	public boolean addTheme(ThemeInfo themeinfo) {
		return false;
	}

	@Override
	public void updateUserTheme(ThemeInfo themeInfo) {
		// 设置主题
		userThemeDao.updateUserTheme(themeInfo);
	}

	@Override
	public List<ThemeInfo> getThemeNmList() {
		return userThemeDao.getThemeNmList();
	}
	
	@Override
	public ThemeInfo getThemeInfo(String userId) {
		return this.userThemeDao.getThemeNm(userId);
	}
	
	@Override
	public void getThemeNm(String userId) {
		
		// 取得用户样式文件名
		String themeStyleNm = "css/";
		if (this.userThemeDao.getThemeNm(userId) != null && (String)this.userThemeDao.getThemeNm(userId).getThemeURL() != null) {
			themeStyleNm += (String)this.userThemeDao.getThemeNm(userId).getThemeURL();
		} else {
			themeStyleNm += (String)this.userThemeDao.getThemeNmList().get(0).getThemeURL();
		}
		
		// 将样式名放入session
		SessionService.set(SessionConstants.USERTHEME, themeStyleNm);
	}


	public UserThemeDao getUserThemeDao() {
		return userThemeDao;
	}

	public void setUserThemeDao(UserThemeDao userThemeDao) {
		this.userThemeDao = userThemeDao;
	}


}
