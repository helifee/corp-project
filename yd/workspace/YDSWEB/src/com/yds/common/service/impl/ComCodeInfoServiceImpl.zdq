/*
 * @(#)ComCodeInfoServiceImpl.java
 * Copyright (c) 2009-2010 大连远东计算机系统有限公司
 * All rights reserved.
 *      Project: 远东公司内部网
 *    SubSystem: 共通系统
 */

package com.yds.common.service.impl;

import java.util.List;

import org.springframework.stereotype.Service;

import com.yds.base.service.AbstractBaseService;
import com.yds.common.bean.ComCodeInfo;
import com.yds.common.bean.ComCodeMaint;
import com.yds.common.dao.ComCodeInfoDao;
import com.yds.common.service.ComCodeInfoService;

/**
 * @see com.yds.common.service.ComCodeInfoService
 */
@Service("comCodeInfoService")
public class ComCodeInfoServiceImpl extends AbstractBaseService implements
		ComCodeInfoService {

	private ComCodeInfoDao comCodeInfoDao;

	/**
	 * {@inheritDoc}
	 */
	@Override
	public List<ComCodeInfo> getComCodeInfo(String subSys, String typeId,
			String... diff) {

		ComCodeInfo comCodeInfo = new ComCodeInfo();
		comCodeInfo.setSubSys(subSys);
		comCodeInfo.setTypeId(typeId);

		if (diff.length == 1) {
			comCodeInfo.setAddDiffName(diff[0]);
		} else if (diff.length == 2) {
			comCodeInfo.setAddDiffNo(diff[0]);
			comCodeInfo.setAddDiffName(diff[1]);
		}
		return this.getComCodeInfo(comCodeInfo);
	}

	/**
	 * {@inheritDoc}
	 */
	@Override
	public String getDiffName(String subSys, String typeId, String diffNo) {

		ComCodeInfo comCodeInfo = new ComCodeInfo();
		comCodeInfo.setSubSys(subSys);
		comCodeInfo.setTypeId(typeId);
		comCodeInfo.setDiffNo(diffNo);
		List<ComCodeInfo> comCodeInfoList = comCodeInfoDao
				.getComCodeInfo(comCodeInfo);
		if (comCodeInfoList.size() == 0) {
			return "";
		} else {
			return comCodeInfoList.get(0).getDiffName();
		}
	}

	/**
	 * {@inheritDoc}
	 */
	@Override
	public List<ComCodeInfo> getComCodeInfo(ComCodeInfo comCodeInfo) {
		List<ComCodeInfo> comCodeInfoList = comCodeInfoDao
				.getComCodeInfo(comCodeInfo);
		if (comCodeInfo.getAddDiffName() != null) {
			if (comCodeInfo.getAddDiffNo() == null) {
				return addDiff("", comCodeInfo.getAddDiffName(),
						comCodeInfoList);
			} else {
				return addDiff(comCodeInfo.getAddDiffNo(), comCodeInfo
						.getAddDiffName(), comCodeInfoList);
			}
		}
		return comCodeInfoList;
	}

	/**
	 * @param comCodeInfoDao
	 *            the comCodeInfoDao to set
	 */
	public void setComCodeInfoDao(ComCodeInfoDao comCodeInfoDao) {
		this.comCodeInfoDao = comCodeInfoDao;
	}

	/**
	 * 追加区分信息
	 * 
	 * @param diffNo
	 *            区分NO
	 * @param diffName
	 *            区分名称
	 * @param comCodeInfoList
	 *            系统参数信息list
	 * @return List<ComCodeInfo> 系统参数信息list
	 */
	public List<ComCodeInfo> addDiff(String diffNo, String diffName,
			List<ComCodeInfo> comCodeInfoList) {
		ComCodeInfo comCodeInfo = new ComCodeInfo();
		comCodeInfo.setDiffNo(diffNo);
		comCodeInfo.setDiffName(diffName);
		comCodeInfoList.add(0, comCodeInfo);
		return comCodeInfoList;
	}

	@Override
	public ComCodeMaint getDetailComCodeInfo(String subSys, String typeId,
			String diffNo) {
		
		ComCodeInfo comCodeInfo = new ComCodeInfo();
		comCodeInfo.setSubSys(subSys);
		comCodeInfo.setTypeId(typeId);
		comCodeInfo.setDiffNo(diffNo);
		List<ComCodeMaint> comCodeInfoList = comCodeInfoDao.getDetailComCodeInfo(comCodeInfo);
		
		if (comCodeInfoList.size() == 0) {
			return null;
		} else {
			return comCodeInfoList.get(0);
		}
	}
}
