<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTDSQLMap2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="ComSequenceDao">
	<typeAlias alias="comSeq" type="com.yds.common.bean.ComSeq"/>
	
	<!-- 序列取得 --> 
	<select id="getNextSequence" parameterClass="comSeq" resultClass="comSeq">
		SELECT  
				TABLE_NM  as tableNm,
				COLUMN_NM as colunmNm,
				SEQ_VALUE as seqValue,
				SEQ_STEP  as seqStep,
				SEQ_MAX   as seqMax,
				SEQ_MIN   as seqMin,
				SEQ_CYCLE_FLG  as seqCycleflg 
		  FROM  COM_SEQ
		 WHERE 
		        TABLE_NM = #tableNm#
		   AND  COLUMN_NM = #colunmNm# FOR UPDATE
	</select>

	<!-- 更新序列 -->
	<update id="updateSequence" parameterClass="comSeq">
        UPDATE  
		        COM_SEQ 
		   SET
				SEQ_VALUE = #seqValue#
		 WHERE 
		        TABLE_NM = #tableNm#
		   AND  COLUMN_NM = #colunmNm# 
    </update>
	
	<!-- 全部序列取得 --> 
	<select id="getAllSequence" resultClass="comSeq">
		SELECT  
				TABLE_NM  as tableNm,
				COLUMN_NM as colunmNm,
				SEQ_VALUE as seqValue,
				SEQ_STEP  as seqStep,
				SEQ_MAX   as seqMax,
				SEQ_MIN   as seqMin,
				SEQ_CYCLE_FLG  as seqCycleflg 
		  FROM  COM_SEQ
	</select>
	
	<!-- 初始化序列 -->
	<insert id="insertSequence" parameterClass="comSeq">
		
		INSERT INTO COM_SEQ 
			(TABLE_NM, 
			COLUMN_NM, 
			SEQ_VALUE, 
			SEQ_STEP, 
			SEQ_MAX, 
			SEQ_MIN, 
			SEQ_CYCLE_FLG
			)
			VALUES
			(#tableNm#, 
			#colunmNm#, 
			#seqValue#, 
			#seqStep#, 
			#seqMax#, 
			#seqMin#, 
			#seqCycleflg#
			);  
	</insert>

</sqlMap>  
