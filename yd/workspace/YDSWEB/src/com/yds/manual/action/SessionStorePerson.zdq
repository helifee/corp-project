package com.yds.manual.action;

import java.util.List;

import org.springframework.beans.factory.config.BeanDefinition;
import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Controller;

import com.yds.base.action.AbstractBaseAction;
import com.yds.common.service.CommonConstants;
import com.yds.manual.bean.Person;
import com.yds.manual.service.SessionStoreSampleService;
import com.yds.util.service.SessionStore;

@Scope(BeanDefinition.SCOPE_PROTOTYPE)
@Controller("sessionStorePerson")
public class SessionStorePerson extends AbstractBaseAction {

	private static final long serialVersionUID = -5194909305073803518L;
	
	private static final String PAGE_ID = "personSearch";
	private SessionStoreSampleService sessionStoreSampleService;
	
	private List<Person> persons;
	
	private Person personSearchInfo;
	
	private Person personInfo;
	
	
	/**
	 * 初始化人员查询画面
	 */
	public String initPerson() {
		// 如果传入参数（reloadFlg在基类中定义）为利用条件进行画面重载
		if (CommonConstants.ActionReloadFlg.Reload_Condition.value()
				.equals(super.getReloadFlg())) {
			// 获得检索条件
			personSearchInfo = (Person) SessionStore.getCondition(PAGE_ID);
			if(personSearchInfo != null){
				persons = sessionStoreSampleService.getPersons(personSearchInfo);
			}
		}
		
//		//设定画面是否有返回按钮,如果没有设定false，如果有属于默认处理，不需要设置
//		setBackFlg(BackFlg.Back_No.value());
		
		return SUCCESS;
	}
	
	/**
	 * 初始化组增加画面
	 */
	public String initGroup() {
		SessionStore.setCondition("groupAdd", "");
		return SUCCESS;
	}
	
	/**
	 * 初始化画面重载
	 */
	public String initSessionStoreManual() {
		SessionStore.setCondition("initSessionStoreManual", "");
		return SUCCESS;
	}
	
	/**
	 * 人员查询
	 */
	public String searchPersons() {
		persons = sessionStoreSampleService.getPersons(personSearchInfo);
		
		// 每次检索后记录检索条件
		SessionStore.setCondition(PAGE_ID, personSearchInfo);
		
		return SUCCESS;
	} 
	
	/**
	 * @param sessionStoreSampleService the sessionStoreSampleService to set
	 */
	public void setSessionStoreSampleService(
			SessionStoreSampleService sessionStoreSampleService) {
		this.sessionStoreSampleService = sessionStoreSampleService;
	}

	/**
	 * @return the persons
	 */
	public List<Person> getPersons() {
		return persons;
	}

	/**
	 * @param persons the persons to set
	 */
	public void setPersons(List<Person> persons) {
		this.persons = persons;
	}

	/**
	 * @return the personSearchInfo
	 */
	public Person getPersonSearchInfo() {
		return personSearchInfo;
	}

	/**
	 * @param personSearchInfo the personSearchInfo to set
	 */
	public void setPersonSearchInfo(Person personSearchInfo) {
		this.personSearchInfo = personSearchInfo;
	}

	/**
	 * @return the personInfo
	 */
	public Person getPersonInfo() {
		return personInfo;
	}

	/**
	 * @param personInfo the personInfo to set
	 */
	public void setPersonInfo(Person personInfo) {
		this.personInfo = personInfo;
	}
	
}
