package com.yds.manual.action;

import org.springframework.beans.factory.config.BeanDefinition;
import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Controller;

import com.yds.base.action.AbstractBaseAction;
import com.yds.common.service.CommonConstants;
import com.yds.manual.bean.Person;
import com.yds.manual.service.SessionStoreSampleService;
import com.yds.util.service.SessionStore;

@Scope(BeanDefinition.SCOPE_PROTOTYPE)
@Controller("personModify")
public class PersonModify extends AbstractBaseAction {

	private static final long serialVersionUID = -5194909305073803518L;
	
	private static final String PG_ID = "personModify";

	private SessionStoreSampleService sessionStoreSampleService;
	
	private Person personInfo;
	
	
	/**
	 * 初始化修改人员画面
	 */
	public String initModifyPerson() {
		
		// 从session里取得员工ID获得检索条件
		if(CommonConstants.ActionReloadFlg.Reload_Condition.value()
				.equals(super.getReloadFlg())){
			personInfo = (Person) SessionStore.getCondition(PG_ID);
		}else{
			//如果是人员查看页面迁移的时候
			//把员工ID保存到Session里，为返回用
			Person backPerson = new Person();
			backPerson.setId(personInfo.getId());
			SessionStore.setCondition(PG_ID, backPerson);
		}
		personInfo = sessionStoreSampleService.getPersons(personInfo).get(0);
		return SUCCESS;
	}
	
	/**
	 * 修改人员
	 */
	public String savePerson() {
		sessionStoreSampleService.savePerson(personInfo);
		System.out.println(getFromId());
		return SUCCESS;
	}
	
	
	/**
	 * @param sessionStoreSampleService the sessionStoreSampleService to set
	 */
	public void setSessionStoreSampleService(
			SessionStoreSampleService sessionStoreSampleService) {
		this.sessionStoreSampleService = sessionStoreSampleService;
	}

	/**
	 * @return the personInfo
	 */
	public Person getPersonInfo() {
		return personInfo;
	}

	/**
	 * @param personInfo the personInfo to set
	 */
	public void setPersonInfo(Person personInfo) {
		this.personInfo = personInfo;
	}

}
