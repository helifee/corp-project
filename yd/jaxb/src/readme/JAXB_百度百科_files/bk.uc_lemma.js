bkuc={};bkuc.user={};baidu.extend(bkuc.user,{getUserAvatar:function(B,A){if(B<0||A<0){return"http://img.baidu.com/img/baike/blank.gif";}var _={1:"http://img.baidu.com/img/baike/encourage/user-priority-boy.gif",2:"http://img.baidu.com/img/baike/encourage/user-priority-girl.gif",3:"http://img.baidu.com/img/baike/encourage/5year-boy.png",4:"http://img.baidu.com/img/baike/encourage/5year-girl.png"};if(0==B){return"http://img.baidu.com/img/baike/pictures/r0s1g"+A+".gif";}else{if(B>0&&B<5){return _[B];}else{return"/cms/s/usershow/"+B+".jpg";}}}});bkuc.url={};baidu.extend(bkuc.url,{removeHash:function(){if(location.hash.length>0){if(history.pushState){history.pushState("",document.title,location.pathname);}else{location.hash="_";}}}});bkuc.dom={};baidu.extend(bkuc.dom,{preventScroll:function(_){_=baidu.g(_);if(baidu.browser.firefox){_.addEventListener("DOMMouseScroll",function(A){_.scrollTop+=A.detail>0?30:-30;A.preventDefault();},false);}else{_.onmousewheel=function(A){A=A||window.event;_.scrollTop+=A.wheelDelta>0?-30:30;A.returnValue=false;};}},placeholder:function(_,B){var A=document.createElement("input");if(A.placeholder===undefined){B=B||"#999";var F=baidu.g(_),E=F.getAttribute("placeholder");if(!E){return;}var D=baidu.dom.getStyle(F,"color"),C=function(){var _=F.value;if(""==_||E==_){F.value=E;baidu.dom.setStyle(F,"color",B);}};baidu.on(F,"focus",function(){var _=F.value;if(""==_||E==_){F.value="";baidu.dom.setStyle(F,"color",D);}});baidu.on(F,"blur",C);C();}}});bkuc.event=(function(){var A={visibilityChange:function(_,A){if(document.visibilityState){return k;}else{if(document.msVisibilityState){return A[0];}else{if(document.webkitVisibilityState){return A[1];}}}return null;}},_={visibilitychange:["msvisibilitychange","webkitvisibilitychange",null,null,A.visibilityChange]};return baidu.extend({},{specialEvents:_});}());baidu.extend(bkuc.event,{on:function(D,C,B){if(bkuc.event.specialEvents.hasOwnProperty(C)){var _=bkuc.event.specialEvents[C],A=_[4];C=A(C,_);if(C!=null){baidu.on(D,C,B);}return;}baidu.on(D,C,B);},un:function(D,C,B){if(bkuc.event.specialEvents.hasOwnProperty(C)){var _=bkuc.event.specialEvents[C],A=_[4];C=A(C,_);if(C!=null){baidu.un(D,C,B);}return;}baidu.un(D,C,B);},isEventSupported:(function(){var A={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};function _(C,B){B=B||document.createElement(A[C]||"div");C="on"+C;var _=(B.eventName!==undefined);if(!_){if(!B.setAttribute){B=document.createElement("div");}if(B.setAttribute&&B.removeAttribute){B.setAttribute(C,"");_=typeof B[C]=="function";if(typeof B[C]!="undefined"){B[C]=undefined;}B.removeAttribute(C);}}B=null;return _;}return _;}())});bkuc.setDomain=function(){try{var _=document.referrer||"",B=document.referrer.indexOf("://passport.baidu.com")!==-1;B=B||(top.location.href.indexOf("://passport.baidu.com")!==-1);if(B){document.domain="baidu.com";}}catch(A){document.domain="baidu.com";}};if(typeof bk=="undefined"){bk={};}if(typeof bk.ui=="undefined"){bk.ui={};}bk.ui.enctip=function(){var B="/ajax/getmessage?events=1&r="+Math.random(),D=true,E="encourage_tip_wrapper",H="bk_encourage_tip2",A=(24-new Date().getHours())*3600*1000,_={},C,G,F={build_tip:function(){var _=C,D=F.render_tip,A=B+"&entry="+_;baidu.ajax.get(A,function(A){if(A.responseText.indexOf("<!DOCTYPE html")==-1){var _=baidu.json.parse(A.responseText);if(_.errno==0){G=F.format_result(_.data);if(!baidu.object.isEmpty(G)){D();}}}});},render_tip:function(){},format_result:function(A){var _=C,D={};if(_!=1){A=A.events;}if(!A){return null;}var B=A.length;if(B==0){return D;}switch(_){case 0:D.type="events";D.href=A[0].iconHref;D.url=A[0].iconUrl;D.title=A[0].title;D.text=A[0].text;return D;case 1:if(A.msg&&A.msg.length>0){D.data=A.msg;D.type="msg";return D;}if(A.events&&A.events.length>0){D.type="events";D.href=A.events[0].iconHref;D.url=A.events[0].iconUrl;D.title=A.events[0].title;D.text=A.events[0].text;return D;}return D;case 2:D.href=A[0].iconHref;D.url=A[0].iconUrl;D.banner_href=A[0].bannerHref;D.banner_url=A[0].bannerBigUrl;D.title=A[0].title;D.text=[];break;case 3:D.href=A[0].iconHref;D.title=A[0].title;D.text=[];break;case 4:D.banner_href=A[0].bannerHref;D.banner_url=A[0].bannerUrl;D.text=A[0].text;return D;}if(B>0){var E;for(E=0;E<B;++E){D.text.push(A[E].text);}}return D;},set_nslog_area_type:function(A,B){var _=(typeof A==="string")?baidu.g(A):A;baidu.each(_.getElementsByTagName("a"),function(_){_.target="_blank";_.className="nslog:"+B;});}};_.buildWrapperTip=function(){var H=G;C=1;B="/ajax/getmessage?msg=1&events=1&r="+Math.random();var D=function(D){var H=D.data,_=[];for(i in H){var B=H[i];switch(B.type){case"passedVersion":_[0]='<li><a href="/uc/effort#1" class="nslog:464" target="_blank"><span>'+B.num+"\u4e2a</span>\u5df2\u901a\u8fc7\u7248\u672c</a></li>";break;case"failedVersion":_[1]='<li><a href="/uc/effort#3" class="nslog:465" target="_blank"><span>'+B.num+"\u4e2a</span>\u672a\u901a\u8fc7\u7248\u672c</a></li>";break;case"midqualityVersion":_[2]='<li><a href="/uc/effort#7" class="nslog:466" target="_blank"><span>'+B.num+"\u4e2a</span>\u7248\u672c\u88ab\u8bc4\u4e3a\u4e2d\u7ea7\u4f18\u8d28</a></li>";break;case"HQVersion":_[3]='<li><a href="/uc/effort#8" class="nslog:467" target="_blank"><span>'+B.num+"\u4e2a</span>\u7248\u672c\u88ab\u8bc4\u4e3a\u521d\u7ea7\u4f18\u8d28</a></li>";break;case"modifiedVersion":_[4]='<li><a href="http://hi.baidu.com/msg/index?from=sys#msgcontent" onclick="baidu.ajax.request(\'/ajax/messageread\',{data:\'type=4\'});" class="nslog:468" target="_blank"><span>'+B.num+"\u4e2a</span>\u7248\u672c\u88ab\u4fee\u6539</a></li>";break;case"upperScoreLimit":_[5]='<li><a href="/uc/score" onclick="baidu.ajax.request(\'/ajax/messageread\',{data:\'type=7\'});" class="nslog:469" target="_blank"><span>'+B.num+"\u4e2a</span>\u79ef\u5206\u4e0a\u9650</a></li>";break;}}var G='<div class="ctr">'+'<div class="tri out">'+"</div>"+'<div class="tri in">'+"</div>"+"</div>"+'<div class="enc-wrap">'+'<div class="enc-content fix clearfix enc-ver-content" style="zoom: 1; ">'+'<ul class="ver_con" id=>'+_.join("")+"</ul>"+'<a href="/uc/usercard#msg" class="nslog:470">\u6d88\u606f\u8bbe\u7f6e</a>'+"</div>"+"</div>"+'<a href="javascript:void(0)" class="close nslog:471" title="\u5173\u95ed" id="enc_close">\u5173\u95ed</a>'+"</div>",I=baidu.g("encourage_tip_wrapper");if(!I){I=document.createElement("div");I.id="encourage_tip_wrapper";I.className="enc-tip enc-ver-tip";document.body.appendChild(I);}I.innerHTML=G;var F=baidu.dom.getPosition(baidu.g("my-home-container")).left,A=baidu.dom.getPosition(I).left,E=F-A+16;baidu.q("ctr",I,"div")[0].style.left=E+"px";I.style.visibility="visible";var C=baidu.dom.q("ver_con",I)[0];baidu.event.on(C,"click",function(_){var A=_.target||_.srcElement;while(A.tagName!="LI"){A=A.parentNode;}if(baidu.dom.children(C).length==1){I.style.visibility="hidden";}else{if(baidu.dom.children(C).length>1){baidu.dom.remove(A);}}});},I=function(B){var C=document.createDocumentFragment(),A=document.createElement("div");A.id=E;A.className="enc-tip";A.innerHTML='<div class="ctr"><div class="tri out"></div><div class="tri in"></div></div><div class="enc-wrap">'+'<div class="enc-content fix clearfix"><div class="fl"><a href="'+B.href+'" target="_blank" '+"onclick=\"nslog('"+window.location.href+'\', 434)"><img id="encTipIcon" /></a></div><div class="fr">'+'<h3><a href="'+B.href+'" target="_blank" onclick="nslog(\''+window.location.href+"', 434)\">"+B.title+'</a></h3><div class="enc-txt" id="encourage_body">'+B.text+'</div></div></div></div><a href="javascript:void(0)" class="close" title="\u5173\u95ed" '+"onclick=\"var tipWrapper = baidu.g('encourage_tip_wrapper');tipWrapper.parentNode.removeChild(tipWrapper);nslog('"+window.location.href+"',442);\">\u5173\u95ed</a>";C.appendChild(A);document.body.appendChild(C);var _=baidu.g("encTipIcon");_.onload=function(){var G=baidu.g(A.id),C=baidu.browser.ie?230:230,B=baidu.dom.query(".enc-content .fl")[0].offsetWidth;baidu.dom.setStyle(baidu.dom.query(".enc-content .fr")[0],"width",(C-B));baidu.q("enc-content",G,"div")[0].style.zoom="1";G.style.visibility="visible";_.onload=null;var F=baidu.dom.getPosition(baidu.g("my-home-container")).left,D=baidu.dom.getPosition(G).left,E=F-D+16;baidu.q("ctr",G,"div")[0].style.left=E+"px";};_.src=B.url;F.set_nslog_area_type("encourage_body",435);};F.render_tip=function(){var B=G;if(B.type=="msg"){D(B);baidu.event.on(baidu.g("enc_close"),"click",A);}if(B.type=="events"){var C=false,_=baidu.cookie.get(this.cookie_name);if(!_){C=true;baidu.cookie.set(this.cookie_name,baidu.url.jsonToQuery({show:C}),{expires:this.cookie_interval});}if(C){I(B);}}};var A=function(_){var A=baidu.g("encourage_tip_wrapper");A.style.visibility="hidden";baidu.ajax.request("/ajax/messageread",{data:"type=0"});},_=function(){var _=baidu.g("encourage_tip_wrapper");baidu.dom.remove(_);nslog("http://baike.baidu.com/",442);};F.build_tip();};_.build_edit_tip=function(){C=0;F.render_tip=function(){var _=G,A='<li><a class="icon-address" id="encourage_icon_href" href="'+_.href+'" target="_blank"><img id="encourage_icon_url" src="'+_.url+'" alt="\u6253\u5f00\u94fe\u63a5" title="\u6253\u5f00\u94fe\u63a5"  /></a><span id="encourage_text">'+_.text+"</span></li>";if(baidu.g("enctip")){baidu.g("enctip").innerHTML=A;return;}if(baidu.g("msg_content")){baidu.g("msg_content").innerHTML=A;F.set_nslog_area_type("encourage_text",436);}bk.shop.MyPropsBox.prototype.openTab(baidu.g("msg_box"),0);};F.build_tip();};_.build_usercenter_tip=function(){C=2;F.render_tip=function(){var A=G,C=A.text.length,_=[],E;for(E=0;E<C;++E){_.push("<li><span>");_.push(A.text[E]);_.push("</span></li>");}var D=window.location.href,B='<div class="push-ads" id="push_ads"><a id="banner_href" href="'+A.banner_href+'" class="icon-address" target="_blank" onclick="nslog(\''+A.banner_href+'\',437)"><img id="banner_url" src="'+A.banner_url+'" alt="\u6253\u5f00\u94fe\u63a5" title="\u6253\u5f00\u94fe\u63a5" width="778px" height="100px"/></a><a class="del" '+"onclick=\"nslog('"+D+"', 444);var del = document.getElementById('push_ads');del.parentNode.removeChild(del);del=null\" title=\"\u5173\u95ed\"></a></div>"+'<dl class="mod-push" id="enc_push_bar"><dt><p><a id="encourage_icon_href" href="'+A.href+'" class="icon-address" target="_blank"><img id="encourage_icon_url" src="'+A.url+'" alt="\u6253\u5f00\u94fe\u63a5" title="\u6253\u5f00\u94fe\u63a5" /></a>'+'<span id="encourage_title">'+A.title+'</span></p><div class="del" onclick="nslog(\''+D+"', 445);var del = document.getElementById('enc_push_bar');del.parentNode.removeChild(del);del=null\" title=\"\u5173\u95ed\"></div></dt>"+'<dd><ul id="encouragements">'+_.join("")+"</ul></dd></dl>";baidu.dom.insertHTML("col_main","afterBegin",B);F.set_nslog_area_type("encouragements",438);};F.build_tip();};_.build_userinfo_tip=function(){var _=baidu.g("encourage");if(!_){return;}C=3;F.render_tip=function(){var D=G;baidu.g("encourage_icon_href").href=D.href;var C=baidu.g("encourage_title");C.href=D.href;C.innerHTML=D.title;var E=D.text.length,B=[],H;for(H=0;H<E;++H){B.push("<li><span>");B.push(D.text[H]);B.push("</span></li>");}var A=baidu.g("encouragements");A.innerHTML=B.join("");baidu.removeClass(_,"dnone");baidu.removeClass(_.parentNode,"dnone");F.set_nslog_area_type(A,439);};F.build_tip();};_.buildEditSuccessTip=function(){C=4;F.render_tip=function(){var _=G,A='<a href="'+_.banner_href+'" onclick="nslog(\''+_.banner_href+'\',440)" target="_blank">'+'<img width="450px" height="60px" src="'+_.banner_url+'" /></a>',C=baidu.g("encourage_tip");C.innerHTML=A;C.style.display="block";var B=baidu.g("encourage_text");B.innerHTML=_.text;B.style.display="block";};F.build_tip();};_.buildUnloginTip=function(){C=1;var _=function(){var B=G,C=document.createDocumentFragment(),A=document.createElement("div");A.id=E;A.className="enc-tip";A.innerHTML='<div class="ctr"><div class="tri out"></div><div class="tri in"></div></div><div class="enc-wrap">'+'<div class="enc-content fix clearfix"><div class="fl"><a href="'+B.href+'" target="_blank" '+"onclick=\"nslog('"+window.location.href+'\', 434)"><img id="encTipIcon" /></a></div><div class="fr">'+'<h3><a href="'+B.href+'" target="_blank" onclick="nslog(\''+window.location.href+"', 434)\">"+B.title+'</a></h3><div class="enc-txt" id="encourage_body">'+B.text+'</div></div></div></div><a href="javascript:void(0)" class="close" title="\u5173\u95ed" '+"onclick=\"var tipWrapper = baidu.g('encourage_tip_wrapper');tipWrapper.parentNode.removeChild(tipWrapper);nslog('"+window.location.href+"',442);\">\u5173\u95ed</a>";C.appendChild(A);A.style.right="22px";document.body.appendChild(C);var _=baidu.g("encTipIcon");_.onload=function(){var D=baidu.g(A.id),C=baidu.browser.ie?230:230,B=baidu.dom.query(".enc-content .fl")[0].offsetWidth;baidu.dom.setStyle(baidu.dom.query(".enc-content .fr")[0],"width",(C-B));baidu.q("enc-content",D,"div")[0].style.zoom="1";D.style.visibility="visible";_.onload=null;baidu.q("ctr",D,"div")[0].style.right=22+"px";};_.src=B.url;F.set_nslog_area_type("encourage_body",435);};F.render_tip=function(){var B=false,C="bk_encourage_tip3",A=baidu.cookie.get(C);if(!A){B=true;baidu.cookie.set(C,baidu.url.jsonToQuery({show:B}),{expires:this.cookie_interval});}if(B){_();}};F.build_tip();};return _;};bk.event.on("bk.event.user.notlogin",function(){var _=bk.ui.enctip();_.buildUnloginTip();});baidu.more.ns("bk.usercenter");bk.usercenter.progressbar=function(_){this.options=_||{};};baidu.extend(bk.usercenter.progressbar.prototype,{build:function(){baidu.g(this.options.selector).innerHTML=this.html();},init:function(_){if(_){this.options=baidu.extend(this.options||{},_);}this.build();},html:function(){var _=[];_.push('<div class="progress-bar">');_.push('<div class="process-inner fix"><span class="pl"></span>');var A=this.calculateProgress();if(A>0){_.push('<span class="pb" style="width:'+A+'px"></span>');}_.push('<span class="pr"></span></div>');_.push('<div class="process-text" style="'+(this.options.textStyle||"")+'">'+this.options.text+"</div>");_.push("</div>");return _.join("");},calculateProgress:function(){var A=this.options.maxWidth,B=A/100,_=(this.options.process||0)*100*B;_=(_>A?A:_);this.options.pixelProgress=_;return _;}});bk.usercenter.commonTaskProgressbar=function(_){bk.usercenter.progressbar.call(this,_);baidu.extend(this.options,{txtStart:-16});};baidu.lang.inherits(bk.usercenter.commonTaskProgressbar,bk.usercenter.progressbar);baidu.extend(bk.usercenter.commonTaskProgressbar.prototype,{init:function(){bk.usercenter.progressbar.prototype.init.call(this);var _=this.options.pixelProgress+this.options.txtStart,A=baidu.dom.q("process-text",this.options.selector,"div")[0];if(A){A.style.left=_+"px";}}});baidu.extend(bk.usercenter.progressbar,{init:function(C){var B=C.type.toLowerCase()||"simple",_=bk.usercenter.progressbar.barConfigs[B];C.maxWidth=_.maxWidth;var A=new _.ctr(C);A.init();},barConfigs:{simple:{ctr:bk.usercenter.progressbar,maxWidth:120},common:{ctr:bk.usercenter.commonTaskProgressbar,maxWidth:140}}});baidu.more.ns("bk.floatBottle");(function(){bk.floatBottle.bottle=function(_){baidu.extend(this,_);this.refuse=null;this.replyList=[];};baidu.extend(bk.floatBottle,{BOTTLE_TYPE:{CARD:1,SUMMARY:2,BODY:3},ACT_STATUS:{NEW:1,BEFORE_EDIT:2,AFTER_EDIT:3,END:4},ACTION:{THROW:"throw",GAIN:"gain",RETHROW:"rethrow"},STATUS:{THROW:{UNSOLVED:1,UNCOMMENT:2,SOLVED:3,FAIL:7},GAIN:{UNEDIT:4,EDITING:5,SUCCESS:6,FAIL:7,COMPLAINT:8}},REQ_URLS:{BOTTLE_CHECK_URL:"/user/ajax/bottle/throw?",BOTTLE_OPEN_URL:"/user/ajax/bottle/show?"},REPLACE:function(_){return _;},GET_BOTTLE_STATUS:function(_,A){switch(A){case bk.floatBottle.ACTION.THROW:switch(_){case 1:case 2:case 3:case 12:return bk.floatBottle.STATUS.THROW.UNSOLVED;case 4:case 5:return bk.floatBottle.STATUS.THROW.UNCOMMENT;case 6:case 7:case 8:case 9:return bk.floatBottle.STATUS.THROW.SOLVED;case 11:case 13:return bk.floatBottle.STATUS.THROW.FAIL;}break;case bk.floatBottle.ACTION.GAIN:switch(_){case 1:case 2:return bk.floatBottle.STATUS.GAIN.UNEDIT;case 3:case 4:case 5:return bk.floatBottle.STATUS.GAIN.EDITING;case 6:case 7:case 11:return bk.floatBottle.STATUS.GAIN.SUCCESS;case 8:case 9:case 13:return bk.floatBottle.STATUS.GAIN.FAIL;case 12:return bk.floatBottle.STATUS.GAIN.COMPLAINT;}break;}},GET_BOTTLE_CONT:function(_){switch(parseInt(_,10)){case 1:return bk.floatBottle.cardBottle;default:return bk.floatBottle.bottle;}}});baidu.lang.inherits(bk.floatBottle.bottle,baidu.lang.Class);baidu.extend(bk.floatBottle.bottle.prototype,{isEmpty:function(){return false;},parseReply:function(){return null;},getReplyList:function(){},check:function(){},open:function(_){var A=this;bk.usercenter.ajax.post(bk.floatBottle.REQ_URLS.BOTTLE_OPEN_URL,baidu.url.jsonToQuery({bottleId:A.id}),function(E){if(E.responseText){var C=baidu.json.parse(E.responseText),D=C.bottle,G=bk.floatBottle.tools.parseRdBottle2My(D);A.replyList=[];var B=false;baidu.each(C.reply,function(_){!B&&A.replyList.push(A.parseReply(_,G));if(_.type=="11"){B=true;}});var H=new bk.floatBottle.reply({id:0,from:G.thrower,tag:D.content,bottle:G,isOpen:true,type:0,status:G.status});A.replyList.push(H);var F={bottle:G,reply:A.replyList};A.dispatchEvent("onOpen",F);_.dispatchEvent("onBottleOpen",F);}});},getThrowData:function(){return null;},getRefuseData:function(){return null;}});}());(function(){bk.floatBottle.cardBottle=function(_){bk.floatBottle.bottle.call(this,_);this.type=bk.floatBottle.BOTTLE_TYPE.CARD;this.lemma=this.lemmas?this.lemmas[0]:_.lemma;};baidu.lang.inherits(bk.floatBottle.cardBottle,bk.floatBottle.bottle);baidu.extend(bk.floatBottle.cardBottle.prototype,{check:function(){var A=this,_={action:"throwCheck",propsId:this.propsId||"","bottleContent[type]":this.type,"bottleContent[lemmaId]":this.lemma.lemmaId};baidu.ajax.post(bk.floatBottle.REQ_URLS.BOTTLE_CHECK_URL+"r="+Math.random(),baidu.url.jsonToQuery(_,bk.floatBottle.REPLACE),function(B){var _=baidu.json.parse(B.responseText);if(_.success){A.dispatchEvent("onCheckSuccess");}else{A.dispatchEvent("onCheckFail",{code:_.flag,detail:_.detailFlag});}});},getThrowData:function(){return{propsId:encodeURIComponent(this.propsId),"bottleContent[reason]":encodeURIComponent(this.tag.reason),"bottleContent[content]":encodeURIComponent(this.tag.content),"bottleContent[reference]":encodeURIComponent(this.tag.reference),"bottleContent[part]":encodeURIComponent(this.tag.part)};},getRefuseData:function(){if(!this.refuse){return{};}return{content:encodeURIComponent(this.refuse.reason),reference:encodeURIComponent(this.refuse.reference)};},parseReply:function(_,B){var A=new bk.floatBottle.reply({id:_.id,isOpen:(1==_.isOpen?true:false),from:new bk.usercenter.bottleUser(_.from),to:new bk.usercenter.bottleUser(_.to),bottle:B,type:parseInt(_.type),status:parseInt(_.status),tag:_.content});return A;}});}());baidu.more.ns("bk.usercenter");(function(){bk.usercenter.user=function(_){baidu.extend(this,_);};baidu.lang.inherits(bk.usercenter.user,baidu.lang.Class);baidu.extend(bk.usercenter.user.prototype,{equalTo:function(_){return(_!=null&&_.id==this.id);},getUserIcon:function(){if(0==this.id){return"http://img.baidu.com/img/baike/logo-baike.gif";}return bkuc.user.getUserAvatar(this.avatar,this.level);},toString:function(){return["id:",this.id,",name:",this.name,",level:",this.level];}});}());(function(){var _="/user/ajax/bottle/list?",D="/user/ajax/bottle/salvage?",B="/user/ajax/bottle/throw?",A="/user/ajax/bottle/editInfo?",C="/user/ajax/bottle/arbitration?";bk.usercenter.bottleUser=function(_){bk.usercenter.user.call(this,_);this.bottlesThrow=[];this.bottlesGain=[];this.maxThrowCount=_.throwCount||0;this.maxGainCount=_.gainCount||0;this.hasThrowCount=this.hasGainCount=0;};baidu.lang.inherits(bk.usercenter.bottleUser,bk.usercenter.user);baidu.extend(bk.usercenter.bottleUser.prototype,{throwBottle:function(D){var C=this;if(D.id){C.reThrow(D);return;}var _=D.lemmas[0]||D.lemma,A={r:Math.random(),action:"throwBottle","bottleContent[lemmaId]":_.lemmaId,"bottleContent[lemmaTitle]":encodeURIComponent(_.lemmaTitle),"bottleContent[subLemmaId]":_.subLemmaId,"bottleContent[subLemmaTitle]":encodeURIComponent(_.subLemmaTitle),"bottleContent[type]":D.type};baidu.extend(A,D.getThrowData());baidu.ajax.post(B,baidu.url.jsonToQuery(A,bk.floatBottle.REPLACE),function(A){if(A.responseText){var _=baidu.json.parse(A.responseText);if(_.success){C.dispatchEvent("onThrowSuccess",{actionType:bk.floatBottle.ACTION.THROW});}else{C.dispatchEvent("onThrowFail",{actionType:bk.floatBottle.ACTION.THROW,code:_.flag,detail:_.detailFlag});}}});},reThrow:function(D){var C=this,B=D.replyList[0],_={r:Math.random(),action:"throwAgain",bottleId:D.id,replyId:B.id};baidu.ajax.post(A,baidu.url.jsonToQuery(_),function(A){if(A.responseText){var _=baidu.json.parse(A.responseText);if(_.success){C.dispatchEvent("onThrowSuccess",{actionType:bk.floatBottle.ACTION.RETHROW});}else{C.dispatchEvent("onThrowFail",{actionType:bk.floatBottle.ACTION.RETHROW,code:_.flag,detail:_.detailFlag});}}});},gain:function(){var _=this;bk.usercenter.ajax.post(D+"r="+Math.random(),baidu.url.jsonToQuery({type:bk.floatBottle.BOTTLE_TYPE.CARD}),function(B){if(B.responseText){var A=baidu.json.parse(B.responseText);if(A.error){_.dispatchEvent("onGainFail",{code:A.error,flag:A.flag});}else{_.dispatchEvent("onGainSuccess",{bottle:A});}}});},refuse:function(B){var _=this,C={action:"addReply",bottleId:B.id,r:Math.random()};baidu.extend(C,B.getRefuseData());baidu.ajax.post(A,baidu.url.jsonToQuery(C,bk.floatBottle.REPLACE),function(B){if(B.responseText){var A=baidu.json.parse(B.responseText);if(A.success){_.dispatchEvent("onRefuseSuccess");}else{_.dispatchEvent("onRefuseFail",{code:A.flag,detail:A.detailFlag});}}});},ignore:function(C){var B=this,_={r:Math.random(),action:"ignoreBottle",bottleId:C.id};baidu.ajax.post(A,baidu.url.jsonToQuery(_,bk.floatBottle.REPLACE),function(A){if(A.responseText){var _=baidu.json.parse(A.responseText);if(_.success){B.dispatchEvent("onIgnoreSuccess");}else{B.dispatchEvent("onIgnoreFail");}}});},getBottles:function(A,D,C,B){bk.usercenter.ajax.post(_,baidu.url.jsonToQuery({page:A,action:C,recordPerPage:D,r:Math.random()},bk.floatBottle.REPLACE),function(F){if(F.responseText){var _=baidu.json.parse(F.responseText),E={page:A,action:C,totalRecord:_.totalRecord,recordPerPage:D,bottles:[],recycle:_.recycle};baidu.each(_.bottles,function(_){E.bottles.push(bk.floatBottle.tools.parseRdBottle2My(_));});B&&B(E);}});},agree:function(D){var C=this,B=D.replyList[0],_={r:Math.random(),action:"addThanks",bottleId:D.id,replyId:B.id,content:B.tag.thanksVal};baidu.ajax.post(A,baidu.url.jsonToQuery(_,bk.floatBottle.REPLACE),function(A){if(A.responseText){var _=baidu.json.parse(A.responseText);if(_.success){C.dispatchEvent("onAgreeSuccess");}else{C.dispatchEvent("onAgreeFail");}}});},arbitration:function(B){var A=this,_={r:Math.random(),bottleId:B.id};baidu.ajax.post(C,baidu.url.jsonToQuery(_),function(B){if(B.responseText){var _=baidu.json.parse(B.responseText);if(_.success){A.dispatchEvent("onArbitrationSuccess");}else{A.dispatchEvent("onArbitrationFail");}}});},open:function(_){_.open(this);}});}());baidu.more.ns("bk.usercenter");(function(){bk.usercenter.message=function(_){this._timer=null;this._curReq=null;this._running=false;this.runner=null;_=_||{};this.method=_.method||bk.usercenter.message.REQ_METHOD.GET;this.timeType=_.type||bk.usercenter.message.TIME_TYPE.INTERVAL;if(bk.usercenter.message.TIME_TYPE.INTERVAL==this.timeType){this.reqDuration=_.interval||bk.usercenter.message.DEFAULT_REQ_DURATION;}this.url=_.url;this.urlParams=_.urlParams||{};this.data=_.data||{};baidu.lang.Class.call(this);return this;};baidu.lang.inherits(bk.usercenter.message,baidu.lang.Class);baidu.extend(bk.usercenter.message.prototype,{start:function(){if(this._running){this.cancel();}this._reqStart();this.dispatchEvent("onReqStart");this._running=true;if(bk.usercenter.message.TIME_TYPE.INTERVAL==this.timeType){this._timer=setInterval(baidu.fn.bind(this._reqStart,this),this.reqDuration);}},cancel:function(){this._running=false;clearTimeout(this._timer);this._curReq!=null&&this._curReq.abort();this.dispatchEvent("onReqCancel");},_reqStart:function(){baidu.extend(this.urlParams,{r:Math.random()});if(!(this.urlParams.hasOwnProperty("entry"))){this.urlParams.entry=2;}var _=this.url+baidu.url.jsonToQuery(this.urlParams);this._curReq=baidu.ajax.request(_,bk.usercenter.message.GET_REQ_DATA(this.method,{onsuccess:baidu.fn.bind(this._onSuccess,this),data:this.data}));},_getTag:function(){return this.constructor;},_onSuccess:function(B){var _=B.responseText,A={message:_};if(""==_||"null"==_||/html/.test(_)){this.cancel();this.dispatchEvent("onSessionTimeout",A);if(this.runner){this.runner._processSessionTimeout();}}else{this.dispatchEvent("onDataGet",A);if(this.runner){A.tag=this._getTag();this.runner._processDataGet(A);}}}});baidu.extend(bk.usercenter.message,{TIME_TYPE:{SINGLE:1,INTERVAL:2},REQ_METHOD:{GET:"get",POST:"post"},DEFAULT_REQ_DURATION:300000,GET_REQ_DATA:function(A,B){var _={};_.onsuccess=B.onsuccess;if(A==bk.usercenter.message.REQ_METHOD.POST){_.method="post";_.data=B.data;}return _;}});}());(function(){bk.usercenter.messageRunner=function(){this.messageList=[];this._running=false;return this;};baidu.lang.inherits(bk.usercenter.messageRunner,baidu.lang.Class);baidu.extend(bk.usercenter.messageRunner.prototype,{_processDataGet:function(_){this.dispatchEvent("onDataGet",_);},_processSessionTimeout:function(){this.release();this.dispatchEvent("onSessionTimeout");},_getMessage:function(_){return this.messageList[_]||null;},_getValidMessage:function(_){return baidu.array.filter(_,function(_){if(_!=null){return true;}});},_doAction:function(A,B){var _=this._getValidMessage(A);baidu.each(_,function(_){B.call(_);});},_getList:function(_){var A=[];if(_){A.push(this._getMessage(_));}else{A=this.messageList;}return A;},stop:function(_){var A=bk.usercenter.message.prototype.cancel;this._doAction(this._getList(_),A);this._running=false;},start:function(_){var A=bk.usercenter.message.prototype.start;this._doAction(this._getList(_),A);this._running=true;},addMessage:function(_){this.messageList.push(_);_.runner=this;if(this._running){_.start();}return this;},removeMessage:function(_){var A=parseInt(_,10),B=null;if(!isNaN(A)){B=this._getMessage(A);}else{B=_;}if(B){B.cancel();var D;for(D=0,len=this.messageList.length;D<len;++D){var C=this.messageList[D];if(C==B){this.messageList.splice(D,1,null);}}}},release:function(){this.stop();baidu.each(this.messageList,function(_){if(_){_.cancel();_=null;}});}});}());baidu.more.ns("bk.usercenter");(function(){bk.usercenter.messageBoard=function(C){this._wrap=baidu.g(C.wrap);this._contentWrap=baidu.g(C.contentWrap);this._messages=[];this._className=C.className||"message-board";this._contentWrap.className=this._className;this.maxShowcount=C.maxCount||baidu.usercenter.messageBoard.DEFAULT_COUNT;var A=C.sortFunc,B=C.buildMsgFunc,_=function(A,_){if(_){return A.sort(_);}return A;};baidu.extend(this,{show:function(){baidu.dom.show(this._wrap);},hide:function(){baidu.dom.hide(this._wrap);},close:function(){this.clearMessages();this._wrap.parentNode.removeChild(this._wrap);},getWrapDomChindren:function(){return baidu.dom.query("."+this._className+" ul li");},clearMessages:function(){var _=this._messages;baidu.each(this.getWrapDomChindren(),function(C,A){var B=baidu.dom.getAttr(C,"click");if(B){baidu.un(C,"click",_[A].handler);}});this._contentWrap.innerHTML="";this._messages=[];},setMessages:function(G){this.clearMessages();if(baidu.lang.isArray(G)){this._messages=[].concat(G);}else{this._messages.push(G);}var H=_(this._messages,A),F=Math.min(this.maxShowcount,H.length),E=document.createElement("ul"),I;for(I=0;I<F;++I){if(B){var C=B(this._messages[I]);if(C){var D=document.createElement("li");D.appendChild(C);E.appendChild(D);}}}this._contentWrap.appendChild(E);}});};baidu.extend(bk.usercenter.messageBoard,{DEFAULT_COUNT:4});}());baidu.more.ns("bk.floatBottle");bk.floatBottle.tools=(function(){if(typeof bk.floatBottle.tools!=="undefined"){return bk.floatBottle.tools;}var A={1:["\u5df2\u53d1\u51fa","s5","send"],2:["\u5f85\u8bc4\u4ef7","s6","uncomment"],3:["\u5df2\u5904\u7406","s1","solve"],4:["\u5f85\u5904\u7406","s4","unedit"],5:["\u8fdb\u884c\u4e2d","s3","going"],6:["\u5df2\u5b8c\u6210","s1","success"],7:["\u5df2\u5173\u95ed","s2","fail"],8:["\u5df2\u6295\u8bc9","s4","complaint"]};function I(D,C,B){D=baidu.g(D);var _=D.innerText||D.textContent,A=new RegExp(C);if(A.test(_)){_=_.replace(A,function(_){return'<span style="color:red" onclick="this.style.color=\'\'">'+_+"</span>";});D.innerHTML=_;B&&B(C);}}function H(B,_,C){if(B.setSelectionRange){B.setSelectionRange(_,C);}else{if(B.createTextRange){var A=B.createTextRange();A.collapse(true);A.moveStart("character",_);A.moveEnd("character",C-_);A.select();}}B.focus();}function D(E,A,C,B){E=baidu.g(E);var D=A.indexOf(C);if(-1!=D){var _=D+C.length;H(E,D,_);B&&B(C);}}function E(C,E){var B=/(\{\w+\})/g,_=C.match(B);if(!_||0==(len=_.length)){return C;}var G;for(G=len;G--;){var F=_[G],A=F.length-2,D=F.substr(1,A);if(!E.hasOwnProperty(D)){E[D]="";}C=C.replace(new RegExp(F,"g"),E[D]);}return C;}function C(F,K,E){var M=F.thrower,J=M.name;if(0==M.id){M.name="\u7cfb\u7edf";}var L=M.getUserIcon(),G=F.fromDate.split(" ")[0],D=bk.floatBottle.GET_BOTTLE_STATUS(parseInt(F.status),K),H=A[D],_=F.thrower,B=F.lemmas[0],I=_.equalTo(E)?"\u60a8\u53d1\u51fa\u6c42\u52a9\u74f6":"\u60a8\u6536\u5230"+_.name+"\u7684\u6c42\u52a9\u74f6",C={name:J,src:L,id:F.id,date:G,statusMsg:H[0],statusClass:H[1],openClass:(1==F.isOpen?"":"unopen"),contentStr:I,lemmaId:B.lemmaId,lemmaTitle:B.lemmaTitle+(B.subLemmaTitle?"-"+B.subLemmaTitle:"")};return C;}function G(_){var B=bk.floatBottle.GET_BOTTLE_CONT(_.type),C={id:_.id,from:new bk.usercenter.user(_.from),fromDate:_.throwDate,isOpen:_.isOpen,type:_.type,status:_.status,thrower:new bk.usercenter.user(_.user),lemmas:[{lemmaId:_.lemmaId,lemmaTitle:_.lemmaTitle,subLemmaId:_.subLemmaId,subLemmaTitle:_.subLemmaTitle,versionId:_.versionId,subVersionId:_.subVersionId}]};if(_.content){baidu.extend(C,{tag:_.content});}var A=new B(C);return A;}function B(_){_.stopPropagation();}function _(_){var A=[];A.push({type:1,length:_.bottle?_.bottle.length:0});A.push({type:2,length:_.reply?_.reply.length:0});A.canEditCard=_.canEditCard=="y"?true:false;return A;}function F(_,B,A){if(typeof _=="undefined"){return;}bk.usercenter.ajax.get("/user/ajax/bottle/setting?receiveMsg="+_+"&r="+Math.random(),function(C){var _=baidu.json.parse(C.responseText);if(_.success&&B){B();}else{A&&A();}});}return{highlight:I,textSelect:D,substitude:E,cancelEvent:B,translateMessage:_,parseMyBottle2UI:C,parseRdBottle2My:G,saveSetting:F};}());baidu.more.ns("bk.lemma");bk.lemma.bottleMessage=(function(){var L={BOTTLE:1,REPLY:2,CLOSE:3,STOP:4},N="/user/ajax/bottle/notice?",Q=3,_=0,P=null,H=null,O=false,K=bk.floatBottle.tools,G,C;function B(){var _=H;if(6===baidu.ie){_.style.setExpression("zoom",'function(ele){ele.style.top = Math.max(baidu.page.getScrollTop(), 30) +"px";}(this)');}function A(){var B=30,A=baidu.page.getScrollTop();if(A>30){B=0;}if(6!==baidu.ie){_.style.top=B+"px";}}A();baidu.on(window,"resize",A);baidu.on(window,"scroll",A);baidu.on(window,"unload",function(){baidu.un(window,"resize",A);baidu.un(window,"scroll",A);});}function D(){H=I();B();C=new bk.usercenter.messageBoard({wrap:H,contentWrap:"btl-indicator-content",maxCount:Q,buildMsgFunc:F});G=new bk.usercenter.message({url:N,urlParams:{type:1},type:bk.usercenter.message.TIME_TYPE.INTERVAL,interval:600000});G.addEventListener("onDataGet",A);G.start();}function I(){var _=document.createElement("div");_.id="btl-msg-indicator";_.className="float-board";_.style.display="none";_.innerHTML='<div class="btl-indicator"><div id="btl-indicator-content"></div><a class="close" '+'onclick="bk.lemma.bottleMessage.close()" href="javascript:;">\xd7</a></div>';document.body.appendChild(_);return _;}function A(A){var B=K.translateMessage(baidu.json.parse(A.message));if(B.canEditCard===true||(0==B[0].length&&0==B[1].length&&0==_)){P=bk.ui.enctip();P.buildWrapperTip();O=true;}if(B[1].length>0&&B.canEditCard===false){if(O){return;}C.show();B.push({type:L.CLOSE});C.setMessages(B);}_++;}function F(B){var A=document.createElement("div"),_="";switch(B.type){case L.BOTTLE:if(B.length>0){_='<span class="dot"></span><span class="msg-content">\u6709<span style="color:red">1</span>\u4e2a\u6c42\u52a9\u74f6\u6f02\u6765\u4e86\uff0c'+'<a href="/uc/bottle#1" target="_blank" onclick="bk.lemma.bottleMessage.close()">\u53bb\u635e\u74f6\u5b50\u5e2e\u5fd9</a></span>';}break;case L.REPLY:if(B.length>0){_='<span class="dot"></span><span class="msg-content"><strong><span class="red">'+B.length+'</span></strong>\u4e2a\u6c42\u52a9\u74f6\u6709\u65b0\u52a8\u6001\uff0c<a href="/uc/bottle#2" target="_blank" onclick="bk.lemma.bottleMessage.close()">\u67e5\u770b\u6211\u7684\u74f6\u5b50</a></span>';}break;case L.CLOSE:A.style.cssText="text-align:right;padding:.5em .5em 0 0;";_='<a href="javascript:;" onclick="bk.lemma.bottleMessage.stopMessage();">\u4e0d\u518d\u63d0\u793a</a>';break;case L.STOP:_='\u8bbe\u7f6e\u6210\u529f\uff01<span style="color:#999">\u53ef\u5728\u201c\u4e2a\u4eba\u4e2d\u5fc3-\u6211\u7684\u6c42\u52a9\u74f6-\u8bbe\u7f6e\u201d\u4e2d\u91cd\u65b0\u5f00\u542f\u3002</span>';break;}A.innerHTML=_;if(_==""){return null;}return A;}function M(){G.cancel();C.close();}function J(){C.setMessages([{type:L.STOP}]);if("undefined"!=typeof easy.fx){var _=new easy.fx({selector:H,duration:210,animate:true,from:[["opacity",1,0]],to:[["opacity",0,0]],onStart:function(){G.cancel();return true;},onStop:function(){C.close();}});setTimeout(function(){_.start();},2000);}else{M();}}function E(){baidu.ajax.get("/user/ajax/bottle/setting?receiveMsg=0&r="+Math.random(),function(A){var _=baidu.json.parse(A.responseText);if(_.success){J();}});}return{run:D,stopMessage:E,start:function(){G.start();},stop:function(){G.cancel();},close:M};}());baidu=baidu||{};baidu.bottle=(function(){var _;return{closeDialog:function(){_.close();},throwBottle:function(H){H=H||{};var F=H.lemmaId,_=H.lemmaTitle,E=H.userId,B=H.modType,J=H.subLemmaId,A=H.subLemmaTitle,D=H.propsId||"",C=H.link;if(C&&typeof curUser!=="undefined"&&curUser.forbid===true){C.href="/error/forbid";C.target="_blank";return true;}A=A||"";if(!A&&baidu.g("polysemy-sub-lemma-desc-temp")&&"undefined"!==typeof EditHelpConf&&EditHelpConf.isPolysemy){A=baidu.g("polysemy-sub-lemma-desc-temp").value;}if(!J&&baidu.g("polysemy-sub-lemma-id")&&"undefined"!==typeof EditHelpConf&&EditHelpConf.isPolysemy){J=baidu.g("polysemy-sub-lemma-id").value;}var I=new bk.floatBottle.cardBottle({lemmas:[{lemmaId:F,lemmaTitle:_}],propsId:D}),G=this;I.addEventListener("onCheckSuccess",function(){G._doThrwoBottle(F,_,E,B,J,A,D);});I.addEventListener("onCheckFail",function(_){var A=["","\u6b63\u5e38","\u6765\u6e90\u8bcd\u6216\u8005\u9501\u5b9a\u8bcd","\u74f6\u5b50\u6254\u8fc7\u4e86","\u6b21\u6570\u8d85\u8fc7","\u5305\u542b\u654f\u611f\u8bcd","\u63d0\u4ea4\u9a8c\u8bc1\u5931\u8d25","\u6254\u74f6\u5b50\u5931\u8d25","\u6254\u6210\u529f","\u672c\u671f\u6c42\u52a9\u74f6\u4ec5\u5f00\u653e\u540d\u7247\u6c42\u52a9\u3002\u60a8\u5df2\u7ecf\u6709\u540d\u7247\u6743\u9650\uff0c\u5feb\u53bb\u53d1\u6325\u7279\u6743\uff0c\u635e\u74f6\u5b50\u5e2e\u52a9\u522b\u4eba\u5427\uff01"];if(_.code===2){G.showDialog("lockedlemma");}else{if(_.code===3){G.showDialog("versionconflict");}else{if(_.code===4){G.showDialog("nobottle",{nums:_.detail,btlParams:H});}else{if(_.code==7){G.showDialog("forbid");}else{if(_.code==-3){G.showDialog("nouser");}else{if(_.code===9){G.showDialog("canedit");}else{alert(A[_.code]);}}}}}}});I.check();return false;},_doThrwoBottle:function(G,A,F,D,H,C,E){D=D||1;var B="/static/usercenter/page/throwbtl.html?lemmaId="+G+"&lemmaTitle="+encodeURIComponent(A)+"&userId="+F+"&type="+D+"&polysemy="+encodeURIComponent(C)+"&polysemyId="+(H)+"&propsId="+(E);_=Dialog.iframe(B,{titleText:"\u53d1\u9001\u6c42\u52a9\u74f6",width:"483px",height:"490px",buttonbar:true,buttons:{cancel:{content:"\u4e0d\u6254\u4e86",onclick:function(){_.close();}},accept:{content:"\u6254\u51fa\u53bb",onclick:function(){_.getIframe().contentWindow.throwBottle();}}},contentType:"HTMLUrl",locked:true});},showDialog:function(D,E){var _="",A;switch(D){case"lockedlemma":Detect.content="<p>\u6765\u6e90\u8bcd\u6216\u9501\u5b9a\u8bcd\u4e0d\u80fd\u8fdb\u884c\u6c42\u52a9\u3002</p>";_="\u4e0d\u80fd\u6c42\u52a9";break;case"nouser":Detect.content="<p>\u7528\u6237\u540d\u4e0d\u5b58\u5728\uff0c\u8bf7\u5148\u586b\u5199\u7528\u6237\u540d\u3002</p>";_="\u53d1\u9001\u6c42\u52a9\u74f6";break;case"versionconflict":Detect.content="<p>\u5df2\u6709\u79d1\u53cb\u5bf9\u8be5\u8bcd\u6761\u7684\u540d\u7247\u53d1\u8d77\u4e86\u6c42\u52a9\uff0c\u6c42\u52a9\u6b63\u5728\u8fdb\u884c\u4e2d\u3002\u4f11\u606f\u4e00\u4e0b\uff0c\u4e00\u4f1a\u513f\u518d\u6765\u770b\u770b\u5427\u3002</p>";_="\u53d1\u9001\u6c42\u52a9\u74f6";break;case"nobottle":if(bk.shop&&bk.shop.propsBox&&bk.shop.propsBox.unUsedBottleProps.length>0){var B=bk.shop.propsBox.unUsedBottleProps[0];A=new bk.shop.DialogHelper();A.addContent("\u6bcf\u4eba\u6bcf\u5929\u53ea\u6709"+E.nums+"\u4e2a\u74f6\u5b50\uff0c\u4eca\u5929\u7684\u74f6\u5b50\u7528\u5b8c\u5566\uff01<br/><br/>");A.addContent("\u9053\u5177\u5305\u4e2d\u6709\u4e00\u4e2a\u53d1\u74f6\u5b50\u9053\u5177\uff0c\u53ef\u4ee5\u4f7f\u7528\u9053\u5177\u53d1\u51fa\u3002<br/>");A.addContent("\u786e\u8ba4\u4f7f\u7528\u5417\uff1f<br/>");A.addBtn({text:"\u4f7f\u7528",onclick:function(){nslog(location.href,3620,{t1:4});var _=new bk.shop.PropsManager();_.addEventListener("propsused",function(_){C.close();E.btlParams.propsId=_.props.propsId;baidu.bottle.throwBottle(E.btlParams);});_.useProps(B);}});A.addBtn({text:"\u53d6\u6d88",onclick:function(){C.close();}});A.addFooter('\u4f60\u4e5f\u53ef\u4ee5\u53c2\u52a0<a href="/uc/task#1" target="_blank">\u6210\u957f\u4efb\u52a1</a>\uff0c\u52a0\u901f\u5347\u7ea7\uff0c\u81ea\u5df1\u83b7\u5f97\u6743\u9650\u6765\u7f16\u8f91\uff01');var C=new Dialog({titleText:"\u74f6\u5b50\u4e0d\u591f\u5566",width:400,height:"auto",autoRender:true,contentText:A.render(),modal:true,buttonbar:false,onload:A.onDialogLoad()});C.open();return;}Detect.content="\u6bcf\u4eba\u6bcf\u5929\u53ea\u6709"+E.nums+'\u4e2a\u74f6\u5b50\uff0c\u4eca\u5929\u7684\u74f6\u5b50\u7528\u5b8c\u5566\uff01<br/><br/>\u53ef\u4ee5\u53bb<a href="/mall" target="_blank">\u767e\u79d1\u5546\u57ce</a>\u5151\u6362\u65b0\u6c42\u52a9\u74f6\u6743\u9650\u53d1\u51fa\u6c42\u52a9\u3002'+'<br/><br/>\u4f60\u4e5f\u53ef\u4ee5\u53c2\u52a0<a href="/uc/task#1" target="_blank">\u6210\u957f\u4efb\u52a1</a>\uff0c\u52a0\u901f\u5347\u7ea7\uff0c\u81ea\u5df1\u83b7\u5f97\u6743\u9650\u6765\u7f16\u8f91\uff01';_="\u74f6\u5b50\u4e0d\u591f\u5566";break;case"canedit":Detect.content="\u672c\u671f\u6c42\u52a9\u74f6\u4ec5\u5f00\u653e\u540d\u7247\u6c42\u52a9\u3002\u60a8\u5df2\u7ecf\u6709\u540d\u7247\u6743\u9650\uff0c\u5feb\u53bb\u53d1\u6325\u7279\u6743\uff0c\u635e\u74f6\u5b50\u5e2e\u52a9\u522b\u4eba\u5427\uff01<br/>\u6709\u6c42\u52a9\u9700\u7f16\u8f91\u65f6\uff0c\u4f1a\u6709\u5c0f\u6c14\u6ce1\u63d0\u793a\u60a8\uff0c\u4e5f\u53ef\u4ee5\u968f\u65f6\u53bb\u201c\u4e2a\u4eba\u4e2d\u5fc3-\u6211\u7684\u6c42\u52a9\u74f6\u201d\u635e\u53d6\u3002";_="\u60a8\u5df2\u6709\u540d\u7247\u6743\u9650";break;case"forbid":Detect.content="\u60a8\u7684\u8d26\u6237\u5df2\u88ab\u5c01\u7981,\u4e0d\u80fd\u635e\u53d6\u6c42\u52a9\u74f6\u3002";_="\u4f60\u7684\u8d26\u6237\u5df2\u88ab\u5c01\u7981";break;default:Detect.content="\u51fa\u9519\u4e86\uff01";_="\u51fa\u9519\u4e86\uff01";break;}C=Dialog.iframe("/page/privcheck.html",{titleText:_,width:"402px",height:"180px",buttonbar:true,buttons:{accept:{content:"\u786e\u5b9a",onclick:function(){C.close();}}},contentType:"HTMLUrl",locked:true});}};}());baidu.dom.ready(function(){var A=baidu.g("lemmaid");if(!A){return;}A=A.value;if(!A){return;}var C="/user/ajax/bottle/getinfo",_="lemmaId="+A,B=function(_,B){if(!B||"null"===B||"[]"===B||/html/.test(B)){return;}var A=baidu.json.parse(B);baidu.g("tip-btl-content-mod").innerHTML=A.content.content;baidu.g("tip-btl-content-reason").innerHTML=A.content.reason;baidu.g("tip-btl-content-ref").innerHTML=A.content.reference;baidu.g("tip-btl-link").href=baidu.g("tip-btl-link").href+A.id;baidu.g("tip-btl").style.display="block";if(baidu.g("bottle-info")){baidu.g("bottle-info").style.display="";}};baidu.ajax.post(C,_,B);});baidu.more.ns("bk.shop");bk.shop.BusinessError=function(_){if(baidu.isString(_)){this.message=_;}else{baidu.extend(this,_||{});}this.errmsg=String(this.flag);this.errno=parseInt(this.errno)||this.errno;};bk.shop.BusinessError.prototype={name:"bkshopBusinessError",errno:"",message:""};baidu.more.ns("bk.shop");bk.shop.Commodity=function(_){_=_||{};this.id="";this.name="";this.classId="";this.className="";this.imgSrc="";this.imgHref="";baidu.extend(this,_);};bk.shop.Commodity.prototype={PURCHASE_URL:"/mall/exchange",id:"",name:"",classId:"",imgSrc:"",imgHref:"",className:"",shareText:"",onbeforepurchase:function(){},onpurchase:function(){},onpurchaseerr:function(B){var _=B.errno,D=B.errmsg,A=new bk.shop.DialogHelper();switch(_){case 1:A.addContent(">_< \u62b1\u6b49\uff0c\u5b83\u592a\u53d7\u6b22\u8fce\uff0c\u88ab\u62a2\u5b8c\u5566\uff01<br/>");A.addContent("\u53bb\u770b\u770b\u5176\u5b83\u5546\u54c1\u5427\uff01<br/>");break;case 2:A.addContent(">_< \u62b1\u6b49\uff0c\u4e0d\u5728\u5151\u6362\u65f6\u95f4\u54df\uff01<br/>");A.addContent("\u5f00\u59cb\u518d\u6765\u5427\uff01<br/>");break;case 3:if(this.consumeType==bk.shop.Commodity.CONSUME_TYPES.WEALTH){A.addContent(">_< \u62b1\u6b49\uff0c\u4f60\u7684\u8d22\u5bcc\u503c\u4e0d\u591f\uff01<br/>");A.addContent("\u5feb\u53bb\u591a\u8d5a\u4e9b\u8d22\u5bcc\u503c\u5427\uff01<br/>");}else{A.addContent(">_< \u62b1\u6b49\uff0c\u4f60\u7684\u79ef\u5206\u4e0d\u591f\uff01<br/>");A.addContent('\u5feb\u53bb\u591a\u8d5a\u4e9b\u79ef\u5206\u5427\uff01<a href="/mall#getScore">\u53bb\u8d5a\u5206</a><br/>');}break;case 4:A.addContent(">_< \u62b1\u6b49\uff0c\u4f60\u7684 "+(bk.shop.Commodity.CONDITION_NAMES[D]||"\u6761\u4ef6")+" \u672a\u6ee1\u8db3\uff01<br/>");A.addContent("\u5feb\u53bb\u52a0\u6cb9\u8fbe\u5230\u5427\uff01<br/>");break;case 5:var E=D.split(",");if(E.length==2){A.addContent(">_< \u62b1\u6b49\uff0c\u8be5\u5546\u54c1\u6bcf"+bk.shop.hourToDay(E[1])+"\u53ea\u80fd\u5151\u6362"+E[0]+"\u4e2a!<br/>");}else{A.addContent(">_< \u62b1\u6b49\uff0c\u8be5\u5546\u54c1\u53ea\u80fd\u5151\u6362"+D+"\u4e2a!<br/>");}break;case 6:A.addContent(">_< \u62b1\u6b49\uff0c\u4f60\u5df2\u62e5\u6709\u8be5\u5546\u54c1\uff0c\u4e0d\u80fd\u518d\u5151\u6362\u4e86\uff01<br/>");break;case 7:A.addContent(">_< \u62b1\u6b49\uff0c\u5151\u6362\u5df2\u7ed3\u675f\uff01<br/>");A.addContent("\u4e0b\u6b21\u65e9\u70b9\u6765\u5427\uff01<br/>");break;case 8:A.addContent("\u8d26\u53f7\u5f02\u5e38\uff0c\u65e0\u6cd5\u5151\u6362\uff01<br/>");break;case 9:A.addContent("\u60a8\u5df2\u7ecf\u6709\u540d\u7247\u6743\u9650\uff0c\u4e0d\u80fd\u5151\u6362\u8be5\u5546\u54c1\uff01<br/>");break;case 240006:A.addContent(">_< \u7528\u6237\u540d\u4e0d\u5b58\u5728\uff0c\u8bf7\u5148\u586b\u5199\u7528\u6237\u540d\uff01<br/>");break;default:A.addContent(">_< \u62b1\u6b49\uff0c\u5151\u6362\u5931\u8d25\uff01");A.addContent("\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002<br/>");}A.addBtn({text:"\u786e\u5b9a",onclick:function(){C.close();}});var C=new bk.Dialog({titleText:"\u5151\u6362\u5931\u8d25",contentText:A.render(),modal:true,buttonbar:false,onload:A.onDialogLoad()});C.open();},getPurchaseParams:function(){return{id:this.id,name:encodeURIComponent(this.name),classId:this.classId};},purchase:function(){var _=this;if(_.onbeforepurchase()!==false){baidu.ajax.post(_.PURCHASE_URL,baidu.url.jsonToQuery(_.getPurchaseParams(),bk.shop.replace),function(C){var A=baidu.json.parse(C.responseText);if(A.success){_.dispatchEvent("purchase",{commodity:_,reqResult:A});}else{var B=new bk.shop.BusinessError(A);_.dispatchEvent("purchaseerror",{commodity:_,err:B});_.onpurchaseerr.call(_,B,B);}});}}};bk.shop.Commodity.TYPE={"1":"Medal","2":"VirtualFigure","3":"DoubleExpByTime","4":"DoubleExpByVersion","5":"CardEditToken","6":"BottleProps","7":"RealThing"};bk.shop.Commodity.CONDITION_NAMES={level:"\u7b49\u7ea7",pass_rate:"\u901a\u8fc7\u7387",cp_version:"\u590d\u6742\u7248\u672c\u6570",hq_version:"\u9ad8\u8d28\u91cf\u7248\u672c\u6570",gq_version:"\u4f18\u8d28\u7248\u672c\u6570",role:"\u7528\u6237\u89d2\u8272"};bk.shop.Commodity.CONSUME_TYPES={SCORE:1,WEALTH:2};baidu.lang.inherits(bk.shop.Commodity,baidu.lang.Class);bk.shop.BaseProps=function(){bk.shop.BaseProps.superClass.constructor.apply(this,arguments);if(typeof this.tinySrc=="undefined"){this.tinySrc=this.imgSrc;}};bk.shop.BaseProps.prototype={isProps:true,propsId:-1,used:false,onbeforeuse:function(){},onuse:function(){},useInfoTpl:"#{name}\u4f7f\u7528\u4e2d.</a>",usableInfoTpl:'\u53ef\u4f7f\u7528#{name}\uff01\u70b9\u51fb\u5373\u53ef<a href="javascript:;" onclick="bk.shop.useProps({propsId:#{propsId},classId:#{classId}});return false;">\u5f00\u542f\u4f7f\u7528</a>',onuseerr:function(B){var _=B.errno,A=new bk.shop.DialogHelper();switch(_){case 2:A.addContent("\u9053\u5177\u65e0\u6548\uff01<br/>");break;case 3:A.addContent(">_< \u62b1\u6b49\uff0c\u60a8\u5df2\u4f7f\u7528\u8be5\u9053\u5177\uff0c\u4e0d\u80fd\u91cd\u590d\u4f7f\u7528\uff01<br/>");break;default:A.addContent(">_< \u62b1\u6b49\uff0c\u4f7f\u7528\u9053\u5177\u5931\u8d25\uff01");A.addContent("\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002<br/>");}A.addBtn({text:"\u786e\u5b9a",onclick:function(){C.close();}});var C=new bk.Dialog({titleText:"\u4f7f\u7528\u9053\u5177\u5931\u8d25",contentText:A.render(),modal:true,buttonbar:false,onload:A.onDialogLoad()});C.open();},renderUseInfoTo:function(B){var _=B.id,A=B.tpl||this.useInfoTpl,C=baidu.string.format(A,this);_=baidu.g(_);if(_){_.innerHTML=C;}return C;},renderUsableInfoTo:function(B){var _=B.id,A=B.tpl||this.usableInfoTpl,C=baidu.string.format(A,this);_=baidu.g(_);if(_){_.innerHTML=C;}return C;}};bk.shop.BaseProps.NAMES={DoubleExpByTime:"DoubleExpByTime",DoubleExpByVersion:"DoubleExpByVersion",CardEditToken:"CardEditToken",BottleProps:"BottleProps"};baidu.lang.inherits(bk.shop.BaseProps,bk.shop.Commodity);bk.shop.CountLimitedProps=function(){bk.shop.CountLimitedProps.superClass.constructor.apply(this,arguments);};bk.shop.CountLimitedProps.prototype={countLimited:true,count:-1};baidu.lang.inherits(bk.shop.CountLimitedProps,bk.shop.BaseProps);bk.shop.TimeLimitedProps=function(){bk.shop.TimeLimitedProps.superClass.constructor.apply(this,arguments);this.countDownTime=this.leftTime;this.createTime=new Date().getTime();};bk.shop.TimeLimitedProps.prototype={timeLimited:true,leftTime:-1,period:60000,useInfoTpl:"\u6b63\u5728\u4f7f\u7528#{name},\u5269\u4f59\u65f6\u95f4:#{leftHour}:#{leftMinute}:#{leftSecond}",usableInfoTpl:'\u53ef\u4f7f\u7528#{name}\uff01\u70b9\u51fb\u5373\u53ef<a href="javascript:;" onclick="bk.shop.useProps({propsId:#{propsId},classId:#{classId}});return false;">\u5f00\u542f\u4f7f\u7528</a>',countDown:function(B){this.stopCountDown();var A=this;A.countDownTime-=parseInt((new Date().getTime()-A.createTime)/1000);B=Math.max(B||this.period,1000);var _=A.countDownTime%(B/1000);if(_>0){_+=1/60;}A.addEventListener("countdown",A.refreshUseInfo);A.countDownTimer=setTimeout(function(){A.countDownTime-=_;A.countDownInterval=setInterval(function(){A.countDownTime-=B/1000;if(A.countDownTime<=0){A.countDownTime=0;A.stopCountDown();}A.fireCountDownEvent();},B);A.fireCountDownEvent();},_*1000);A.fireCountDownEvent();},setLeftTime:function(_){this.leftTime=_;this.countDownTime=this.leftTime;this.createTime=new Date().getTime();},stopCountDown:function(){if(this.countDownTimer){clearTimeout(this.countDownTimer);}if(this.countDownInterval){clearInterval(this.countDownInterval);}this.removeEventListener("countdown",this.refreshUseInfo);},fireCountDownEvent:function(){var A=this;A.leftHour=parseInt(A.countDownTime/3600);A.leftMinute=parseInt(A.countDownTime%3600/60);A.leftSecond=A.countDownTime%60;var _={hour:A.leftHour,minute:A.leftMinute,second:A.leftSecond};A.dispatchEvent("countdown",{countdownTime:_,props:A});},refreshUseInfo:function(){var B=this,A,_=bk.shop.TimeLimitedProps;if(this.used){baidu.array.each(_.useInfoEls,function(_){A=baidu.g(_.id);if(!A){return;}A.innerHTML=baidu.string.format(_.tpl,B);});}else{baidu.array.each(_.usableInfoEls,function(_){A=baidu.g(_.id);if(!A){return;}A.innerHTML=baidu.string.format(_.tpl,B);});}},findElById:function(_,A){for(var C=0,B=A.length;C<B;C++){if(A[C].id==_){return C;}}return-1;},renderUseInfoTo:function(B){var A=bk.shop.TimeLimitedProps;B.tpl=B.tpl||this.useInfoTpl;var _=this.findElById(B.id,A.useInfoEls);if(_>=0){A.useInfoEls.splice(_,1);}_=this.findElById(B.id,A.usableInfoEls);if(_>=0){A.usableInfoEls.splice(_,1);}A.useInfoEls.push(B);},renderUsableInfoTo:function(B){var A=bk.shop.TimeLimitedProps;B.tpl=B.tpl||this.usableInfoTpl;var _=this.findElById(B.id,A.useInfoEls);if(_>=0){A.useInfoEls.splice(_,1);}_=this.findElById(B.id,A.usableInfoEls);if(_>=0){A.usableInfoEls.splice(_,1);}A.usableInfoEls.push(B);}};bk.shop.TimeLimitedProps.useInfoEls=[];bk.shop.TimeLimitedProps.usableInfoEls=[];baidu.lang.inherits(bk.shop.TimeLimitedProps,bk.shop.BaseProps);bk.shop.BottleProps=function(){bk.shop.BottleProps.superClass.constructor.apply(this,arguments);};bk.shop.BottleProps.prototype={isBottleProps:true,onpurchase:function(){var _=new bk.shop.DialogHelper();_.addContent("\u606d\u559c\uff0c\u5151\u6362\u6210\u529f\uff01^_^<br/>");_.addContent("\u53ef\u4ee5\u53bb\u6254\u51fa\u4f60\u8981\u6c42\u52a9\u7684\u74f6\u5b50\u5566~");_.addBtn({text:"\u786e\u5b9a",onclick:function(){A.close();}});_.addBtn('<a href="/uc/score" target="_blank">\u67e5\u770b\u5151\u6362\u8bb0\u5f55&gt;&gt;</a>');_.addFooter("\u6e29\u99a8\u63d0\u793a\uff1a\u5728\u9700\u8981\u6c42\u52a9\u7684\u8bcd\u6761\uff0c\u70b9\u51fb\u201c\u6c42\u52a9\u7f16\u8f91\u201d\u5373\u53ef\u4f7f\u7528\u3002");var A=new bk.Dialog({titleText:"\u5151\u6362\u6210\u529f",contentText:_.render(),modal:true,width:400,buttonbar:false,onload:_.onDialogLoad()});A.open();}};baidu.lang.inherits(bk.shop.BottleProps,bk.shop.BaseProps);bk.shop.CardEditToken=function(){bk.shop.CardEditToken.superClass.constructor.apply(this,arguments);};bk.shop.CardEditToken.prototype={isCardEditToken:true,onpurchase:function(){var _=new bk.shop.DialogHelper();_.addContent("\u606d\u559c\uff0c\u5151\u6362\u6210\u529f\uff01^_^<br/>");_.addContent("\u5feb\u53bb\u7f16\u8f91\u540d\u7247\u8bd5\u8bd5\u8eab\u624b\u5427~");_.addBtn({text:"\u786e\u5b9a",onclick:function(){A.close();}});_.addBtn('<a href="/uc/score" target="_blank">\u67e5\u770b\u5151\u6362\u8bb0\u5f55&gt;&gt;</a>');_.addFooter("\u6e29\u99a8\u63d0\u793a\uff1a\u5728\u7f16\u8f91\u8bcd\u6761\u72b6\u6001\u4e0b\uff0c\u70b9\u51fb\u201c\u7f16\u8f91\u540d\u7247\u201d\u5373\u53ef\u4f7f\u7528\u3002");var A=new bk.Dialog({titleText:"\u5151\u6362\u6210\u529f",contentText:_.render(),modal:true,width:400,buttonbar:false,onload:_.onDialogLoad()});A.open();}};baidu.lang.inherits(bk.shop.CardEditToken,bk.shop.BaseProps);bk.shop.DoubleExpByTime=function(){bk.shop.DoubleExpByTime.superClass.constructor.apply(this,arguments);};bk.shop.DoubleExpByTime.prototype={onpurchase:function(){var A=this,_=new bk.shop.DialogHelper();_.addContent("\u606d\u559c\uff0c\u5151\u6362\u6210\u529f\uff01^_^<br/>");_.addContent("\u5feb\u4f7f\u7528\u5b83\u52a0\u901f\u5347\u7ea7\u5427!");_.addBtn({text:"\u4f7f\u7528",tpl:'<a href="/uc/prop#act=useItem&id='+A.id+'" target="_blank" class="bk-dialog-accept" id="#{id}" '+'onclick="javascript:#{onclick}"><div class="bk-dialog-button-label">#{text}</div></a>',onclick:function(){B.close();}});_.addBtn('<a href="/uc/score" target="_blank">\u67e5\u770b\u5151\u6362\u8bb0\u5f55&gt;&gt;</a>');_.addFooter("\u6e29\u99a8\u63d0\u793a\uff1a\u4e5f\u53ef\u4ee5\u5728\u7f16\u8f91\u8bcd\u6761\u65f6\u70b9\u51fb\u4f7f\u7528\uff0c\u5f00\u542f\u8ba1\u65f6~");var B=new bk.Dialog({titleText:"\u5151\u6362\u6210\u529f",width:350,contentText:_.render(),modal:true,buttonbar:false,onload:_.onDialogLoad()});B.open();},onuse:function(){var _=new bk.shop.DialogHelper();_.addContent("\u4f7f\u7528\u6210\u529f\uff01^_^<br/>");_.addContent("\u5f00\u59cb\u8ba1\u65f6\u5566\uff0c12\u5c0f\u65f6\u5185\u7f16\u8f91\u7684\u6240\u6709\u7248\u672c\uff0c\u5728\u901a\u8fc7\u540e\u4f1a\u83b7\u5f97\u53cc\u500d\u79ef\u5206\u54e6\uff0c\u5feb\u53bb\u7f16\u8f91\u64c5\u957f\u7684\u8bcd\u6761\u5427~");_.addBtn({text:"\u786e\u5b9a",onclick:function(){A.close();}});_.addFooter('\u6e29\u99a8\u63d0\u793a\uff1a\u7f16\u8f91\u6c42\u52a9\u74f6\u8bcd\u6761\uff0c\u7ecf\u9a8c\u503c\u66f4\u591a\u54e6\uff01<a href="/uc/bottle#1">\u635e\u74f6\u5b50\u53bb>></a>');var A=new bk.Dialog({titleText:"\u4f7f\u7528\u6210\u529f",width:400,contentText:_.render(),modal:true,buttonbar:false,onload:_.onDialogLoad()});A.open();}};baidu.lang.inherits(bk.shop.DoubleExpByTime,bk.shop.TimeLimitedProps);bk.shop.DoubleExpByVersion=function(){bk.shop.DoubleExpByVersion.superClass.constructor.apply(this,arguments);};bk.shop.DoubleExpByVersion.prototype={doubleExpByVersion:true,onpurchase:function(){var _=new bk.shop.DialogHelper();_.addContent("\u606d\u559c\uff0c\u5151\u6362\u6210\u529f\uff01^_^<br/>");_.addContent("\u5feb\u4f7f\u7528\u5b83\u52a0\u901f\u5347\u7ea7\u5427!");_.addBtn({text:"\u786e\u5b9a",onclick:function(){A.close();}});_.addBtn('<a href="/uc/score" target="_blank">\u67e5\u770b\u5151\u6362\u8bb0\u5f55&gt;&gt;</a>');_.addFooter("\u6e29\u99a8\u63d0\u793a\uff1a\u5728\u63d0\u4ea4\u8bcd\u6761\u65f6\u70b9\u51fb\u4f7f\u7528\u5373\u53ef\u3002");var A=new bk.Dialog({titleText:"\u5151\u6362\u6210\u529f",contentText:_.render(),modal:true,buttonbar:false,onload:_.onDialogLoad()});A.open();}};baidu.lang.inherits(bk.shop.DoubleExpByVersion,bk.shop.BaseProps);baidu.more.ns("bk.shop");bk.shop.DialogHelper=function(){this.content=[];this.btn=[];this.footer=[];this.btnHandler=[];};bk.shop.DialogHelper.prototype={tpl:'<div class="bkshopdialog"><div class="content">#{content}</div><div class="btns">#{btns}</div><div class="footer">#{footer}</div></div>',addContent:function(_){this.content.push(_);return this;},addBtn:function(_){if(baidu.isString(_)){this.btn.push(_);return true;}else{if(baidu.isObject(_)){if(_.type=="sinaweibo"){this.btn.push(this.createWeiboButton(_));}else{this.btn.push(this.createButton(_));}}}return this;},addFooter:function(_){this.footer.push(_);return this;},render:function(){var _=this;return baidu.string.format(this.tpl,{content:_.content.join(""),btns:_.btn.join(""),footer:_.footer.join("")});},createButton:function(A){var _=baidu.lang.guid(),B=A.tpl||'<div class="bk-dialog-accept" id="#{id}" onclick="javascript:#{onclick}"><div class="bk-dialog-button-label">#{text}</div></div>',C=A.onclick;if(baidu.lang.isFunction(A.onclick)){C=baidu.fn.bind(C,A.scope);this.addBtnHandler(_,C);C=";";}this.btn.push(baidu.string.format(B,{id:_,onclick:C,text:A.text,btnName:A.name||"accept"}));},createWeiboButton:function(C){C=C||{};var _={url:location.href,type:"4",count:"",appkey:"3417820038",title:C.shareText||"",pic:C.sharePic||"",ralateUid:"1647247597",rnd:new Date().valueOf()},B=[];for(var A in _){B.push(A+"="+encodeURIComponent(_[A]||""));}return'<span class="sinaweibo"><a class="tsina" href="javascript:;" onclick="window.open'+"(&quot;http://service.weibo.com/share/share.php?"+B.join("&")+"&quot;,"+"&quot;newwindow&quot;,&quot;height=440,width=430,top=&quot;+(screen.height-440)/2+&quot;,left=&quot;+(screen.width-430)/2+&quot;,"+' toolbar=no, menubar=no, scrollbars=no,resizable=yes,location=no, status=no&quot;);nslog(location.href,3614);return false" '+'title="\u5206\u4eab\u5230\u65b0\u6d6a\u5fae\u535a"></a></span>';},addBtnHandler:function(_,A){this.btnHandler.push({id:_,fn:A});},onDialogLoad:function(){var _=this;return baidu.fn.bind(function(){if(_.btnHandler){baidu.array.each(_.btnHandler,function(_){baidu.on(_.id,"click",function(){_.fn();});});}},_);}};baidu.lang.inherits(bk.shop.DialogHelper,baidu.lang.Class);baidu.more.ns("bk.shop");bk.shop.MyPropsBox=function(_){this.guid=baidu.lang.guid();baidu.extend(this,_);this.parseProps();this.render();};bk.shop.MyPropsBox.prototype={propsCount:0,usedProps:[],unUsedProps:[],renderTo:null,tpl:'<div class="bkshop-propsbox" id="#{id}"><div id="encbox_head" class="clearfix"><div id="props_box" class="propsbox-header" node-type="props"><span class="icon icon-pro"></span><span class="box_title" style="display:none;">\u6211\u7684\u9053\u5177\u7bb1</span></div><div id="msg_box" class="propsbox-header" node-type="msg"><span class="icon icon-msg"></span><span class="box_title" style="display:none;">\u6211\u7684\u4fe1\u606f</span></div><div class="propsbox-header" id="tip_box" node-type="tip"><span class="icon icon-tip"></span><span class="box_title" style="display:none;">\u63d0\u793a\u4fe1\u606f</span></div></div>'+'<div class="propsbox-content clearfix"><ul id="props_content" style="display:none">#{propsList}</ul>'+'<ul id="msg_content" style="display:none"><li>\u60a8\u7684\u7528\u6237\u4fe1\u606f\u6682\u65f6\u4e3a\u7a7a</li></ul>'+'<ul id="tip_content" style="display:none"><li><div id="guidebar" style="display:none;"><div id="gb-content"> \u8be5\u8bcd\u6761\u4e3a\u5f85\u5b8c\u5584<span id="gb-lemmatype"></span>\uff0c\u5b8c\u5584\u5efa\u8bae\uff1a </div></div></li></ul></div></div>',propTpl:'<li><div class="pic-wrap"><img class="pic" src="#{tinySrc}"/></div><div class="desc"><div class="name">#{name}</div>'+'<div class="props-useinfo" id="propsbox-props#{propsId}">#{useInfo}</div></div></li>',isCollpased:false,collapsed:true,parseProps:function(){var A=this,B,_,C=new bk.shop.ShopManager();baidu.each(["used","unUsed"],function(D){var E=A[D];for(var F in bk.shop.BaseProps.NAMES){B=D+bk.shop.BaseProps.NAMES[F];A[B]=[];}A[D+"Props"]=[];baidu.each(E,function(E){E=C.determineCommodityType(E);E[D]=true;if(E.hasOwnProperty("className")&&E.className&&E.isProps===true){_=E.className;}else{return;}B=D+_;A[B].push(E);A[D+"Props"].push(E);});});this.propsCount=this.usedProps.length+this.unUsedProps.length;},propsUsed:function(C){var A=this.removeProps(C,this.unUsedProps),B=this;if(A){this.addProps(A,this.usedProps);var _=C.className;this.removeProps(A,B["unUsed"+_]);this.addProps(A,B["used"+_]);}},removeProps:function(C,_){if(!C||!_){return;}var A=C.propsId,C=null;for(var D=0,B=_.length;D<B;D++){if(_[D].propsId==A){C=_[D];}}if(C){baidu.array.remove(_,C);}return C;},addProps:function(A,_){_.push(A);},getPropsUseInfo:function(_){var A="";if(_.used===true){if(_.timeLimited===true){_.renderUseInfoTo({id:"propsbox-props"+_.propsId,tpl:'\u5269\u4f59\u65f6\u95f4:<span class="orange">#{leftHour}\u5c0f\u65f6#{leftMinute}\u5206\u949f</span>'});_.countDown(60000);}else{A=_.renderUseInfoTo({tpl:'<span class="orange">\u6b63\u5728\u4f7f\u7528\u4e2d</span>'});}}else{if(_.isBottleProps===true){A="\u5728\u6254\u74f6\u5b50\u65f6\u70b9\u51fb\u4f7f\u7528";}else{A='<span class="btn-use" propsId="'+_.propsId+'" classId="'+_.classId+'">\u4f7f\u7528</span>';}}return A;},render:function(){var _=this;if(!_.renderTo){return;}var A=[];baidu.each(_.usedProps,function(B){B.used=true;B.useInfo=_.getPropsUseInfo(B);A.push(baidu.string.format(_.propTpl,B));});baidu.each(_.unUsedProps,function(B){if(B.isBottleProps){return;}B.used=false;B.useInfo=_.getPropsUseInfo(B);A.push(baidu.string.format(_.propTpl,B));});baidu.dom.insertHTML(_.renderTo,"beforeEnd",baidu.string.format(_.tpl,{id:_.guid,propsList:A.join("")||'<li>\u9053\u5177\u7bb1\u4e2d\u6682\u65f6\u6ca1\u6709\u9053\u5177<br/>\u4f60\u53ef\u4ee5<a href="/mall/zone?zoneId=1" target="_blank" onclick="nslog(location.href,3622);">\u53bb\u767e\u79d1\u5546\u57ce\u5151\u6362</a></li>'}));baidu.each(_.usedProps,function(_){if(_.timeLimited===true){_.countDown(60000);}bk.shop.fillEditField(_);});_.el=baidu.g(_.guid);_.contentEl=baidu.dom.query(".propsbox-content",this.el)[0];_.initEvents();if(_.open===true){_.preEl=baidu.g("props_box");_.openTab(_.preEl,0);}var B=new bk.ui.enctip();B.build_edit_tip();bk.editor.guidebar.start();bk.event.fire("bk.propsbox.inited",{propsbox:this});},initEvents:function(){var A=this,B=baidu.g("encbox_head");baidu.on(B,"click",function(_){var B=_.target||_.srcElement;if(B.tagName!="DIV"){B=B.parentNode;}A.changeTab(B);});var _=baidu.dom.query(".btn-use",this.el);baidu.each(_,function(_){baidu.on(_,"click",function(){var D=_.getAttribute("propsId")||0,C=_.getAttribute("classId")||0;if(D&&C){if(C=="3"){nslog(location.href,3620,{t1:1});}else{if(C=="4"){nslog(location.href,3620,{t1:2});}else{if(C=="5"){nslog(location.href,3620,{t1:3});}}}var B=new bk.shop.PropsManager();if(C=="3"||C=="4"){if(A.usedDoubleExpByTime.length>0||A.usedDoubleExpByVersion.length>0){return bk.Dialog.alert("\u4f60\u5df2\u7ecf\u4f7f\u7528\u4e86\u4e00\u5f20\u53cc\u500d\u7ecf\u9a8c\u5361,\u4e0d\u80fd\u540c\u65f6\u4f7f\u7528\u4e24\u5f20\u53cc\u500d\u7ecf\u9a8c\u5361\u54e6~");}}B.addEventListener("propsused",function(B){_.innerHTML="\u4f7f\u7528";var D=B.props;A.propsUsed(D);bk.shop.fillEditField(D);if(D.isCardEditToken===true){g_canInsertCard_flag=true;}if(D.timeLimited===true){D.setLeftTime(12*3600);D.renderUseInfoTo({id:"propsbox-props"+D.propsId,tpl:'\u5269\u4f59\u65f6\u95f4:<span class="orange">#{leftHour}\u5c0f\u65f6#{leftMinute}\u5206\u949f</span>'});D.countDown(60000);}else{D.renderUseInfoTo({id:"propsbox-props"+D.propsId,tpl:'<span class="orange">\u6b63\u5728\u4f7f\u7528\u4e2d</span>'});}var C=baidu.g("bkshopPropsTipsBottom");if(C&&(D.timeLimited||D.doubleExpByVersion)){C.innerHTML="";}});B.addEventListener("propsuseerror",function(){_.innerHTML="\u4f7f\u7528";});_.innerHTML="\u5904\u7406\u4e2d";B.useProps({classId:C,propsId:D,onuse:function(){alert("\u4f7f\u7528\u9053\u5177\u6210\u529f\uff01");}});}});});},changeTab:function(_){if(this.preEl!=_){if(this.preEl){this.closeTab(this.preEl);this.openTab(_);}else{this.openTab(_,0);}}else{this.closeTab(_,0);}},openTab:function(A,D){if(D==0){var B=baidu.q("box_title",baidu.g("encbox_head"));for(i in B){B[i].style.display="";}}if(this.preEl){this.closeTab(this.preEl);}baidu.dom.addClass(A,"header-current");var _=A.getAttribute("node-type"),C=_+"_content";baidu.g(C).style.display="";this.preEl=A;},closeTab:function(A,D){if(D==0){var B=baidu.q("box_title",baidu.g("encbox_head"));for(i in B){B[i].style.display="none";}this.preEl=null;}baidu.dom.removeClass(A,"header-current");var _=A.getAttribute("node-type"),C=_+"_content";baidu.g(C).style.display="none";},toggle:function(){this.isCollpased===true?this.expand():this.collapse();},expand:function(){if(this.isCollpased===false){return;}this.isCollpased=false;baidu.dom.removeClass(this.el,"propsbox-collpased");baidu.dom.setStyle(this.contentEl,"display","");},collapse:function(){if(this.isCollpased===true){return;}this.isCollpased=true;baidu.dom.addClass(this.el,"propsbox-collpased");baidu.dom.setStyle(this.contentEl,"display","none");}};baidu.more.ns("bk.shop");bk.shop=baidu.extend(bk.shop,(function(){function A(B,G){var A,F,H=new bk.shop.ShopManager();B=H.determineCommodityType(B);var _=parseInt(B.price),E=G.activityScore,D=G.wealth,C=false;if(B.consumeType==bk.shop.Commodity.CONSUME_TYPES.SCORE){C=E>=_?true:bk.shop.Commodity.CONSUME_TYPES.SCORE;}else{if(B.consumeType==bk.shop.Commodity.CONSUME_TYPES.WEALTH){C=D>=_?true:bk.shop.Commodity.CONSUME_TYPES.WEALTH;}}if(C!==true){A=new bk.shop.DialogHelper();if(C===bk.shop.Commodity.CONSUME_TYPES.SCORE){A.addContent(">_< \u62b1\u6b49\uff0c\u4f60\u7684\u79ef\u5206\u4e0d\u591f\uff01<br/>");A.addContent('\u5feb\u53bb\u591a\u8d5a\u4e9b\u79ef\u5206\u5427\uff01<a href="/mall#getScore">\u53bb\u8d5a\u5206</a><br/>');}else{if(C===bk.shop.Commodity.CONSUME_TYPES.WEALTH){A.addContent(">_< \u62b1\u6b49\uff0c\u4f60\u7684\u8d22\u5bcc\u503c\u4e0d\u591f\uff01<br/>");A.addContent("\u5feb\u53bb\u591a\u8d5a\u4e9b\u8d22\u5bcc\u503c\u5427\uff01<br/>");}else{A.addContent(">_< \u62b1\u6b49\uff0c\u4f60\u7684\u79ef\u5206\u6216\u8d22\u5bcc\u503c\u4e0d\u591f\uff01<br/>");}}A.addBtn({text:"\u786e\u5b9a",onclick:function(){F.close();}});F=new bk.Dialog({titleText:"\u5151\u6362\u5931\u8d25",contentText:A.render(),modal:true,buttonbar:false,onload:A.onDialogLoad()});F.open();return false;}return true;}function _(C){if(!bkShopUser||bkShopUser.login!==true){userlogin();nslog(location.href,3721,{fr:4});return;}if(bk.pass.checkTofillUsername({nslogType:3725})){return;}var B,E;if(A(C,bkShopUser)!==true){return;}B=new bk.shop.DialogHelper();var _=(C.consumeType==bk.shop.Commodity.CONSUME_TYPES.SCORE?bkShopUser.activityScore:bkShopUser.wealth)||0,D=C.consumeType==bk.shop.Commodity.CONSUME_TYPES.SCORE?"\u79ef\u5206":"\u8d22\u5bcc\u503c";B.addContent("\u672c\u6b21\u5151\u6362\u5c06\u6d88\u8d39"+C.price+D+"\u3002<br/>");B.addContent(baidu.string.format("\u60a8\u5f53\u524d#{unit}#{current}\uff0c\u6d88\u8d39\u540e\u5269\u4f59#{left}\u3002<br/>",{unit:D,current:_,left:_-C.price}));B.addContent("\u786e\u5b9a\u8981\u5151\u6362\u5417\uff1f");B.addBtn({text:"\u786e\u5b9a",onclick:function(){var _=new bk.shop.ShopManager();_.addEventListener("commoditypurchase",function(_){var C=_.commodity;if(C.consumeType==bk.shop.Commodity.CONSUME_TYPES.SCORE){bkShopUser.activityScore-=C.price;var B=baidu.g("bkshop-user-score");if(B){B.innerHTML=bkShopUser.activityScore;}}else{if(C.consumeType==bk.shop.Commodity.CONSUME_TYPES.WEALTH){bkShopUser.wealth-=C.price;var A=baidu.g("bkshop-user-wealth");if(A){A.innerHTML=bkShopUser.wealth;}}}});_.purchase(C);E.close();}});B.addBtn({text:"\u53d6\u6d88",onclick:function(){E.close();}});E=new bk.Dialog({titleText:"\u5151\u6362\u786e\u8ba4",contentText:B.render(),buttonbar:false,onload:B.onDialogLoad()});E.open();}function K(B,A){var _=new bk.shop.PropsManager();_.addEventListener("propsused",function(_){if(baidu.lang.isFunction(A)){A(_);}});_.addEventListener("propsusederror",function(){});_.useProps(B);}function G(){var _=document.createElement("link");_.href="http://baike.bdimg.com/static/usercenter/css/liteoutput/bk.shop.propsbox.css?r="+Math.random();_.type="text/css";_.rel="stylesheet";var A=document.getElementsByTagName("HEAD")[0];A.insertBefore(_,A.firstChild);}function B(B){if(B.className=="DoubleExpByTime"||B.className=="DoubleExpByVersion"||B.className=="CardEditToken"){var A=baidu.g("bkshopPropsId"),_=baidu.g("bkshopPropsClassId");if(A){if(!A.value){A.value=B.propsId;}else{A.value+=(","+B.propsId);}}if(_){if(!_.value){_.value=B.classId;}else{_.value+=(","+B.classId);}}}}function E(_){var A=baidu.g("bkshopViewPropsTips"),B;if(!A){return;}if(_.propsCount===0){A.innerHTML='<a href="/mall/zone?zoneId=1" target="_blank" onclick="nslog(location.href,3618);">\u53bb\u5151\u6362&gt;&gt;</a>'+'<span class="nopropsicon"></span>\u60a8\u5c1a\u65e0\u9053\u5177\u53ef\u4f7f\u7528';}else{if(_.usedDoubleExpByTime.length>0){B=_.usedDoubleExpByTime[0];B.renderUseInfoTo({id:"bkshopViewPropsTips",tpl:'<span class="propsicon"></span>\u53cc\u500d\u79ef\u5206\u5269\u4f59\u65f6\u95f4\uff1a<span class="num">#{leftHour}:#{leftMinute}:#{leftSecond}<span>'});B.countDown(1000);}else{if(_.unUsedProps.length>0){if(_.unUsedDoubleExpByTime.length>0){B=_.unUsedDoubleExpByTime[0];}else{if(_.unUsedDoubleExpByVersion.length>0){B=_.unUsedDoubleExpByVersion[0];}else{if(_.unUsedCardEditToken.length>0){B=_.unUsedCardEditToken[0];}else{if(_.unUsedBottleProps.length>0){B=_.unUsedBottleProps[0];}}}}if(B){A.innerHTML='<a href="/uc/prop" target="_blank" onclick="nslog(location.href,3619);">\u53bb\u4f7f\u7528&gt;&gt;</a>'+'<span class="propsicon"></span>\u53ef\u7528\u9053\u5177\uff1a<span class="num">'+B.name+"</span>";}}}}}function C(_){var A=baidu.g("bkshopPropsTipsBottom"),B;if(!A){return;}if(_.usedDoubleExpByTime.length==0&&(_.unUsedDoubleExpByTime.length>0||_.unUsedDoubleExpByVersion.length>0)){A.innerHTML='<span style="margin-left:10px;font-size:12px;color:#f70;">\u60a8\u7684\u9053\u5177\u7bb1\u4e2d\u8fd8\u6709\u53cc\u500d\u7ecf\u9a8c\u5361\uff0c\u63d0\u4ea4\u524d\u53ef\u4ee5\u5728\u9053\u5177\u7bb1\u4e2d\u70b9\u51fb\u4f7f\u7528</span>';}}function L(){var _=new bk.shop.PropsManager(),A;_.addEventListener("propslist",function(_){var B=_.props;if(baidu.g("bkshopItemTips")){B.renderTo=document.body;B.collapsed=false;G();}A=new bk.shop.MyPropsBox(B);E(A);C(A);bk.shop.propsBox=A;});_.listProps();}function D(){if(window.location.hash=="#exchange"){var _=baidu.g("bkshop-exchange-btn");if(_&&_.onclick){_.onclick.call(_);}else{var A="\u4e0d\u80fd\u5151\u6362\u8be5\u5546\u54c1!";if(baidu.dom.query(".commodityinfo .btns .finish").length>0){A="\u5f88\u62b1\u6b49,\u5151\u6362\u5df2\u7ed3\u675f\uff01>_<";}else{if(baidu.dom.query(".commodityinfo .btns .purchase-disable").length>0){A="\u5f88\u62b1\u6b49,\u4e0d\u6ee1\u8db3\u5151\u6362\u6761\u4ef6\uff01>_<";}}bk.Dialog.alert(A,{titleText:"\u5151\u6362\u5931\u8d25"});}window.location.hash="";}}function H(_){B(_.props);}function F(_){return _;}function J(_){_=parseInt(_);if(!_){return"";}var B=parseInt(_/24),C="",A="\u5c0f\u65f6";if(B>0){A="\u5929";}else{B=_;}if(B==2){C="\u4e24";}else{if(B>=3){C=String(B);}}return C+A;}function I(){if(bk.shop.propsBox&&typeof bk.shop.propsBox.collapse=="function"){var _=baidu.dom.q("header-current",baidu.g("encbox_head"))[0];if(_){bk.shop.propsBox.closeTab(_,0);}}}return{doExchange:_,listMyProps:L,useProps:K,autoExchange:D,cardEditTokenUsedInEditCallback:H,replace:F,hourToDay:J,fillEditField:B,collapsePropsBox:I};}()));baidu.dom.ready(function(){setTimeout(bk.shop.autoExchange,500);});bk.shop.ShopManager=function(){};bk.shop.ShopManager.prototype={purchase:function(_){if(!_||!_.classId||!_.id){throw new bk.shop.BusinessError("\u5546\u54c1\u4fe1\u606f\u4e0d\u6b63\u786e\u3002");}var A=this;_=this.determineCommodityType(_);_.addEventListener("purchase",function(_){A.dispatchEvent("commoditypurchase",{commodity:_.commodity});});_.addEventListener("purchaseerror",function(_){A.dispatchEvent("purchaseerror",{commodity:_.commodity,err:_.err});});_.purchase();},determineCommodityType:function(_){_=_||{};if(!_.hasOwnProperty("classId")){return;}if(_ instanceof bk.shop.Commodity){return _;}var A=this.getClassNameById(_.classId);if(A=="UNKOWN"||typeof bk.shop[A]=="undefined"){throw new bk.shop.BusinessError("\u672a\u77e5\u7684\u5546\u54c1\u7c7b\u522b\u3002");}_.className=A;return new bk.shop[A](_);},getClassNameById:function(_){var A=bk.shop.Commodity.TYPE;return A[_]||"UNKOWN";}};baidu.lang.inherits(bk.shop.ShopManager,baidu.lang.Class);bk.shop.PropsManager=function(){this.initEvents();};bk.shop.PropsManager.prototype={USE_URL:"/user/useprops?",LIST_URL:"/api/user/getuserprops?act=1",initEvents:function(){var _=this;baidu.on(_,"commoditypurchase",function(A){var B=A.commodity;if(B.isProps){_.dispatchEvent("propspurchase",{props:B});}});},purchase:function(){bk.shop.PropsManager.superClass.purchase.apply(this,arguments);},useProps:function(B){B=this.determineCommodityType(B);if(B.isProps!==true){throw new bk.shop.BusinessError("\u8be5\u5546\u54c1\u4e0d\u662f\u9053\u5177\uff0c\u4e0d\u80fd\u88ab\u4f7f\u7528\uff01");}var _=this,A={id:B.propsId,classId:B.classId};if(B.onbeforeuse()!==false){baidu.ajax.post(_.USE_URL,baidu.url.jsonToQuery(A),function(C){var A=baidu.json.parse(C.responseText);if(A.success){B.used=true;_.dispatchEvent("propsused",{props:B});B.onuse.call(B);}else{_.dispatchEvent("propsuseerror",{props:B,err:new bk.shop.BusinessError(A)});B.onuseerr.call(B,new bk.shop.BusinessError(A));}});}},listProps:function(){var _=this,A={};baidu.ajax.post(_.LIST_URL,baidu.url.jsonToQuery(A),function(B){var A=baidu.json.parse(B.responseText);if(A.success){baidu.each(A.using||[],function(_){_.id=_.itemId;_.name=_.itemName;});baidu.each(A.unused||[],function(_){_.id=_.itemId;_.name=_.itemName;});var C={used:A.using||[],unUsed:A.unused||[]};_.dispatchEvent("propslist",{props:C});}});}};baidu.lang.inherits(bk.shop.PropsManager,bk.shop.ShopManager,"bk.shop.PropsManager");baidu.more.ns("bk.doubt");bk.doubt.DialogHelper=function(){this.btnName="accept";bk.doubt.DialogHelper.superClass.constructor.apply(this,arguments);};baidu.extend(bk.doubt.DialogHelper.prototype,{tpl:'<div class="bkshopdialog doubtdialog"><div class="content">#{content}</div><div class="btns doubtdialog-btns">#{btns}</div><div class="footer">#{footer}</div></div>',createButton:function(_){_=_||{};_.tpl=_.tpl||'<div class="bkdialog-button bkdialog-#{btnName}" id="#{id}" onclick="javascript:#{onclick}" onmouseover="baidu.dom.addClass(this,\'#{btnName}-hover\');"  onmouseout="baidu.dom.removeClass(this,\'#{btnName}-hover\');"><div class="bkdialog-button-label">#{text}</div></div>';return bk.doubt.DialogHelper.superClass.constructor.prototype.createButton.call(this,_);}});baidu.lang.inherits(bk.doubt.DialogHelper,bk.shop.DialogHelper);bk.doubt.dialog={showJudgedInfo:function(G){window.J=G;var B=baidu.string.filterFormat.escapeString,_=!G.expertComment;nslog(location.href,_?3795:3794);var A=new bk.doubt.DialogHelper(),F,K=1000000;if(!_){var L=G.expertComment.substr(0,K);A.addContent("<i style='padding-bottom: 7px;display: block;'>");A.addContent("<a href='/zhuanjia/"+G.expertLink+"' target='blank'>");A.addContent(B(G.expertTitle)+" "+B(G.expertName)+"</a>\u8ba4\u4e3a\u6b64\u5904\u5185\u5bb9\u7684\u6b63\u786e\u8868\u8ff0\u4e3a\uff1a</i><span class='gray' style='display: block;margin-bottom: 15px;'>");A.addContent('<span id="expert-comment-short">'+B(L));if(L.length<G.expertComment.length){A.addContent('...</span></span><span id="expert-comment-long" style="display:none;">'+B(G.expertComment)+'</span><span id="collapse-comment-btn" class="collapsed">\u5c55\u5f00</span>');}else{A.addContent("</span></span>");}}if(G.references.length>0){A.addContent('<i style="padding-bottom: 7px;display: block;font-weight: normal;">');A.addContent(!_?"":"<a href='/zhuanjia/"+G.expertLink+"' target='blank'>"+B(G.expertTitle)+" "+B(G.expertName)+"</a>\u63d0\u4f9b\u4e86\u4ee5\u4e0b");A.addContent("\u53c2\u8003\u8d44\u6599\uff1a</i>");if(!_){for(var H=0,C=Math.min(G.references.length,1);H<C;H++){F=G.references[H];A.addContent('<p class="gray">'+B(F.referContent)+"<br/>"+'<a href="'+B(F.referLink)+'" target="_blank">'+B(F.referLink)+"</a>");}if(G.references.length>1){A.addContent('<span id="collapse-btn" class="collapsed">\u5c55\u5f00</span>');}}else{for(H=0,C=Math.min(G.references.length,3);H<C;H++){F=G.references[H];A.addContent('<p class="gray">'+B(F.referContent)+"<br/>"+'<a href="'+B(F.referLink)+'" target="_blank">'+B(F.referLink)+"</a>");}if(G.references.length>3){A.addContent('<span id="collapse-btn" class="collapsed">\u5c55\u5f00</span>');}}A.addContent("</p>");}var J=!_?1:3;if(G.references.length>J){A.addContent('<div id="more-ref" style="display:none;">');for(H=J,C=G.references.length;H<C;H++){F=G.references[H];A.addContent('<p class="gray">'+B(F.referContent)+"<br/>"+'<a href="'+B(F.referLink)+'" target="_blank">'+B(F.referLink)+"</a>");if(H==G.references.length-1){A.addContent('<span id="expand-btn" class="expanded">\u6536\u8d77</span>');}A.addContent("</p>");}A.addContent("</div>");}A.addBtn({text:"\u6211\u77e5\u9053\u4e86",onclick:function(){M.close();}});A.addFooter("\u5982\u679c\u60a8\u5bf9\u8fd9\u4e9b\u5185\u5bb9\u8f83\u4e3a\u4e86\u89e3\uff0c\u4e14\u638c\u63e1\u767e\u79d1\u7f16\u8f91\u6280\u5de7\uff0c\u6b22\u8fce\u60a8\u5c06\u8fd9\u4e9b\u5224\u65ad");A.addFooter("\u7f16\u8f91\u6574\u7406\u5230\u8bcd\u6761");A.addFooter("\uff01");function E(){var A=baidu.dom.query(".doubtdialog"),_=(A[0].clientHeight||A[0].offsetHeight)+20;M.update({height:_});}var D=A.onDialogLoad();function I(){var _=baidu.g("collapse-btn");if(_){baidu.on(_,"click",function(){baidu.dom.show(baidu.g("more-ref"));E();baidu.dom.setStyle("collapse-btn","display","none");});}_=baidu.g("expand-btn");if(_){baidu.on(_,"click",function(){baidu.dom.hide(baidu.g("more-ref"));E();baidu.dom.setStyle("collapse-btn","display","inline-block");});}_=baidu.g("collapse-comment-btn");if(_){baidu.on(_,"click",function(){baidu.dom.toggle(baidu.g("expert-comment-short"));baidu.dom.toggle(baidu.g("expert-comment-long"));E();if(baidu.dom.getStyle("expert-comment-long","display")=="none"){baidu.dom.removeClass("collapse-comment-btn","expanded");baidu.dom.addClass("collapse-comment-btn","collapsed");baidu.g("collapse-comment-btn").innerHTML="\u5c55\u5f00";}else{baidu.dom.removeClass("collapse-comment-btn","collapsed");baidu.dom.addClass("collapse-comment-btn","expanded");baidu.g("collapse-comment-btn").innerHTML="\u6536\u8d77";}});}}var M=new Dialog({classPrefix:"bkdialog-doubt bkdialog",titleText:G.expertComment?"\u4e13\u4e1a\u4eba\u58eb\u5224\u65ad\u6b64\u5904\u5b58\u7591":"\u4e13\u4e1a\u4eba\u58eb\u5df2\u8fdb\u884c\u6838\u5b9e\u67e5\u8bc1",autoRender:true,autoDispose:true,width:520,height:"auto",contentText:A.render(),modal:true,buttonbar:false,buttons:{},onload:function(){D();I();}});M.open();E();}};baidu.more.ns("bk.judge");bk.judge.dialog={referTpl:'<div class="f-row">\t\t\t<div class="desc">\u53c2\u8003\u8d44\u6599\u8bf4\u660e\uff1a</div>\t\t\t<div class="input"><input type="text" name="referContent" class="placeholder referContent" placeholder="\u8bf7\u586b\u5199\u6b63\u786e\u8868\u8ff0\u4e2d\u60a8\u53c2\u8003\u7684\u6587\u7ae0\u3001\u4e66\u7c4d\u6216\u8005\u7f51\u9875"/></div>\t\t</div>\t\t<div class="f-row">\t\t\t<div class="desc">\u53c2\u8003\u8d44\u6599\u94fe\u63a5\uff1a</div>\t\t\t<div class="input"><input type="text" name="referLink" class="placeholder referLink" placeholder="\u5982\u679c\u60a8\u6dfb\u52a0\u7684\u53c2\u8003\u8d44\u6599\u662f\u7f51\u7edc\u8d44\u6e90\uff0c\u8bf7\u586b\u5199\u7f51\u5740"/></div>\t\t</div>',tpl:'<div class="judgeform fix clearfix">\t\t<form action="#" name="judgeform" method="post" class="judge-form">\t\t\t<p class="judgetitle" style="#{contentStyle}">\u4f60\u9009\u4e2d\u7684\u9519\u8bef\u5185\u5bb9:<span class="errContent">#{doubtContent}</span></p>\t\t\t<p class="judgetip" style="#{tipStyle}">\u611f\u8c22\u60a8\u7684\u5224\u65ad\uff0c\u8bf7\u60a8\u6dfb\u52a0\u4e0e\u672c\u6bb5\u76f8\u5173\u7684\u53c2\u8003\u8d44\u6599\uff0c\u65b9\u4fbf\u7528\u6237\u66f4\u597d\u7684\u4e86\u89e3\u672c\u6bb5\u77e5\u8bc6\u3002</p>\t\t\t<div class="f-row" style="#{fixStyle}">\t\t\t\t<div class="desc">\u4fee\u6b63\u4e3a\u6b63\u786e\u5185\u5bb9\uff1a</div>\t\t\t\t<div class="input"><textarea class="expertComment" name="expertComment" row="10"></textarea></div>\t\t\t</div>\t\t\t<p class="judgetitle"><a class="help" href="http://baike.baidu.com/cms/s/expert/guide/ref-guide.gif" target="_blank">\u586b\u5199\u5e2e\u52a9</a>\u8bf7\u4e3a\u60a8\u5224\u65ad\u7684\u5185\u5bb9\u586b\u5199\u53c2\u8003\u8d44\u6599\uff1a</p>\t\t\t<div class="f-row">\t\t\t\t<div class="desc">\u53c2\u8003\u8d44\u6599\u8bf4\u660e\uff1a</div>\t\t\t\t<div class="input"><input type="text" name="referContent" class="placeholder referContent" placeholder="\u8bf7\u586b\u5199\u6b63\u786e\u8868\u8ff0\u4e2d\u60a8\u53c2\u8003\u7684\u6587\u7ae0\u3001\u4e66\u7c4d\u6216\u8005\u7f51\u9875"/></div>\t\t\t</div>\t\t\t<div class="f-row">\t\t\t\t<div class="desc">\u53c2\u8003\u8d44\u6599\u94fe\u63a5\uff1a</div>\t\t\t\t<div class="input"><input type="text" name="referLink" class="placeholder referLink" placeholder="\u5982\u679c\u60a8\u6dfb\u52a0\u7684\u53c2\u8003\u8d44\u6599\u662f\u7f51\u7edc\u8d44\u6e90\uff0c\u8bf7\u586b\u5199\u7f51\u5740"/></div>\t\t\t</div>\t\t\t<a id="judgeform-add-refer" class="more-refer" onclick="bk.judge.dialog.addRefer(this);"><span class="plus">+</span>\u6dfb\u52a0\u66f4\u591a\u53c2\u8003\u8d44\u6599</a>\t\t</from>\t\t<div class="judgeform-error" id="judgeform-error"></div>\t</div>',addRefer:function(_){baidu.dom.insertHTML(_,"beforeBegin",bk.judge.dialog.referTpl);if(bk.judge.dialog.currentDialog&&baidu.lang.isFunction(bk.judge.dialog.currentDialog.synDialogHeight)){bk.judge.dialog.currentDialog.synDialogHeight();}},showErrorMsg:function(A,_){baidu.g("judgeform-error").innerHTML=A;},_judgeForm:function(D,_){function C(){var B=baidu.dom.query(".judgeform"),_=(B[0].clientHeight||B[0].offsetHeight)+20;A.update({height:_});}var B={fixStyle:_?"display:none;":"",doubtContent:D.doubtContent||"",contentStyle:_?"display:none":"",tipStyle:_?"":"display:none"},A=new Dialog({classPrefix:"bkdialog-judge bkdialog",titleText:_?"\u5224\u65ad\u6b64\u6bb5\u5185\u5bb9\u6b63\u786e":"\u5224\u65ad\u6b64\u6bb5\u5185\u5bb9\u5b58\u7591",autoRender:true,autoDispose:true,width:520,height:"auto",contentText:baidu.string.format(bk.judge.dialog.tpl,B),modal:true,buttonbar:true,onload:function(){baidu.each(baidu.dom.query(".judgeform .placeholder"),function(_){bkuc.dom.placeholder(_);});},buttons:{accept:{content:"\u63d0\u4ea4",onclick:function(){function C(_){if(!_){return _;}return _.replace(/^\s*/,"").replace(/\s*$/,"");}function E(D){bk.judge.dialog.showErrorMsg("");var F={},A=baidu.dom.query(".expertComment",D)[0],I=baidu.dom.query(".referLink",D),G=baidu.dom.query(".referContent",D);if(!("length"in I)){I=[I];G=[G];}if(!_){if(!C(A.value)){bk.judge.dialog.showErrorMsg('\u8bf7\u8f93\u5165"\u4fee\u6b63\u4e3a\u6b63\u786e\u7684\u5185\u5bb9"',A);return null;}}F.expertComment=C(A.value);var K=[];function M(_){var D=document.createElement("input"),B=_.getAttribute("placeholder"),A=C(_.value);if(D.placeholder!==undefined||!B){return A;}else{if(B==A){return"";}else{return A;}}}for(var J=0,H=I.length;J<H;J++){var E=I[J],L=M(E),B=M(G[J]);if(!L&&!B){}else{if(!B){bk.judge.dialog.showErrorMsg('\u8bf7\u8f93\u5165"\u53c2\u8003\u8d44\u6599\u8bf4\u660e"',G[J]);return null;}else{K.push({referLink:L,referContent:B});}}}if(K.length==0){bk.judge.dialog.showErrorMsg('\u8bf7\u8f93\u5165"\u53c2\u8003\u8d44\u6599\u8bf4\u660e"',G[0]);return null;}F.refer=K;window._data=F;return F;}var A=baidu.dom.query(".judge-form")[0],B=null;if(A){B=E(A);}if(B){D.callback.call(D.scope||window,B);}}},cancel:{content:"\u5173\u95ed",onclick:function(){A.close();}}}});A.open();bk.judge.dialog.currentDialog=A;A.synDialogHeight=C;C();return A;},judgeRight:function(_){return bk.judge.dialog._judgeForm(_,true);},judgeError:function(_){return bk.judge.dialog._judgeForm(_,false);},judgeComplete:function(A){var _=new Dialog({classPrefix:"bkdialog-judge bkdialog",titleText:"\u5224\u65ad\u5b8c\u6210",autoRender:true,autoDispose:true,width:520,height:170,contentText:'<div class="judgeComplete"><h1>\u975e\u5e38\u611f\u8c22\u60a8\u7684\u5224\u65ad!</h1><h1>\u60a8\u7684\u5224\u65ad\u5c06\u5728\u8bcd\u6761\u4e2d\u5c55\u793a\uff0c\u4ebf\u4e07\u7f51\u53cb\u56e0\u60a8\u7684\u4e13\u4e1a\u8d21\u732e\u83b7\u76ca\uff01</h1></div>',modal:true,buttonbar:true,buttons:{accept:{content:"\u7ee7\u7eed\u5224\u65ad",onclick:function(){if(baidu.lang.isFunction(A.callback)){A.callback.apply(A.scope||window);}}},cancel:{content:"\u8fd4\u56de\u5de5\u4f5c\u5ba4",onclick:function(){_.close();location.href="/workroom";}}}});bk.judge.dialog.currentDialog=_;_.open();return _;},judgeContinue:function(){},judgeTip:function(B){var _=new bk.doubt.DialogHelper();bk.judge.dialog.judgeContinue=B.judgeContinue;_.addContent('<div class="judgeTip"><h1>\u60a8\u7684\u5224\u65ad\u5c06\u51fa\u73b0\u5728\u8bcd\u6761\u4e2d</h1>');_.addContent("<p>\u8bf7\u95ee\u60a8\u786e\u8ba4\u63d0\u4ea4\u5224\u65ad\u5185\u5bb9\u5417\uff1f</p><p>\u63d0\u4ea4\u540e\uff0c\u60a8\u7684\u5224\u65ad\u5185\u5bb9\u5c06\u5728\u8bcd\u6761\u4e2d\u5c55\u793a\uff0c\u548c\u4ebf\u4e07\u7f51\u53cb\u5206\u4eab\u4e13\u4e1a\u77e5\u8bc6\u3002</p>");_.addContent("</div>");_.addBtn({text:"\u786e\u8ba4\u63d0\u4ea4",onclick:function(){if(baidu.lang.isFunction(B.callback)){B.callback.apply(B.scope||window);}}});_.addBtn({name:"cancel",text:"\u653e\u5f03\u63d0\u4ea4",onclick:function(){if(baidu.lang.isFunction(B.giveUp)){B.giveUp.apply(B.scope||window);}}});_.addFooter('\u5982\u679c\u60a8\u8fd8\u6ca1\u6709\u5b8c\u6210\u672c\u6bb5\u5224\u65ad\uff0c\u8bf7<a href="javascript:;" onclick="bk.judge.dialog.judgeContinue();">\u8fd4\u56de\u5224\u65ad\u3002</a>');var A=new Dialog({classPrefix:"bkdialog-judge bkdialog-judge-tip bkdialog",titleText:"\u5224\u65ad\u63d0\u793a",autoRender:true,autoDispose:true,width:520,height:232,contentText:_.render(),modal:true,buttonbar:false,buttons:{},onload:_.onDialogLoad()});A.open();bk.judge.dialog.currentDialog=A;return A;}};baidu.more.ns("bk.usercenter");bk.usercenter.tab=function(_){this.cfg={trigger:"click",delay:0,defaultIdx:0,cancelBubble:false,indexChanged:function(){},forceChange:false};baidu.extend(this.cfg,_);this.hasLoaded=false;};baidu.extend(bk.usercenter.tab.prototype,{init:function(){this.sw=baidu.dom.children(this.cfg.switcherID);this.ct=baidu.dom.children(this.cfg.contentID);this.curIdx=this._getValidIdx(this.cfg.defaultIdx);this.unbindQueue=[];this.initEvent();this.select(this.cfg.defaultIdx);this.hasLoaded=true;},initEvent:function(){var A=this.sw.length,_=this,B;for(B=0;B<A;++B){baidu.event.on(_.sw[B],_.cfg.trigger,(function(A){return function(B){_.triggerEvent.call(_,B,A);if(baidu.lang.isFunction(_.cfg.triggerClick)){_.cfg.triggerClick(A);}};}(B)));_.hideContent(B);}baidu.event.on(window,"unload",baidu.fn.bind(this.release,this));},unbindEvent:function(){if(baidu.lang.isArray(this.unbindQueue)){for(var B=0,A=this.unbindQueue.length;B<A;B++){var _=this.unbindQueue[B];if(baidu.lang.isFunction(_)){_.call(this);}}}},select:function(_,A){_=this._getValidIdx(_);if(this.hasLoaded&&this.curIdx==_&&!this.cfg.forceChange){return;}this.clear(this.curIdx);var B=this.sw[_];baidu.dom.addClass(B,"on");this.showContent(_);if(!A){this.cfg.indexChanged.call(this,_,this.curIdx);}this.curIdx=_;},triggerEvent:function(A,_){if(this.cancelBubble){baidu.event.stopPropagation(A);}if(this.cfg.lazyLoad!==true){this.select(_);}},clear:function(_){var A=this.sw[_];baidu.dom.removeClass(A,"on");this.hideContent(_);},showContent:function(_){this.ct[_].style.display="block";},hideContent:function(_){this.ct[_].style.display="none";},_getValidIdx:function(_){var A=this.sw.length-1;return(_>A)?A:_;},release:function(){var _;for(_ in this.cfg){delete this.cfg[_];}delete this.cfg;delete this.sw;delete this.ct;this.unbindEvent();}});bk.usercenter.frameTab=function(_){_.forceChange=_.forceChange||true;bk.usercenter.tab.call(this,_);this.frame=baidu.g(_.frameId);this.urls=_.urls;this.loadUrl=_.loadUrl;};baidu.lang.inherits(bk.usercenter.frameTab,bk.usercenter.tab);baidu.extend(bk.usercenter.frameTab.prototype,{init:function(){this.sw=baidu.dom.children(this.cfg.switcherID);this.curIdx=this._getValidIdx(this.cfg.defaultIdx);this.initEvent();this.select(this.curIdx);this.hasLoaded=true;},initEvent:function(){bk.usercenter.tab.prototype.initEvent.call(this);var A=this,_=function(){return A._frameContentLoad.apply(A);};baidu.on(A.frame,"load",_);baidu.on(A.frame,"load",function(){if(baidu.lang.isFunction(A.cfg.frameLoad)){A.cfg.frameLoad();}});if(bk.usercenter.frameTab.timer){clearInterval(bk.usercenter.frameTab.timer);}bk.usercenter.frameTab.timer=setInterval(_,200);},showContent:function(_){if(this.loadUrl!==false){this.frame.src=this.urls[_];}else{delete this.loadUrl;}},hideContent:function(){},_frameContentLoad:function(){try{var C=this.frame.contentWindow.document,B=C.body.scrollHeight,A=B;if(this.cfg.minHeight&&A<this.cfg.minHeight){A=this.cfg.minHeight;}this.frame.height=A+"px";this.frame.style.height=A+"px";}catch(_){}}});baidu.ui.Slider=baidu.ui.createUI(function(A){var _=this;_.range=_.range||[_.min,_.max];}).extend({layout:"horizontal",uiType:"slider",tplBody:'<div id="#{id}" class="#{class}" onmousedown="#{mousedown}" style="position:relative;">#{thumb}</div>',tplThumb:'<div id="#{thumbId}" class="#{thumbClass}" style="position:absolute;"></div>',value:0,min:0,max:100,disabled:false,_dragOpt:{},_axis:{horizontal:{mousePos:"x",pos:"left",size:"width",clientSize:"clientWidth",offsetSize:"offsetWidth"},vertical:{mousePos:"y",pos:"top",size:"height",clientSize:"clientHeight",offsetSize:"offsetHeight"}},getString:function(){var _=this;return baidu.format(_.tplBody,{id:_.getId(),"class":_.getClass(),mousedown:_.getCallRef()+"._mouseDown(event)",thumb:baidu.format(_.tplThumb,{thumbId:_.getId("thumb"),thumbClass:_.getClass("thumb")})});},_mouseDown:function(A){var D=this,_=D._axis[D.layout],F=baidu.page.getMousePosition(),C=baidu.dom.getPosition(D.getBody()),E=D.getThumb(),B=baidu.event.getTarget(A);if(B==E||baidu.dom.contains(E,B)||D.disabled){return;}D._calcValue(F[_.mousePos]-C[_.pos]-E[_.offsetSize]/2);D.update();D.dispatchEvent("slideclick");},render:function(_){var A=this;if(!_){return;}baidu.dom.insertHTML(A.renderMain(_),"beforeEnd",A.getString());A._createThumb();A.update();A.dispatchEvent("onload");},_createThumb:function(){var A=this,_;A._dragOpt={ondragend:function(){A.dispatchEvent("slidestop");},ondragstart:function(){A.dispatchEvent("slidestart");},ondrag:function(){var _=A._axis[A.layout],B=A.getThumb().style[_.pos];A._calcValue(parseInt(B));A.dispatchEvent("slide");},range:[0,0,0,0]};A._updateDragRange();_=baidu.dom.draggable(A.getThumb(),A._dragOpt);A.addEventListener("dispose",function(){_.cancel();});},_updateDragRange:function(A){var D=this,_=D._axis[D.layout],B=A||D.range,C=D._dragOpt.range,E=D.getThumb();B=[Math.max(Math.min(B[0],D.max),D.min),Math.max(Math.min(B[1],D.max),D.min)];if(D.layout.toLowerCase()=="horizontal"){C[1]=D._parseValue(B[1],"fix")+E[_.offsetSize];C[3]=D._parseValue(B[0],"fix");C[2]=E.clientHeight;}else{C[0]=D._parseValue(B[0],"fix");C[2]=D._parseValue(B[1],"fix")+E[_.offsetSize];C[1]=E.clientWidth;}},update:function(C){var B=this,_=B._axis[B.layout],A=B.getBody();C=C||{};baidu.object.extend(B,C);B._updateDragRange();B._adjustValue();if(B.dispatchEvent("beforesliderto",{drop:C.drop})){B.getThumb().style[_.pos]=B._parseValue(B.value,"pix")+"px";B.dispatchEvent("update");}},_adjustValue:function(){var A=this,_=A.range;A.value=Math.max(Math.min(A.value,_[1]),_[0]);},_calcValue:function(A){var _=this;_.value=_._parseValue(A,"value");_._adjustValue();},_parseValue:function(A,D){var B=this,_=B._axis[B.layout],C=B.getBody()[_.clientSize]-B.getThumb()[_.offsetSize];if(D=="value"){A=(B.max-B.min)/C*A+B.min;}else{A=Math.round(C/(B.max-B.min)*(A-B.min));}return A;},getValue:function(){return this.value;},getTarget:function(){return baidu.g(this.targetId);},getThumb:function(){return baidu.g(this.getId("thumb"));},disable:function(){var _=this;_.disabled=true;_._updateDragRange([_.value,_.value]);},enable:function(){var _=this;_.disabled=false;_._updateDragRange(_.range);},dispose:function(){var _=this;_.dispatchEvent("dispose");baidu.dom.remove(_.getId());_.dispatchEvent("ondispose");baidu.lang.Class.prototype.dispose.call(_);}});baidu.ui.ScrollBar=baidu.ui.createUI(function(A){var _=this;_._scrollBarSize={width:0,height:0};}).extend({uiType:"scrollbar",tplDOM:'<div id="#{id}" class="#{class}"></div>',tplThumb:'<div class="#{prev}"></div><div class="#{track}"></div><div class="#{next}"></div>',value:0,dimension:10,orientation:"vertical",step:5,_axis:{horizontal:{size:"width",unSize:"height",offsetSize:"offsetWidth",unOffsetSize:"offsetHeight",clientSize:"clientWidth",scrollPos:"scrollLeft",scrollSize:"scrollWidth"},vertical:{size:"height",unSize:"width",offsetSize:"offsetHeight",unOffsetSize:"offsetWidth",clientSize:"clientHeight",scrollPos:"scrollTop",scrollSize:"scrollHeight"}},getThumbString:function(){var _=this;return baidu.string.format(_.tplThumb,{prev:_.getClass("thumb-prev"),track:_.getClass("thumb-track"),next:_.getClass("thumb-next")});},render:function(_){var A=this;if(!_||A.getMain()){return;}baidu.dom.insertHTML(A.renderMain(_),"beforeEnd",baidu.string.format(A.tplDOM,{id:A.getId(),"class":A.getClass()}));A._renderUI();A.dispatchEvent("load");},_renderUI:function(){var D=this,A=D._axis[D.orientation],B=D.getBody(),G,_,C;function F(_){return{classPrefix:D.classPrefix+"-"+_,skin:D.skin?D.skin+"-"+_:"",poll:{time:4},onmousedown:function(){D._basicScroll(_);},element:B,autoRender:true};}G=D._prev=new baidu.ui.Button(F("prev"));baidu.dom.insertHTML(B,"beforeEnd",baidu.string.format(D.tplDOM,{id:D.getId("track"),"class":D.getClass("track")}));C=D._next=new baidu.ui.Button(F("next"));function E(_){D.dispatchEvent("scroll",{value:Math.round(_.target.getValue())});}_=D._slider=new baidu.ui.Slider({classPrefix:D.classPrefix+"-slider",skin:D.skin?D.skin+"-slider":"",layout:D.orientation,onslide:E,onslideclick:E,element:baidu.dom.g(D.getId("track")),autoRender:true});D._scrollBarSize[A.unSize]=C.getBody()[A.unOffsetSize];D._thumbButton=new baidu.ui.Button({classPrefix:D.classPrefix+"-thumb-btn",skin:D.skin?D.skin+"-thumb-btn":"",content:D.getThumbString(),capture:true,element:_.getThumb(),autoRender:true});D.flushUI(D.value,D.dimension);D._registMouseWheelEvt(D.getMain());},flushUI:function(E,D){var F=this,B=F._axis[F.orientation],G=F._prev.getBody()[B.offsetSize]+F._next.getBody()[B.offsetSize],C=F.getBody(),A=F._slider,H=A.getThumb(),_;baidu.dom.hide(C);_=F.getMain()[B.clientSize];F._scrollBarSize[B.size]=(_<=0)?G:_;A.getMain().style[B.size]=(_<=0?0:_-G)+"px";H.style[B.size]=Math.max(Math.min(D,100),0)+"%";baidu.dom.show(C);F._scrollTo(E);},_scrollTo:function(_){this._slider.update({value:_});},scrollTo:function(_){var A=this;A._scrollTo(_);A.dispatchEvent("scroll",{value:_});},_basicScroll:function(A){var _=this;_.scrollTo(Math.round(_._slider.getValue())+(A=="prev"?-_.step:_.step));},_onMouseWheelHandler:function(A){var C=this,B=C.target,A=A||window.event,_=A.detail||-A.wheelDelta;baidu.event.preventDefault(A);C._basicScroll(_>0?"next":"prev");},_registMouseWheelEvt:function(A){var B=this,C=function(){var A=navigator.userAgent.toLowerCase(),_=/(webkit)/.exec(A)||/(opera)/.exec(A)||/(msie)/.exec(A)||A.indexOf("compatible")<0&&/(mozilla)/.exec(A)||[];return _[1]=="mozilla"?"DOMMouseScroll":"mousewheel";},_=B._mouseWheelEvent={target:A,evtName:C(),handler:baidu.fn.bind("_onMouseWheelHandler",B)};baidu.event.on(_.target,_.evtName,_.handler);},_cancelMouseWheelEvt:function(){var _=this._mouseWheelEvent;if(!_){return;}baidu.event.un(_.target,_.evtName,_.handler);this._mouseWheelEvent=null;},setVisible:function(_){this.getMain().style.display=_?"":"none";},isVisible:function(){return this.getMain().style.display!="none";},getSize:function(){return this._scrollBarSize;},update:function(A){var _=this;_.dispatchEvent("beforeupdate");baidu.object.extend(_,A);_.flushUI(_.value,_.dimension);_.dispatchEvent("update");},dispose:function(){var _=this;_.dispatchEvent("dispose");_._cancelMouseWheelEvt();_._prev.dispose();_._thumbButton.dispose();_._slider.dispose();_._next.dispose();baidu.dom.remove(_.getMain());baidu.lang.Class.prototype.dispose.call(_);}});baidu.ui.ScrollBar.register(function(_){if(!_.container){return;}_.addEventListeners({load:function(){_.update();if(_.orientation=="vertical"){_._registMouseWheelEvt(_.getContainer());}},beforeupdate:function(){var B=this,_=B._axis[B.orientation],A=B.getContainer();if(!A){return;}B.dimension=Math.round(A[_.clientSize]/A[_.scrollSize]*100);B.value=A[_.scrollSize]-A[_.clientSize];B.value>0&&(B.value=Math.round(A[_.scrollPos]/(A[_.scrollSize]-A[_.clientSize])*100));},scroll:function(C){var B=_.getContainer(),A=_._axis[_.orientation];B[A.scrollPos]=C.value/100*(B[A.scrollSize]-B[A.clientSize]);}});});baidu.object.extend(baidu.ui.ScrollBar.prototype,{getContainer:function(){return baidu.dom.g(this.container);}});baidu.ui.ScrollPanel=baidu.ui.createUI(function(_){}).extend({uiType:"scrollpanel",tplDOM:'<div id="#{id}" class="#{class}">#{body}</div>',overflow:"auto",_scrollBarSize:0,_yVisible:false,_xVisible:false,_axis:{y:{size:"height",unSize:"width",unScrollSize:"scrollWidth",unClientSize:"clientWidth",offsetSize:"offsetHeight",unOffsetSize:"offsetWidth"},x:{size:"width",unSize:"height",unScrollSize:"scrollHeight",unClientSize:"clientHeight",offsetSize:"offsetWidth",unOffsetSize:"offsetHeight"}},getString:function(){var A=this,_=baidu.string.format(A.tplDOM,{id:A.getId("panel"),"class":A.getClass("panel")});_=baidu.string.format(A.tplDOM,{id:A.getId(),"class":A.getClass(),body:_});return baidu.string.format(A.tplDOM,{id:A.getId("main"),"class":A.getClass("main"),body:_});},render:function(_){var A=this;A.target=_;if(!_||A.getMain()){return;}baidu.dom.insertHTML(A.getTarget(),"afterEnd",A.getString());A.renderMain(A.getId("main"));A._renderUI();A.dispatchEvent("onload");},_renderUI:function(){var B=this,E=B.getMain(),_=B.getPanel(),A=B.getTarget(),D=B.skin||"";E.style.width=A.offsetWidth+"px";E.style.height=A.offsetHeight+"px";_.appendChild(A);function C(F){var C=B.getId("overflow-"+F),A=B._axis[F],_=B.getPanel(),E;baidu.dom.insertHTML(_,(F=="y"?"afterEnd":"beforeEnd"),baidu.string.format(B.tplDOM,{id:C,"class":B.getClass("overflow-"+F)}));C=baidu.dom.g(C);if("y"==F){baidu.dom.setStyle(_,"float","left");baidu.dom.setStyle(C,"float","left");}B["_"+F+"Visible"]=true;E=B["_"+F+"Scrollbar"]=new baidu.ui.ScrollBar({skin:D+"scrollbar"+"-"+F,orientation:F=="y"?"vertical":"horizontal",container:B.container,element:C,autoRender:true});C.style[A.unSize]=E.getSize()[A.unSize]+"px";B._scrollBarSize=E.getSize()[A.unSize];E.setVisible(false);}if(B.overflow=="overflow-y"||B.overflow=="auto"){C("y");}if(B.overflow=="overflow-x"||B.overflow=="auto"){C("x");}B._smartVisible();},_smartVisible:function(){var A=this,D={yshow:false,xshow:false};if(!A.getContainer()){return;}function B(B){var _=A._axis[B],D=A["_"+B+"Scrollbar"],C=A.getContainer(),E={};if(!D||!D.isVisible()){C.style[_.unSize]=C[_.unClientSize]-A._scrollBarSize+"px";}E[_.unSize]=C[_.unClientSize];E["scroll"+_.unSize]=C[_.unScrollSize];return E;}function _(B,D){var _=A._axis[B],C=A.getContainer();if(!A["_"+B+"Visible"]||!D[B+"show"]||!A["_"+B+"Scrollbar"]){C.style[_.unSize]=C[_.unClientSize]+A._scrollBarSize+"px";}}function C(B,F){var _=A._axis[B],D=A.getContainer(),C=A["_"+B+"Scrollbar"],E=F[B+"show"];if(C){C.getMain().style[_.size]=D[_.offsetSize]+"px";C.setVisible(A["_"+B+"Visible"]?E:false);C.update();}}baidu.object.extend(D,B("y"));baidu.object.extend(D,B("x"));if(D.scrollwidth<=D.width+A._scrollBarSize&&D.scrollheight<=D.height+A._scrollBarSize){D.yshow=D.xshow=false;}else{if(D.scrollwidth<=D.width&&D.scrollheight>D.height+A._scrollBarSize){D.yshow=true;D.xshow=false;}else{if(D.scrollwidth>D.width+A._scrollBarSize&&D.scrollheight<=D.height){D.yshow=false;D.xshow=true;}else{D.yshow=D.xshow=true;}}}_("y",D);_("x",D);C("y",D);C("x",D);},setVisible:function(_,B){var A=this;if(B){A["_"+B+"Visible"]=_;}else{A._yVisible=A._xVisible=_;}A._smartVisible();},isVisible:function(A){var _=this;return _["_"+A+"Visible"];},getScrollBar:function(B){var _=this,A=B?_["_"+B+"Scrollbar"]:null;if(!A){A=(_._yScrollbar&&_._xScrollbar)?[_._yScrollbar,_._xScrollbar]:(_._yScrollbar||_._xScrollbar);}return A;},update:function(A){var _=this;baidu.object.extend(_,A);_._smartVisible();},getPanel:function(){return baidu.dom.g(this.getId("panel"));},getTarget:function(){return baidu.dom.g(this.target);},getContainer:function(){return baidu.dom.g(this.container);},dispose:function(){var A=this,_=A._yScrollbar,B=A._xScrollbar;A.dispatchEvent("dispose");A.setVisible(false);A.getMain().parentNode.insertBefore(A.getTarget(),A.getMain());if(_){_.dispose();}if(B){B.dispose();}baidu.dom.remove(A.getMain());baidu.lang.Class.prototype.dispose.call(A);}});baidu.ui.ScrollPanel.register(function(_){if(!_.adaptive){return;}_.addEventListener("onload",function(){var A=20,C=_.getContainer(),D={w:C.clientWidth,h:C.clientHeight},B=setInterval(function(){var C=_.getContainer(),E=D,B;if(E.w==C.clientWidth&&E.h==C.clientHeight){return;}B=D={w:C.clientWidth,h:C.clientHeight};function A(C){var E=_["_"+C+"Scrollbar"],B=_._axis[C],D=E?E.isVisible():false,A=_.getMain()[B.unClientSize]-_.getContainer()[B.unOffsetSize];return(D&&A==_._scrollBarSize)||(!D&&A==0);}if(A("y")&&A("x")){return;}_.flushBounds();},A);_.addEventListener("dispose",function(){clearInterval(B);});});});baidu.ui.ScrollPanel.extend({adaptive:true,flushBounds:function(_){var B=this,E=B.getMain(),A=B.getContainer(),D={y:B._yVisible,x:B._xVisible},C={w:_&&baidu.lang.isNumber(_.width)?_.width:A.clientWidth,h:_&&baidu.lang.isNumber(_.height)?_.height:A.clientHeight};B.setVisible(false);A.style.width=C.w+"px";A.style.height=C.h+"px";E.style.width=A.offsetWidth+"px";E.style.height=A.offsetHeight+"px";B._yVisible=D.y;B._xVisible=D.x;B._smartVisible();}});T.undope=true;baidu.more.ns("bk.doubt");bk.doubt.DoubtBox=function(_){this.clsName="doubtbox";this.gid=baidu.lang.guid();this.tabItems=["\u53c2\u4e0e\u8d28\u7591","\u4e13\u4e1a\u5224\u65ad"];this.tabstring="";this.selectedTab=0;this.data=[];this.collapsed=true;this.isVisible=true;this.inited=false;this.modeEventNames=["","bk.doubtbox.agreemodeactive","bk.doubtbox.doubtmodeactive","bk.doubtbox.expertmodeactive"];this.titleNames=["","\u540c\u610f\u8d28\u7591","\u53d1\u8d77\u8d28\u7591","\u5224\u65ad\u63d0\u793a"];this.exitTitleNames=["","\u9000\u51fa\u8d28\u7591","\u9000\u51fa\u8d28\u7591","\u9000\u51fa\u5224\u65ad"];this.mode=-1;this.tabCountIds=[];this.tabConent=[];baidu.extend(this,_);this.title="";};bk.doubt.DoubtBox.prototype={dataTpl:'<li class="data-#{isFat}" id="doubtlist-#{edata}">\t\t\t\t<div class="list-content">\t\t\t\t\t\u201c<span class="slim">#{slimContent}</span><span class="fat" style="display:none;">#{doubtContent}</span>\u201d\u88ab\t\t\t\t\t<span class="num">\t\t\t\t\t\t<em  id="doubtlist-num-#{edata}">#{userCount}</em>\t\t\t\t\t\t<span class="animation" style="display:none;" id="doubtlist-animation-#{edata}">\t\t\t\t\t\t\t<span class="t1"  id="doubtlist-t1-#{edata}">1</span>\t\t\t\t\t\t\t<span class="t2"  id="doubtlist-t2-#{edata}">2</span></span>\t\t\t\t\t</span>\u4eba\u8d28\u7591\uff0c\u53d1\u8d77\u4eba\uff1a<a href="http://passport.baidu.com/?business&aid=7&default_tab=2&un=#{userName}#3" target="_blank">#{userName}</a>\u3002\t\t\t\t\t<span class="showExpand showExpand-#{isFat}"><a href="javascript:;" etype="expand" class="expand">\u5c55\u5f00<i></i></a>\t\t\t\t\t<a href="javascript:;" class="collapse" etype="collapse" style="display:none;">\u6536\u8d77<i></i></a></span>\t\t\t\t</div>\t\t\t\t<div class="btn-container btn-container-boxmode#{_boxmode}"><a href="javascript:void(0)" class="btn agree" etype="agree" data="#{edata}" id="doubtlist-btn-#{edata}">\u540c\u610f\u8d28\u7591</a></div>\t\t\t</li>',tpl:'<div class="#{clsName}-icon" id="#{clsName}-icon-#{gid}" title="\u53c2\u4e0e\u6307\u51fa\u8bcd\u6761\u4e2d\u5b58\u5728\u4e89\u8bae\u7684\u5185\u5bb9" style="display:none;">\t\t\t<div class="#{clsName}-tipbubble-wrap" id="#{clsName}-tipbubble-#{gid}" style="display:none;">\t\t\t\t<div class="#{clsName}-tipbubble"></div>\t\t\t\t<div class="#{clsName}-tipbubble-close" title="\u5173\u95ed\u63d0\u793a"></div>\t\t\t</div>\t\t</div>\t\t<div class="#{clsName} #{collpaseCls}" id="#{gid}">\t\t\t<div class="#{clsName}-wrap">\t\t\t\t<div class="#{clsName}-header">\t\t\t\t\t<a id="#{gid}-quit" class="#{clsName}-quit" href="javascript:;" onclick="void(0);">\u9000\u51fa</a>\t\t\t\t\t<span class="#{clsName}-title">#{title}</span>\t\t\t\t</div>\t\t\t\t<div class="#{clsName}-content">\t\t\t\t\t<div class="#{clsName}-tab-container" id="#{clsName}-tab_container#{gid}">\t\t\t\t\t\t<div class="#{clsName}-tab-wrap" id="#{clsName}-tabwrap_container#{gid}">\t\t\t\t\t\t\t#{contentstring}\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<ul class="#{clsName}-tab-switcher fix" id="#{clsName}-tab_switcher#{gid}">\t\t\t\t\t\t#{tabstring}\t\t\t\t\t</ul>\t\t\t\t</div>\t\t\t</div>\t\t</div>',guideTpl:'<div class="guide">\t\t\t\t<p>\u82e5\u6709\u9519\u8bef\uff0c\u8bf7\u5212\u8bcd\u9009\u4e2d\u9519\u8bef\u5185\u5bb9\u5e76\u6309\u63d0\u793a\u8d28\u7591\uff0c\u4e3a\u8bcd\u6761\u7684\u8d28\u91cf\u63d0\u5347\u505a\u51fa\u8d21\u732e\u3002</p>\t\t\t\t<div class="flash" style="#{falshStyle}">#{flashCode}</div>\t\t\t\t<div class="btn-container"><a href="javascript:;" etype="expandFlash" class="expandFlash" style="#{expandStyle}">\u5c55\u5f00<i></i></a><a href="javascript:;" etype="collapseFlash" class="collapseFlash" style="#{collapseStyle}">\u6536\u8d77<i></i></a></div>\t\t\t\t<p class="content-footer">\u82e5\u60a8\u5bf9\u8fd9\u4e9b\u5185\u5bb9\u6709\u53ef\u4fe1\u7684\u53c2\u8003\u8d44\u6599\uff0c\u5e76\u638c\u63e1\u767e\u79d1\u7f16\u8f91\u6280\u5de7\uff0c\u6b22\u8fce\u4f60\u76f4\u63a5<a href="/edit/#{editQuery}" target="_blank">\u7f16\u8f91\u8bcd\u6761</a>\u3002</p>\t\t\t</div>',show:function(){if(!this.inited){this.render();}if(this.isVisible){return;}var _=this;baidu.show(this.el);if(baidu.fx&&false){baidu.fx.expand(_.el,{duration:400,orientation:"horizontal"});}this.expand();this.isVisible=true;},hide:function(){this.collapse();if(baidu.fx&&false){baidu.fx.collapse(box.el,{duration:400,orientation:"horizontal"});}else{baidu.hide(this.el);}this.isVisible=false;if(this.inited){bk.event.fire("bk.doubtbox.collapsed");}},render:function(A){A=A||[];this.data=this._processData(A);var B=this._build(),_=baidu.dom.g(this.renderTo);baidu.dom.insertHTML(_,"beforeEnd",B);this._loadTangramFx();this._initEl();this._fixPosition(this);this._bindEvents();this.hide();this._showTipBubble();this.inited=true;bk.event.fire("bk.doubt.duobtbox.created");},_processData:function(_){_=_||this.data;baidu.array.each(_||this.data,function(D){var B=11,_=A(D.doubtContent),C=_.length>B?1:0;D.isFat=C;D.slimContent=C?_.substring(0,B).replace(/&#?\d*$/,"")+"...":D.doubtContent;});return _;function A(_){var A=_.replace(/&#(\d+);/g,function(_){return String.fromCharCode(_.replace(/[&#;]/g,""));});return A;}},_buildDataString:function(C){var B=this,A=[],_="";if(B.mode==1){if(B.data.length>0){A.push('<p class="doubt-t3">\u672c\u6bb5\u6b63\u5728\u8d28\u7591</p>');}else{A.push('<p class="doubt-t2">\u6682\u65f6\u6ca1\u6709\u7528\u6237\u5bf9\u672c\u6bb5\u53d1\u8d77\u8d28\u7591\u3002</p>');}}else{if(B.mode==2||C==0){if(B.data.length>0){A.push('<p class="doubt-t2">\u82e5\u60a8\u8d28\u7591\u5185\u5bb9\u5df2\u88ab\u6307\u51fa,\u8bf7\u5728\u4e0b\u65b9\u540c\u610f\u3002</p><p class="doubt-t3">\u672c\u6bb5\u6b63\u5728\u8d28\u7591</p>');}else{A.push('<p class="doubt-t2">\u6682\u65f6\u6ca1\u6709\u7528\u6237\u5bf9\u672c\u6bb5\u53d1\u8d77\u8d28\u7591\u3002</p>');}}else{if(B.mode==3||C==1){if(B.data.length>0){A.push('<p class="expert-t3">\u672c\u6bb5\u7528\u6237\u8d28\u7591</p>');}else{A.push('<p class="doubt-t2">\u672c\u6bb5\u6682\u65f6\u6ca1\u6709\u7528\u6237\u53d1\u8d77\u8d28\u7591\uff01</p>');}}}}baidu.array.each(B.data,function(_,C){_.edata=C;_._boxmode=B.mode;A.push(baidu.string.format(B.dataTpl,_));});return'<ul class="doubtbox-data">'+A.join("")+"</ul>"+_;},_showTipBubble:function(){var _="bk.doubt.tipbubble";if(!baidu.cookie.get(_)){baidu.dom.show(this.bubbleEl);}else{baidu.dom.hide(this.bubbleEl);}},_hideTipBubble:function(){var _="bk.doubt.tipbubble";baidu.dom.hide(this.bubbleEl);baidu.cookie.set(_,"1",{expires:30*24*3600000});},_initEl:function(){this.el=baidu.g(this.gid);this.iconEl=baidu.g(this.clsName+"-icon-"+this.gid);this.contentEl=baidu.dom.query(".doubtbox-content",this.el)[0];this.closeEl=baidu.g(this.gid+"-quit");this.tabEl=baidu.g(this.clsName+"-tab_container"+this.gid);this.tabItemEls=baidu.dom.query("."+this.clsName+"-tab-switcher li",this.el);this.titleEl=baidu.dom.query("."+this.clsName+"-title",this.el)[0];this.bubbleEl=baidu.dom.g(this.clsName+"-tipbubble-"+this.gid);this.closeBubbleEl=baidu.dom.query("."+this.clsName+"-tipbubble-close",this.bubbleEl)[0];},_createFlashCode:function(){return baidu.swf.createHTML({id:this.gid+"flash",url:"http://baike.bdimg.com/static/usercenter/images/doubt/flash/jiucuo.swf",wmode:"transparent",align:"top",width:225,height:150});},setTitle:function(_){if(this.mode==-1){return;}this.titleEl.innerHTML=_||this.titleNames[this.mode];this.closeEl.innerHTML=this.exitTitleNames[this.mode];},_buildContent:function(){var A=this,_=[];this.tabCountIds=[];baidu.array.each(this.tabItems,function(C,D){if((!window.curUser||!curUser.isExpert)&&D==1){return;}var B="tab-"+A.gid+"-"+D;A.tabCountIds.push(B);_.push('<div id="'+B+'">');if(D==0){if(!baidu.cookie.get("bk.doubt.flashplayed")||(window.curUser&&baidu.cookie.get("bk.doubt.flashplayed").indexOf(","+window.curUser.id)==-1)){_.push(baidu.string.format(A.guideTpl,{flashCode:A._createFlashCode(),expandStyle:"display:none",collapseStyle:"",editQuery:baikeViewInfo.isMulit?"id="+baikeViewInfo.id+"&subLemmaId="+baikeViewInfo.subList[baikeViewInfo.expIndex].subLemmaId:"id="+baikeViewInfo.id}));}else{_.push(baidu.string.format(A.guideTpl,{flashCode:"",falshStyle:"display:none",collapseStyle:"display:none",expandStyle:"",editQuery:baikeViewInfo.isMulit?"id="+baikeViewInfo.id+"&subLemmaId="+baikeViewInfo.subList[baikeViewInfo.expIndex].subLemmaId:"id="+baikeViewInfo.id}));}}else{if(D==1){_.push('<p class="doubt-t2"><strong>\u8bf7\u5224\u65ad\u6807\u7070\u6bb5\u843d\u6b63\u786e\u6027</strong></p><p class="doubt-t2"><strong>\u82e5\u9519\u8bef\uff1a</strong>\u8bf7\u5212\u8bcd\u9009\u4e2d\u9519\u8bef\u5185\u5bb9</p><p class="doubt-t1"><strong>\u82e5\u6b63\u786e\uff1a</strong>\u8bf7\u70b9\u51fb\u6bb5\u843d\u4e0b\u65b9\u7684\u6b63\u786e\u6309\u94ae</p>');_.push(A._buildDataString(D));}}_.push("</div>");});this.contentstring=_.join("");},_buildTabContent:function(){var A=this,_=[];if(A.mode==1){_.push(A._buildDataString());}else{if(A.mode==2){if(!baidu.cookie.get("bk.doubt.flashplayed")||(window.curUser&&baidu.cookie.get("bk.doubt.flashplayed").indexOf(","+window.curUser.id)==-1)){A.showFlash=false;_.push(baidu.string.format(A.guideTpl,{flashCode:A._createFlashCode(),expandStyle:"display:none",collapseStyle:"",editQuery:baikeViewInfo.isMulit?"id="+baikeViewInfo.id+"&subLemmaId="+baikeViewInfo.subList[baikeViewInfo.expIndex].subLemmaId:"id="+baikeViewInfo.id}));baidu.cookie.set("bk.doubt.flashplayed",baidu.cookie.get("bk.doubt.flashplayed")+","+window.curUser.id,{expires:30*24*3600000});}else{if(A.showFlash){A.showFlash=false;_.push(baidu.string.format(A.guideTpl,{flashCode:"",falshStyle:"display:none",collapseStyle:"display:none",expandStyle:"",editQuery:baikeViewInfo.isMulit?"id="+baikeViewInfo.id+"&subLemmaId="+baikeViewInfo.subList[baikeViewInfo.expIndex].subLemmaId:"id="+baikeViewInfo.id}));}else{_.push('<p class="doubt-t1">\u82e5\u6709\u9519\u8bef\uff0c\u8bf7\u5212\u8bcd\u9009\u4e2d\u9519\u8bef\u5185\u5bb9\u5e76\u6309\u63d0\u793a\u8d28\u7591\uff0c\u4e3a\u8bcd\u6761\u7684\u8d28\u91cf\u63d0\u5347\u505a\u51fa\u8d21\u732e\u3002</p>');_.push(A._buildDataString());}}}else{if(A.mode==3){if(A.firstShow){_.push('<p class="expert-t4">\u8bf7\u70b9\u51fb\u60a8\u60f3\u5224\u65ad\u7684\u6bb5\u843d\uff0c\u5e76\u6309\u63d0\u793a\u8fdb\u884c\u64cd\u4f5c\u3002\u4ebf\u4e07\u7f51\u53cb\u5c06\u56e0\u60a8\u7684\u4e13\u4e1a\u8d21\u732e\u800c\u83b7\u76ca\u3002</p>');A.firstShow=0;}else{_.push('<p class="expert-t2"><strong>\u8bf7\u5224\u65ad\u6807\u7070\u6bb5\u843d\u6b63\u786e\u6027</strong></p><p class="expert-t2"><strong>\u82e5\u9519\u8bef\uff1a</strong>\u8bf7\u5212\u8bcd\u9009\u4e2d\u9519\u8bef\u5185\u5bb9</p><p class="expert-t1"><strong>\u82e5\u6b63\u786e\uff1a</strong>\u8bf7\u70b9\u51fb\u6bb5\u843d\u4e0b\u65b9\u7684\u6b63\u786e\u6309\u94ae</p>');_.push(A._buildDataString());}}}}var B=this.mode-1;if(B>=0){this.tabConent[B]=_.join("");return this.tabConent[B];}else{return"";}},_build:function(){var A=[],_=this;this._buildContent();baidu.array.each(this.tabItems,function(_,B){if((!window.curUser||!curUser.isExpert)&&B==1){return;}A.push('<li class="');if(B==0){A.push("first ");}if(B==this.selectedTab){A.push("on ");}A.push('"><span');A.push((!!!B)?' id="doubtModeBtn"':' id="expertModeBtn"');A.push(">");A.push(_);A.push("</span></li>");});this.tabstring=A.join("");this.collpaseCls=this.collapsed?this.clsName+"-collapse":"";return baidu.string.format(this.tpl,this);},_loadTangramFx:function(){if(!baidu.fx){baidu.page.loadJsFile("http://baike.bdimg.com/static/common/js/lib/tangram-fx.js");}},_bindEvents:function(){var A=this;baidu.on(window,"resize",function(){A._fixPosition(A);});baidu.on(window,"scroll",function(){A._fixPosition(A);});bk.event.on("bk.doubtbox.modechanged",function(_){A.setTitle();});baidu.on(this.iconEl,"click",function(){if(!window.curUser&&(this.mode!=1)){nslog(location.href,3798);userlogin();return;}A.showFlash=1;A.setMode(2);if(!bk.doubt.isFeedSysInit){bk.event.fire("bk.doubtbox.startDoubt",{doubtBox:A});bk.doubt.isFeedSysInit=1;}});baidu.on(this.bubbleEl,"click",function(_){baidu.event.stopPropagation(_);});baidu.on(this.closeBubbleEl,"click",function(_){A._hideTipBubble();baidu.event.stopPropagation(_);});this._initTab();this._tab.init();baidu.on(this.closeEl,"click",function(){A.mode=-1;A.hide();});baidu.each(this.tabItemEls,function(_,B){baidu.on(_,"click",function(_){A.firstShow=1;A.update();});});baidu.on(this.contentEl,"click",function(_){function B(B){var C=baidu.event.getTarget(_),E=baidu.dom.getAttr(C,"etype");if(E){return C;}var D=baidu.dom.getAncestorBy(C,function(_){return baidu.dom.getAttr(_,"etype")||_==A.el;});return D;}var C=B(_),D=baidu.dom.getAttr(C,"etype"),E=D+"Handler";if(A[E]){A[E].call(A,_,C);}});bk.event.on("bk.dountbox.agreesuccess",function(B){var F=B.edata,E=B.userCount;if(F===undefined){return;}var A=baidu.g("doubtlist-num-"+B.edata),G=baidu.g("doubtlist-t1-"+B.edata),_=baidu.g("doubtlist-t2-"+B.edata),D=baidu.g("doubtlist-animation-"+B.edata),C=baidu.g("doubtlist-btn-"+B.edata);G.innerHTML=E-1;_.innerHTML=E;D.style.display="block";baidu.fx.moveBy(D,{y:-19},{onafterfinish:function(){A.innerHTML=E;D.style.cssText="display: none";}});});bk.event.on("bk.dountbox.updated",function(){var B;baidu.array.each(A.data,function(A,C){if(A.isNewDoubt){B=baidu.g("doubtlist-btn-"+C);B&&(_(B));}});});function _(_){_.parentNode.style.display="none";}},_fixPosition:function(B){var _=baidu.dom.query(".col-sub")[0],A=_.offsetLeft;if(baidu.browser.ie){A+=(baidu.g("wrap").offsetLeft-5);}baidu.dom.setStyle(B.el,"left",(A-document.body.scrollLeft-(baidu.browser.ie?5:10))+"px");baidu.dom.setStyle(B.iconEl,"left",(A-document.body.scrollLeft-(baidu.browser.ie<8?35:40))+"px");},raiseDoubtHandler:function(A,_){this.setMode(2);this.update([]);},expandFlashHandler:function(B,A){var C=this,D=baidu.dom.getAncestorByClass(A,"guide"),_=baidu.dom.query(".flash",D)[0];_.innerHTML=this._createFlashCode();baidu.dom.show(_);baidu.dom.hide(A);baidu.dom.show(baidu.dom.query(".collapseFlash",D)[0]);},collapseFlashHandler:function(B,A){var C=this,D=baidu.dom.getAncestorByClass(A,"guide"),_=baidu.dom.query(".flash",D)[0];_.innerHTML="";baidu.dom.hide(_);baidu.dom.hide(A);baidu.dom.show(baidu.dom.query(".expandFlash",D)[0]);},expandHandler:function(B,E){var F=this,A=baidu.dom.getAncestorByTag(E,"li"),D=baidu.dom.query(".slim",A)[0],_=baidu.dom.query(".fat",A)[0],C=baidu.dom.query(".collapse",A)[0];baidu.hide(D);baidu.show(_);baidu.hide(E);baidu.show(C);setTimeout(function(){F._initScrollPanel();},100);},collapseHandler:function(B,E){var F=this,A=baidu.dom.getAncestorByTag(E,"li"),D=baidu.dom.query(".slim",A)[0],_=baidu.dom.query(".fat",A)[0],C=baidu.dom.query(".expand",A)[0];baidu.hide(_);baidu.show(D);baidu.hide(E);baidu.show(C);},agreeHandler:function(A,_){var B=baidu.dom.getAttr(_,"data");if(this.data[B]){this.data[B]._evt=A;}bk.event.fire("bk.dountbox.agreecliked",this.data[B]);if(!baidu.getAttr(_,"clicked")){baidu.setAttr(_,"clicked","1");(function(_){setTimeout(function(){_&&baidu.dom.setAttr(_,"clicked","");},5000);})(_);}},collapse:function(){if(this.collapsed){return;}var _=this;if(_.scrollPanel&&_.scrollPanel.isVisible("y")){_.scrollPanel.setVisible(false,"y");}baidu.addClass(this.el,this.clsName+"-collapse");this.collapsed=true;},expand:function(){baidu.removeClass(this.el,this.clsName+"-collapse");this.collapsed=false;this._initScrollPanel();},setMode:function(A){if((!window.curUser||!curUser.isExpert)&&A==3){return;}this._hideTipBubble();if(A!=this.mode){var _=this.mode;this.mode=A;this.show();if(A==1||A==2){this._tab.select(0,true);}else{if(this.mode==3){this._tab.select(1,true);}}if(this.mode==2){nslog(location.href,3796);}bk.event.fire("bk.doubtbox.modechanged",{mode:this.mode,oldMode:_});bk.event.fire(this.modeEventNames[this.mode]);}else{this.show();}},_initTab:function(){if(this._tab){return;}var B=this,A=this.clsName+"-tab_switcher"+this.gid,_=this.clsName+"-tabwrap_container"+this.gid;this._tab=new bk.usercenter.tab({switcherID:A,contentID:_,defaultIdx:0,indexChanged:function(_){if(B.inited){B.setMode(_?3:2);}}});},_initScrollPanel:function(){if(this.collapsed){return;}var A=this,_=this.clsName+"-tab_container"+this.gid;if(!A.scrollPanel){scrollPanel=new baidu.ui.ScrollPanel({container:_,overflow:"overflow-y",element:_});A.scrollPanel=scrollPanel;A.scrollPanel.setVisible(false,"x");scrollPanel.render(_);}else{this.tabEl.style.width="";this.tabEl.style.height="";if(!A.scrollPanel.isVisible("y")){A.scrollPanel.setVisible(true,"y");}A.scrollPanel.update();}},update:function(_,E){var C=this;this.show();if(this.scrollPanel&&this.scrollPanel.isVisible("y")){this.scrollPanel.setVisible(false,"y");}C.data=C._processData(_);var B=C._buildTabContent(),D=(C.mode==1||C.mode==2)?"tab-"+C.gid+"-0":"tab-"+C.gid+"-1",A=baidu.g(D);A.innerHTML=B;bk.event.fire("bk.dountbox.updated");this._initScrollPanel();}};bk.doubt.islocked=function(){if(baikeViewInfo.editable=="false"||(window.curUser&&window.curUser.forbid)){return 1;}return 0;};baidu.lang.inherits(bk.doubt.DoubtBox,baidu.lang.Class);bk.doubt.isFeedSysInit=0;baidu.dom.ready(function(){function _(){if(location.href.indexOf("/view/")>0&&!bk.doubt.islocked()){bk.event.on("bk.doubt.duobtbox.created",function(){function _(){baidu.ajax.request("/ajax/doubt/doubtcheck",{onsuccess:function(_,B){B=baidu.json.parse(B);if(B.errno===0&&B.data&&B.data.privilege===1){if(!baidu.platform.isIpad){var A=baidu.dom.query(".doubtbox-icon");if(A&&A.length>0){baidu.dom.show(A[0]);}}}}});}if(window.curUser){_();}else{bk.event.on("bk.event.user.login",function(){_();});}});C.render();}}var C=new bk.doubt.DoubtBox({renderTo:document.body}),A=B();if(A){bk.event.fire("bk.doubtbox.startDoubt",{doubtBox:C});bk.doubt.isFeedSysInit=1;}if(window.curUser){_();}else{bk.event.on("bk.event.user.login",function(){_();});}function B(){var _=judgeInfo_data.sysDoubt_multi;for(var D=0,C=sublemmaIds.length;D<C;D++){var B=judgeInfo_multi[sublemmaIds[D]];if(B&&(B.content||B.abstract)){A=true;return true;}}for(D=0,C=sublemmaIds.length;D<C;D++){B=_[sublemmaIds[D]];if(B&&(B.content||B.abstract)){return true;}}return false;}});baidu.more.ns("bk.doubt");bk.doubt.ExpertCard=baidu.ui.createUI(function(_){_=_||{};},{superClass:bk.Dialog}).extend({classPrefix:"expertcard bkdialog",shadow:true,modal:false,titlebar:true,buttonbar:false,autoDispose:false,top:100,left:100,contentTpl:'<div class="expert-card clearfix">\t\t\t\t<div class="expert-img">\t\t\t\t\t<img src="#{expertImg}"/>\t\t\t\t</div>\t\t\t\t<div class="expert-info">\t\t\t\t\t<div class="expert-name">#{expertName}<span class="i"></span></div>\t\t\t\t\t<div class="expert-title">#{expertTitle}</div>\t\t\t\t\t<div class="expert-fields">\u9886\u57df\uff1a#{expertFields}</div>\t\t\t\t\t<div class="expert-judges">\u505a\u51fa<span class="num">#{judgeCount}</span>\u6b21\u5224\u65ad\uff0c\u6307\u5bfc\u4e86<span class="num">#{userCount}</span>\u540d\u7f51\u53cb</div>\t\t\t\t</div>\t\t\t</div>',setData:function(_){var A=baidu.string.format(this.contentTpl,_);this.update({contentText:A});return this;},setPosition:function(_){if(baidu.lang.isArray(_)){this.top=_[0];this.left=_[1];}this.update({top:this.top,left:this.left});return this;}});bk.doubt.ExpertCard.getSharedCard=function(){if(!bk.doubt.ExpertCard.instance){bk.doubt.ExpertCard.instance=new bk.doubt.ExpertCard({contentText:"tongliang",titleText:"hello expert",width:350,height:98});baidu.setStyles(bk.doubt.ExpertCard.instance.getMain(),{"border-top-width":"2px"});baidu.setStyles(bk.doubt.ExpertCard.instance.Coverable_iframeContainer,{left:"3px",top:"1px",backgroundColor:"#000",opacity:0.08});}return bk.doubt.ExpertCard.instance;};baidu.dom.ready(function(){return;var _=bk.doubt.ExpertCard.getSharedCard();_.setData({expertName:"\u674e\u5f00\u590d",expertImg:"http://baike.baidu.com/cms/s/mall/badge/mallboy03.jpg",expertTitle:"\u521b\u65b0\u5de5\u573a\u603b\u88c1\u517cCEO",expertFields:"\u521b\u4e1a\u3001\u4e92\u8054\u7f51",judgeCount:1098,userCount:98563}).setPosition().open();});