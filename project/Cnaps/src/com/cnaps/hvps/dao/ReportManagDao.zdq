package com.cnaps.hvps.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import org.hibernate.Session;

import com.bancstone.common.dao.impl.GenericHibernateDaoSupportImpl;
import com.bancstone.constants.SystemConstants;
import com.cnaps.hvps.form.transfer.TransProcessForm;
import com.cnaps.hvps.persistence.messages.ReportManagEntity;


public class ReportManagDao extends GenericHibernateDaoSupportImpl {
	/**
	 * 大额报文登记查询 按照来往标识、业务状态、业务类型编码、清算日期查询发送或接收报文总数及交易总金额
	 * 
	 * @param direction
	 * @param prcSts
	 * @param pmtTp
	 * @param chckDt
	 * @return
	 */
	public ReportManagEntity checkTotalAcct(String direction, String prcSts,
			String pmtTp, String chckDt, String systemCd, String netgRnd) {
		ReportManagEntity entity = new ReportManagEntity();
		Connection conn = null;
		PreparedStatement pst = null;
		ResultSet rs = null;
		Session session = this.getHibernateTemplate().getSessionFactory()
				.openSession();
		String sql = "";
		if ("HVPS".equals(systemCd)) {
			sql = "select * from HVPSMSGRGSTR o where o.prcSts='" + prcSts
					+ "' and o.pmtTp='" + pmtTp + "' and o.sttlmDt='" + chckDt
					+ "' and o.direction='" + direction + "'";
		} else {
			if ("PR04".equals(prcSts)) {// 已清算
				sql = "select NVL(sum(OrnglNbOfTxs),0) as num, NVL(sum(OrnglCtrlSum),0) as totalAmt from BEPSMSGRGSTR o where o.prcSts='"
						+ prcSts
						+ "' and o.MsgTpCd='"
						+ pmtTp
						+ "' and o.NetgDt='"
						+ chckDt
						+ "' and o.direction='"
						+ direction + "' and o.netgRnd='" + netgRnd + "' ";
			} else {
				sql = "select NVL(sum(OrnglNbOfTxs),0) as num, NVL(sum(OrnglCtrlSum),0) as totalAmt from BEPSMSGRGSTR o where o.prcSts='"
						+ prcSts
						+ "' and o.MsgTpCd='"
						+ pmtTp
						+ "' and o.NetgDt='"
						+ chckDt
						+ "' and o.direction='"
						+ direction + "'";
			}

		}

		try {
			conn = session.connection();
			conn.setAutoCommit(false);
			pst = conn.prepareStatement(sql);
			rs = pst.executeQuery();
			while (rs.next()) {
				entity.setNum(rs.getString("num"));
				entity.setTotalAmt(rs.getString("totalAmt"));
			}
			conn.commit();
		} catch (SQLException e) {
			try {
				conn.rollback();
			} catch (SQLException e1) {
				e1.printStackTrace();
			}

			e.printStackTrace();
		} finally {
			try {
				if (rs != null) {
					rs.close();
				}
				pst.close();
				conn.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
			this.releaseSession(session);
		}
		return entity;
	}

	/**
	 * 取得大额报文登记列表
	 * 
	 * @param transProcessForm
	 * @return
	 */
	@SuppressWarnings("unchecked")
	public List getHvpsMsgList(TransProcessForm transProcessForm) {
		List hvpsMsgList = new ArrayList();
		StringBuffer sb = new StringBuffer();
		sb.append("select msgid,instgpty,pmtgrpid,sttlmdt,prcsts,direction  from HVPSMSGRGSTR where 1=1");
		if (transProcessForm.getPo().getMsgid() != null
				&& !"".equals(transProcessForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ transProcessForm.getPo().getMsgid().trim() + "'");
		}
		if (transProcessForm.getPo().getWorkdt() != null
				&& !"".equals(transProcessForm.getPo().getWorkdt().trim())) {
			sb.append(" and sttlmdt='"
					+ transProcessForm.getPo().getWorkdt().trim() + "'");
		}
		if (transProcessForm.getPo().getDirection() != null
				&& !"".equals(transProcessForm.getPo().getDirection().trim())) {
			sb.append(" and direction='"
					+ transProcessForm.getPo().getDirection().trim() + "'");
		}
		try {
			hvpsMsgList=queryBySql4Page(sb.toString(), transProcessForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return hvpsMsgList;
	}

	/**
	 * 取得小额报文登记列表
	 * 
	 * @param transProcessForm
	 * @return
	 */
	@SuppressWarnings("unchecked")
	public List getBepsMsgList(TransProcessForm transProcessForm) {
		List bepsMsgList = new ArrayList();
		StringBuffer sb = new StringBuffer();
		sb
				.append("select msgid,instgpty,pmtgrpid,sttlmdt,prcsts,direction from BEPSMSGRGSTR where 1=1");
		if (transProcessForm.getPo().getMsgid() != null
				&& !"".equals(transProcessForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ transProcessForm.getPo().getMsgid().trim() + "'");
		}
		if (transProcessForm.getPo().getWorkdt() != null
				&& !"".equals(transProcessForm.getPo().getWorkdt().trim())) {
			sb.append(" and sttlmdt='"
					+ transProcessForm.getPo().getWorkdt().trim() + "'");
		}
		if (transProcessForm.getPo().getDirection() != null
				&& !"".equals(transProcessForm.getPo().getDirection().trim())) {
			sb.append(" and direction='"
					+ transProcessForm.getPo().getDirection().trim() + "'");
		}
		try {
			bepsMsgList=queryBySql4Page(sb.toString(), transProcessForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return bepsMsgList;
	}

	/**
	 * 取得大小额已经清算来往账业务列表
	 * @param transProcessForm
	 * @param statusFlag
	 * @return
	 */
	public List getliquidatedMsgList(TransProcessForm transProcessForm,String statusFlag) {
		ReportManagEntity entity = null;
		Connection conn = null;
		PreparedStatement pst = null;
		ResultSet rs = null;
		// Session session =
		// this.getHibernateTemplate().getSessionFactory().openSession();
		List liquidatedMsgList = new ArrayList();
		StringBuffer sb = new StringBuffer();
		sb
				.append("select  msgid,pmtgrpid,InstdPty,instgpty,systemcd, direction,amount,dbtracct,cdtracct,status,Id from CNAPSPMTCOLLECT where 1=1");
		if (transProcessForm.getPo().getMsgid() != null
				&& !"".equals(transProcessForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ transProcessForm.getPo().getMsgid().trim() + "'");
		}
		if (transProcessForm.getPo().getWorkdt() != null
				&& !"".equals(transProcessForm.getPo().getWorkdt().trim())) {
			sb.append(" and workdt='"
					+ transProcessForm.getPo().getWorkdt().trim() + "'");
		}
		if (transProcessForm.getPo().getDirection() != null
				&& !"".equals(transProcessForm.getPo().getDirection().trim())) {
			sb.append(" and direction='"
					+ transProcessForm.getPo().getDirection().trim() + "'");
		}
		if (transProcessForm.getPo().getSystemcd() != null
				&& !"".equals(transProcessForm.getPo().getSystemcd().trim())) {
			sb.append(" and systemcd='"
					+ transProcessForm.getPo().getSystemcd().trim() + "'");
		}
		if(statusFlag.trim().equals("1")){//已清算
			sb.append(" and Status='" + SystemConstants.PMTSTS_PR04 + "'");
		}else{
			sb.append(" and Status <>'" + SystemConstants.PMTSTS_PR04 + "'");
		}
		try {
			liquidatedMsgList = queryBySql4Page(sb.toString(), transProcessForm
					.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		}
		return liquidatedMsgList;
	}
	/**
	 * 查询查复列表
	 * @param transProcessForm
	 * @return
	 */
	public List getReplyInfoList(TransProcessForm transProcessForm) {
		List replyInfoList = new ArrayList();
		StringBuffer sb = new StringBuffer();
		sb.append("select Id,WorkDt,Direction,PmtGrpId,MsgId,CreDtTm,RecptMsgId," +
				"RecptDtTm,InstgPty,InstgIndrctPty,InstdPty,InstdIndrctPty,OrnglMsgId," +
				"OrnglInstgPty,OrnglMsgTp,OrnglTxId," +
				"OrnglPmtTp,QueryType,CurrencyCd,Amount,QueryContent,ReplyContent,Status,PrcCd," +
				"RjctInf,SttlmDt,SystemCd,Ustrd  from CCMSQueryReplyInfo where 1=1");
		if (transProcessForm.getPo().getMsgid() != null
				&& !"".equals(transProcessForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ transProcessForm.getPo().getMsgid().trim() + "'");
		}
		if (transProcessForm.getPo().getWorkdt() != null
				&& !"".equals(transProcessForm.getPo().getWorkdt().trim())) {
			sb.append(" and workdt='"
					+ transProcessForm.getPo().getWorkdt().trim() + "'");
		}
		if (transProcessForm.getPo().getDirection() != null
				&& !"".equals(transProcessForm.getPo().getDirection().trim())) {
			sb.append(" and direction='"
					+ transProcessForm.getPo().getDirection().trim() + "'");
		}
		if(transProcessForm.getPo().getQueryType() != null
				&& !"".equals(transProcessForm.getPo().getQueryType().trim())){
			sb.append(" and querytype='"
					+ transProcessForm.getPo().getQueryType().trim() + "'");
		}
		try {
			replyInfoList=queryBySql4Page(sb.toString(), transProcessForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return replyInfoList;
	}
	/**
	 * 自由格式查询
	 * @param transProcessForm
	 * @return
	 */
	public List getFreeMsgList(TransProcessForm transProcessForm) {
		List replyInfoList = new ArrayList();
		StringBuffer sb = new StringBuffer();
		sb.append("select Id,MsgId,CreDtTm,InstgPty,InstdPty,InstgDrctPty,InstdDrctPty,MsgCnt,Status,WorkDt," +
				"SttlmDt,PrcCd,TxRjctInf,TxRjctCd,Direction,SystemCd,Ustrd  from ccmsFreeMsg where 1=1");
		if (transProcessForm.getPo().getMsgid() != null
				&& !"".equals(transProcessForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ transProcessForm.getPo().getMsgid().trim() + "'");
		}
		if (transProcessForm.getPo().getWorkdt() != null
				&& !"".equals(transProcessForm.getPo().getWorkdt().trim())) {
			sb.append(" and workdt='"
					+ transProcessForm.getPo().getWorkdt().trim() + "'");
		}
		if (transProcessForm.getPo().getDirection() != null
				&& !"".equals(transProcessForm.getPo().getDirection().trim())) {
			sb.append(" and direction='"
					+ transProcessForm.getPo().getDirection().trim() + "'");
		}
		try {
			replyInfoList=queryBySql4Page(sb.toString(), transProcessForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return replyInfoList;
	}
	/**
	 * 已签发银行汇票清单
	 * @param tForm
	 * @return
	 */
	@SuppressWarnings("unchecked")
	public List getBillList(TransProcessForm tForm){
		//msgid,pmtGrpId，dbtrbrnchid,cdtrbrnchid,amount,cdtrAcct,dbtrAcct
		List billList=null;
		StringBuffer sb = new StringBuffer();
		sb.append("select msgid,pmtGrpId,dbtrbrnchid,cdtrbrnchid,amount,cdtrAcct,dbtrAcct  from HVPSBILLDBTR where 1=1");
		if (tForm.getPo().getMsgid() != null
				&& !"".equals(tForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ tForm.getPo().getMsgid().trim() + "'");
		}
		if (tForm.getPo().getWorkdt() != null
				&& !"".equals(tForm.getPo().getWorkdt().trim())) {
			sb.append(" and workdt='"
					+ tForm.getPo().getWorkdt().trim() + "'");
		}
		sb.append(" and status='"+SystemConstants.COMMON_PR04+"'");//已清算
		sb.append(" and PmtKd ='02901'");//业务种类编码--银行汇票资金移存
		sb.append(" and pmttp='A202'");//业务类型编码--银行汇票
		try {
			billList=queryBySql4Page(sb.toString(), tForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return billList;
	}
	/**
	 * 已兑付银行汇票清单
	 * @param tForm
	 * @return
	 */
	public List getBillCashList(TransProcessForm tForm){
		//msgid,pmtGrpId，dbtrbrnchid,cdtrbrnchid,amount,cdtrAcct,dbtrAcct
		List billList=null;
		StringBuffer sb = new StringBuffer();
		sb.append("select msgid,pmtGrpId,dbtrbrnchid,cdtrbrnchid,amount,cdtrAcct,dbtrAcct,pmtkd  from HVPSBILLDBTR where 1=1");
		if (tForm.getPo().getMsgid() != null
				&& !"".equals(tForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ tForm.getPo().getMsgid().trim() + "'");
		}
		if (tForm.getPo().getWorkdt() != null
				&& !"".equals(tForm.getPo().getWorkdt().trim())) {
			sb.append(" and workdt='"
					+ tForm.getPo().getWorkdt().trim() + "'");
		}
		sb.append(" and status='"+SystemConstants.COMMON_PR04+"'");//已清算
		sb.append(" and (pmtkd ='02902' or pmtkd='02903' or pmtkd='02904')");//业务种类编码--银行汇票资金清算--银行汇票资金多余划回--银行汇票资金未用退回
		sb.append(" and pmttp='A202'");//业务类型编码--银行汇票
		try {
			billList=queryBySql4Page(sb.toString(), tForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return billList;
	}
	/**
	 * 已签发银行本票清单
	 * @param tForm
	 * @return
	 */
	public List getBeps131cdtrList(TransProcessForm tForm){
		//msgid,pmtGrpId，dbtrbrnchid,cdtrbrnchid,amount,cdtrAcct,dbtrAcct
		List billList=null;
		StringBuffer sb = new StringBuffer();
		sb.append("select msgid,pmtGrpId,dbtrbrnchid,cdtrbrnchid,amount,cdtrAcct,dbtrAcct,pmtkd  from beps131cdtr where 1=1");
		if (tForm.getPo().getMsgid() != null
				&& !"".equals(tForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ tForm.getPo().getMsgid().trim() + "'");
		}
		if (tForm.getPo().getWorkdt() != null
				&& !"".equals(tForm.getPo().getWorkdt().trim())) {
			sb.append(" and workdt='"
					+ tForm.getPo().getWorkdt().trim() + "'");
		}
		sb.append(" and status='"+SystemConstants.COMMON_PR04+"'");//已清算
		sb.append(" and pmtkd ='03406'");//业务种类编码--银行本票
		sb.append(" and pmttp='D203'");//业务类型编码--小实时通用票据截留业务
		try {
			billList=queryBySql4Page(sb.toString(), tForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return billList;
	}
	/**
	 * 当日提出支票业务登记簿
	 * @param tForm
	 * @return
	 */
	public List getBeps130List(TransProcessForm tForm){
		//msgid,pmtGrpId，dbtrbrnchid,cdtrbrnchid,amount,cdtrAcct,dbtrAcct
		List billList=null;
		StringBuffer sb = new StringBuffer();
		sb.append("select MsgId,InstgPty,InstdPty,NbOfTxsOfScs,CtrlSum,NbOfTxs," +
				"PmtKd,Status  from beps130 where 1=1");
		if (tForm.getPo().getMsgid() != null
				&& !"".equals(tForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ tForm.getPo().getMsgid().trim() + "'");
		}
		if (tForm.getPo().getWorkdt() != null
				&& !"".equals(tForm.getPo().getWorkdt().trim())) {
			sb.append(" and workdt='"
					+ tForm.getPo().getWorkdt().trim() + "'");
		}
		//sb.append(" and status='"+SystemConstants.COMMON_PR04+"'");//已清算
		sb.append(" and pmtkd='05301'");//CIS支票业务回执
		try {
			billList=queryBySql4Page(sb.toString(), tForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return billList;
	}
	/**
	 * 已兑付银行本票清单
	 * @param tForm
	 * @return
	 */
	public List getBeps131dbtrList(TransProcessForm tForm){
		//msgid,pmtGrpId，dbtrbrnchid,cdtrbrnchid,amount,cdtrAcct,dbtrAcct
		List billList=null;
		StringBuffer sb = new StringBuffer();
		sb.append("select msgid,txid,dbtrbrnchid,cdtrbrnchid,amount,cdtrAcct,dbtrAcct,pmtkd  from beps131dbtr where 1=1");
		if (tForm.getPo().getMsgid() != null
				&& !"".equals(tForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ tForm.getPo().getMsgid().trim() + "'");
		}
		if (tForm.getPo().getWorkdt() != null
				&& !"".equals(tForm.getPo().getWorkdt().trim())) {
			sb.append(" and workdt='"
					+ tForm.getPo().getWorkdt().trim() + "'");
		}
		sb.append(" and status='"+SystemConstants.COMMON_PR04+"'");//已清算
		sb.append(" and pmtkd ='03406'");//业务种类编码--银行本票
		sb.append(" and pmttp='D203'");//业务类型编码--小实时通用票据截留业务
		try {
			billList=queryBySql4Page(sb.toString(), tForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return billList;
	}
	/**
	 * 实时借记业务付款签约报表查询
	 * @param transProcessForm
	 * @return
	 */
	public List getSignupMsgList(TransProcessForm transProcessForm) {
		List signupInfoList = new ArrayList();
		StringBuffer sb = new StringBuffer();
		sb.append("select *　from BEPS131DEBITPRTCL ");
		if((transProcessForm.getPo().getContractoracct() != null
				&& !"".equals(transProcessForm.getPo().getContractoracct().trim()))||(transProcessForm.getPo().getContractfctvdt() != null
				&& !"".equals(transProcessForm.getPo().getContractfctvdt().trim()))||(transProcessForm.getPo().getContractmd() != null
				&& !"".equals(transProcessForm.getPo().getContractmd().trim()))){
			sb.append(" where 1=1 ");
		}
		if (transProcessForm.getPo().getContractmd() != null
				&& !"".equals(transProcessForm.getPo().getContractmd().trim())) {
			sb.append("and  ContractMd='"
					+ transProcessForm.getPo().getContractmd().trim() + "'");
		}
		if (transProcessForm.getPo().getContractoracct() != null
				&& !"".equals(transProcessForm.getPo().getContractoracct().trim())) {
			sb.append(" and ContractorAcct='"
					+ transProcessForm.getPo().getContractoracct().trim() + "'");
		}
		if (transProcessForm.getPo().getContractfctvdt() != null
				&& !"".equals(transProcessForm.getPo().getContractfctvdt().trim())) {
			sb.append(" and ContractFctvDt='"
					+ transProcessForm.getPo().getContractfctvdt().trim() + "'");
		}
		
		try {
			signupInfoList=queryBySql4Page(sb.toString(), transProcessForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return signupInfoList;
	}
	
	/**
	 * 定期借记业务付款签约报表查询
	 * @param transProcessForm
	 * @return
	 */
	public List getRegularMsgList(TransProcessForm transProcessForm) {
		List regularInfoList = new ArrayList();
		StringBuffer sb = new StringBuffer();
		sb.append("select * from BEPS133DEBITPRTCL where 1=1");
		if (transProcessForm.getPo().getPmtagrmtnb() != null
				&& !"".equals(transProcessForm.getPo().getPmtagrmtnb().trim())) {
			sb.append(" and  pmtagrmtnb='"
					+ transProcessForm.getPo().getPmtagrmtnb().trim() + "'");
		}
		
		try {
			regularInfoList=queryBySql4Page(sb.toString(), transProcessForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return regularInfoList;
	}
	/**
	 * -查询查复情况登记查询
	 * @param transProcessForm
	 * @return
	 */
	public List getQueryreplybookMsgList(TransProcessForm transProcessForm) {
		List queryreplybookInfoList = new ArrayList();
		StringBuffer sb = new StringBuffer();
		sb.append("select * from CCMSQueryReplyInfo where 1=1");
		if (transProcessForm.getPo().getMsgid() != null
				&& !"".equals(transProcessForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ transProcessForm.getPo().getMsgid().trim() + "'");
		}
		if (transProcessForm.getPo().getWorkdt() != null
				&& !"".equals(transProcessForm.getPo().getWorkdt().trim())) {
			sb.append(" and workdt='"
					+ transProcessForm.getPo().getWorkdt().trim() + "'");
		}
		if (transProcessForm.getPo().getDirection() != null
				&& !"".equals(transProcessForm.getPo().getDirection().trim())) {
			sb.append(" and direction='"
					+ transProcessForm.getPo().getDirection().trim() + "'");
		}
		
		try {
			queryreplybookInfoList=queryBySql4Page(sb.toString(), transProcessForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return queryreplybookInfoList;
	}
	/**
	 * -退回申请及应答情况登记查询
	 * @param transProcessForm
	 * @return
	 */
	public List getReturnquestanswerMsgList(TransProcessForm transProcessForm) {
		List returnquestanswerInfoList = new ArrayList();
		StringBuffer sb = new StringBuffer();
		sb.append("select * from CCMSBackApp where 1=1");
		if (transProcessForm.getPo().getMsgid() != null
				&& !"".equals(transProcessForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ transProcessForm.getPo().getMsgid().trim() + "'");
		}
		if (transProcessForm.getPo().getWorkdt() != null
				&& !"".equals(transProcessForm.getPo().getWorkdt().trim())) {
			sb.append(" and workdt='"
					+ transProcessForm.getPo().getWorkdt().trim() + "'");
		}
		if (transProcessForm.getPo().getDirection() != null
				&& !"".equals(transProcessForm.getPo().getDirection().trim())) {
			sb.append(" and direction='"
					+ transProcessForm.getPo().getDirection().trim() + "'");
		}
		
		try {
			returnquestanswerInfoList=queryBySql4Page(sb.toString(), transProcessForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return returnquestanswerInfoList;
	}
	
	/**
	 * -业务撤销申请及应答情况登记查询
	 * @param transProcessForm
	 * @return
	 */
	public List getBusinessCancleanswerMsgList(TransProcessForm transProcessForm) {
		List businessCancleanswerInfoList = new ArrayList();
		StringBuffer sb = new StringBuffer();
		sb.append("select * from HVPSCancelDeal where 1=1");
		if (transProcessForm.getPo().getMsgid() != null
				&& !"".equals(transProcessForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ transProcessForm.getPo().getMsgid().trim() + "'");
		}
		if (transProcessForm.getPo().getWorkdt() != null
				&& !"".equals(transProcessForm.getPo().getWorkdt().trim())) {
			sb.append(" and workdt='"
					+ transProcessForm.getPo().getWorkdt().trim() + "'");
		}
		if (transProcessForm.getPo().getDirection() != null
				&& !"".equals(transProcessForm.getPo().getDirection().trim())) {
			sb.append(" and direction='"
					+ transProcessForm.getPo().getDirection().trim() + "'");
		}
		
		try {
			businessCancleanswerInfoList=queryBySql4Page(sb.toString(), transProcessForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return businessCancleanswerInfoList;
	}
	/**
	 * -借记止付申请及应答情况登记查询
	 * @param transProcessForm
	 * @return
	 */
	public List getDebitstoppayanswerMsgList(TransProcessForm transProcessForm) {
		List debitstoppayanswerInfoList = new ArrayList();
		StringBuffer sb = new StringBuffer();
		sb.append("select * from beps411 where 1=1");
		if (transProcessForm.getPo().getMsgid() != null
				&& !"".equals(transProcessForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ transProcessForm.getPo().getMsgid().trim() + "'");
		}
		if (transProcessForm.getPo().getWorkdt() != null
				&& !"".equals(transProcessForm.getPo().getWorkdt().trim())) {
			sb.append(" and workdt='"
					+ transProcessForm.getPo().getWorkdt().trim() + "'");
		}
		if (transProcessForm.getPo().getDirection() != null
				&& !"".equals(transProcessForm.getPo().getDirection().trim())) {
			sb.append(" and direction='"
					+ transProcessForm.getPo().getDirection().trim() + "'");
		}
		
		try {
			debitstoppayanswerInfoList=queryBySql4Page(sb.toString(), transProcessForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return debitstoppayanswerInfoList;
	}
	/**
	 * -业务冲正申请及应答情况登记查询                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
	 * @param transProcessForm
	 * @return
	 */
	public List getRealreversalanswerMsgList(TransProcessForm transProcessForm) {
		List realreversalanswerInfoList = new ArrayList();
		StringBuffer sb = new StringBuffer();
		sb.append("select * from beps413 where 1=1");
		if (transProcessForm.getPo().getMsgid() != null
				&& !"".equals(transProcessForm.getPo().getMsgid().trim())) {
			sb.append(" and msgid='"
					+ transProcessForm.getPo().getMsgid().trim() + "'");
		}
		if (transProcessForm.getPo().getWorkdt() != null
				&& !"".equals(transProcessForm.getPo().getWorkdt().trim())) {
			sb.append(" and workdt='"
					+ transProcessForm.getPo().getWorkdt().trim() + "'");
		}
		if (transProcessForm.getPo().getDirection() != null
				&& !"".equals(transProcessForm.getPo().getDirection().trim())) {
			sb.append(" and direction='"
					+ transProcessForm.getPo().getDirection().trim() + "'");
		}
		
		try {
			realreversalanswerInfoList=queryBySql4Page(sb.toString(), transProcessForm.getPageInfo());
		} catch (Exception e) {
			e.printStackTrace();
		} 
		return realreversalanswerInfoList;
	}
}
