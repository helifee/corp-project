package com.bancstone.exportexcel;

import java.io.UnsupportedEncodingException;
import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import javax.servlet.http.HttpServletResponse;


 
public class ExcelCreate<T> {

	public void createExcel(List list,HttpServletResponse response, String msgtype,String prodate,String pmtsts,BigDecimal dbitdecimal,String flag) throws UnsupportedEncodingException{
		List newlist = new ArrayList();
		String fileType="1";
		String[][] names = null;
		String fileName="";

		if(flag.equals("1")){
			names=ExcelHelper.wangzhangmx_names;
			fileName=ExcelHelper.wangzhangmx_title;
		}else if(flag.equals("2")){
			names=ExcelHelper.wangzhangmx_names;
			fileName=ExcelHelper.laizhangmx_title;
		}
		processExcel(fileType,names, list, response, msgtype, prodate,pmtsts, dbitdecimal,fileName);

	}
	
	private void processExcel(String titleType,String[][] names,List list,HttpServletResponse response, String msgtype,String prodate,String pmtsts,BigDecimal dbitdecimal,String fileName){
		ExportToExcel export = new ExportToExcel();
		export.exportExcel(titleType, names, list, response, msgtype, prodate,pmtsts,dbitdecimal,fileName);
	}
	

	
	  
	/**
	 * 
	 * <ul>
	 * <li>1、开发作者：史文龙</li>
	 * <li>2、开发日期：Jul 15, 2010</li>
	 * <li>3、开发时间：3:36:47 PM</li>
	 * <li>4、返回类型：void</li>
	 * <li>5、方法含义：</li>
	 * <li>6、方法说明：根据指定enNames数组属性名称复制对象的属性值并添加到little列表中</li>
	 * </ul>
	 * 
	 * @param list
	 * @param allList
	 */
	@SuppressWarnings( { "unused", "unchecked" })
	private void processProperties(List list, List allList, String[] enNames) {
		int i = 1;
		if (list != null) {
			for (Iterator it = list.iterator(); it.hasNext();) {
				T reg = (T) it.next();
				List littlelist = new ArrayList();
				if (enNames != null) {
					BeanUtil.copyProperties2List(littlelist, reg, enNames);
				}
				allList.add(littlelist);
				i++;
			}
		}
	}
	  /**
	 * <ul>
	 * <li>1、开发作者：史文龙</li>
	 * <li>2、开发日期：2010-9-20</li>
	 * <li>3、开发时间：下午06:13:08</li>
	 * <li>4、返回类型：void</li>
	 * <li>5、方法含义：</li>
	 * <li>6、方法说明：</li>
	 * </ul>
	 * @param titleType 几位表头类型 
	 * @param names     字段显示名称
	 * @param list		list  数据集合
	 * @param fileName  文件标题名称
	 * @param response
	 * @param msgtype 类型
	 * @param prodate 日期
	 * @param tradingcount;//交易笔数
	 * @param  tradingamt;//交易金额
	 * @param  tradingsxf;//交易手续费
	 */
	//String titleType,String[][] names,List list,String fileName,HttpServletResponse response, String msgtype,String prodate,String tradingcount,String tradingamt,String tradingsxf
	public  void processExcel_InterBankCount(String titleType,String[][] names,String[] englistname,List list,String fileName,HttpServletResponse response, String msgtype,String prodate,String tradingcount,String tradingamt,String tradingsxf){
		List allList = new ArrayList();
		this.processProperties(list, allList, englistname);
		ExportToExcel export = new ExportToExcel();
		export.exportExcel_InterBankCount(titleType, names, allList,fileName, response, msgtype, prodate,tradingcount,tradingamt,tradingsxf);
	}
	
	/**
	 * @param list
	 * @param response
	 * @param message 这个表头 第一行 就一格随便写的信息
	 * @param message1这个暂时没用
	 * @param message2这个是下面一行 总计那行的 所需要的字段
	 * @param flag    这个判断标准 是来判断文件名名称和表头的字段名字显示的样式
	 * @throws UnsupportedEncodingException
	 */
	public void createExcel_1(List list,HttpServletResponse response,String message,String message1,String message2,String flag) throws UnsupportedEncodingException{
		List newlist = new ArrayList();
		String fileType="1";
		String[][] names = null;
		String fileName="";

		if(flag.equals("1")){
			names=ExcelHelper.ACCOUNT_REPORT_NAMES;
			fileName=ExcelHelper.ACCOUNT_REPORT_TITLE;
		}else if(flag.equals("2")){
 
		}
		processExcel_1(fileType,names, list, response, message, message1,message2,fileName);

	}
	
	private void processExcel_1(String titleType,String[][] names,List list,HttpServletResponse response, String message,String message1,String message2,String fileName){
		ExportToExcel export = new ExportToExcel();
		export.exportExcel_1(titleType, names, list, response, message,message1,message2,fileName);
	}
}
