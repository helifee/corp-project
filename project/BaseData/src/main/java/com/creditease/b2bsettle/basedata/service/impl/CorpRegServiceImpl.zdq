package com.creditease.b2bsettle.basedata.service.impl;

import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;

import net.sf.json.JSONObject;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.creditease.b2bsettle.basedata.model.CorpReg;
import com.creditease.b2bsettle.basedata.model.CorpRegRes;
//import com.creditease.b2bsettle.basedata.model.CorpRegAudit;
//import com.creditease.b2bsettle.basedata.repository.CorpRegAuditRepository;
import com.creditease.b2bsettle.basedata.repository.CorpRegRepository;
import com.creditease.b2bsettle.basedata.service.CorpRegService;

/**
 * 企业入网注册管理
 * 
 * @author shihl
 *
 */
@Service
public class CorpRegServiceImpl implements CorpRegService {
//	@Autowired
//	private CorpRegAuditRepository corpRegAuditRepository;
	@Autowired
	private CorpRegRepository corpRegRepository;
//
//	// 新增支付类型（审核表）
//	@Override
//	public long newCorpRegAuditService(CorpRegAudit CorpRegAudit) {
//		CorpRegAudit save = corpRegAuditRepository.save(CorpRegAudit);
//		return save.getId();
//
//	}

	/**
	 * 审核操作 通过or拒绝 审核意见 cId 支付类型ID status 0待审核（审核中） 1审核通过 2审核拒绝 text 审核意见
	 * modifier 审核人
	 * */
//	@Override
//	public boolean auditCorpReg(long cId, String status, String text,
//			String modifier) {
//		corpRegAuditRepository.updateById(cId, status, text, modifier,
//				new Date());
//		// Date date = new Date();
//		// corpRegAuditRepository.updateById(1,"44",text,"2",date);
//
//		return true;
//	}

	
	
	
	
	
	
	@Override
	public CorpRegRes newCorpReg(JSONObject temp) {
		SimpleDateFormat df=new SimpleDateFormat("yyyy-MM-dd HH:MM:ss");
		Date date = new Date();
		String strDate=df.format(date);
		CorpRegRes corpRegRes = new CorpRegRes();
		
		CorpReg corpReg = new CorpReg();
		corpReg.setCorpName(temp.getString("eName"));
		corpReg.setFoundDate(new Date());
		corpReg.setStatus(false);
		corpReg.setContact(temp.getString("contactName"));
		corpReg.setTel(temp.getString("contactPhone"));
		corpReg.setEmail(temp.getString("contactMail"));
		corpReg.setCreator("000");
		corpReg.setCreatedTime(new Date());
		corpReg.setModifier("000");
		corpReg.setModifyTime(new Date());
		corpReg.setCanOperate(true);
		
		corpRegRepository.save(corpReg);
		corpRegRes.setSendTime(strDate);
		corpRegRes.setRetCode("1");
		corpRegRes.setRetMessage("企业注册成功");
		return corpRegRes;
	}

	@Override
	
	public String processingResults(CorpReg corpReg) {
		corpRegRepository.modifyCorpReg(corpReg.getId(),corpReg.isStatus(),corpReg.getComments(),corpReg.getModifier(),corpReg.getModifyTime());
		return "1";
	}


	@Override
	public List<CorpReg> queryCorpRegAll() {
		return corpRegRepository.findAll();

	}

	@Override
	public List<CorpReg> queryCorpReg(CorpReg corpReg) {
		List<CorpReg> corpregs  = corpRegRepository.findByCorpNameAndStatus(corpReg.getCorpName(),corpReg.isStatus());
		return corpregs;
	}

}
