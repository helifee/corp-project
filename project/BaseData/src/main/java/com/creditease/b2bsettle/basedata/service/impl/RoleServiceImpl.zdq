package com.creditease.b2bsettle.basedata.service.impl;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.creditease.b2bsettle.basedata.model.Role;
import com.creditease.b2bsettle.basedata.model.RoleMenu;
import com.creditease.b2bsettle.basedata.repository.RoleMenuRepository;
import com.creditease.b2bsettle.basedata.repository.RoleRepository;
import com.creditease.b2bsettle.basedata.service.RoleService;

@Service
public class RoleServiceImpl implements RoleService {
	
	@Autowired
	private RoleRepository roleRepository;

	@Autowired
	private RoleMenuRepository roleMenuRepository;

	@Override
	public long addRole(Role role) {
		Role retRole = roleRepository.save(role);
		return retRole.getId();
	}

	@Override
	public boolean updateRole(Role role) {
		Role newRole = roleRepository.save(role);
		return newRole != null;
	}

	@Override
	public boolean delRole(long id) {
		int count = roleRepository.delRoleById(id);
		return count == 1;
	}

	@Override
	public List<Role> findAll() {
		return roleRepository.findByDeleted(false);
	}

	@Override
	public Role findById(long id) {
		return roleRepository.findOne(id);
	}

	@Override
	public boolean bindMenuFor(long roleId, long menuId) {
		RoleMenu roleMenu = new RoleMenu();
		roleMenu.setRole(roleId);
		roleMenu.setMenu(menuId);
		roleMenuRepository.save(roleMenu);
		return true;
	}

	@Override
	public boolean unbindMenuFor(long roleId, long menuId) {
		return roleMenuRepository.delete(roleId, menuId);
	}

}
