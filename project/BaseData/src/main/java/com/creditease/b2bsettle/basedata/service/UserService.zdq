package com.creditease.b2bsettle.basedata.service;

import java.util.Date;
import java.util.List;

import com.creditease.b2bsettle.basedata.constant.LockOperator;
import com.creditease.b2bsettle.basedata.exception.DuplicateKeyException;
import com.creditease.b2bsettle.basedata.model.User;
import com.creditease.b2bsettle.basedata.model.UserAudit;

/**
 * 用户管理
 * 
 * @author daoqiangzhang
 *
 */
public interface UserService {
	
	/************************* 对外系统接口 *****************************/
	//用户登陆
    public User login(String userName, String password);
    
    //修改密码
    public boolean changePwd(String userName, String oldPwd, String newPwd);
    
    //更新指定用户DN
    public boolean updateDN(String userName, String dn);
    
    //根据ID查询用户
    public User findById(long id); 

    //验证用户有效性
	public boolean validate(String userName, String keyInfo);
	
	/************************* 管理界面接口 *****************************/
    //查询所有启用用户
    public List<User> findAllValidUsers();
    
    //查询未启用数据（待审核与拒绝）
    public List<UserAudit> findAllInvalidUser();
    
    //新增用户（需要审核）
    public long newUser(UserAudit user) throws DuplicateKeyException;
    
    //根据ID修改用户（需要审核）
    public boolean updateUser(UserAudit user);

    //删除指定ID用户（需要审核）
    public boolean deleteUserById(long userId);

    //锁定用户(1手动锁定与2系统锁定)（需要审核）
    public boolean lockUser(long id, LockOperator operator);
    
    //解锁用户（需要审核）
    public boolean unlockUser(long id);
    
    //用户审核通过
    public boolean pass(UserAudit userAudit);
    
    //用户审核拒绝
    public boolean noPass(UserAudit userAudit);
    
    
	/************************* 其他接口 *****************************/
    //检查用户是否存在
    public boolean isUserExists(String name);
    
    //根据Name查询用户
    public User findByName(String userName); 
    
    //查询指定用户是否锁定
    public boolean isLocked(long id);

    //设置用户登陆时间
	public boolean setLoginTime(String userName, Date date);

    
}
