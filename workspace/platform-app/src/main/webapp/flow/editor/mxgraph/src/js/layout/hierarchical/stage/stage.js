function mxHierarchicalLayoutStage(){}mxHierarchicalLayoutStage.prototype.execute=function(A){};function mxMedianHybridCrossingReduction(A){this.layout=A}mxMedianHybridCrossingReduction.prototype=new mxHierarchicalLayoutStage();mxMedianHybridCrossingReduction.prototype.constructor=mxMedianHybridCrossingReduction;mxMedianHybridCrossingReduction.prototype.layout=null;mxMedianHybridCrossingReduction.prototype.maxIterations=24;mxMedianHybridCrossingReduction.prototype.nestedBestRanks=null;mxMedianHybridCrossingReduction.prototype.currentBestCrossings=0;mxMedianHybridCrossingReduction.prototype.iterationsWithoutImprovement=0;mxMedianHybridCrossingReduction.prototype.maxNoImprovementIterations=2;mxMedianHybridCrossingReduction.prototype.execute=function(J){var K=this.layout.getModel();this.nestedBestRanks=[];for(var D=0;D<K.ranks.length;D++){this.nestedBestRanks[D]=K.ranks[D].slice()}var H=0;var I=this.calculateCrossings(K);for(var D=0;D<this.maxIterations&&H<this.maxNoImprovementIterations;D++){this.weightedMedian(D,K);this.transpose(D,K);var F=this.calculateCrossings(K);if(F<I){I=F;H=0;for(var B=0;B<this.nestedBestRanks.length;B++){var C=K.ranks[B];for(var E=0;E<C.length;E++){var L=C[E];this.nestedBestRanks[B][L.getGeneralPurposeVariable(B)]=L}}}else{H++;for(var B=0;B<this.nestedBestRanks.length;B++){var C=K.ranks[B];for(var E=0;E<C.length;E++){var L=C[E];L.setGeneralPurposeVariable(B,E)}}}if(I==0){break}}var A=[];var G=[];for(var D=0;D<K.maxRank+1;D++){G[D]=[];A[D]=G[D]}for(var D=0;D<this.nestedBestRanks.length;D++){for(var B=0;B<this.nestedBestRanks[D].length;B++){G[D].push(this.nestedBestRanks[D][B])}}K.ranks=A};mxMedianHybridCrossingReduction.prototype.calculateCrossings=function(D){var B=D.ranks.length;var C=0;for(var A=1;A<B;A++){C+=this.calculateRankCrossing(A,D)}return C};mxMedianHybridCrossingReduction.prototype.calculateRankCrossing=function(S,D){var L=0;var A=D.ranks[S];var H=D.ranks[S-1];var M=[];for(var P=0;P<A.length;P++){var O=A[P];var B=O.getGeneralPurposeVariable(S);var I=O.getPreviousLayerConnectedCells(S);var N=[];for(var E=0;E<I.length;E++){var G=I[E];var R=G.getGeneralPurposeVariable(S-1);N.push(R)}N.sort(function(U,V){return U-V});M[B]=N}var Q=[];for(var P=0;P<M.length;P++){Q=Q.concat(M[P])}var F=1;while(F<H.length){F<<=1}var J=2*F-1;F-=1;var T=[];for(var P=0;P<J;++P){T[P]=0}for(var P=0;P<Q.length;P++){var C=Q[P];var K=C+F;++T[K];while(K>0){if(K%2){L+=T[K+1]}K=(K-1)>>1;++T[K]}}return L};mxMedianHybridCrossingReduction.prototype.transpose=function(Y,G){var C=true;var S=0;var Z=10;while(C&&S++<Z){var N=Y%2==1&&S%2==1;C=false;for(var I=0;I<G.ranks.length;I++){var A=G.ranks[I];var W=[];for(var U=0;U<A.length;U++){var O=A[U];var P=O.getGeneralPurposeVariable(I);if(P<0){P=U}W[P]=O}var M=null;var K=null;var E=null;var a=null;var B=null;var X=null;var D=null;var V=null;var Q=null;var L=null;for(var U=0;U<(A.length-1);U++){if(U==0){Q=W[U];M=Q.getNextLayerConnectedCells(I);K=Q.getPreviousLayerConnectedCells(I);B=[];X=[];for(var H=0;H<M.length;H++){B[H]=M[H].getGeneralPurposeVariable(I+1)}for(var H=0;H<K.length;H++){X[H]=K[H].getGeneralPurposeVariable(I-1)}}else{M=E;K=a;B=D;X=V;Q=L}L=W[U+1];E=L.getNextLayerConnectedCells(I);a=L.getPreviousLayerConnectedCells(I);D=[];V=[];for(var H=0;H<E.length;H++){D[H]=E[H].getGeneralPurposeVariable(I+1)}for(var H=0;H<a.length;H++){V[H]=a[H].getGeneralPurposeVariable(I-1)}var R=0;var J=0;for(var H=0;H<B.length;H++){for(var F=0;F<D.length;F++){if(B[H]>D[F]){R++}if(B[H]<D[F]){J++}}}for(var H=0;H<X.length;H++){for(var F=0;F<V.length;F++){if(X[H]>V[F]){R++}if(X[H]<V[F]){J++}}}if((J<R)||(J==R&&N)){var T=Q.getGeneralPurposeVariable(I);Q.setGeneralPurposeVariable(I,L.getGeneralPurposeVariable(I));L.setGeneralPurposeVariable(I,T);E=M;a=K;D=B;V=X;L=Q;if(!N){C=true}}}}}};mxMedianHybridCrossingReduction.prototype.weightedMedian=function(A,C){var B=(A%2==0);if(B){for(var D=C.maxRank-1;D>=0;D--){this.medianRank(D,B)}}else{for(var D=1;D<C.maxRank;D++){this.medianRank(D,B)}}};mxMedianHybridCrossingReduction.prototype.medianRank=function(G,B){var C=this.nestedBestRanks[G].length;var E=[];var I=[];for(var F=0;F<C;F++){var J=this.nestedBestRanks[G][F];var H=new MedianCellSorter();H.cell=J;var A;if(B){A=J.getNextLayerConnectedCells(G)}else{A=J.getPreviousLayerConnectedCells(G)}var D;if(B){D=G+1}else{D=G-1}if(A!=null&&A.length!=0){H.medianValue=this.medianValue(A,D);E.push(H)}else{I[J.getGeneralPurposeVariable(G)]=true}}E.sort(MedianCellSorter.prototype.compare);for(var F=0;F<C;F++){if(I[F]==null){var J=E.shift().cell;J.setGeneralPurposeVariable(G,F)}}};mxMedianHybridCrossingReduction.prototype.medianValue=function(E,G){var B=[];var C=0;for(var D=0;D<E.length;D++){var I=E[D];B[C++]=I.getGeneralPurposeVariable(G)}B.sort(function(K,J){return K-J});if(C%2==1){return B[Math.floor(C/2)]}else{if(C==2){return((B[0]+B[1])/2)}else{var H=C/2;var F=B[H-1]-B[0];var A=B[C-1]-B[H];return(B[H-1]*A+B[H]*F)/(F+A)}}};function MedianCellSorter(){}MedianCellSorter.prototype.medianValue=0;MedianCellSorter.prototype.cell=false;MedianCellSorter.prototype.compare=function(B,A){if(B!=null&&A!=null){if(A.medianValue>B.medianValue){return -1}else{if(A.medianValue<B.medianValue){return 1}else{return 0}}}else{return 0}};function mxMinimumCycleRemover(A){this.layout=A}mxMinimumCycleRemover.prototype=new mxHierarchicalLayoutStage();mxMinimumCycleRemover.prototype.constructor=mxMinimumCycleRemover;mxMinimumCycleRemover.prototype.layout=null;mxMinimumCycleRemover.prototype.execute=function(G){var H=this.layout.getModel();var A=new Object();var E=H.vertexMapper.getValues();var I=new Object();for(var C=0;C<E.length;C++){I[E[C].id]=E[C]}var B=null;if(H.roots!=null){var F=H.roots;B=[];for(var C=0;C<F.length;C++){B[C]=H.vertexMapper.get(F[C])}}H.visit(function(M,K,N,L,J){if(K.isAncestor(M)){N.invert();mxUtils.remove(N,M.connectsAsSource);M.connectsAsTarget.push(N);mxUtils.remove(N,K.connectsAsTarget);K.connectsAsSource.push(N)}A[K.id]=K;delete I[K.id]},B,true,null);var D=mxUtils.clone(A,null,true);H.visit(function(M,K,N,L,J){if(K.isAncestor(M)){N.invert();mxUtils.remove(N,M.connectsAsSource);K.connectsAsSource.push(N);M.connectsAsTarget.push(N);mxUtils.remove(N,K.connectsAsTarget)}A[K.id]=K;delete I[K.id]},I,true,D)};function mxCoordinateAssignment(F,A,B,C,D,E){this.layout=F;this.intraCellSpacing=A;this.interRankCellSpacing=B;this.orientation=C;this.initialX=D;this.parallelEdgeSpacing=E}mxCoordinateAssignment.prototype=new mxHierarchicalLayoutStage();mxCoordinateAssignment.prototype.constructor=mxCoordinateAssignment;mxCoordinateAssignment.prototype.layout=null;mxCoordinateAssignment.prototype.intraCellSpacing=30;mxCoordinateAssignment.prototype.interRankCellSpacing=100;mxCoordinateAssignment.prototype.parallelEdgeSpacing=10;mxCoordinateAssignment.prototype.maxIterations=8;mxCoordinateAssignment.prototype.prefHozEdgeSep=5;mxCoordinateAssignment.prototype.prefVertEdgeOff=2;mxCoordinateAssignment.prototype.minEdgeJetty=12;mxCoordinateAssignment.prototype.channelBuffer=4;mxCoordinateAssignment.prototype.jettyPositions=null;mxCoordinateAssignment.prototype.orientation=mxConstants.DIRECTION_NORTH;mxCoordinateAssignment.prototype.initialX=null;mxCoordinateAssignment.prototype.limitX=null;mxCoordinateAssignment.prototype.currentXDelta=null;mxCoordinateAssignment.prototype.widestRank=null;mxCoordinateAssignment.prototype.rankTopY=null;mxCoordinateAssignment.prototype.rankBottomY=null;mxCoordinateAssignment.prototype.widestRankValue=null;mxCoordinateAssignment.prototype.rankWidths=null;mxCoordinateAssignment.prototype.rankY=null;mxCoordinateAssignment.prototype.fineTuning=true;mxCoordinateAssignment.prototype.nextLayerConnectedCache=null;mxCoordinateAssignment.prototype.previousLayerConnectedCache=null;mxCoordinateAssignment.prototype.groupPadding=10;mxCoordinateAssignment.prototype.printStatus=function(){var D=this.layout.getModel();mxLog.show();mxLog.writeln("======Coord assignment debug=======");for(var E=0;E<D.ranks.length;E++){mxLog.write("Rank ",E," : ");var B=D.ranks[E];for(var A=0;A<B.length;A++){var C=B[A];mxLog.write(C.getGeneralPurposeVariable(E),"  ")}mxLog.writeln()}mxLog.writeln("====================================")};mxCoordinateAssignment.prototype.execute=function(F){this.jettyPositions=Object();var G=this.layout.getModel();this.currentXDelta=0;this.initialCoords(this.layout.getGraph(),G);if(this.fineTuning){this.minNode(G)}var A=100000000;if(this.fineTuning){for(var D=0;D<this.maxIterations;D++){if(D!=0){this.medianPos(D,G);this.minNode(G)}if(this.currentXDelta<A){for(var B=0;B<G.ranks.length;B++){var C=G.ranks[B];for(var E=0;E<C.length;E++){var H=C[E];H.setX(B,H.getGeneralPurposeVariable(B))}}A=this.currentXDelta}else{for(var B=0;B<G.ranks.length;B++){var C=G.ranks[B];for(var E=0;E<C.length;E++){var H=C[E];H.setGeneralPurposeVariable(B,H.getX(B))}}}this.minPath(this.layout.getGraph(),G);this.currentXDelta=0}}this.setCellLocations(this.layout.getGraph(),G)};mxCoordinateAssignment.prototype.minNode=function(D){var C=[];var V=new mxDictionary();var A=[];for(var F=0;F<=D.maxRank;F++){A[F]=D.ranks[F];for(var Y=0;Y<A[F].length;Y++){var W=A[F][Y];var G=new WeightedCellSorter(W,F);G.rankIndex=Y;G.visited=true;C.push(G);V.put(W,G)}}var T=C.length*10;var U=0;var b=1;while(C.length>0&&U<=T){var S=C.shift();var P=S.cell;var f=S.weightedValue;var Z=parseInt(S.rankIndex);var L=P.getNextLayerConnectedCells(f);var R=P.getPreviousLayerConnectedCells(f);var J=L.length;var X=R.length;var Q=this.medianXValue(L,f+1);var O=this.medianXValue(R,f-1);var H=J+X;var c=P.getGeneralPurposeVariable(f);var K=c;if(H>0){K=(Q*J+O*X)/H}var E=false;if(K<c-b){if(Z==0){P.setGeneralPurposeVariable(f,K);E=true}else{var I=A[f][Z-1];var a=I.getGeneralPurposeVariable(f);a=a+I.width/2+this.intraCellSpacing+P.width/2;if(a<K){P.setGeneralPurposeVariable(f,K);E=true}else{if(a<P.getGeneralPurposeVariable(f)-b){P.setGeneralPurposeVariable(f,a);E=true}}}}else{if(K>c+b){var M=A[f].length;if(Z==M-1){P.setGeneralPurposeVariable(f,K);E=true}else{var e=A[f][Z+1];var B=e.getGeneralPurposeVariable(f);B=B-e.width/2-this.intraCellSpacing-P.width/2;if(B>K){P.setGeneralPurposeVariable(f,K);E=true}else{if(B>P.getGeneralPurposeVariable(f)+b){P.setGeneralPurposeVariable(f,B);E=true}}}}}if(E){for(var F=0;F<L.length;F++){var N=L[F];var d=V.get(N);if(d!=null){if(d.visited==false){d.visited=true;C.push(d)}}}for(var F=0;F<R.length;F++){var N=R[F];var d=V.get(N);if(d!=null){if(d.visited==false){d.visited=true;C.push(d)}}}}S.visited=false;U++}};mxCoordinateAssignment.prototype.medianPos=function(A,C){var B=(A%2==0);if(B){for(var D=C.maxRank;D>0;D--){this.rankMedianPosition(D-1,C,D)}}else{for(var D=0;D<C.maxRank-1;D++){this.rankMedianPosition(D+1,C,D)}}};mxCoordinateAssignment.prototype.rankMedianPosition=function(T,D,B){var A=D.ranks[T];var I=[];var N=new Object();for(var E=0;E<A.length;E++){var M=A[E];I[E]=new WeightedCellSorter();I[E].cell=M;I[E].rankIndex=E;N[M.id]=I[E];var H=null;if(B<T){H=M.getPreviousLayerConnectedCells(T)}else{H=M.getNextLayerConnectedCells(T)}I[E].weightedValue=this.calculatedWeightedValue(M,H)}I.sort(WeightedCellSorter.prototype.compare);for(var E=0;E<I.length;E++){var F=0;var J=I[E].cell;var H=null;var K=0;if(B<T){H=J.getPreviousLayerConnectedCells(T).slice()}else{H=J.getNextLayerConnectedCells(T).slice()}if(H!=null){F=H.length;if(F>0){K=this.medianXValue(H,B)}else{K=J.getGeneralPurposeVariable(T)}}var O=0;var R=-100000000;for(var Q=I[E].rankIndex-1;Q>=0;){var P=N[A[Q].id];if(P!=null){var L=P.cell;if(P.visited){R=L.getGeneralPurposeVariable(T)+L.width/2+this.intraCellSpacing+O+J.width/2;Q=-1}else{O+=L.width+this.intraCellSpacing;Q--}}}var G=0;var C=100000000;for(var Q=I[E].rankIndex+1;Q<I.length;){var P=N[A[Q].id];if(P!=null){var S=P.cell;if(P.visited){C=S.getGeneralPurposeVariable(T)-S.width/2-this.intraCellSpacing-G-J.width/2;Q=I.length}else{G+=S.width+this.intraCellSpacing;Q++}}}if(K>=R&&K<=C){J.setGeneralPurposeVariable(T,K)}else{if(K<R){J.setGeneralPurposeVariable(T,R);this.currentXDelta+=R-K}else{if(K>C){J.setGeneralPurposeVariable(T,C);this.currentXDelta+=K-C}}}I[E].visited=true}};mxCoordinateAssignment.prototype.calculatedWeightedValue=function(A,C){var D=0;for(var B=0;B<C.length;B++){var E=C[B];if(A.isVertex()&&E.isVertex()){D++}else{if(A.isEdge()&&E.isEdge()){D+=8}else{D+=2}}}return D};mxCoordinateAssignment.prototype.medianXValue=function(A,C){if(A.length==0){return 0}var D=[];for(var B=0;B<A.length;B++){D[B]=A[B].getGeneralPurposeVariable(C)}D.sort(function(I,H){return I-H});if(A.length%2==1){return D[Math.floor(A.length/2)]}else{var E=A.length/2;var G=D[E-1];var F=D[E];return((G+F)/2)}};mxCoordinateAssignment.prototype.initialCoords=function(A,C){this.calculateWidestRank(A,C);for(var B=this.widestRank;B>=0;B--){if(B<C.maxRank){this.rankCoordinates(B,A,C)}}for(var B=this.widestRank+1;B<=C.maxRank;B++){if(B>0){this.rankCoordinates(B,A,C)}}};mxCoordinateAssignment.prototype.rankCoordinates=function(J,C,K){var E=K.ranks[J];var B=0;var G=this.initialX+(this.widestRankValue-this.rankWidths[J])/2;var F=false;for(var I=0;I<E.length;I++){var H=E[I];if(H.isVertex()){var A=this.layout.getVertexBounds(H.cell);if(A!=null){if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){H.width=A.width;H.height=A.height}else{H.width=A.height;H.height=A.width}}else{F=true}B=Math.max(B,H.height)}else{if(H.isEdge()){var D=1;if(H.edges!=null){D=H.edges.length}else{mxLog.warn("edge.edges is null")}H.width=(D-1)*this.parallelEdgeSpacing}}G+=H.width/2;H.setX(J,G);H.setGeneralPurposeVariable(J,G);G+=H.width/2;G+=this.intraCellSpacing}if(F==true){mxLog.warn("At least one cell has no bounds")}};mxCoordinateAssignment.prototype.calculateWidestRank=function(B,N){var L=-this.interRankCellSpacing;var E=0;this.rankWidths=[];this.rankY=[];for(var K=N.maxRank;K>=0;K--){var J=0;var D=N.ranks[K];var G=this.initialX;var F=false;for(var I=0;I<D.length;I++){var H=D[I];if(H.isVertex()){var A=this.layout.getVertexBounds(H.cell);if(A!=null){if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){H.width=A.width;H.height=A.height}else{H.width=A.height;H.height=A.width}}else{F=true}J=Math.max(J,H.height)}else{if(H.isEdge()){var C=1;if(H.edges!=null){C=H.edges.length}else{mxLog.warn("edge.edges is null")}H.width=(C-1)*this.parallelEdgeSpacing}}G+=H.width/2;H.setX(K,G);H.setGeneralPurposeVariable(K,G);G+=H.width/2;G+=this.intraCellSpacing;if(G>this.widestRankValue){this.widestRankValue=G;this.widestRank=K}this.rankWidths[K]=G}if(F==true){mxLog.warn("At least one cell has no bounds")}this.rankY[K]=L;var M=J/2+E/2+this.interRankCellSpacing;E=J;if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_WEST){L+=M}else{L-=M}for(var I=0;I<D.length;I++){var O=D[I];O.setY(K,L)}}};mxCoordinateAssignment.prototype.minPath=function(C,O){var B=O.edgeMapper.getValues();for(var F=0;F<B.length;F++){var P=B[F];if(P.maxRank-P.minRank-1<1){continue}var G=P.getGeneralPurposeVariable(P.minRank+1);var M=true;var J=0;for(var H=P.minRank+2;H<P.maxRank;H++){var L=P.getGeneralPurposeVariable(H);if(G!=L){M=false;G=L}else{J++}}if(!M){var N=0;var E=0;var K=[];var A=[];var I=P.getGeneralPurposeVariable(P.minRank+1);for(var H=P.minRank+1;H<P.maxRank-1;H++){var D=P.getX(H+1);if(I==D){K[H-P.minRank-1]=I;N++}else{if(this.repositionValid(O,P,H+1,I)){K[H-P.minRank-1]=I;N++}else{K[H-P.minRank-1]=D;I=D}}}I=P.getX(H);for(var H=P.maxRank-1;H>P.minRank+1;H--){var D=P.getX(H-1);if(I==D){A[H-P.minRank-2]=I;E++}else{if(this.repositionValid(O,P,H-1,I)){A[H-P.minRank-2]=I;E++}else{A[H-P.minRank-2]=P.getX(H-1);I=D}}}if(E>J||N>J){if(E>=N){for(var H=P.maxRank-2;H>P.minRank;H--){P.setX(H,A[H-P.minRank-1])}}else{if(N>E){for(var H=P.minRank+2;H<P.maxRank;H++){P.setX(H,K[H-P.minRank-2])}}else{}}}}}};mxCoordinateAssignment.prototype.repositionValid=function(K,L,E,G){var J=K.ranks[E];var B=-1;for(var F=0;F<J.length;F++){if(L==J[F]){B=F;break}}if(B<0){return false}var I=L.getGeneralPurposeVariable(E);if(G<I){if(B==0){return true}var A=J[B-1];var H=A.getGeneralPurposeVariable(E);H=H+A.width/2+this.intraCellSpacing+L.width/2;if(H<=G){return true}else{return false}}else{if(G>I){if(B==J.length-1){return true}var C=J[B+1];var D=C.getGeneralPurposeVariable(E);D=D-C.width/2-this.intraCellSpacing-L.width/2;if(D>=G){return true}else{return false}}}return true};mxCoordinateAssignment.prototype.setCellLocations=function(D,E){this.rankTopY=[];this.rankBottomY=[];for(var A=0;A<E.ranks.length;A++){this.rankTopY[A]=Number.MAX_VALUE;this.rankBottomY[A]=-Number.MAX_VALUE}var C=E.vertexMapper.getValues();for(var A=0;A<C.length;A++){this.setVertexLocation(C[A])}if(this.layout.edgeStyle==mxHierarchicalEdgeStyle.ORTHOGONAL||this.layout.edgeStyle==mxHierarchicalEdgeStyle.POLYLINE||this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE){this.localEdgeProcessing(E)}var B=E.edgeMapper.getValues();for(var A=0;A<B.length;A++){this.setEdgePosition(B[A])}};mxCoordinateAssignment.prototype.localEdgeProcessing=function(E){for(var L=0;L<E.ranks.length;L++){var A=E.ranks[L];for(var G=0;G<A.length;G++){var N=A[G];if(N.isVertex()){var H=N.getPreviousLayerConnectedCells(L);var Z=L-1;for(var F=0;F<2;F++){if(Z>-1&&Z<E.ranks.length&&H!=null&&H.length>0){var S=[];for(var V=0;V<H.length;V++){var U=new WeightedCellSorter(H[V],H[V].getX(Z));S.push(U)}S.sort(WeightedCellSorter.prototype.compare);var Y=N.x[0]-N.width/2;var C=Y+N.width;var M=0;var B=0;var K=[];for(var V=0;V<S.length;V++){var R=S[V].cell;var W;if(R.isVertex()){if(F==0){W=N.connectsAsSource}else{W=N.connectsAsTarget}for(var I=0;I<W.length;I++){if(W[I].source==R||W[I].target==R){M+=W[I].edges.length;B++;K.push(W[I])}}}else{M+=R.edges.length;B++;K.push(R)}}var D=(M+1)*this.prefHozEdgeSep;if(N.width>D+(2*this.prefHozEdgeSep)){Y+=this.prefHozEdgeSep;C-=this.prefHozEdgeSep}var b=C-Y;var T=b/M;var Q=Y+T/2;var P=this.minEdgeJetty-this.prefVertEdgeOff;var X=0;for(var V=0;V<K.length;V++){var O=K[V].edges.length;var a=this.jettyPositions[K[V].ids[0]];if(a==null){a=[];this.jettyPositions[K[V].ids[0]]=a}if(V<M/2){P+=this.prefVertEdgeOff}else{if(V>M/2){P-=this.prefVertEdgeOff}}for(var J=0;J<O;J++){a[J*4+F*2]=Q;Q+=T;a[J*4+F*2+1]=P}X=Math.max(X,P)}}H=N.getNextLayerConnectedCells(L);Z=L+1}}}}};mxCoordinateAssignment.prototype.setEdgePosition=function(Q){var F=0;if(Q.temp[0]!=101207){var N=Q.maxRank;var L=Q.minRank;if(N==L){N=Q.source.maxRank;L=Q.target.minRank}var A=0;var Z=this.jettyPositions[Q.ids[0]];var R=Q.isReversed?Q.target.cell:Q.source.cell;var a=this.layout.graph;var H=this.orientation==mxConstants.DIRECTION_EAST||this.orientation==mxConstants.DIRECTION_SOUTH;for(var I=0;I<Q.edges.length;I++){var B=Q.edges[I];var X=this.layout.getVisibleTerminal(B,true);var E=[];var K=Q.isReversed;if(X!=R){K=!K}if(Z!=null){var b=K?2:0;var e=K?(H?this.rankBottomY[L]:this.rankTopY[L]):(H?this.rankTopY[N]:this.rankBottomY[N]);var V=Z[A*4+1+b];if(K!=H){V=-V}e+=V;var d=Z[A*4+b];var M=a.model.getTerminal(B,true);if(this.layout.isPort(M)&&a.model.getParent(M)==X){var J=a.view.getState(M);if(J!=null){d=J.x}else{d=X.geometry.x+Q.source.width*M.geometry.x}}if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){E.push(new mxPoint(d,e));if(this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE){E.push(new mxPoint(d,e+V))}}else{E.push(new mxPoint(e,d));if(this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE){E.push(new mxPoint(e+V,d))}}}var c=Q.x.length-1;var G=-1;var P=-1;var U=Q.maxRank-1;if(K){c=0;G=Q.x.length;P=1;U=Q.minRank+1}for(var T=c;(Q.maxRank!=Q.minRank)&&T!=G;T+=P){var W=Q.x[T]+F;var Y=(this.rankTopY[U]+this.rankBottomY[U+1])/2;var f=(this.rankTopY[U-1]+this.rankBottomY[U])/2;if(K){var D=Y;Y=f;f=D}if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){E.push(new mxPoint(W,Y));E.push(new mxPoint(W,f))}else{E.push(new mxPoint(Y,W));E.push(new mxPoint(f,W))}this.limitX=Math.max(this.limitX,W);U+=P}if(Z!=null){var b=K?2:0;var C=K?(H?this.rankTopY[N]:this.rankBottomY[N]):(H?this.rankBottomY[L]:this.rankTopY[L]);var V=Z[A*4+3-b];if(K!=H){V=-V}var e=C-V;var d=Z[A*4+2-b];var O=a.model.getTerminal(B,false);var S=this.layout.getVisibleTerminal(B,false);if(this.layout.isPort(O)&&a.model.getParent(O)==S){var J=a.view.getState(O);if(J!=null){d=J.x}else{d=S.geometry.x+Q.target.width*O.geometry.x}}if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){if(this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE){E.push(new mxPoint(d,e-V))}E.push(new mxPoint(d,e))}else{if(this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE){E.push(new mxPoint(e-V,d))}E.push(new mxPoint(e,d))}}if(Q.isReversed){this.processReversedEdge(Q,B)}this.layout.setEdgePoints(B,E);if(F==0){F=this.parallelEdgeSpacing}else{if(F>0){F=-F}else{F=-F+this.parallelEdgeSpacing}}A++}Q.temp[0]=101207}};mxCoordinateAssignment.prototype.setVertexLocation=function(D){var C=D.cell;var A=D.x[0]-D.width/2;var B=D.y[0]-D.height/2;this.rankTopY[D.minRank]=Math.min(this.rankTopY[D.minRank],B);this.rankBottomY[D.minRank]=Math.max(this.rankBottomY[D.minRank],B+D.height);if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){this.layout.setVertexLocation(C,A,B)}else{this.layout.setVertexLocation(C,B,A)}this.limitX=Math.max(this.limitX,A+D.width)};mxCoordinateAssignment.prototype.processReversedEdge=function(A,B){};function WeightedCellSorter(B,A){this.cell=B;this.weightedValue=A}WeightedCellSorter.prototype.weightedValue=0;WeightedCellSorter.prototype.nudge=false;WeightedCellSorter.prototype.visited=false;WeightedCellSorter.prototype.rankIndex=null;WeightedCellSorter.prototype.cell=null;WeightedCellSorter.prototype.compare=function(B,A){if(B!=null&&A!=null){if(A.weightedValue>B.weightedValue){return -1}else{if(A.weightedValue<B.weightedValue){return 1}else{if(A.nudge){return -1}else{return 1}}}}else{return 0}};function mxSwimlaneOrdering(A){this.layout=A}mxSwimlaneOrdering.prototype=new mxHierarchicalLayoutStage();mxSwimlaneOrdering.prototype.constructor=mxSwimlaneOrdering;mxSwimlaneOrdering.prototype.layout=null;mxSwimlaneOrdering.prototype.execute=function(F){var G=this.layout.getModel();var A=new Object();var H=mxUtils.clone(G.vertexMapper,null,true);var C=null;if(G.roots!=null){var E=G.roots;C=[];for(var D=0;D<E.length;D++){var B=mxCellPath.create(E[D]);C[D]=G.vertexMapper.get(E[D])}}G.visit(function(O,L,P,K,J){var N=O!=null&&O.swimlaneIndex==L.swimlaneIndex&&L.isAncestor(O);var I=O!=null&&P!=null&&O.swimlaneIndex<L.swimlaneIndex&&P.source==L;if(N){P.invert();mxUtils.remove(P,O.connectsAsSource);L.connectsAsSource.push(P);O.connectsAsTarget.push(P);mxUtils.remove(P,L.connectsAsTarget)}else{if(I){P.invert();mxUtils.remove(P,O.connectsAsTarget);L.connectsAsTarget.push(P);O.connectsAsSource.push(P);mxUtils.remove(P,L.connectsAsSource)}}var M=mxCellPath.create(L.cell);A[M]=L;delete H[M]},C,true,null)};