function mxGraphAbstractHierarchyCell(){this.x=[];this.y=[];this.temp=[]}mxGraphAbstractHierarchyCell.prototype.maxRank=-1;mxGraphAbstractHierarchyCell.prototype.minRank=-1;mxGraphAbstractHierarchyCell.prototype.x=null;mxGraphAbstractHierarchyCell.prototype.y=null;mxGraphAbstractHierarchyCell.prototype.width=0;mxGraphAbstractHierarchyCell.prototype.height=0;mxGraphAbstractHierarchyCell.prototype.nextLayerConnectedCells=null;mxGraphAbstractHierarchyCell.prototype.previousLayerConnectedCells=null;mxGraphAbstractHierarchyCell.prototype.temp=null;mxGraphAbstractHierarchyCell.prototype.getNextLayerConnectedCells=function(A){return null};mxGraphAbstractHierarchyCell.prototype.getPreviousLayerConnectedCells=function(A){return null};mxGraphAbstractHierarchyCell.prototype.isEdge=function(){return false};mxGraphAbstractHierarchyCell.prototype.isVertex=function(){return false};mxGraphAbstractHierarchyCell.prototype.getGeneralPurposeVariable=function(A){return null};mxGraphAbstractHierarchyCell.prototype.setGeneralPurposeVariable=function(A,B){return null};mxGraphAbstractHierarchyCell.prototype.setX=function(A,B){if(this.isVertex()){this.x[0]=B}else{if(this.isEdge()){this.x[A-this.minRank-1]=B}}};mxGraphAbstractHierarchyCell.prototype.getX=function(A){if(this.isVertex()){return this.x[0]}else{if(this.isEdge()){return this.x[A-this.minRank-1]}}return 0};mxGraphAbstractHierarchyCell.prototype.setY=function(A,B){if(this.isVertex()){this.y[0]=B}else{if(this.isEdge()){this.y[A-this.minRank-1]=B}}};function mxGraphHierarchyNode(A){mxGraphAbstractHierarchyCell.apply(this,arguments);this.cell=A;this.id=mxObjectIdentity.get(A);this.connectsAsTarget=[];this.connectsAsSource=[]}mxGraphHierarchyNode.prototype=new mxGraphAbstractHierarchyCell();mxGraphHierarchyNode.prototype.constructor=mxGraphHierarchyNode;mxGraphHierarchyNode.prototype.cell=null;mxGraphHierarchyNode.prototype.id=null;mxGraphHierarchyNode.prototype.connectsAsTarget=null;mxGraphHierarchyNode.prototype.connectsAsSource=null;mxGraphHierarchyNode.prototype.hashCode=false;mxGraphHierarchyNode.prototype.getRankValue=function(A){return this.maxRank};mxGraphHierarchyNode.prototype.getNextLayerConnectedCells=function(C){if(this.nextLayerConnectedCells==null){this.nextLayerConnectedCells=[];this.nextLayerConnectedCells[0]=[];for(var A=0;A<this.connectsAsTarget.length;A++){var B=this.connectsAsTarget[A];if(B.maxRank==-1||B.maxRank==C+1){this.nextLayerConnectedCells[0].push(B.source)}else{this.nextLayerConnectedCells[0].push(B)}}}return this.nextLayerConnectedCells[0]};mxGraphHierarchyNode.prototype.getPreviousLayerConnectedCells=function(C){if(this.previousLayerConnectedCells==null){this.previousLayerConnectedCells=[];this.previousLayerConnectedCells[0]=[];for(var A=0;A<this.connectsAsSource.length;A++){var B=this.connectsAsSource[A];if(B.minRank==-1||B.minRank==C-1){this.previousLayerConnectedCells[0].push(B.target)}else{this.previousLayerConnectedCells[0].push(B)}}}return this.previousLayerConnectedCells[0]};mxGraphHierarchyNode.prototype.isVertex=function(){return true};mxGraphHierarchyNode.prototype.getGeneralPurposeVariable=function(A){return this.temp[0]};mxGraphHierarchyNode.prototype.setGeneralPurposeVariable=function(A,B){this.temp[0]=B};mxGraphHierarchyNode.prototype.isAncestor=function(A){if(A!=null&&this.hashCode!=null&&A.hashCode!=null&&this.hashCode.length<A.hashCode.length){if(this.hashCode==A.hashCode){return true}if(this.hashCode==null||this.hashCode==null){return false}for(var B=0;B<this.hashCode.length;B++){if(this.hashCode[B]!=A.hashCode[B]){return false}}return true}return false};mxGraphHierarchyNode.prototype.getCoreCell=function(){return this.cell};function mxGraphHierarchyEdge(B){mxGraphAbstractHierarchyCell.apply(this,arguments);this.edges=B;this.ids=[];for(var A=0;A<B.length;A++){this.ids.push(mxObjectIdentity.get(B[A]))}}mxGraphHierarchyEdge.prototype=new mxGraphAbstractHierarchyCell();mxGraphHierarchyEdge.prototype.constructor=mxGraphHierarchyEdge;mxGraphHierarchyEdge.prototype.edges=null;mxGraphHierarchyEdge.prototype.ids=null;mxGraphHierarchyEdge.prototype.source=null;mxGraphHierarchyEdge.prototype.target=null;mxGraphHierarchyEdge.prototype.isReversed=false;mxGraphHierarchyEdge.prototype.invert=function(A){var B=this.source;this.source=this.target;this.target=B;this.isReversed=!this.isReversed};mxGraphHierarchyEdge.prototype.getNextLayerConnectedCells=function(B){if(this.nextLayerConnectedCells==null){this.nextLayerConnectedCells=[];for(var A=0;A<this.temp.length;A++){this.nextLayerConnectedCells[A]=[];if(A==this.temp.length-1){this.nextLayerConnectedCells[A].push(this.source)}else{this.nextLayerConnectedCells[A].push(this)}}}return this.nextLayerConnectedCells[B-this.minRank-1]};mxGraphHierarchyEdge.prototype.getPreviousLayerConnectedCells=function(B){if(this.previousLayerConnectedCells==null){this.previousLayerConnectedCells=[];for(var A=0;A<this.temp.length;A++){this.previousLayerConnectedCells[A]=[];if(A==0){this.previousLayerConnectedCells[A].push(this.target)}else{this.previousLayerConnectedCells[A].push(this)}}}return this.previousLayerConnectedCells[B-this.minRank-1]};mxGraphHierarchyEdge.prototype.isEdge=function(){return true};mxGraphHierarchyEdge.prototype.getGeneralPurposeVariable=function(A){return this.temp[A-this.minRank-1]};mxGraphHierarchyEdge.prototype.setGeneralPurposeVariable=function(A,B){this.temp[A-this.minRank-1]=B};mxGraphHierarchyEdge.prototype.getCoreCell=function(){if(this.edges!=null&&this.edges.length>0){return this.edges[0]}return null};function mxGraphHierarchyModel(H,I,N,M,O){var C=H.getGraph();this.tightenToSource=O;this.roots=N;this.parent=M;this.vertexMapper=new mxDictionary();this.edgeMapper=new mxDictionary();this.maxRank=0;var L=[];if(I==null){I=this.graph.getChildVertices(M)}this.maxRank=this.SOURCESCANSTARTRANK;this.createInternalCells(H,I,L);for(var G=0;G<I.length;G++){var B=L[G].connectsAsSource;for(var E=0;E<B.length;E++){var A=B[E];var F=A.edges;if(F!=null&&F.length>0){var D=F[0];var K=H.getVisibleTerminal(D,false);var J=this.vertexMapper.get(K);if(L[G]==J){K=H.getVisibleTerminal(D,true);J=this.vertexMapper.get(K)}if(J!=null&&L[G]!=J){A.target=J;if(J.connectsAsTarget.length==0){J.connectsAsTarget=[]}if(mxUtils.indexOf(J.connectsAsTarget,A)<0){J.connectsAsTarget.push(A)}}}}L[G].temp[0]=1}}mxGraphHierarchyModel.prototype.maxRank=null;mxGraphHierarchyModel.prototype.vertexMapper=null;mxGraphHierarchyModel.prototype.edgeMapper=null;mxGraphHierarchyModel.prototype.ranks=null;mxGraphHierarchyModel.prototype.roots=null;mxGraphHierarchyModel.prototype.parent=null;mxGraphHierarchyModel.prototype.dfsCount=0;mxGraphHierarchyModel.prototype.SOURCESCANSTARTRANK=100000000;mxGraphHierarchyModel.prototype.tightenToSource=false;mxGraphHierarchyModel.prototype.createInternalCells=function(G,H,L){var B=G.getGraph();for(var F=0;F<H.length;F++){L[F]=new mxGraphHierarchyNode(H[F]);this.vertexMapper.put(H[F],L[F]);var E=G.getEdges(H[F]);L[F].connectsAsSource=[];for(var D=0;D<E.length;D++){var M=G.getVisibleTerminal(E[D],false);if(M!=H[F]&&G.graph.model.isVertex(M)&&!G.isVertexIgnored(M)){var C=G.getEdgesBetween(H[F],M,false);var K=G.getEdgesBetween(H[F],M,true);if(C!=null&&C.length>0&&this.edgeMapper.get(C[0])==null&&K.length*2>=C.length){var A=new mxGraphHierarchyEdge(C);for(var J=0;J<C.length;J++){var I=C[J];this.edgeMapper.put(I,A);B.resetEdge(I);if(G.disableEdgeStyle){G.setEdgeStyleEnabled(I,false);G.setOrthogonalEdge(I,true)}}A.source=L[F];if(mxUtils.indexOf(L[F].connectsAsSource,A)<0){L[F].connectsAsSource.push(A)}}}}L[F].temp[0]=0}};mxGraphHierarchyModel.prototype.initialRank=function(){var L=[];if(this.roots!=null){for(var G=0;G<this.roots.length;G++){var A=this.vertexMapper.get(this.roots[G]);if(A!=null){L.push(A)}}}var E=this.vertexMapper.getValues();for(var G=0;G<E.length;G++){E[G].temp[0]=-1}var D=L.slice();while(L.length>0){var A=L[0];var H;var N;H=A.connectsAsTarget;N=A.connectsAsSource;var M=true;var F=this.SOURCESCANSTARTRANK;for(var G=0;G<H.length;G++){var B=H[G];if(B.temp[0]==5270620){var K=B.source;F=Math.min(F,K.temp[0]-1)}else{M=false;break}}if(M){A.temp[0]=F;this.maxRank=Math.min(this.maxRank,F);if(N!=null){for(var G=0;G<N.length;G++){var B=N[G];B.temp[0]=5270620;var K=B.target;if(K.temp[0]==-1){L.push(K);K.temp[0]=-2}}}L.shift()}else{var I=L.shift();L.push(A);if(I==A&&L.length==1){break}}}for(var G=0;G<E.length;G++){E[G].temp[0]-=this.maxRank}for(var G=0;G<D.length;G++){var A=D[G];var C=0;var H=A.connectsAsSource;for(var J=0;J<H.length;J++){var B=H[J];var K=B.target;A.temp[0]=Math.max(C,K.temp[0]+1);C=A.temp[0]}}this.maxRank=this.SOURCESCANSTARTRANK-this.maxRank};mxGraphHierarchyModel.prototype.fixRanks=function(){var E=[];this.ranks=[];for(var B=0;B<this.maxRank+1;B++){E[B]=[];this.ranks[B]=E[B]}var A=null;if(this.roots!=null){var F=this.roots;A=[];for(var B=0;B<F.length;B++){var D=F[B];var C=this.vertexMapper.get(D);A[B]=C}}this.visit(function(M,J,I,K,G){if(G==0&&J.maxRank<0&&J.minRank<0){E[J.temp[0]].push(J);J.maxRank=J.temp[0];J.minRank=J.temp[0];J.temp[0]=E[J.maxRank].length-1}if(M!=null&&I!=null){var L=M.maxRank-J.maxRank;if(L>1){I.maxRank=M.maxRank;I.minRank=J.maxRank;I.temp=[];I.x=[];I.y=[];for(var H=I.minRank+1;H<I.maxRank;H++){E[H].push(I);I.setGeneralPurposeVariable(H,E[H].length-1)}}}},A,false,null)};mxGraphHierarchyModel.prototype.visit=function(C,D,F,E){if(D!=null){for(var B=0;B<D.length;B++){var A=D[B];if(A!=null){if(E==null){E=new Object()}if(F){A.hashCode=[];A.hashCode[0]=this.dfsCount;A.hashCode[1]=B;this.extendedDfs(null,A,null,C,E,A.hashCode,B,0)}else{this.dfs(null,A,null,C,E,0)}}}this.dfsCount++}};mxGraphHierarchyModel.prototype.dfs=function(J,G,K,C,F,I){if(G!=null){var D=G.id;if(F[D]==null){F[D]=G;C(J,G,K,I,0);var A=G.connectsAsSource.slice();for(var H=0;H<A.length;H++){var B=A[H];var E=B.target;this.dfs(G,E,B,C,F,I+1)}}else{C(J,G,K,I,1)}}};mxGraphHierarchyModel.prototype.extendedDfs=function(L,F,N,C,I,H,K,M){if(F!=null){if(L!=null){if(F.hashCode==null||F.hashCode[0]!=L.hashCode[0]){var A=L.hashCode.length+1;F.hashCode=L.hashCode.slice();F.hashCode[A-1]=K}}var D=F.id;if(I[D]==null){I[D]=F;C(L,F,N,M,0);var G=F.connectsAsSource.slice();for(var J=0;J<G.length;J++){var B=G[J];var E=B.target;this.extendedDfs(F,E,B,C,I,F.hashCode,J,M+1)}}else{C(L,F,N,M,1)}}};function mxSwimlaneModel(H,I,N,M,O){var C=H.getGraph();this.tightenToSource=O;this.roots=N;this.parent=M;this.vertexMapper=new mxDictionary();this.edgeMapper=new mxDictionary();this.maxRank=0;var L=[];if(I==null){I=this.graph.getChildVertices(M)}this.maxRank=this.SOURCESCANSTARTRANK;this.createInternalCells(H,I,L);for(var G=0;G<I.length;G++){var B=L[G].connectsAsSource;for(var E=0;E<B.length;E++){var A=B[E];var F=A.edges;if(F!=null&&F.length>0){var D=F[0];var K=H.getVisibleTerminal(D,false);var J=this.vertexMapper.get(K);if(L[G]==J){K=H.getVisibleTerminal(D,true);J=this.vertexMapper.get(K)}if(J!=null&&L[G]!=J){A.target=J;if(J.connectsAsTarget.length==0){J.connectsAsTarget=[]}if(mxUtils.indexOf(J.connectsAsTarget,A)<0){J.connectsAsTarget.push(A)}}}}L[G].temp[0]=1}}mxSwimlaneModel.prototype.maxRank=null;mxSwimlaneModel.prototype.vertexMapper=null;mxSwimlaneModel.prototype.edgeMapper=null;mxSwimlaneModel.prototype.ranks=null;mxSwimlaneModel.prototype.roots=null;mxSwimlaneModel.prototype.parent=null;mxSwimlaneModel.prototype.dfsCount=0;mxSwimlaneModel.prototype.SOURCESCANSTARTRANK=100000000;mxGraphHierarchyModel.prototype.tightenToSource=false;mxSwimlaneModel.prototype.ranksPerGroup=null;mxSwimlaneModel.prototype.createInternalCells=function(H,I,N){var B=H.getGraph();var O=H.swimlanes;for(var G=0;G<I.length;G++){N[G]=new mxGraphHierarchyNode(I[G]);this.vertexMapper.put(I[G],N[G]);N[G].swimlaneIndex=-1;for(var D=0;D<O.length;D++){if(B.model.getParent(I[G])==O[D]){N[G].swimlaneIndex=D;break}}var F=H.getEdges(I[G]);N[G].connectsAsSource=[];for(var E=0;E<F.length;E++){var L=H.getVisibleTerminal(F[E],false);if(L!=I[G]&&H.graph.model.isVertex(L)&&!H.isVertexIgnored(L)){var C=H.getEdgesBetween(I[G],L,false);var M=H.getEdgesBetween(I[G],L,true);if(C!=null&&C.length>0&&this.edgeMapper.get(C[0])==null&&M.length*2>=C.length){var A=new mxGraphHierarchyEdge(C);for(var K=0;K<C.length;K++){var J=C[K];this.edgeMapper.put(J,A);B.resetEdge(J);if(H.disableEdgeStyle){H.setEdgeStyleEnabled(J,false);H.setOrthogonalEdge(J,true)}}A.source=N[G];if(mxUtils.indexOf(N[G].connectsAsSource,A)<0){N[G].connectsAsSource.push(A)}}}}N[G].temp[0]=0}};mxSwimlaneModel.prototype.initialRank=function(){this.ranksPerGroup=[];var M=[];var J=new Object();if(this.roots!=null){for(var K=0;K<this.roots.length;K++){var A=this.vertexMapper.get(this.roots[K]);this.maxChainDfs(null,A,null,J,0);if(A!=null){M.push(A)}}}var E=[];var H=[];for(var K=this.ranksPerGroup.length-1;K>=0;K--){if(K==this.ranksPerGroup.length-1){E[K]=0}else{E[K]=H[K+1]+1}H[K]=E[K]+this.ranksPerGroup[K]}this.maxRank=H[0];var F=this.vertexMapper.getValues();for(var K=0;K<F.length;K++){F[K].temp[0]=-1}var D=M.slice();while(M.length>0){var A=M[0];var I;var O;I=A.connectsAsTarget;O=A.connectsAsSource;var N=true;var G=H[0];for(var K=0;K<I.length;K++){var B=I[K];if(B.temp[0]==5270620){var L=B.source;G=Math.min(G,L.temp[0]-1)}else{N=false;break}}if(N){if(G>H[A.swimlaneIndex]){G=H[A.swimlaneIndex]}A.temp[0]=G;if(O!=null){for(var K=0;K<O.length;K++){var B=O[K];B.temp[0]=5270620;var L=B.target;if(L.temp[0]==-1){M.push(L);L.temp[0]=-2}}}M.shift()}else{var C=M.shift();M.push(A);if(C==A&&M.length==1){break}}}};mxSwimlaneModel.prototype.maxChainDfs=function(J,E,K,G,I){if(E!=null){var F=mxCellPath.create(E.cell);if(G[F]==null){G[F]=E;var C=E.swimlaneIndex;if(this.ranksPerGroup[C]==null||this.ranksPerGroup[C]<I){this.ranksPerGroup[C]=I}var A=E.connectsAsSource.slice();for(var H=0;H<A.length;H++){var B=A[H];var D=B.target;if(E.swimlaneIndex<D.swimlaneIndex){this.maxChainDfs(E,D,B,mxUtils.clone(G,null,true),0)}else{if(E.swimlaneIndex==D.swimlaneIndex){this.maxChainDfs(E,D,B,mxUtils.clone(G,null,true),I+1)}}}}}};mxSwimlaneModel.prototype.fixRanks=function(){var E=[];this.ranks=[];for(var B=0;B<this.maxRank+1;B++){E[B]=[];this.ranks[B]=E[B]}var A=null;if(this.roots!=null){var F=this.roots;A=[];for(var B=0;B<F.length;B++){var D=F[B];var C=this.vertexMapper.get(D);A[B]=C}}this.visit(function(M,J,I,K,G){if(G==0&&J.maxRank<0&&J.minRank<0){E[J.temp[0]].push(J);J.maxRank=J.temp[0];J.minRank=J.temp[0];J.temp[0]=E[J.maxRank].length-1}if(M!=null&&I!=null){var L=M.maxRank-J.maxRank;if(L>1){I.maxRank=M.maxRank;I.minRank=J.maxRank;I.temp=[];I.x=[];I.y=[];for(var H=I.minRank+1;H<I.maxRank;H++){E[H].push(I);I.setGeneralPurposeVariable(H,E[H].length-1)}}}},A,false,null)};mxSwimlaneModel.prototype.visit=function(C,D,F,E){if(D!=null){for(var B=0;B<D.length;B++){var A=D[B];if(A!=null){if(E==null){E=new Object()}if(F){A.hashCode=[];A.hashCode[0]=this.dfsCount;A.hashCode[1]=B;this.extendedDfs(null,A,null,C,E,A.hashCode,B,0)}else{this.dfs(null,A,null,C,E,0)}}}this.dfsCount++}};mxSwimlaneModel.prototype.dfs=function(J,G,K,C,F,I){if(G!=null){var D=G.id;if(F[D]==null){F[D]=G;C(J,G,K,I,0);var A=G.connectsAsSource.slice();for(var H=0;H<A.length;H++){var B=A[H];var E=B.target;this.dfs(G,E,B,C,F,I+1)}}else{C(J,G,K,I,1)}}};mxSwimlaneModel.prototype.extendedDfs=function(M,G,O,C,J,I,L,N){if(G!=null){if(M!=null){if(G.hashCode==null||G.hashCode[0]!=M.hashCode[0]){var A=M.hashCode.length+1;G.hashCode=M.hashCode.slice();G.hashCode[A-1]=L}}var D=G.id;if(J[D]==null){J[D]=G;C(M,G,O,N,0);var H=G.connectsAsSource.slice();var E=G.connectsAsTarget.slice();for(var K=0;K<H.length;K++){var B=H[K];var F=B.target;if(G.swimlaneIndex<=F.swimlaneIndex){this.extendedDfs(G,F,B,C,J,G.hashCode,K,N+1)}}for(var K=0;K<E.length;K++){var B=E[K];var F=B.source;if(G.swimlaneIndex<F.swimlaneIndex){this.extendedDfs(G,F,B,C,J,G.hashCode,K,N+1)}}}else{C(M,G,O,N,1)}}};
function mxHierarchicalLayoutStage(){}mxHierarchicalLayoutStage.prototype.execute=function(A){};function mxMedianHybridCrossingReduction(A){this.layout=A}mxMedianHybridCrossingReduction.prototype=new mxHierarchicalLayoutStage();mxMedianHybridCrossingReduction.prototype.constructor=mxMedianHybridCrossingReduction;mxMedianHybridCrossingReduction.prototype.layout=null;mxMedianHybridCrossingReduction.prototype.maxIterations=24;mxMedianHybridCrossingReduction.prototype.nestedBestRanks=null;mxMedianHybridCrossingReduction.prototype.currentBestCrossings=0;mxMedianHybridCrossingReduction.prototype.iterationsWithoutImprovement=0;mxMedianHybridCrossingReduction.prototype.maxNoImprovementIterations=2;mxMedianHybridCrossingReduction.prototype.execute=function(J){var K=this.layout.getModel();this.nestedBestRanks=[];for(var D=0;D<K.ranks.length;D++){this.nestedBestRanks[D]=K.ranks[D].slice()}var H=0;var I=this.calculateCrossings(K);for(var D=0;D<this.maxIterations&&H<this.maxNoImprovementIterations;D++){this.weightedMedian(D,K);this.transpose(D,K);var F=this.calculateCrossings(K);if(F<I){I=F;H=0;for(var B=0;B<this.nestedBestRanks.length;B++){var C=K.ranks[B];for(var E=0;E<C.length;E++){var L=C[E];this.nestedBestRanks[B][L.getGeneralPurposeVariable(B)]=L}}}else{H++;for(var B=0;B<this.nestedBestRanks.length;B++){var C=K.ranks[B];for(var E=0;E<C.length;E++){var L=C[E];L.setGeneralPurposeVariable(B,E)}}}if(I==0){break}}var A=[];var G=[];for(var D=0;D<K.maxRank+1;D++){G[D]=[];A[D]=G[D]}for(var D=0;D<this.nestedBestRanks.length;D++){for(var B=0;B<this.nestedBestRanks[D].length;B++){G[D].push(this.nestedBestRanks[D][B])}}K.ranks=A};mxMedianHybridCrossingReduction.prototype.calculateCrossings=function(D){var B=D.ranks.length;var C=0;for(var A=1;A<B;A++){C+=this.calculateRankCrossing(A,D)}return C};mxMedianHybridCrossingReduction.prototype.calculateRankCrossing=function(S,D){var L=0;var A=D.ranks[S];var H=D.ranks[S-1];var M=[];for(var P=0;P<A.length;P++){var O=A[P];var B=O.getGeneralPurposeVariable(S);var I=O.getPreviousLayerConnectedCells(S);var N=[];for(var E=0;E<I.length;E++){var G=I[E];var R=G.getGeneralPurposeVariable(S-1);N.push(R)}N.sort(function(U,V){return U-V});M[B]=N}var Q=[];for(var P=0;P<M.length;P++){Q=Q.concat(M[P])}var F=1;while(F<H.length){F<<=1}var J=2*F-1;F-=1;var T=[];for(var P=0;P<J;++P){T[P]=0}for(var P=0;P<Q.length;P++){var C=Q[P];var K=C+F;++T[K];while(K>0){if(K%2){L+=T[K+1]}K=(K-1)>>1;++T[K]}}return L};mxMedianHybridCrossingReduction.prototype.transpose=function(Y,G){var C=true;var S=0;var Z=10;while(C&&S++<Z){var N=Y%2==1&&S%2==1;C=false;for(var I=0;I<G.ranks.length;I++){var A=G.ranks[I];var W=[];for(var U=0;U<A.length;U++){var O=A[U];var P=O.getGeneralPurposeVariable(I);if(P<0){P=U}W[P]=O}var M=null;var K=null;var E=null;var a=null;var B=null;var X=null;var D=null;var V=null;var Q=null;var L=null;for(var U=0;U<(A.length-1);U++){if(U==0){Q=W[U];M=Q.getNextLayerConnectedCells(I);K=Q.getPreviousLayerConnectedCells(I);B=[];X=[];for(var H=0;H<M.length;H++){B[H]=M[H].getGeneralPurposeVariable(I+1)}for(var H=0;H<K.length;H++){X[H]=K[H].getGeneralPurposeVariable(I-1)}}else{M=E;K=a;B=D;X=V;Q=L}L=W[U+1];E=L.getNextLayerConnectedCells(I);a=L.getPreviousLayerConnectedCells(I);D=[];V=[];for(var H=0;H<E.length;H++){D[H]=E[H].getGeneralPurposeVariable(I+1)}for(var H=0;H<a.length;H++){V[H]=a[H].getGeneralPurposeVariable(I-1)}var R=0;var J=0;for(var H=0;H<B.length;H++){for(var F=0;F<D.length;F++){if(B[H]>D[F]){R++}if(B[H]<D[F]){J++}}}for(var H=0;H<X.length;H++){for(var F=0;F<V.length;F++){if(X[H]>V[F]){R++}if(X[H]<V[F]){J++}}}if((J<R)||(J==R&&N)){var T=Q.getGeneralPurposeVariable(I);Q.setGeneralPurposeVariable(I,L.getGeneralPurposeVariable(I));L.setGeneralPurposeVariable(I,T);E=M;a=K;D=B;V=X;L=Q;if(!N){C=true}}}}}};mxMedianHybridCrossingReduction.prototype.weightedMedian=function(A,C){var B=(A%2==0);if(B){for(var D=C.maxRank-1;D>=0;D--){this.medianRank(D,B)}}else{for(var D=1;D<C.maxRank;D++){this.medianRank(D,B)}}};mxMedianHybridCrossingReduction.prototype.medianRank=function(G,B){var C=this.nestedBestRanks[G].length;var E=[];var I=[];for(var F=0;F<C;F++){var J=this.nestedBestRanks[G][F];var H=new MedianCellSorter();H.cell=J;var A;if(B){A=J.getNextLayerConnectedCells(G)}else{A=J.getPreviousLayerConnectedCells(G)}var D;if(B){D=G+1}else{D=G-1}if(A!=null&&A.length!=0){H.medianValue=this.medianValue(A,D);E.push(H)}else{I[J.getGeneralPurposeVariable(G)]=true}}E.sort(MedianCellSorter.prototype.compare);for(var F=0;F<C;F++){if(I[F]==null){var J=E.shift().cell;J.setGeneralPurposeVariable(G,F)}}};mxMedianHybridCrossingReduction.prototype.medianValue=function(E,G){var B=[];var C=0;for(var D=0;D<E.length;D++){var I=E[D];B[C++]=I.getGeneralPurposeVariable(G)}B.sort(function(K,J){return K-J});if(C%2==1){return B[Math.floor(C/2)]}else{if(C==2){return((B[0]+B[1])/2)}else{var H=C/2;var F=B[H-1]-B[0];var A=B[C-1]-B[H];return(B[H-1]*A+B[H]*F)/(F+A)}}};function MedianCellSorter(){}MedianCellSorter.prototype.medianValue=0;MedianCellSorter.prototype.cell=false;MedianCellSorter.prototype.compare=function(B,A){if(B!=null&&A!=null){if(A.medianValue>B.medianValue){return -1}else{if(A.medianValue<B.medianValue){return 1}else{return 0}}}else{return 0}};function mxMinimumCycleRemover(A){this.layout=A}mxMinimumCycleRemover.prototype=new mxHierarchicalLayoutStage();mxMinimumCycleRemover.prototype.constructor=mxMinimumCycleRemover;mxMinimumCycleRemover.prototype.layout=null;mxMinimumCycleRemover.prototype.execute=function(G){var H=this.layout.getModel();var A=new Object();var E=H.vertexMapper.getValues();var I=new Object();for(var C=0;C<E.length;C++){I[E[C].id]=E[C]}var B=null;if(H.roots!=null){var F=H.roots;B=[];for(var C=0;C<F.length;C++){B[C]=H.vertexMapper.get(F[C])}}H.visit(function(M,K,N,L,J){if(K.isAncestor(M)){N.invert();mxUtils.remove(N,M.connectsAsSource);M.connectsAsTarget.push(N);mxUtils.remove(N,K.connectsAsTarget);K.connectsAsSource.push(N)}A[K.id]=K;delete I[K.id]},B,true,null);var D=mxUtils.clone(A,null,true);H.visit(function(M,K,N,L,J){if(K.isAncestor(M)){N.invert();mxUtils.remove(N,M.connectsAsSource);K.connectsAsSource.push(N);M.connectsAsTarget.push(N);mxUtils.remove(N,K.connectsAsTarget)}A[K.id]=K;delete I[K.id]},I,true,D)};function mxCoordinateAssignment(F,A,B,C,D,E){this.layout=F;this.intraCellSpacing=A;this.interRankCellSpacing=B;this.orientation=C;this.initialX=D;this.parallelEdgeSpacing=E}mxCoordinateAssignment.prototype=new mxHierarchicalLayoutStage();mxCoordinateAssignment.prototype.constructor=mxCoordinateAssignment;mxCoordinateAssignment.prototype.layout=null;mxCoordinateAssignment.prototype.intraCellSpacing=30;mxCoordinateAssignment.prototype.interRankCellSpacing=100;mxCoordinateAssignment.prototype.parallelEdgeSpacing=10;mxCoordinateAssignment.prototype.maxIterations=8;mxCoordinateAssignment.prototype.prefHozEdgeSep=5;mxCoordinateAssignment.prototype.prefVertEdgeOff=2;mxCoordinateAssignment.prototype.minEdgeJetty=12;mxCoordinateAssignment.prototype.channelBuffer=4;mxCoordinateAssignment.prototype.jettyPositions=null;mxCoordinateAssignment.prototype.orientation=mxConstants.DIRECTION_NORTH;mxCoordinateAssignment.prototype.initialX=null;mxCoordinateAssignment.prototype.limitX=null;mxCoordinateAssignment.prototype.currentXDelta=null;mxCoordinateAssignment.prototype.widestRank=null;mxCoordinateAssignment.prototype.rankTopY=null;mxCoordinateAssignment.prototype.rankBottomY=null;mxCoordinateAssignment.prototype.widestRankValue=null;mxCoordinateAssignment.prototype.rankWidths=null;mxCoordinateAssignment.prototype.rankY=null;mxCoordinateAssignment.prototype.fineTuning=true;mxCoordinateAssignment.prototype.nextLayerConnectedCache=null;mxCoordinateAssignment.prototype.previousLayerConnectedCache=null;mxCoordinateAssignment.prototype.groupPadding=10;mxCoordinateAssignment.prototype.printStatus=function(){var D=this.layout.getModel();mxLog.show();mxLog.writeln("======Coord assignment debug=======");for(var E=0;E<D.ranks.length;E++){mxLog.write("Rank ",E," : ");var B=D.ranks[E];for(var A=0;A<B.length;A++){var C=B[A];mxLog.write(C.getGeneralPurposeVariable(E),"  ")}mxLog.writeln()}mxLog.writeln("====================================")};mxCoordinateAssignment.prototype.execute=function(F){this.jettyPositions=Object();var G=this.layout.getModel();this.currentXDelta=0;this.initialCoords(this.layout.getGraph(),G);if(this.fineTuning){this.minNode(G)}var A=100000000;if(this.fineTuning){for(var D=0;D<this.maxIterations;D++){if(D!=0){this.medianPos(D,G);this.minNode(G)}if(this.currentXDelta<A){for(var B=0;B<G.ranks.length;B++){var C=G.ranks[B];for(var E=0;E<C.length;E++){var H=C[E];H.setX(B,H.getGeneralPurposeVariable(B))}}A=this.currentXDelta}else{for(var B=0;B<G.ranks.length;B++){var C=G.ranks[B];for(var E=0;E<C.length;E++){var H=C[E];H.setGeneralPurposeVariable(B,H.getX(B))}}}this.minPath(this.layout.getGraph(),G);this.currentXDelta=0}}this.setCellLocations(this.layout.getGraph(),G)};mxCoordinateAssignment.prototype.minNode=function(D){var C=[];var V=new mxDictionary();var A=[];for(var F=0;F<=D.maxRank;F++){A[F]=D.ranks[F];for(var Y=0;Y<A[F].length;Y++){var W=A[F][Y];var G=new WeightedCellSorter(W,F);G.rankIndex=Y;G.visited=true;C.push(G);V.put(W,G)}}var T=C.length*10;var U=0;var b=1;while(C.length>0&&U<=T){var S=C.shift();var P=S.cell;var f=S.weightedValue;var Z=parseInt(S.rankIndex);var L=P.getNextLayerConnectedCells(f);var R=P.getPreviousLayerConnectedCells(f);var J=L.length;var X=R.length;var Q=this.medianXValue(L,f+1);var O=this.medianXValue(R,f-1);var H=J+X;var c=P.getGeneralPurposeVariable(f);var K=c;if(H>0){K=(Q*J+O*X)/H}var E=false;if(K<c-b){if(Z==0){P.setGeneralPurposeVariable(f,K);E=true}else{var I=A[f][Z-1];var a=I.getGeneralPurposeVariable(f);a=a+I.width/2+this.intraCellSpacing+P.width/2;if(a<K){P.setGeneralPurposeVariable(f,K);E=true}else{if(a<P.getGeneralPurposeVariable(f)-b){P.setGeneralPurposeVariable(f,a);E=true}}}}else{if(K>c+b){var M=A[f].length;if(Z==M-1){P.setGeneralPurposeVariable(f,K);E=true}else{var e=A[f][Z+1];var B=e.getGeneralPurposeVariable(f);B=B-e.width/2-this.intraCellSpacing-P.width/2;if(B>K){P.setGeneralPurposeVariable(f,K);E=true}else{if(B>P.getGeneralPurposeVariable(f)+b){P.setGeneralPurposeVariable(f,B);E=true}}}}}if(E){for(var F=0;F<L.length;F++){var N=L[F];var d=V.get(N);if(d!=null){if(d.visited==false){d.visited=true;C.push(d)}}}for(var F=0;F<R.length;F++){var N=R[F];var d=V.get(N);if(d!=null){if(d.visited==false){d.visited=true;C.push(d)}}}}S.visited=false;U++}};mxCoordinateAssignment.prototype.medianPos=function(A,C){var B=(A%2==0);if(B){for(var D=C.maxRank;D>0;D--){this.rankMedianPosition(D-1,C,D)}}else{for(var D=0;D<C.maxRank-1;D++){this.rankMedianPosition(D+1,C,D)}}};mxCoordinateAssignment.prototype.rankMedianPosition=function(T,D,B){var A=D.ranks[T];var I=[];var N=new Object();for(var E=0;E<A.length;E++){var M=A[E];I[E]=new WeightedCellSorter();I[E].cell=M;I[E].rankIndex=E;N[M.id]=I[E];var H=null;if(B<T){H=M.getPreviousLayerConnectedCells(T)}else{H=M.getNextLayerConnectedCells(T)}I[E].weightedValue=this.calculatedWeightedValue(M,H)}I.sort(WeightedCellSorter.prototype.compare);for(var E=0;E<I.length;E++){var F=0;var J=I[E].cell;var H=null;var K=0;if(B<T){H=J.getPreviousLayerConnectedCells(T).slice()}else{H=J.getNextLayerConnectedCells(T).slice()}if(H!=null){F=H.length;if(F>0){K=this.medianXValue(H,B)}else{K=J.getGeneralPurposeVariable(T)}}var O=0;var R=-100000000;for(var Q=I[E].rankIndex-1;Q>=0;){var P=N[A[Q].id];if(P!=null){var L=P.cell;if(P.visited){R=L.getGeneralPurposeVariable(T)+L.width/2+this.intraCellSpacing+O+J.width/2;Q=-1}else{O+=L.width+this.intraCellSpacing;Q--}}}var G=0;var C=100000000;for(var Q=I[E].rankIndex+1;Q<I.length;){var P=N[A[Q].id];if(P!=null){var S=P.cell;if(P.visited){C=S.getGeneralPurposeVariable(T)-S.width/2-this.intraCellSpacing-G-J.width/2;Q=I.length}else{G+=S.width+this.intraCellSpacing;Q++}}}if(K>=R&&K<=C){J.setGeneralPurposeVariable(T,K)}else{if(K<R){J.setGeneralPurposeVariable(T,R);this.currentXDelta+=R-K}else{if(K>C){J.setGeneralPurposeVariable(T,C);this.currentXDelta+=K-C}}}I[E].visited=true}};mxCoordinateAssignment.prototype.calculatedWeightedValue=function(A,C){var D=0;for(var B=0;B<C.length;B++){var E=C[B];if(A.isVertex()&&E.isVertex()){D++}else{if(A.isEdge()&&E.isEdge()){D+=8}else{D+=2}}}return D};mxCoordinateAssignment.prototype.medianXValue=function(A,C){if(A.length==0){return 0}var D=[];for(var B=0;B<A.length;B++){D[B]=A[B].getGeneralPurposeVariable(C)}D.sort(function(I,H){return I-H});if(A.length%2==1){return D[Math.floor(A.length/2)]}else{var E=A.length/2;var G=D[E-1];var F=D[E];return((G+F)/2)}};mxCoordinateAssignment.prototype.initialCoords=function(A,C){this.calculateWidestRank(A,C);for(var B=this.widestRank;B>=0;B--){if(B<C.maxRank){this.rankCoordinates(B,A,C)}}for(var B=this.widestRank+1;B<=C.maxRank;B++){if(B>0){this.rankCoordinates(B,A,C)}}};mxCoordinateAssignment.prototype.rankCoordinates=function(J,C,K){var E=K.ranks[J];var B=0;var G=this.initialX+(this.widestRankValue-this.rankWidths[J])/2;var F=false;for(var I=0;I<E.length;I++){var H=E[I];if(H.isVertex()){var A=this.layout.getVertexBounds(H.cell);if(A!=null){if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){H.width=A.width;H.height=A.height}else{H.width=A.height;H.height=A.width}}else{F=true}B=Math.max(B,H.height)}else{if(H.isEdge()){var D=1;if(H.edges!=null){D=H.edges.length}else{mxLog.warn("edge.edges is null")}H.width=(D-1)*this.parallelEdgeSpacing}}G+=H.width/2;H.setX(J,G);H.setGeneralPurposeVariable(J,G);G+=H.width/2;G+=this.intraCellSpacing}if(F==true){mxLog.warn("At least one cell has no bounds")}};mxCoordinateAssignment.prototype.calculateWidestRank=function(B,N){var L=-this.interRankCellSpacing;var E=0;this.rankWidths=[];this.rankY=[];for(var K=N.maxRank;K>=0;K--){var J=0;var D=N.ranks[K];var G=this.initialX;var F=false;for(var I=0;I<D.length;I++){var H=D[I];if(H.isVertex()){var A=this.layout.getVertexBounds(H.cell);if(A!=null){if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){H.width=A.width;H.height=A.height}else{H.width=A.height;H.height=A.width}}else{F=true}J=Math.max(J,H.height)}else{if(H.isEdge()){var C=1;if(H.edges!=null){C=H.edges.length}else{mxLog.warn("edge.edges is null")}H.width=(C-1)*this.parallelEdgeSpacing}}G+=H.width/2;H.setX(K,G);H.setGeneralPurposeVariable(K,G);G+=H.width/2;G+=this.intraCellSpacing;if(G>this.widestRankValue){this.widestRankValue=G;this.widestRank=K}this.rankWidths[K]=G}if(F==true){mxLog.warn("At least one cell has no bounds")}this.rankY[K]=L;var M=J/2+E/2+this.interRankCellSpacing;E=J;if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_WEST){L+=M}else{L-=M}for(var I=0;I<D.length;I++){var O=D[I];O.setY(K,L)}}};mxCoordinateAssignment.prototype.minPath=function(C,O){var B=O.edgeMapper.getValues();for(var F=0;F<B.length;F++){var P=B[F];if(P.maxRank-P.minRank-1<1){continue}var G=P.getGeneralPurposeVariable(P.minRank+1);var M=true;var J=0;for(var H=P.minRank+2;H<P.maxRank;H++){var L=P.getGeneralPurposeVariable(H);if(G!=L){M=false;G=L}else{J++}}if(!M){var N=0;var E=0;var K=[];var A=[];var I=P.getGeneralPurposeVariable(P.minRank+1);for(var H=P.minRank+1;H<P.maxRank-1;H++){var D=P.getX(H+1);if(I==D){K[H-P.minRank-1]=I;N++}else{if(this.repositionValid(O,P,H+1,I)){K[H-P.minRank-1]=I;N++}else{K[H-P.minRank-1]=D;I=D}}}I=P.getX(H);for(var H=P.maxRank-1;H>P.minRank+1;H--){var D=P.getX(H-1);if(I==D){A[H-P.minRank-2]=I;E++}else{if(this.repositionValid(O,P,H-1,I)){A[H-P.minRank-2]=I;E++}else{A[H-P.minRank-2]=P.getX(H-1);I=D}}}if(E>J||N>J){if(E>=N){for(var H=P.maxRank-2;H>P.minRank;H--){P.setX(H,A[H-P.minRank-1])}}else{if(N>E){for(var H=P.minRank+2;H<P.maxRank;H++){P.setX(H,K[H-P.minRank-2])}}else{}}}}}};mxCoordinateAssignment.prototype.repositionValid=function(K,L,E,G){var J=K.ranks[E];var B=-1;for(var F=0;F<J.length;F++){if(L==J[F]){B=F;break}}if(B<0){return false}var I=L.getGeneralPurposeVariable(E);if(G<I){if(B==0){return true}var A=J[B-1];var H=A.getGeneralPurposeVariable(E);H=H+A.width/2+this.intraCellSpacing+L.width/2;if(H<=G){return true}else{return false}}else{if(G>I){if(B==J.length-1){return true}var C=J[B+1];var D=C.getGeneralPurposeVariable(E);D=D-C.width/2-this.intraCellSpacing-L.width/2;if(D>=G){return true}else{return false}}}return true};mxCoordinateAssignment.prototype.setCellLocations=function(D,E){this.rankTopY=[];this.rankBottomY=[];for(var A=0;A<E.ranks.length;A++){this.rankTopY[A]=Number.MAX_VALUE;this.rankBottomY[A]=-Number.MAX_VALUE}var C=E.vertexMapper.getValues();for(var A=0;A<C.length;A++){this.setVertexLocation(C[A])}if(this.layout.edgeStyle==mxHierarchicalEdgeStyle.ORTHOGONAL||this.layout.edgeStyle==mxHierarchicalEdgeStyle.POLYLINE||this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE){this.localEdgeProcessing(E)}var B=E.edgeMapper.getValues();for(var A=0;A<B.length;A++){this.setEdgePosition(B[A])}};mxCoordinateAssignment.prototype.localEdgeProcessing=function(E){for(var L=0;L<E.ranks.length;L++){var A=E.ranks[L];for(var G=0;G<A.length;G++){var N=A[G];if(N.isVertex()){var H=N.getPreviousLayerConnectedCells(L);var Z=L-1;for(var F=0;F<2;F++){if(Z>-1&&Z<E.ranks.length&&H!=null&&H.length>0){var S=[];for(var V=0;V<H.length;V++){var U=new WeightedCellSorter(H[V],H[V].getX(Z));S.push(U)}S.sort(WeightedCellSorter.prototype.compare);var Y=N.x[0]-N.width/2;var C=Y+N.width;var M=0;var B=0;var K=[];for(var V=0;V<S.length;V++){var R=S[V].cell;var W;if(R.isVertex()){if(F==0){W=N.connectsAsSource}else{W=N.connectsAsTarget}for(var I=0;I<W.length;I++){if(W[I].source==R||W[I].target==R){M+=W[I].edges.length;B++;K.push(W[I])}}}else{M+=R.edges.length;B++;K.push(R)}}var D=(M+1)*this.prefHozEdgeSep;if(N.width>D+(2*this.prefHozEdgeSep)){Y+=this.prefHozEdgeSep;C-=this.prefHozEdgeSep}var b=C-Y;var T=b/M;var Q=Y+T/2;var P=this.minEdgeJetty-this.prefVertEdgeOff;var X=0;for(var V=0;V<K.length;V++){var O=K[V].edges.length;var a=this.jettyPositions[K[V].ids[0]];if(a==null){a=[];this.jettyPositions[K[V].ids[0]]=a}if(V<M/2){P+=this.prefVertEdgeOff}else{if(V>M/2){P-=this.prefVertEdgeOff}}for(var J=0;J<O;J++){a[J*4+F*2]=Q;Q+=T;a[J*4+F*2+1]=P}X=Math.max(X,P)}}H=N.getNextLayerConnectedCells(L);Z=L+1}}}}};mxCoordinateAssignment.prototype.setEdgePosition=function(Q){var F=0;if(Q.temp[0]!=101207){var N=Q.maxRank;var L=Q.minRank;if(N==L){N=Q.source.maxRank;L=Q.target.minRank}var A=0;var Z=this.jettyPositions[Q.ids[0]];var R=Q.isReversed?Q.target.cell:Q.source.cell;var a=this.layout.graph;var H=this.orientation==mxConstants.DIRECTION_EAST||this.orientation==mxConstants.DIRECTION_SOUTH;for(var I=0;I<Q.edges.length;I++){var B=Q.edges[I];var X=this.layout.getVisibleTerminal(B,true);var E=[];var K=Q.isReversed;if(X!=R){K=!K}if(Z!=null){var b=K?2:0;var e=K?(H?this.rankBottomY[L]:this.rankTopY[L]):(H?this.rankTopY[N]:this.rankBottomY[N]);var V=Z[A*4+1+b];if(K!=H){V=-V}e+=V;var d=Z[A*4+b];var M=a.model.getTerminal(B,true);if(this.layout.isPort(M)&&a.model.getParent(M)==X){var J=a.view.getState(M);if(J!=null){d=J.x}else{d=X.geometry.x+Q.source.width*M.geometry.x}}if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){E.push(new mxPoint(d,e));if(this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE){E.push(new mxPoint(d,e+V))}}else{E.push(new mxPoint(e,d));if(this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE){E.push(new mxPoint(e+V,d))}}}var c=Q.x.length-1;var G=-1;var P=-1;var U=Q.maxRank-1;if(K){c=0;G=Q.x.length;P=1;U=Q.minRank+1}for(var T=c;(Q.maxRank!=Q.minRank)&&T!=G;T+=P){var W=Q.x[T]+F;var Y=(this.rankTopY[U]+this.rankBottomY[U+1])/2;var f=(this.rankTopY[U-1]+this.rankBottomY[U])/2;if(K){var D=Y;Y=f;f=D}if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){E.push(new mxPoint(W,Y));E.push(new mxPoint(W,f))}else{E.push(new mxPoint(Y,W));E.push(new mxPoint(f,W))}this.limitX=Math.max(this.limitX,W);U+=P}if(Z!=null){var b=K?2:0;var C=K?(H?this.rankTopY[N]:this.rankBottomY[N]):(H?this.rankBottomY[L]:this.rankTopY[L]);var V=Z[A*4+3-b];if(K!=H){V=-V}var e=C-V;var d=Z[A*4+2-b];var O=a.model.getTerminal(B,false);var S=this.layout.getVisibleTerminal(B,false);if(this.layout.isPort(O)&&a.model.getParent(O)==S){var J=a.view.getState(O);if(J!=null){d=J.x}else{d=S.geometry.x+Q.target.width*O.geometry.x}}if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){if(this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE){E.push(new mxPoint(d,e-V))}E.push(new mxPoint(d,e))}else{if(this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE){E.push(new mxPoint(e-V,d))}E.push(new mxPoint(e,d))}}if(Q.isReversed){this.processReversedEdge(Q,B)}this.layout.setEdgePoints(B,E);if(F==0){F=this.parallelEdgeSpacing}else{if(F>0){F=-F}else{F=-F+this.parallelEdgeSpacing}}A++}Q.temp[0]=101207}};mxCoordinateAssignment.prototype.setVertexLocation=function(D){var C=D.cell;var A=D.x[0]-D.width/2;var B=D.y[0]-D.height/2;this.rankTopY[D.minRank]=Math.min(this.rankTopY[D.minRank],B);this.rankBottomY[D.minRank]=Math.max(this.rankBottomY[D.minRank],B+D.height);if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){this.layout.setVertexLocation(C,A,B)}else{this.layout.setVertexLocation(C,B,A)}this.limitX=Math.max(this.limitX,A+D.width)};mxCoordinateAssignment.prototype.processReversedEdge=function(A,B){};function WeightedCellSorter(B,A){this.cell=B;this.weightedValue=A}WeightedCellSorter.prototype.weightedValue=0;WeightedCellSorter.prototype.nudge=false;WeightedCellSorter.prototype.visited=false;WeightedCellSorter.prototype.rankIndex=null;WeightedCellSorter.prototype.cell=null;WeightedCellSorter.prototype.compare=function(B,A){if(B!=null&&A!=null){if(A.weightedValue>B.weightedValue){return -1}else{if(A.weightedValue<B.weightedValue){return 1}else{if(A.nudge){return -1}else{return 1}}}}else{return 0}};function mxSwimlaneOrdering(A){this.layout=A}mxSwimlaneOrdering.prototype=new mxHierarchicalLayoutStage();mxSwimlaneOrdering.prototype.constructor=mxSwimlaneOrdering;mxSwimlaneOrdering.prototype.layout=null;mxSwimlaneOrdering.prototype.execute=function(F){var G=this.layout.getModel();var A=new Object();var H=mxUtils.clone(G.vertexMapper,null,true);var C=null;if(G.roots!=null){var E=G.roots;C=[];for(var D=0;D<E.length;D++){var B=mxCellPath.create(E[D]);C[D]=G.vertexMapper.get(E[D])}}G.visit(function(O,L,P,K,J){var N=O!=null&&O.swimlaneIndex==L.swimlaneIndex&&L.isAncestor(O);var I=O!=null&&P!=null&&O.swimlaneIndex<L.swimlaneIndex&&P.source==L;if(N){P.invert();mxUtils.remove(P,O.connectsAsSource);L.connectsAsSource.push(P);O.connectsAsTarget.push(P);mxUtils.remove(P,L.connectsAsTarget)}else{if(I){P.invert();mxUtils.remove(P,O.connectsAsTarget);L.connectsAsTarget.push(P);O.connectsAsSource.push(P);mxUtils.remove(P,L.connectsAsSource)}}var M=mxCellPath.create(L.cell);A[M]=L;delete H[M]},C,true,null)};
function mxHierarchicalLayout(B,A,C){mxGraphLayout.call(this,B);this.orientation=(A!=null)?A:mxConstants.DIRECTION_NORTH;this.deterministic=(C!=null)?C:true}var mxHierarchicalEdgeStyle={ORTHOGONAL:1,POLYLINE:2,STRAIGHT:3,CURVE:4};mxHierarchicalLayout.prototype=new mxGraphLayout();mxHierarchicalLayout.prototype.constructor=mxHierarchicalLayout;mxHierarchicalLayout.prototype.roots=null;mxHierarchicalLayout.prototype.resizeParent=false;mxHierarchicalLayout.prototype.maintainParentLocation=false;mxHierarchicalLayout.prototype.moveParent=false;mxHierarchicalLayout.prototype.parentBorder=0;mxHierarchicalLayout.prototype.intraCellSpacing=30;mxHierarchicalLayout.prototype.interRankCellSpacing=100;mxHierarchicalLayout.prototype.interHierarchySpacing=60;mxHierarchicalLayout.prototype.parallelEdgeSpacing=10;mxHierarchicalLayout.prototype.orientation=mxConstants.DIRECTION_NORTH;mxHierarchicalLayout.prototype.fineTuning=true;mxHierarchicalLayout.prototype.tightenToSource=true;mxHierarchicalLayout.prototype.disableEdgeStyle=true;mxHierarchicalLayout.prototype.traverseAncestors=true;mxHierarchicalLayout.prototype.model=null;mxHierarchicalLayout.prototype.edgesCache=null;mxHierarchicalLayout.prototype.edgeSourceTermCache=null;mxHierarchicalLayout.prototype.edgesTargetTermCache=null;mxHierarchicalLayout.prototype.edgeStyle=mxHierarchicalEdgeStyle.POLYLINE;mxHierarchicalLayout.prototype.getModel=function(){return this.model};mxHierarchicalLayout.prototype.execute=function(E,C){this.parent=E;var F=this.graph.model;this.edgesCache=new mxDictionary();this.edgeSourceTermCache=new mxDictionary();this.edgesTargetTermCache=new mxDictionary();if(C!=null&&!(C instanceof Array)){C=[C]}if(C==null&&E==null){return}this.parentX=null;this.parentY=null;if(E!=this.root&&F.isVertex(E)!=null&&this.maintainParentLocation){var G=this.graph.getCellGeometry(E);if(G!=null){this.parentX=G.x;this.parentY=G.y}}if(C!=null){var A=[];for(var B=0;B<C.length;B++){var D=E!=null?F.isAncestor(E,C[B]):true;if(D&&F.isVertex(C[B])){A.push(C[B])}}this.roots=A}F.beginUpdate();try{this.run(E);if(this.resizeParent&&!this.graph.isCellCollapsed(E)){this.graph.updateGroupBounds([E],this.parentBorder,this.moveParent)}if(this.parentX!=null&&this.parentY!=null){var G=this.graph.getCellGeometry(E);if(G!=null){G=G.clone();G.x=this.parentX;G.y=this.parentY;F.setGeometry(E,G)}}}finally{F.endUpdate()}};mxHierarchicalLayout.prototype.findRoots=function(L,I){var J=[];if(L!=null&&I!=null){var M=this.graph.model;var F=null;var A=-100000;for(var G in I){var N=I[G];if(M.isVertex(N)&&this.graph.isCellVisible(N)){var E=this.getEdges(N);var C=0;var K=0;for(var H=0;H<E.length;H++){var B=this.getVisibleTerminal(E[H],true);if(B==N){C++}else{K++}}if(K==0&&C>0){J.push(N)}var D=C-K;if(D>A){A=D;F=N}}}if(J.length==0&&F!=null){J.push(F)}}return J};mxHierarchicalLayout.prototype.getEdges=function(K){var E=this.edgesCache.get(K);if(E!=null){return E}var J=this.graph.model;var D=[];var B=this.graph.isCellCollapsed(K);var A=J.getChildCount(K);for(var F=0;F<A;F++){var I=J.getChildAt(K,F);if(this.isPort(I)){D=D.concat(J.getEdges(I,true,true))}else{if(B||!this.graph.isCellVisible(I)){D=D.concat(J.getEdges(I,true,true))}}}D=D.concat(J.getEdges(K,true,true));var C=[];for(var F=0;F<D.length;F++){var H=this.getVisibleTerminal(D[F],true);var G=this.getVisibleTerminal(D[F],false);if((H==G)||((H!=G)&&((G==K&&(this.parent==null||this.graph.isValidAncestor(H,this.parent,this.traverseAncestors)))||(H==K&&(this.parent==null||this.graph.isValidAncestor(G,this.parent,this.traverseAncestors)))))){C.push(D[F])}}this.edgesCache.put(K,C);return C};mxHierarchicalLayout.prototype.getVisibleTerminal=function(C,B){var A=this.edgesTargetTermCache;if(B){A=this.edgeSourceTermCache}var D=A.get(C);if(D!=null){return D}var F=this.graph.view.getState(C);var E=(F!=null)?F.getVisibleTerminal(B):this.graph.view.getVisibleTerminal(C,B);if(E==null){E=(F!=null)?F.getVisibleTerminal(B):this.graph.view.getVisibleTerminal(C,B)}if(E!=null){if(this.isPort(E)){E=this.graph.model.getParent(E)}A.put(C,E)}return E};mxHierarchicalLayout.prototype.run=function(J){var H=[];var A=[];if(this.roots==null&&J!=null){var B=Object();this.filterDescendants(J,B);this.roots=[];var K=true;for(var G in B){if(B[G]!=null){K=false;break}}while(!K){var F=this.findRoots(J,B);for(var E=0;E<F.length;E++){var C=Object();H.push(C);this.traverse(F[E],true,null,A,C,H,B)}for(var E=0;E<F.length;E++){this.roots.push(F[E])}K=true;for(var G in B){if(B[G]!=null){K=false;break}}}}else{for(var E=0;E<this.roots.length;E++){var C=Object();H.push(C);this.traverse(this.roots[E],true,null,A,C,H,null)}}var I=0;for(var E=0;E<H.length;E++){var C=H[E];var D=[];for(var G in C){D.push(C[G])}this.model=new mxGraphHierarchyModel(this,D,this.roots,J,this.tightenToSource);this.cycleStage(J);this.layeringStage();this.crossingStage(J);I=this.placementStage(I,J)}};mxHierarchicalLayout.prototype.filterDescendants=function(E,C){var F=this.graph.model;if(F.isVertex(E)&&E!=this.parent&&this.graph.isCellVisible(E)){C[mxObjectIdentity.get(E)]=E}if(this.traverseAncestors||E==this.parent&&this.graph.isCellVisible(E)){var A=F.getChildCount(E);for(var B=0;B<A;B++){var D=F.getChildAt(E,B);if(!this.isPort(D)){this.filterDescendants(D,C)}}}};mxHierarchicalLayout.prototype.isPort=function(A){if(A.geometry.relative){return true}return false};mxHierarchicalLayout.prototype.getEdgesBetween=function(F,G,H){H=(H!=null)?H:false;var C=this.getEdges(F);var A=[];for(var E=0;E<C.length;E++){var B=this.getVisibleTerminal(C[E],true);var D=this.getVisibleTerminal(C[E],false);if((B==F&&D==G)||(!H&&B==G&&D==F)){A.push(C[E])}}return A};mxHierarchicalLayout.prototype.traverse=function(I,C,A,L,Q,P,R){if(I!=null&&L!=null){var J=mxObjectIdentity.get(I);if((L[J]==null)&&(R==null?true:R[J]!=null)){if(Q[J]==null){Q[J]=I}if(L[J]==null){L[J]=I}if(R!==null){delete R[J]}var O=this.getEdges(I);var F=[];for(var E=0;E<O.length;E++){F[E]=(this.getVisibleTerminal(O[E],true)==I)}for(var E=0;E<O.length;E++){if(!C||F[E]){var K=this.getVisibleTerminal(O[E],!F[E]);var B=1;for(var D=0;D<O.length;D++){if(D==E){continue}else{var N=F[D];var H=this.getVisibleTerminal(O[D],!N);if(H==K){if(N){B++}else{B--}}}}if(B>=0){Q=this.traverse(K,C,O[E],L,Q,P,R)}}}}else{if(Q[J]==null){for(var E=0;E<P.length;E++){var G=P[E];if(G[J]!=null){for(var M in G){Q[M]=G[M]}P.splice(E,1);return Q}}}}}return Q};mxHierarchicalLayout.prototype.cycleStage=function(A){var B=new mxMinimumCycleRemover(this);B.execute(A)};mxHierarchicalLayout.prototype.layeringStage=function(){this.model.initialRank();this.model.fixRanks()};mxHierarchicalLayout.prototype.crossingStage=function(A){var B=new mxMedianHybridCrossingReduction(this);B.execute(A)};mxHierarchicalLayout.prototype.placementStage=function(B,C){var A=new mxCoordinateAssignment(this,this.intraCellSpacing,this.interRankCellSpacing,this.orientation,B,this.parallelEdgeSpacing);A.fineTuning=this.fineTuning;A.execute(C);return A.limitX+this.interHierarchySpacing};function mxSwimlaneLayout(B,A,C){mxGraphLayout.call(this,B);this.orientation=(A!=null)?A:mxConstants.DIRECTION_NORTH;this.deterministic=(C!=null)?C:true}mxSwimlaneLayout.prototype=new mxGraphLayout();mxSwimlaneLayout.prototype.constructor=mxSwimlaneLayout;mxSwimlaneLayout.prototype.roots=null;mxSwimlaneLayout.prototype.swimlanes=null;mxSwimlaneLayout.prototype.dummyVertices=null;mxSwimlaneLayout.prototype.dummyVertexWidth=50;mxSwimlaneLayout.prototype.resizeParent=false;mxSwimlaneLayout.prototype.maintainParentLocation=false;mxSwimlaneLayout.prototype.moveParent=false;mxSwimlaneLayout.prototype.parentBorder=30;mxSwimlaneLayout.prototype.intraCellSpacing=30;mxSwimlaneLayout.prototype.interRankCellSpacing=100;mxSwimlaneLayout.prototype.interHierarchySpacing=60;mxSwimlaneLayout.prototype.parallelEdgeSpacing=10;mxSwimlaneLayout.prototype.orientation=mxConstants.DIRECTION_NORTH;mxSwimlaneLayout.prototype.fineTuning=true;mxSwimlaneLayout.prototype.tightenToSource=true;mxSwimlaneLayout.prototype.disableEdgeStyle=true;mxSwimlaneLayout.prototype.traverseAncestors=true;mxSwimlaneLayout.prototype.model=null;mxSwimlaneLayout.prototype.edgesCache=null;mxHierarchicalLayout.prototype.edgeSourceTermCache=null;mxHierarchicalLayout.prototype.edgesTargetTermCache=null;mxHierarchicalLayout.prototype.edgeStyle=mxHierarchicalEdgeStyle.POLYLINE;mxSwimlaneLayout.prototype.getModel=function(){return this.model};mxSwimlaneLayout.prototype.execute=function(E,F){this.parent=E;var D=this.graph.model;this.edgesCache=new mxDictionary();this.edgeSourceTermCache=new mxDictionary();this.edgesTargetTermCache=new mxDictionary();if(F==null||F.length<1){return}if(E==null){E=D.getParent(F[0])}this.parentX=null;this.parentY=null;if(E!=this.root&&D.isVertex(E)!=null&&this.maintainParentLocation){var G=this.graph.getCellGeometry(E);if(G!=null){this.parentX=G.x;this.parentY=G.y}}this.swimlanes=F;this.dummyVertices=[];for(var B=0;B<F.length;B++){var A=this.graph.getChildCells(F[B]);if(A==null||A.length==0){var C=this.graph.insertVertex(F[B],null,null,0,0,this.dummyVertexWidth,0);this.dummyVertices.push(C)}}D.beginUpdate();try{this.run(E);if(this.resizeParent&&!this.graph.isCellCollapsed(E)){this.graph.updateGroupBounds([E],this.parentBorder,this.moveParent)}if(this.parentX!=null&&this.parentY!=null){var G=this.graph.getCellGeometry(E);if(G!=null){G=G.clone();G.x=this.parentX;G.y=this.parentY;D.setGeometry(E,G)}}this.graph.removeCells(this.dummyVertices)}finally{D.endUpdate()}};mxSwimlaneLayout.prototype.updateGroupBounds=function(){var L=[];var B=this.model;for(var D in B.edgeMapper){var A=B.edgeMapper[D];for(var P=0;P<A.edges.length;P++){L.push(A.edges[P])}}var G=this.graph.getBoundingBoxFromGeometry(L,true);var F=[];for(var P=0;P<this.swimlanes.length;P++){var Q=this.swimlanes[P];var K=this.graph.getCellGeometry(Q);if(K!=null){var J=this.graph.getChildCells(Q);var C=(this.graph.isSwimlane(Q))?this.graph.getStartSize(Q):new mxRectangle();var M=this.graph.getBoundingBoxFromGeometry(J);F[P]=M;var E=M.y+K.y-C.height-this.parentBorder;var O=M.y+K.y+M.height;if(G==null){G=new mxRectangle(0,E,0,O-E)}else{G.y=Math.min(G.y,E);var I=Math.max(G.y+G.height,O);G.height=I-G.y}}}for(var P=0;P<this.swimlanes.length;P++){var Q=this.swimlanes[P];var K=this.graph.getCellGeometry(Q);if(K!=null){var J=this.graph.getChildCells(Q);var C=(this.graph.isSwimlane(Q))?this.graph.getStartSize(Q):new mxRectangle();var N=K.clone();var H=(P==0)?this.parentBorder:this.interRankCellSpacing/2;N.x+=F[P].x-C.width-H;N.y=N.y+G.y-K.y-this.parentBorder;N.width=F[P].width+C.width+this.interRankCellSpacing/2+H;N.height=G.height+C.height+2*this.parentBorder;this.graph.model.setGeometry(Q,N);this.graph.moveCells(J,-F[P].x+C.width+H,K.y-G.y+this.parentBorder)}}};mxSwimlaneLayout.prototype.findRoots=function(M,J){var K=[];if(M!=null&&J!=null){var N=this.graph.model;var G=null;var A=-100000;for(var H in J){var O=J[H];if(O!=null&&N.isVertex(O)&&this.graph.isCellVisible(O)&&N.isAncestor(M,O)){var F=this.getEdges(O);var D=0;var L=0;for(var I=0;I<F.length;I++){var C=this.getVisibleTerminal(F[I],true);if(C==O){var B=this.getVisibleTerminal(F[I],false);if(N.isAncestor(M,B)){D++}}else{if(N.isAncestor(M,C)){L++}}}if(L==0&&D>0){K.push(O)}var E=D-L;if(E>A){A=E;G=O}}}if(K.length==0&&G!=null){K.push(G)}}return K};mxSwimlaneLayout.prototype.getEdges=function(K){var E=this.edgesCache.get(K);if(E!=null){return E}var J=this.graph.model;var D=[];var B=this.graph.isCellCollapsed(K);var A=J.getChildCount(K);for(var F=0;F<A;F++){var I=J.getChildAt(K,F);if(this.isPort(I)){D=D.concat(J.getEdges(I,true,true))}else{if(B||!this.graph.isCellVisible(I)){D=D.concat(J.getEdges(I,true,true))}}}D=D.concat(J.getEdges(K,true,true));var C=[];for(var F=0;F<D.length;F++){var H=this.getVisibleTerminal(D[F],true);var G=this.getVisibleTerminal(D[F],false);if((H==G)||((H!=G)&&((G==K&&(this.parent==null||this.graph.isValidAncestor(H,this.parent,this.traverseAncestors)))||(H==K&&(this.parent==null||this.graph.isValidAncestor(G,this.parent,this.traverseAncestors)))))){C.push(D[F])}}this.edgesCache.put(K,C);return C};mxSwimlaneLayout.prototype.getVisibleTerminal=function(C,B){var A=this.edgesTargetTermCache;if(B){A=this.edgeSourceTermCache}var D=A.get(C);if(D!=null){return D}var F=this.graph.view.getState(C);var E=(F!=null)?F.getVisibleTerminal(B):this.graph.view.getVisibleTerminal(C,B);if(E==null){E=(F!=null)?F.getVisibleTerminal(B):this.graph.view.getVisibleTerminal(C,B)}if(E!=null){if(this.isPort(E)){E=this.graph.model.getParent(E)}A.put(C,E)}return E};mxSwimlaneLayout.prototype.run=function(J){var I=[];var A=[];if(this.swimlanes!=null&&this.swimlanes.length>0&&J!=null){var B=Object();for(var F=0;F<this.swimlanes.length;F++){this.filterDescendants(this.swimlanes[F],B)}this.roots=[];var K=true;for(var H in B){if(B[H]!=null){K=false;break}}var D=0;while(!K&&D<this.swimlanes.length){var G=this.findRoots(this.swimlanes[D],B);if(G.length==0){D++;continue}for(var F=0;F<G.length;F++){var C=Object();I.push(C);this.traverse(G[F],true,null,A,C,I,B,D)}for(var F=0;F<G.length;F++){this.roots.push(G[F])}K=true;for(var H in B){if(B[H]!=null){K=false;break}}}}else{for(var F=0;F<this.roots.length;F++){var C=Object();I.push(C);this.traverse(this.roots[F],true,null,A,C,I,null)}}var E=[];for(var H in A){E.push(A[H])}this.model=new mxSwimlaneModel(this,E,this.roots,J,this.tightenToSource);this.cycleStage(J);this.layeringStage();this.crossingStage(J);initialX=this.placementStage(0,J)};mxSwimlaneLayout.prototype.filterDescendants=function(E,C){var F=this.graph.model;if(F.isVertex(E)&&E!=this.parent&&F.getParent(E)!=this.parent&&this.graph.isCellVisible(E)){C[mxObjectIdentity.get(E)]=E}if(this.traverseAncestors||E==this.parent&&this.graph.isCellVisible(E)){var A=F.getChildCount(E);for(var B=0;B<A;B++){var D=F.getChildAt(E,B);if(!this.isPort(D)){this.filterDescendants(D,C)}}}};mxSwimlaneLayout.prototype.isPort=function(A){if(A.geometry.relative){return true}return false};mxSwimlaneLayout.prototype.getEdgesBetween=function(F,G,H){H=(H!=null)?H:false;var C=this.getEdges(F);var A=[];for(var E=0;E<C.length;E++){var B=this.getVisibleTerminal(C[E],true);var D=this.getVisibleTerminal(C[E],false);if((B==F&&D==G)||(!H&&B==G&&D==F)){A.push(C[E])}}return A};mxSwimlaneLayout.prototype.traverse=function(G,B,A,J,P,O,Q,N){if(G!=null&&J!=null){var I=mxObjectIdentity.get(G);if((J[I]==null)&&(Q==null?true:Q[I]!=null)){if(P[I]==null){P[I]=G}if(J[I]==null){J[I]=G}if(Q!==null){delete Q[I]}var M=this.getEdges(G);var C=this.graph.model;for(var D=0;D<M.length;D++){var L=this.getVisibleTerminal(M[D],true);var E=L==G;if(E){L=this.getVisibleTerminal(M[D],false)}var H=0;for(H=0;H<this.swimlanes.length;H++){if(C.isAncestor(this.swimlanes[H],L)){break}}if(H>=this.swimlanes.length){continue}if((H>N)||((!B||E)&&H==N)){P=this.traverse(L,B,M[D],J,P,O,Q,H)}}}else{if(P[I]==null){for(var D=0;D<O.length;D++){var F=O[D];if(F[I]!=null){for(var K in F){P[K]=F[K]}O.splice(D,1);return P}}}}}return P};mxSwimlaneLayout.prototype.cycleStage=function(A){var B=new mxSwimlaneOrdering(this);B.execute(A)};mxSwimlaneLayout.prototype.layeringStage=function(){this.model.initialRank();this.model.fixRanks()};mxSwimlaneLayout.prototype.crossingStage=function(A){var B=new mxMedianHybridCrossingReduction(this);B.execute(A)};mxSwimlaneLayout.prototype.placementStage=function(B,C){var A=new mxCoordinateAssignment(this,this.intraCellSpacing,this.interRankCellSpacing,this.orientation,B,this.parallelEdgeSpacing);A.fineTuning=this.fineTuning;A.execute(C);return A.limitX+this.interHierarchySpacing};