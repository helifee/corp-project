package helife.ibatis;

import helife.ibatis.bean.Account;

import java.io.IOException;
import java.io.Reader;
import java.sql.SQLException;
import java.util.Date;
import java.util.List;
import java.util.Map;

import com.ibatis.common.resources.Resources;
import com.ibatis.sqlmap.client.*;

public class Main {

	/**
	 * @param args
	 */
	@SuppressWarnings("unchecked")
	public static void main(String[] args) {
		String resource = "SqlMapConfig.xml";
		try {
			Reader reader = Resources.getResourceAsReader(resource);
			SqlMapClient sqlMap = SqlMapClientBuilder.buildSqlMapClient(reader);
			
			List list = sqlMap.queryForList("getAllUsers", "ibm");
			System.out.println("get " + list.size() + " records");
			for(int i=0; i<list.size(); i++) {
				//System.out.println(((Account)list.get(i)).getUserId());
				//hash --> Account error
				
				Map m = (Map)list.get(i);
				System.out.println(m.get("userid"));
			}

						
//			List<Account> list = sqlMap.queryForList("getAllUsers2", "ibm");
//			System.out.println("get " + list.size() + " records");
//			for(int i=0; i<list.size(); i++) {
//				System.out.println(list.get(i).getUserId());
//			}

//			List<Account> list = sqlMap.queryForList("getAllUsers3", "b");
//			System.out.println("get " + list.size() + " records");
//			for(int i=0; i<list.size(); i++) {
//				System.out.println(list.get(i).getUserId());
//			}
			
//			Account a = (Account) sqlMap.queryForObject("getOneUser", "baby");
//			System.out.println(a.getPassword());
			
//			int total = (Integer) sqlMap.queryForObject("getTotal");
//			System.out.println(total);
			
//			List<Account> list = sqlMap.queryForList("selectXml", "ibm");
//			System.out.println("get " + list.size() + " records");
//			for(int i=0; i<list.size(); i++) {
//				System.out.println(list.get(i));
//			}
			
//			Account a = new Account();
//			a.setUserName("zhangsan");
//			a.setPassword("123");
//			a.setGroupName("ms");
//			
//			sqlMap.startBatch();
//			double s = new Date().getTime();
//			for(int i=0; i<500; i++) {
//				sqlMap.insert("insertUser2", a);
//			}
//			sqlMap.executeBatch();
//			double e = new Date().getTime();
//			System.out.println(e - s);

//			sqlMap.update("createTable");
			
		} catch (IOException e) {
			e.printStackTrace();
		} catch (SQLException e) {
			e.printStackTrace();
		}

	}

}
