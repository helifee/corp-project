package com.xinleju.erp.frame.dao;


import java.util.List;

import org.apache.commons.lang3.StringUtils;
import org.hibernate.criterion.DetachedCriteria;
import org.hibernate.criterion.Order;
import org.hibernate.criterion.Restrictions;
import org.springframework.stereotype.Repository;

import com.xinleju.erp.base.app.bean.Page;
import com.xinleju.erp.flow.dao.impl.BaseDAO;
import com.xinleju.erp.frame.models.IdRule;
import com.xinleju.erp.frame.service.extend.dto.IdRuleDto;


/**
 * 版权：(C) 版权所有 2000-2014 上海天好电子商务有限公司苏州分公司 zhengxj <详细描述>
 * 
 * @author zhengxj
 * @version $Id: IdRuleDao.java 720 2015-03-24 08:11:10Z zhongjun $
 * @since
 * @see
 */
@Repository
public class IdRuleDao extends BaseDAO {

    /**
     * 获取编号规则列表 〈详细描述〉
     * 
     * @author zhengxj
     * @param idRuleDto 查询参数
     * @param start 分页开始数
     * @param limit 每页条数
     * @return page
     */
    public Page getIdRuleList(IdRuleDto idRuleDto, int start, int limit) {
        DetachedCriteria dc = DetachedCriteria.forClass(IdRule.class);
        if (idRuleDto != null) {
            String keyword = idRuleDto.getKeyword();
            if(StringUtils.isNotBlank(keyword)) {
            	dc.add(Restrictions.or(Restrictions.like("name", "%" + keyword + "%"), Restrictions.like("code", "%" + keyword + "%")));
            }
            Integer status = idRuleDto.getStatus();
            if (status != null) {
                dc.add(Restrictions.eq("status", status));
            }
        }
        dc.addOrder(Order.desc("createDate"));
        return getDao().findPage(dc, start, limit);

    }

    public List<IdRule> getAllIdRuleList(){
    	DetachedCriteria dc = DetachedCriteria.forClass(IdRule.class);
    	dc.add(Restrictions.or(Restrictions.isNull("status"), Restrictions.eq("status", IdRule.STATUS_Y)));
    	dc.addOrder(Order.desc("createDate"));
    	return getDao().findByCriteria(dc);
    }
   
}
