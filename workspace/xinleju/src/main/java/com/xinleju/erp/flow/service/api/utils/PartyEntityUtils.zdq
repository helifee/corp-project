package com.xinleju.erp.flow.service.api.utils;

import java.util.ArrayList;
import java.util.List;

import org.apache.commons.lang3.StringUtils;

import com.xinleju.erp.flow.service.api.extend.dto.OrgnDTO;
import com.xinleju.erp.flow.service.api.extend.dto.PartyEntityDTO;
import com.xinleju.erp.frame.models.PartyEntity;

public class PartyEntityUtils {
	
    /**
     * 
     * @param partyEntitys
     * @return
     */
    public static List<PartyEntityDTO> buildPartyEntityDTOList(List<PartyEntity> partyEntitys) {
        List<PartyEntityDTO> partyEntityDTOs = new ArrayList<PartyEntityDTO>();
        if(partyEntitys != null && !partyEntitys.isEmpty()){
            PartyEntityDTO dto = null;
            for(PartyEntity partyEntity : partyEntitys){
                dto =  buildPartyEntityDTO(partyEntity);
                if(dto != null) {
                    partyEntityDTOs.add(dto);
                }
            }
        }
        return partyEntityDTOs;
    }
    
   /**
    * 
    * @param partyEntity
    * @return
    */
    public static PartyEntityDTO buildPartyEntityDTO(PartyEntity partyEntity) {
        PartyEntityDTO partyEntityDTO = null;
        if(partyEntity != null){
            partyEntityDTO = new PartyEntityDTO();
            partyEntityDTO.setMyUnitId(partyEntity.getMyUnitId());
            partyEntityDTO.setName(partyEntity.getName());
            partyEntityDTO.setPartyTypeId(partyEntity.getPartyTypeId());
            partyEntityDTO.setPrefix(partyEntity.getPrefix());
            partyEntityDTO.setRefId(partyEntity.getRefId());
            partyEntityDTO.setRefParentId(partyEntity.getRefParentId());
            partyEntityDTO.setShortName(partyEntity.getShortName());
            partyEntityDTO.setId(partyEntity.getId());
            String nameFix = partyEntity.getNamePrefix();
            if(StringUtils.isNotBlank(nameFix)){
            	String[] nameFixs = nameFix.split("-");
            	if(nameFixs.length>1){
            		String name = nameFix.replace(nameFixs[0]+"-", "");
            		name = name.substring(0,name.lastIndexOf("-"));
            		partyEntityDTO.setNamePrefix(name);
            	}else{
            		partyEntityDTO.setNamePrefix(nameFixs[0]);
            	}
            }
        }
        return partyEntityDTO;
    }
    
    /**
     * 
     * @param partyEntitys
     * @return
     */
    public static List<OrgnDTO> buildOrgnDTOList(List<PartyEntity> partyEntitys) {
        List<OrgnDTO> partyEntityDTOs = new ArrayList<OrgnDTO>();
        if(partyEntitys != null && !partyEntitys.isEmpty()){
        	OrgnDTO dto = null;
            for(PartyEntity partyEntity : partyEntitys){
                dto =  buildOrgnDTO(partyEntity);
                if(dto != null) {
                    partyEntityDTOs.add(dto);
                }
            }
        }
        return partyEntityDTOs;
    }
    
   /**
    * 
    * @param partyEntity
    * @return
    */
    public static OrgnDTO buildOrgnDTO(PartyEntity partyEntity) {
    	OrgnDTO orgnDto = null;
        if(partyEntity != null){
        	orgnDto = new OrgnDTO();
            
//            partyEntityDTO.setName(partyEntity.getName());
//            partyEntityDTO.setPartyTypeId(partyEntity.getPartyTypeId());
//            partyEntityDTO.setPrefix(partyEntity.getPrefix());
//            partyEntityDTO.setRefId(partyEntity.getRefId());
//            partyEntityDTO.setRefParentId(partyEntity.getRefParentId());
//            partyEntityDTO.setShortName(partyEntity.getShortName());
//            partyEntityDTO.setId(partyEntity.getId());
            
            orgnDto.setId(partyEntity.getId());
            orgnDto.setRefId(partyEntity.getRefId());
            orgnDto.setName(partyEntity.getName());
            orgnDto.setShortName(partyEntity.getShortName());
            orgnDto.setType("zc");
            //orgnDto.setParentId(ps.getParentEntity()!=null?ps.getParentEntity().getId():0);
            orgnDto.setNodeType(partyEntity.getPartyType().getType());
           // orgnDto.setSubCount(ps.getSubCount());
           // orgnDto.setIsLeaf(ps.getSubCount()<1);
        }
        return orgnDto;
    }

}
