package com.xinleju.erp.frame.models.ref;

import java.util.ArrayList;
import java.util.List;

import com.xinleju.erp.base.app.bean.Page;
import com.xinleju.erp.base.app.config.App;
import com.xinleju.erp.frame.dto.FiAccountSubjectDTO;
import com.xinleju.erp.frame.dto.JsonTreeTableTemplete;
import com.xinleju.erp.frame.itf.ITreeRefModel;
import com.xinleju.erp.frame.models.extender.FiASTreeReflExtender;
import com.xinleju.erp.frame.service.FiSysDataService;

public class FiAccSubRefModel implements ITreeRefModel {
	private FiSysDataService fiSysDataService;
	private Long fisysinfoid;
	private String targsyscorpid;
	
	public FiSysDataService getFiSysDataService() {
		if(fiSysDataService == null)
			fiSysDataService = App.getBean(FiSysDataService.class);
		return fiSysDataService;
	}


	public FiAccSubRefModel(Long fisysinfoid,String targsyscorpid){
		this.fisysinfoid = fisysinfoid;
		this.targsyscorpid = targsyscorpid;
	}
	
	
	@Override
	public Page getData(int start,int limit,String keywords) {
		List<FiAccountSubjectDTO> dtoList = null;
		if(fisysinfoid != null && targsyscorpid != null)
			dtoList = getFiSysDataService().queryAccountSubject(fisysinfoid,targsyscorpid);
		else
			dtoList = new ArrayList<FiAccountSubjectDTO>();
		Page page = new Page();
		page.setItems(dtoList);
		page.setTotal(dtoList.size());
		return page;
	}
	
	@Override
	public String getKeyField() {
		return "id";
	}

	@Override
	public String getNameField() {
		return "subname";
	}

	@Override
	public String[] getShowFields() {
		return new String[]{"subcode","subname","asstypename"};
	}
	
	@Override
	public String[] getShowNames() {
		return new String[]{"科目编码","科目名称","辅助核算"};
	}

	@Override
	public String getTitle() {
		return "会计科目";
	}

	@Override
	public Boolean isMutil() {
		return false;
	}
	
	@Override
	public String getCodeField() {
		return "subcode";
	}


	@Override
	public JsonTreeTableTemplete getJsonTreeTableTemplete() {
		return new JsonTreeTableTemplete("id","pid",getShowFields(),FiASTreeReflExtender.class);
	}
}
