package com.xinleju.erp.frame.models.extender;

import java.util.List;
import java.util.Map;

import com.xinleju.erp.base.app.config.App;
import com.xinleju.erp.frame.dto.FiAccountSubjectDTO;
import com.xinleju.erp.frame.models.BusinessMold;
import com.xinleju.erp.frame.models.EntityExtender;
import com.xinleju.erp.frame.models.VoucherEntry;
import com.xinleju.erp.frame.service.FiBusinessService;
import com.xinleju.erp.frame.service.FiSysDataService;
import com.xinleju.erp.frame.utils.CommonUtil;

public class FiVEExtender extends EntityExtender {
	@SuppressWarnings("unused")
	private String subid_name = "";
	@SuppressWarnings("unused")
	private String vsstypename = "";
	private Map<String, FiAccountSubjectDTO> map = null;

	public FiVEExtender(Long bmid) {
		FiBusinessService fiBusinessService = App.getBean(FiBusinessService.class);
		BusinessMold bm = fiBusinessService.getDao().getById(BusinessMold.class, bmid);
		List<FiAccountSubjectDTO> fiasDtoList = null;
		if (bm != null) {
			FiSysDataService fiSysDataService = App.getBean(FiSysDataService.class);
			fiasDtoList = fiSysDataService.queryAccountSubject(bm.getFisysinfoid(), bm.getTargsyscorpid());
		}
		if (fiasDtoList != null && fiasDtoList.size() > 0) {
			map = CommonUtil.toMap(fiasDtoList, "id");
		}
	}

	public String getSubid_name(VoucherEntry ve) {
		if (map == null)
			return "";
		FiAccountSubjectDTO dto = map.get(ve.getSubid());
		return dto == null ? "" : dto.getSubname();
	}

	public String getVsstypename(VoucherEntry ve) {
		return "";
	}
}
