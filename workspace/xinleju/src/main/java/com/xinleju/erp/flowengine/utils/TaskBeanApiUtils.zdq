package com.xinleju.erp.flowengine.utils;

import java.util.List;

import org.apache.commons.lang.time.DateFormatUtils;

import com.xinleju.erp.flow.flowutils.bean.ToDoWorkBean;
import com.xinleju.erp.flow.flowutils.bean.UploadBean;
import com.xinleju.erp.flowengine.models.FlowInstanceStepWorkTask;

public class TaskBeanApiUtils {
	
	

	public static ToDoWorkBean buildToDoWorkBean(FlowInstanceStepWorkTask task, List<UploadBean> uploadBeanList, String spType, String rolePath){
		ToDoWorkBean toDoWorkBean = new ToDoWorkBean();
		if (null != task) {
			//toDoWorkBean.setAiId(wi.getAiId());
			toDoWorkBean.setFlowInstanceStepId(task.getStepId());
			toDoWorkBean.setCompleteTime(task.getCompleteTime()!=null?DateFormatUtils.format(task.getCompleteTime(), "yyyy-dd-MM"):"");
			String userName = "";
			if (TaskTypeStatus.STATUS_COMPLETE == task.getStatus() && null != task.getParticipant()){
				userName = null != task.getParticipantUserName()? task.getParticipantUserName() : "";
				if (null != task && null != task.getCompleteUserId() && !task.getParticipant().equals(task.getCompleteUserId())){
					userName += "(" + task.getCompleteUserName()+ "[ä»£])";
				}
			}
			toDoWorkBean.setCompleteUserName(userName);
			//toDoWorkBean.setFiId(wi.getFiId());
			toDoWorkBean.setFlowInstanceId(task.getFiId());
			//toDoWorkBean.setIsRead(wi.getIsRead());
			//toDoWorkBean.setOpCode(wi.getOpCode());
			//toDoWorkBean.setOpCode(task.getOpCode());
			toDoWorkBean.setOpName(task.getOpCode());
			//toDoWorkBean.setOpRole(task.);
			toDoWorkBean.setParticipantUserName(task.getParticipantUserName());
			toDoWorkBean.setStartTime(task.getCreateTime()!=null?DateFormatUtils.format(task.getCreateTime(), "yyyy-dd-MM"):"");
			toDoWorkBean.setStatus(task.getStatus());
			toDoWorkBean.setUserNote(task.getUserNote());
			toDoWorkBean.setFlowInstancetaskId(task.getGuid());
//			toDoWorkBean.setWiName(wi.getWiName());
//			toDoWorkBean.setWiType(wi.getWiType());
//			toDoWorkBean.setWpId(wi.getWpId());
//			toDoWorkBean.setWpName(null != wi.getWp() ? wi.getWp().getDisplayName() : "");
			toDoWorkBean.setSpType(spType);
		}
		toDoWorkBean.setUploadBeanList(uploadBeanList);
		return toDoWorkBean;
	}
}
