/**   
*
* @version V1.0   
*/
package com.xinleju.erp.finance.utils;

import java.util.List;
import java.util.Map;

import org.apache.poi.hssf.usermodel.HSSFSheet;

/**
 * @author wangjf
 * excel导入导出接口
 */
public interface IExcelHandler {

	/**
	 * 以下为导出方法
	 */
	
	/**
	 * excel页签名
	 * @return
	 */
	public String getSheetName();
	
	/**
	 * 导出的excel字段名称
	 * @return
	 */
	public String[] getHeadItemsNameAry();
	/**
	 * 导出的excel字段属性名，class中必须存在此属性
	 * @return
	 */
	public String[] getHeadItemsCodeAry();
	/**
	 * 导出的excel字段在表格中占的宽度，与code一一对应，默认100，如不想显示比如ID字段，可设置为0。
	 * @return
	 */
	public Integer[] getHeadItemsLength();
	/**
	 * 导出字段在excel中是否红色显示 <br/> true:是（字段值不导出），false：否，null：红色、且字段值导出
	 * @return
	 */
	public Boolean[] getHeadItemsColor();
	
	/**
	 * 导出的excel实体类名
	 * @return
	 */
	public Class<?> getEntityClass();
	
	/**
	 * 导出到excel的具体数据
	 * @return
	 */
	public List<?> getEntityList(IExcelHandler handler,String accountSetCode,long sysId,Long accountSetId,Long companyId);
	
	/**
	 * 表格最上方的提示列表，为String集合，多条提示逐行显示
	 * @return
	 */
	public List<String> getTipsList();
	
	/**
	 * 复合表头，只支持一列复合表头  例：<br/>
	 * cellJoinMap.put("金额", new Integer[]{1,1,2,4});<br/>
	 * int[]里面前两个元素是起始行、结束行，后两个元素是起始列、结束列，<br/>
	 * 都是从0开始计数   key值是显示的合并列列名
	 * @return
	 */
	public Map<String,Integer[]> getCellJoinMap();
	
	
	/**
	 * 以下是导入时用到的方法
	 */
	
	/**
	 * excel导入之后，封装的实体类类名
	 * @return
	 */
	public Class<?> getImpClass();
	/**
	 * 导入的字段:字段必须在实体中存在该属性，否则无法赋值
	 * @return
	 */
	public String[] getImportColumns();
	/**
	 * 用于字段导入校验错误时的提示字段名称 与导入字段数组一一对应
	 * @return
	 */
	public String[] getImportHeadItemsName();
	/**
	 * 必须：与字段数组一一对应，表示对应字段的类型，导入时会将excel单元格的值转换为此类型
	 * @return
	 */
	public Class<?>[] getImportColumnsType();
	/**
	 * 是否导入：针对某些excel的字段只是为了显示，不准备导入的字段可设置为false，与字段数组一一对应
	 * @return
	 */
	public Boolean[] getColsIsImp();
	
	public int importPr(String accountSetCode,String sysId,String companyCode,String accountSetId,HSSFSheet sheet,Long companyId);
}
