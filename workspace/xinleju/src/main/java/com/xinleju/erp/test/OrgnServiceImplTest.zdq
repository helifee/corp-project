package com.xinleju.erp.test;


import java.util.List;


import org.junit.Before;
import org.junit.Test;
import org.springframework.context.support.ClassPathXmlApplicationContext;

import com.xinleju.erp.data.cache.api.BaseExtendAPI;
import com.xinleju.erp.flow.flowutils.bean.FlowResult;
import com.xinleju.erp.flow.service.api.extend.BaseAPI;
import com.xinleju.erp.flow.service.api.extend.CommonService;
import com.xinleju.erp.flow.service.api.extend.FlowService;
import com.xinleju.erp.flow.service.api.extend.OrgnService;
import com.xinleju.erp.flow.service.api.extend.UserSerivce;
import com.xinleju.erp.flow.service.api.extend.dto.CompanyDTO;
import com.xinleju.erp.flow.service.api.extend.dto.DeptDTO;
import com.xinleju.erp.flow.service.api.extend.dto.OrgnDTO;
import com.xinleju.erp.flow.service.api.extend.dto.PostDTO;

public class OrgnServiceImplTest {
	private BaseExtendAPI baseExtendAPI;
	private BaseAPI baseAPI;
	private OrgnService orgnService;
	private UserSerivce userService;
	private FlowService flowService;
	private CommonService commonService;
	
	

  @Before
  public  void beforeClass() {
	  ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(new String[] {"test-dubbo.xml"});
      context.start();
     
      baseAPI = (BaseAPI)context.getBean("baseAPIService");
      
      orgnService = (OrgnService)context.getBean("orgnServiceCustmer");
      userService = (UserSerivce)context.getBean("userServiceCustmer");
      flowService = (FlowService)context.getBean("flowServiceCustmer");
      commonService = (CommonService)context.getBean("commonServiceCustmer");
  }
  
  @Test
  public void getUpDeptMainByUserId() {
	  FlowResult<DeptDTO> fr = orgnService.getUpDeptMainByUserId(2041856l);
	  DeptDTO deptDTO = fr.getResult();
	  System.out.println(deptDTO.getCode() + "|" + deptDTO.getName() + "|" + deptDTO.getId());
}
  @Test
  public void getDeptListByUserId(){
	  FlowResult<List<DeptDTO>> fr = orgnService.getDeptListByUserId(16l);
	  for(DeptDTO user : fr.getResult()){
		  System.out.println("--------------getDeptListByUserId-----------"+user.getName());
	  }
  }
  
  @Test
  public void getDeptListByCompanyIdAndUserId(){
	  FlowResult<List<DeptDTO>> fr = orgnService.getDeptListByUserId(1l,1l);
	  for(DeptDTO user : fr.getResult()){
		  System.out.println("--------------getDeptListByUserId-----------"+user.getName());
	  }
  }
  
  @Test
  public void getOrgnListAll(){
	  FlowResult<List<OrgnDTO>> fr = orgnService.getOrgnListAll();
	  System.out.println("总条数："+fr.getResult().size());
	  for(OrgnDTO o : fr.getResult()){
		  System.out.println(o.getId()+"--"+o.getParentId()+"--"+o.getRefId()+"----"+o.getNodeType()+"---"+o.getName());
	  }
  }
  
  @Test
  public void getAllDept(){
	  FlowResult<List<DeptDTO>> fr = orgnService.getAllDept(10l, "ex", "liuhaiqing", 80001l, 80002l);
	  System.out.println(fr.getResult());
	  System.out.println(fr.getDebugInfo().getErrDesc());
	  for(DeptDTO user : fr.getResult()){
		  System.out.println("--------------getDeptListByUserId-----------"+user.getName());
	  }
  }
  
  @Test
  public void getAuthDeptByCompany(){
	  FlowResult<List<OrgnDTO>> fr = orgnService.getAuthDeptByCompany(1l,"PL","admin", 40001L,40003L);
	  for(OrgnDTO o : fr.getResult()){
		  System.out.println("--"+o.getParentId()+"--"+o.getRefId()+"----"+o.getNodeType()+"---"+o.getName());
	  }
  }
  
  @Test
  public void getOrgnListNotProjectAndBranch(){
	  FlowResult<List<OrgnDTO>> fr = orgnService.getOrgnListNotProjectAndBranch();
	  for(OrgnDTO o : fr.getResult()){
		  System.out.println("----"+o.getRefId()+"----"+o.getNodeType()+"---"+o.getName());
	  }
  }
  
  @Test
  public void getOrgnRoot(){
	  FlowResult<OrgnDTO> fr= orgnService.getOrgnRoot();
	  System.out.println("查询组织机构的根结点信息："+fr.getResult().getName());
  }
  
  @Test
  public void getPostListByCompanyId(){
	  FlowResult<List<PostDTO>> fr=orgnService.getPostListByCompanyId(34L);
	  System.out.println("======="+fr.getResult());
	  for(PostDTO dto : fr.getResult()){
		  System.out.println("--------getPostListByCompanyId---------"+dto.getName());
	  }
  }

  @Test
  public void getCompanyListByIds(){
	  FlowResult<List<CompanyDTO>> fr = orgnService.getCompanyListByIds(new String[]{"1"});
	  for(CompanyDTO dto : fr.getResult()){
		  System.out.println("--------getCompanyListByIds---------"+dto.getName());
	  }
  }
  
  @Test
  public void getDeptListByCompanyId(){
	  
	  FlowResult<List<DeptDTO>> fr = orgnService.getDeptListByCompanyId(10l);
	  for(DeptDTO dto : fr.getResult()){
		  System.out.println("--------getDeptListByCompanyId---------"+dto.getName());
	  }
  }
  
  @Test
  public void getCompanyMainByUserId(){
	  FlowResult<CompanyDTO> fr = orgnService.getCompanyMainByUserId(17230l);
	  System.out.println("--------getCompanyMainByUserId---------"+fr.getResult().getName());
	  
  }
  
  @Test
  public void getCompanyMainByUserLoginName(){
	  FlowResult<CompanyDTO> fr = orgnService.getCompanyMainByUserLoginName("zhg");
	  System.out.println("--------getCompanyMainByUserId---------"+fr.getResult().getName());
	  
  }
  
  @Test
  public void getDeptMainByUserId(){
	  FlowResult<DeptDTO> fr = orgnService.getDeptMainByUserId(16l);
	  System.out.println("--------getDeptMainByUserId---------"+fr.getResult().getName());
  }
  @Test
  public void getCompanyListAll(){
	  FlowResult<List<CompanyDTO>> fr = orgnService.getCompanyListAll();
	  
	  System.out.println("getCompanyListAll.size===="+fr.getResult().size());
	  
	  for(CompanyDTO dto : fr.getResult()){
		  System.out.println("-----------------"+dto.getName());
	  }
  }
  
  @Test
  public void getCompanyListByUserLoginNameAuth(){
	  FlowResult<List<CompanyDTO>> fr = orgnService.getCompanyListAll("SA","xq",50001l,50001l);
	  
	  System.out.println("getCompanyListByUserLoginNameAuth----------"+fr.getResult().size());
	  
	  for(CompanyDTO dto : fr.getResult()){
		  System.out.println("-----------------"+dto.getName());
	  }
  }
  

  
  @Test
  public void getCompanyListByUserLoginName(){
	  FlowResult<List<CompanyDTO>> fr = orgnService.getCompanyListByUserLoginNames(new String[]{"liliang"},"SA","liliang",50001l,50001l);
	  
	  System.out.println("getCompanyListByUserLoginNameAuth----------"+fr.getResult().size());
	  
	  for(CompanyDTO dto : fr.getResult()){
		  System.out.println("-----------------"+dto.getName());
	  }
  }
  
  
  @Test
  public void  getParentOrgnByChildId(){
	  FlowResult<OrgnDTO> fr = orgnService.getParentOrgnByChildId(3L);
	  System.out.println(fr.getResult());
	 //System.out.println("getParentOrgnByChildId----------"+fr.getResult().getName()+"--"+fr.getResult().getNodeType()+"--"+fr.getResult().getType());
  }
  
  @Test
  public void  getParentOrgnByChildIdRef(){
	  FlowResult<OrgnDTO> fr = orgnService.getParentOrgnByChildId(61L,new String[]{"department"});
	  System.out.println(fr.getResult().getId()+"=="+fr.getResult().getRefId()+"getParentOrgnByChildId----------"+fr.getResult().getName()+"--"+fr.getResult().getNodeType()+"--"+fr.getResult().getType());
  }
  
  //根据岗位id来查部门 有问题不对
  @Test
  public void getDeptListByPostIds(){
	  FlowResult<List<DeptDTO>> fr=orgnService.getDeptListByPostIds(new String[]{"220"});
	  for(DeptDTO dd:fr.getResult()){
		  System.out.println("deptname======"+dd.getId()+"=========="+dd.getName());
	  }
  }
  

  //根据岗位id来查部门  正确
  @Test
  public void getDeptListByPost(){
	  FlowResult<DeptDTO> fr=orgnService.getDeptByPostId(220L);
	  System.out.println(fr.getResult());
	  System.out.println("--------"+fr.getResult().getName());
  }
  
  @Test
  public void getOrgnById(){
	  FlowResult<OrgnDTO> fr = orgnService.getOrgnById(3L);
	  System.out.println("getOrgnById----------"+fr.getResult().getName()+"--"+fr.getResult().getNodeType()+"--"+fr.getResult().getType());
  }
  
  @Test
  public void getDeptById(){
	  FlowResult<DeptDTO>  fr = orgnService.getDeptById(704L);
	  System.out.println(fr.getResult());
	 // System.out.println("getDeptById----------"+fr.getResult().getName());
  }
  
  @Test
  public void getPostListByCompanyIdAndStandardRoleId(){
	  FlowResult<List<PostDTO>> fr=orgnService.getPostListByCompanyIdAndStandardRoleId(10l,1079l);
	  for(PostDTO dto : fr.getResult()){
		  System.out.println("--------name---------"+dto.getName());
	  }
  }
  

  @Test
  public void getPostListByDeptIdAndStandardRoleId(){
	  FlowResult<List<PostDTO>> fr=orgnService.getPostListByDeptIdAndStandardRoleId(58l,1079l);
	  for(PostDTO dto : fr.getResult()){
		  System.out.println("--------name---------"+dto.getName());
	  }
  }
  
  @Test
  public void getCompanyListAll_1(){
	  System.out.println("==============");
	  FlowResult<List<CompanyDTO>> fr=orgnService.getCompanyListAll("EX", "yanghonglei", 80001l,80001l);
	  for(CompanyDTO dto : fr.getResult()){
		  System.out.println("-----------------"+dto.getName());
	  }
  }
  
  
  
  
}
