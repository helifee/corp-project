package com.xinleju.erp.frame.utils;

import java.lang.reflect.Field;
import java.util.ArrayList;
import java.util.List;

import com.xinleju.erp.annotation.Voucher;
import com.xinleju.erp.frame.dto.FiBillDTO;
import com.xinleju.erp.frame.dto.VoucherField;
import com.xinleju.erp.frame.dto.VoucherFiledTemplate;

public class VoucherDTOUtil {
	public static FiBillDTO transform(Object object ,VoucherFiledTemplate template){
		FiBillDTO dto = new FiBillDTO();
		List<VoucherField> fields = template.getFields() ;
		if(template.getFields() == null || fields .size() == 0)
			return dto;
		for(VoucherField field : fields){
			dto.setAttribute(field.getCode(), BeanUtil.getAttribute(field.getCode(), object));
		}
		return dto;
	}
	
	public static List<FiBillDTO> transform(List<Object> objectList ,VoucherFiledTemplate template){
		List<FiBillDTO> list = new ArrayList<FiBillDTO>();
		if(objectList == null || objectList.size() == 0)
			return list;
		for(Object obj : objectList)
			list.add(transform(obj, template));
		return list;
	}
	
	public static VoucherFiledTemplate transform(Class<?> clazz){
		VoucherFiledTemplate template = new VoucherFiledTemplate();
		if(clazz == null)
			return template;
		for(Field field : clazz.getDeclaredFields()){
			Voucher ann = field.getAnnotation(Voucher.class);
			if(ann == null)
				continue;
			template.add(field.getName(), ann.name(), ann.iskey(), ann.isname(),ann.iscode(), ann.fieldtype());
		}
		return template;
	}
	
	public static List<FiBillDTO> transform(Class<?> clazz ,List<?> list){
		List<FiBillDTO> dtoList = new ArrayList<FiBillDTO>();
		if(list == null || list.size() == 0)
			return dtoList;
		for(Object obj :  list){
			if(obj == null || !clazz.isAssignableFrom(obj.getClass()))
				continue;
			for(Field field : clazz.getFields()){
				Voucher ann = field.getAnnotation(Voucher.class);
				if(ann == null)
					continue;
				FiBillDTO dto = new FiBillDTO();
				dtoList.add(dto);
				dto.setAttribute(field.getName(), BeanUtil.getAttribute(field.getName(), obj));
			}
		}
		return dtoList;
	}
}
