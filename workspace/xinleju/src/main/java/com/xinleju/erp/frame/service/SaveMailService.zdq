package com.xinleju.erp.frame.service;

import java.util.Date;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import com.xinleju.erp.frame.dao.MailContentDao;
import com.xinleju.erp.frame.dao.SendQueueDao;
import com.xinleju.erp.frame.models.MailContent;
import com.xinleju.erp.frame.models.SendQueue;
import com.xinleju.erp.sm.extend.dto.MailDTO;

@Service
@Transactional
public class SaveMailService {

	@Autowired
	private MailContentDao mailContentDao;

	@Autowired
	private SendQueueDao sendQueueDao;

	public Boolean saveMailContent(MailDTO mailDto) {
		Boolean flag = false;
		if (mailDto != null) {
			MailContent mailContent = new MailContent();
			mailContent.setContent(mailDto.getContent());
			mailContent.setMailcc(mailDto.getMailcc());
			mailContent.setMailto(mailDto.getMailto());
			mailContent.setSendName(mailDto.getSendName());
			mailContent.setStartTime(new Date());
			mailContent.setTitle(mailDto.getTitle());
			mailContent.setSendState(0);
			mailContent.setMailtos(mailDto.getMailtos());
			mailContent.setMailccs(mailDto.getMailccs());
			mailContentDao.save(mailContent);

			SendQueue sendQueue = new SendQueue();

			sendQueue.setContentId(mailContent.getId());
			sendQueue.setPriority(1);
			sendQueue.setSendBy(1);
			sendQueue.setInTime(new Date());
			sendQueueDao.save(sendQueue);
		}
		flag = true;
		return flag;
	}

}
