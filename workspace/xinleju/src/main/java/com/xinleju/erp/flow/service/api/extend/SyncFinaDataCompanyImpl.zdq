package com.xinleju.erp.flow.service.api.extend;

import java.util.ArrayList;
import java.util.List;

import org.apache.commons.lang3.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;

import com.xinleju.erp.base.app.bean.Page;
import com.xinleju.erp.flow.flowutils.bean.FlowResult;
import com.xinleju.erp.flow.flowutils.bean.PageBean;
import com.xinleju.erp.frame.dao.CompanyDao;
import com.xinleju.erp.frame.models.Company;
import com.xinleju.erp.sm.cache.api.SyncFinaDataCompanyService;
import com.xinleju.erp.sm.extend.dto.FinaData;
import com.xinleju.erp.sm.extend.dto.FinaQueryParams;

public class SyncFinaDataCompanyImpl implements SyncFinaDataCompanyService {

	@Autowired
	private CompanyDao companyDao;

	@Override
	public FlowResult<PageBean<FinaData>> getFinaData(FinaQueryParams arg0) {
		FlowResult<PageBean<FinaData>> fr = new FlowResult<PageBean<FinaData>>();
		List<Company> clist = new ArrayList<Company>();
			List<FinaData> list = new ArrayList<FinaData>();
			Page page = companyDao.getAllCompanyByCodeHasPage(arg0.getCorpId(),
					arg0.getCurrentPage(), arg0.getPageSize());
			clist = page.getItems();
			if (clist != null && clist.size() > 0) {
				for (Company c : clist) {
					if(c!=null){
						if (StringUtils.isNotBlank(c.getName())&&StringUtils.isNotBlank(c.getCode())){
							FinaData fd = new FinaData();
							fd.put("id", c.getId());
							fd.put("name", c.getName());
							fd.put("code", c.getCode());
							list.add(fd);
						}
						
					}
				}
			}

			fr.setResult(new PageBean<FinaData>(arg0.getCurrentPage(), arg0
					.getPageSize(), page.getTotal(), list));
		
		return fr;
		
	}

}
