package com.xinleju.erp.frame.action;

import java.util.HashMap;
import java.util.Map;

import org.apache.commons.lang.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;

import com.xinleju.erp.base.app.action.BaseAction;
import com.xinleju.erp.flow.service.api.extend.dto.AppDTO;
import com.xinleju.erp.flow.service.extend.dto.ModuleDto;
import com.xinleju.erp.frame.models.App;
import com.xinleju.erp.frame.service.AppService;
/**
 * 
 * 版权：(C) 版权所有 2000-2014 上海天好电子商务有限公司苏州分公司
 * 模块管理
 * @author   jeeping
 * @version  $Id$
 * @since
 * @see
 */
public class ModuleAction extends BaseAction {
    
    /**
     * app应用
     */
    private AppDTO appDTO;
    /**
     * 模块查询定义条件
     */
    private ModuleDto moduleDto;
    
    /**
     * appService
     */
    @Autowired
    private AppService appService;
    /**
     * 
     * 系统模块管理list页面
     *〈详细描述〉
     * @author zhoupeng
     * @return
     */
    public String list() {
        Map<String, String> statusMap = new HashMap<String, String>();
        statusMap.put(ModuleDto.IS_DISABLED_Y, "禁用");
        statusMap.put(ModuleDto.IS_DISABLED_N, "启用");
        request.setAttribute("statusMap", statusMap);
        page = appService.getAppDTOPage(moduleDto, start, limit);
        return "list";
    }
    /**
     * 
     * 编辑模块
     * @author zhoupeng
     * @return
     */
    public String edit() {
        if (null != id) {
            appDTO = appService.getAppDTO(id);
        }
        if (null == appDTO){
            appDTO = new AppDTO();
        }
        return "edit";
    }
    /**
     * 
     *〈简述〉
     *〈详细描述〉
     * @author zhoupeng
     */
    public void save(){
        appService.save(appDTO);
        renderJson("{\"success\":true,\"msg\":\"保存成功。\"}");
    }
    /**
     * 
     * 禁用
     * @author jeeping
     */
    public void disable() {
       String moduleId = request.getParameter("moduleId");
       if (StringUtils.isNotBlank(moduleId)) {
           appService.changStatus(Long.valueOf(moduleId), App.STATUS_DISABLE);
       }
    }
    /**
     * 
     * 启用
     * @author jeeping
     */
    public void enable() {
        String moduleId = request.getParameter("moduleId");
        if (StringUtils.isNotBlank(moduleId)) {
            appService.changStatus(Long.valueOf(moduleId), App.STATUS_ENABLE);
        }
    }
    
    public ModuleDto getModuleDto() {
        return moduleDto;
    }
    public void setModuleDto(ModuleDto moduleDto) {
        this.moduleDto = moduleDto;
    }
    public AppDTO getAppDTO() {
        return appDTO;
    }
    public void setAppDTO(AppDTO appDTO) {
        this.appDTO = appDTO;
    }
   
  
    
}
