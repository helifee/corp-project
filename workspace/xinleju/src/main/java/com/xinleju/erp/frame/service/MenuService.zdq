package com.xinleju.erp.frame.service;

import java.util.List;

import org.apache.commons.lang.StringUtils;
import org.hibernate.criterion.DetachedCriteria;
import org.hibernate.criterion.Restrictions;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.xinleju.erp.base.app.bean.Page;
import com.xinleju.erp.base.app.service.impl.BaseService;
import com.xinleju.erp.frame.dao.MenuDao;
import com.xinleju.erp.frame.models.FuncModule;
/**
 * 
 * 版权：(C) 版权所有 2000-2014 上海天好电子商务有限公司苏州分公司
 *  按钮管理service
 * <详细描述>
 * @author   zhoupeng
 * @version  $Id$
 * @since
 * @see
 */
@Service
public class MenuService  extends BaseService{
    @Autowired
    private MenuDao menuDao;
    /**
     * 
     * 按钮page
     *〈详细描述〉
     * @author zhoupeng
     * @param keyWord
     * @param start
     * @param limit
     * @return
     */
    public Page findMenuList(String parentId, String keyWord, String systemCode, Integer start, Integer limit) {
        DetachedCriteria dc = DetachedCriteria.forClass(FuncModule.class);
        if (StringUtils.isNotBlank(parentId) && Long.valueOf(parentId) != 0) {
            dc.add(Restrictions.eq("parentId",Long.valueOf(parentId)));
        } else {
            dc.add(Restrictions.isNull("parentId"));
            dc.add(Restrictions.eq("systemCode", systemCode));
        }
        if (StringUtils.isNotBlank(keyWord)) {
            dc.add(Restrictions.like("name", "%" + keyWord + "%"));
        }
        
        return getDao().findPage(dc, start, limit);
    }
    /**
     * 
     *查找指定父节点下的所有子节点
     *〈详细描述〉
     * @author zhoupeng
     * @param parentId
     * @return
     */
    public List<FuncModule> findAllChild(String systemCode, Long parentId) {
        return menuDao.findAllChild(systemCode, parentId);
    }
    /**
     * 
     *〈简述〉
     *〈详细描述〉
     * @author zhoupeng
     * @return
     */
    public List<FuncModule> findRoot(String systemCode) {
        return menuDao.findRoot(systemCode);
    }
    
    public  void changeStatus(Long menuId,Integer status) {
        menuDao.changeStatus(menuId, status);
    }

}
