package com.xinleju.erp.flow.dao.impl;

import java.util.ArrayList;
import java.util.List;

import org.apache.commons.lang3.StringUtils;
import org.springframework.stereotype.Repository;

import com.xinleju.erp.flow.models.OpRelation;

/**
 * 操作组Service 版权：(C) 版权所有 2000-2014 上海天好电子商务有限公司苏州分公司 <简述> <详细描述>
 * 
 * @author jun
 * @version $Id$
 * @since
 * @see
 */
@Repository
public class OpRelationDAO extends BaseDAO {

    /**
     * 得到操作组
     * 
     * @author jun
     * @param opGroupId 操作组设置id
     * @return 操作组集合
     */
    public List<OpRelation> getOpRelationList(Long opGroupId) {
        return this.getOpRelationList(opGroupId, null);
    }
    /**
     *  得到操作列表
     * @author jun
     * @param opGroupId 操作组id
     * @param opUserType 操作组用户类型
     * @return 操作组
     */
    public List<OpRelation> getOpRelationList(Long opGroupId, String opUserType) {
        if (null == opGroupId){
            return new ArrayList<OpRelation>();
        } else if (StringUtils.isBlank(opUserType)){
            return getDao().findAll(OpRelation.class, "(isDisabled = 0 or isDisabled is null) and opGroupId = ? "
                    , new Object[]{opGroupId} , " sort asc ", new String[]{"op"});
        } else {
            return getDao().findAll(OpRelation.class, "(isDisabled = 0 or isDisabled is null) and opGroupId = ? and opUserType = ? "
                    , new Object[]{opGroupId, opUserType}, " sort asc ", new String[]{"op"});
        }
    }
    /**
     * 得到操作
     * @author jun
     * @param opGroupId 操作组id
     * @param opId 操作id
     * @param opUserType 操作组用户类型
     * @return 操作
     */
    public OpRelation getOpRelation(Long opGroupId, Long opId, String opUserType){
        return getDao().findFirst(OpRelation.class, "opGroupId = ? and opId = ? and opUserType = ?"
                , new Object[]{opGroupId, opId, opUserType}, " sort asc ", new String[]{"op"});
    }
}
