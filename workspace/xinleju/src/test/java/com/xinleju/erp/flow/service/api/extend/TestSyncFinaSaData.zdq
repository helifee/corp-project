package com.xinleju.erp.flow.service.api.extend;

import org.junit.Before;
import org.junit.Test;
import org.springframework.context.support.ClassPathXmlApplicationContext;

import com.xinleju.erp.flow.flowutils.bean.FlowResult;
import com.xinleju.erp.flow.flowutils.bean.PageBean;
import com.xinleju.erp.sm.cache.api.SyncFinaDataCompanyService;
import com.xinleju.erp.sm.cache.api.SyncFinaDataProjectBranchService;
import com.xinleju.erp.sm.cache.api.SyncFinaSaData;
import com.xinleju.erp.sm.extend.dto.FinaData;
import com.xinleju.erp.sm.extend.dto.FinaQueryParams;

/**
 * 测试财务接口-销售系统接口
 * 
 * @author walden
 * 
 */
public class TestSyncFinaSaData {

	private SyncFinaSaData syncFinaSaData;

	private SyncFinaDataCompanyService syncFinaDataCompanyService;
	private SyncFinaDataProjectBranchService syncFinaDataProjectBranch;

	@Before
	public void beforeClass() {
		ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(new String[] { "test-dubbo.xml" });
		context.start();
		syncFinaDataCompanyService = (SyncFinaDataCompanyService) context.getBean("syncFinaDataCompany");
		syncFinaDataProjectBranch = (SyncFinaDataProjectBranchService) context.getBean("syncFinaDataProjectBranch");
		// syncFinaSaData = (SyncFinaSaData) context.getBean("syncFinaSaData");
	}

	// @Test
	public void testFinaSaData() {
		FinaQueryParams params = new FinaQueryParams();
		FlowResult<PageBean<FinaData>> flowResult = syncFinaDataProjectBranch.getFinaData(params);
		if (flowResult.isSuccess()) {
			PageBean pageBean = flowResult.getResult();
			System.out.format("共%d条", pageBean.getTotal());
			for (Object obj : pageBean.getItems()) {
				FinaData finaData = (FinaData) obj;
				System.out.println("id:" + finaData.get("id"));
				System.out.println("name:" + finaData.get("name"));
				System.out.println("code:" + finaData.get("code"));
			}
		} else {
			System.out.println("销售接口返回报错信息：===>");
			for (String err : flowResult.getDebugInfo().getErrDesc()) {
				System.out.println(err);
			}
		}
	}

	@Test
	public void test() {
		FinaQueryParams params = new FinaQueryParams();
		syncFinaDataCompanyService.getFinaData(params);
	}
}
